{"episode_reward_max": -0.24947330500207776, "episode_reward_min": -0.7895248179840637, "episode_reward_mean": -0.5936629272307532, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6488425648633847, -0.6566129209265095, -0.24947330500207776, -0.6404220139400085, -0.7371774006773129, -0.7895248179840637, -0.6442829710303508, -0.3829674234223185], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.138384560490237, "mean_inference_ms": 1.1061903074805701, "mean_action_processing_ms": 0.047196486736257356, "mean_env_wait_ms": 1.063429369388985, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 14400, "timers": {"sample_time_ms": 4893.731, "sample_throughput": 2942.54, "learn_time_ms": 3334.341, "learn_throughput": 4318.695, "update_time_ms": 1.673}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.0019386378570204288, "policy_loss": -0.01813264550492827, "vf_loss": 0.00424922882183661, "vf_explained_var": 0.4497295022010803, "kl": 0.011944778008073304, "entropy": -3.4598639116878003, "entropy_coeff": 0.0}}, "num_steps_sampled": 14400, "num_steps_trained": 14400}, "done": false, "episodes_total": 8, "training_iteration": 1, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-18-14", "timestamp": 1617635894, "time_this_iter_s": 8.23261570930481, "time_total_s": 8.23261570930481, "pid": 9441, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.23261570930481, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.54999999999999, "ram_util_percent": 59.916666666666664}, "trial_id": "1bd20_00001"}
{"episode_reward_max": -0.22998251707788336, "episode_reward_min": -0.8651128120289899, "episode_reward_mean": -0.6046978688766943, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.22998251707788336, -0.676698953192475, -0.7255994266114805, -0.4499313387617719, -0.6143242885156396, -0.7137593977931935, -0.31606255465104516, -0.6484945312989496, -0.5986115783950853, -0.8651128120289899, -0.7496781420880192, -0.6050053302670069, -0.6861766838161967, -0.5275887059424147, -0.6792642777441233, -0.6771548970103605, -0.6488425648633847, -0.6566129209265095, -0.24947330500207776, -0.6404220139400085, -0.7371774006773129, -0.7895248179840637, -0.6442829710303508, -0.3829674234223185], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13774941440698973, "mean_inference_ms": 1.0294849151477976, "mean_action_processing_ms": 0.043848400933137945, "mean_env_wait_ms": 0.9699997136527815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 28800, "timers": {"sample_time_ms": 4265.792, "sample_throughput": 3375.692, "learn_time_ms": 3524.765, "learn_throughput": 4085.379, "update_time_ms": 1.59}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.0048042799931316245, "policy_loss": -0.017786148630610083, "vf_loss": 0.0034450633694475467, "vf_explained_var": 0.6258141994476318, "kl": 0.00953680606954525, "entropy": -3.4930916275598305, "entropy_coeff": 0.0}}, "num_steps_sampled": 28800, "num_steps_trained": 28800}, "done": false, "episodes_total": 24, "training_iteration": 2, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-18-22", "timestamp": 1617635902, "time_this_iter_s": 7.359977722167969, "time_total_s": 15.592593431472778, "pid": 9441, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.592593431472778, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 46.63636363636363, "ram_util_percent": 60.10909090909092}, "trial_id": "1bd20_00001"}
{"episode_reward_max": -0.22998251707788336, "episode_reward_min": -0.8651128120289899, "episode_reward_mean": -0.5917887702444015, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.672723714298747, -0.7543879099498232, -0.578269849372026, -0.2800665239691146, -0.39767667687460395, -0.24930390999860963, -0.7885217402250144, -0.4924904015713265, -0.7392122696333846, -0.6441941431398865, -0.5758414517881321, -0.6525719512703108, -0.7156260939457928, -0.6212720062055739, -0.7613892255377547, -0.23525408895529965, -0.6488425648633847, -0.6566129209265095, -0.24947330500207776, -0.6404220139400085, -0.7371774006773129, -0.7895248179840637, -0.6442829710303508, -0.3829674234223185, -0.22998251707788336, -0.676698953192475, -0.7255994266114805, -0.4499313387617719, -0.6143242885156396, -0.7137593977931935, -0.31606255465104516, -0.6484945312989496, -0.5986115783950853, -0.8651128120289899, -0.7496781420880192, -0.6050053302670069, -0.6861766838161967, -0.5275887059424147, -0.6792642777441233, -0.6771548970103605], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13654495861721294, "mean_inference_ms": 0.9890035917114585, "mean_action_processing_ms": 0.04203308354874804, "mean_env_wait_ms": 0.9213779928365513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 43200, "timers": {"sample_time_ms": 3982.471, "sample_throughput": 3615.846, "learn_time_ms": 3550.904, "learn_throughput": 4055.305, "update_time_ms": 1.678}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.004679448272109823, "policy_loss": -0.019141150135711757, "vf_loss": 0.004450488176229781, "vf_explained_var": 0.7004219889640808, "kl": 0.010011213757427393, "entropy": -3.473722677315231, "entropy_coeff": 0.0}}, "num_steps_sampled": 43200, "num_steps_trained": 43200}, "done": false, "episodes_total": 40, "training_iteration": 3, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-18-29", "timestamp": 1617635909, "time_this_iter_s": 7.027641534805298, "time_total_s": 22.620234966278076, "pid": 9441, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.620234966278076, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.900000000000006, "ram_util_percent": 60.20000000000001}, "trial_id": "1bd20_00001"}
{"episode_reward_max": -0.22998251707788336, "episode_reward_min": -0.8737457183692139, "episode_reward_mean": -0.6071092103474559, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.7931126799603838, -0.6975992707516457, -0.7152581674137268, -0.8214236814871202, -0.6098946835805689, -0.47042206805387443, -0.6313682888257779, -0.44888646040450014, -0.3911035868370399, -0.8453432660913722, -0.5662295767299865, -0.8737457183692139, -0.40114595161222283, -0.6758623169462271, -0.7930495251356178, -0.5921197274821888, -0.6488425648633847, -0.6566129209265095, -0.24947330500207776, -0.6404220139400085, -0.7371774006773129, -0.7895248179840637, -0.6442829710303508, -0.3829674234223185, -0.22998251707788336, -0.676698953192475, -0.7255994266114805, -0.4499313387617719, -0.6143242885156396, -0.7137593977931935, -0.31606255465104516, -0.6484945312989496, -0.5986115783950853, -0.8651128120289899, -0.7496781420880192, -0.6050053302670069, -0.6861766838161967, -0.5275887059424147, -0.6792642777441233, -0.6771548970103605, -0.672723714298747, -0.7543879099498232, -0.578269849372026, -0.2800665239691146, -0.39767667687460395, -0.24930390999860963, -0.7885217402250144, -0.4924904015713265, -0.7392122696333846, -0.6441941431398865, -0.5758414517881321, -0.6525719512703108, -0.7156260939457928, -0.6212720062055739, -0.7613892255377547, -0.23525408895529965], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13710216680241258, "mean_inference_ms": 0.974256223948391, "mean_action_processing_ms": 0.04138328880349088, "mean_env_wait_ms": 0.902252358734849, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 57600, "timers": {"sample_time_ms": 3995.924, "sample_throughput": 3603.672, "learn_time_ms": 3466.91, "learn_throughput": 4153.555, "update_time_ms": 1.612}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.009432099053875206, "policy_loss": -0.022683889951260215, "vf_loss": 0.003239618616376435, "vf_explained_var": 0.6557267904281616, "kl": 0.01001217009384284, "entropy": -3.5172547260216906, "entropy_coeff": 0.0}}, "num_steps_sampled": 57600, "num_steps_trained": 57600}, "done": false, "episodes_total": 56, "training_iteration": 4, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-18-36", "timestamp": 1617635916, "time_this_iter_s": 7.258753776550293, "time_total_s": 29.87898874282837, "pid": 9441, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.87898874282837, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.660000000000004, "ram_util_percent": 60.20000000000001}, "trial_id": "1bd20_00001"}
{"episode_reward_max": -0.22998251707788336, "episode_reward_min": -0.8737457183692139, "episode_reward_mean": -0.593598877014749, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.39817110297702657, -0.6642105398858374, -0.44758620652302594, -0.6292269902470059, -0.6605395898930766, -0.5556651300663672, -0.7743911385825727, -0.26838939725990485, -0.25866427269594494, -0.4944088639466879, -0.6821434173479757, -0.4680501267670669, -0.3094354002410734, -0.7889953905962952, -0.5959827231605772, -0.7451430754139632, -0.6488425648633847, -0.6566129209265095, -0.24947330500207776, -0.6404220139400085, -0.7371774006773129, -0.7895248179840637, -0.6442829710303508, -0.3829674234223185, -0.22998251707788336, -0.676698953192475, -0.7255994266114805, -0.4499313387617719, -0.6143242885156396, -0.7137593977931935, -0.31606255465104516, -0.6484945312989496, -0.5986115783950853, -0.8651128120289899, -0.7496781420880192, -0.6050053302670069, -0.6861766838161967, -0.5275887059424147, -0.6792642777441233, -0.6771548970103605, -0.672723714298747, -0.7543879099498232, -0.578269849372026, -0.2800665239691146, -0.39767667687460395, -0.24930390999860963, -0.7885217402250144, -0.4924904015713265, -0.7392122696333846, -0.6441941431398865, -0.5758414517881321, -0.6525719512703108, -0.7156260939457928, -0.6212720062055739, -0.7613892255377547, -0.23525408895529965, -0.7931126799603838, -0.6975992707516457, -0.7152581674137268, -0.8214236814871202, -0.6098946835805689, -0.47042206805387443, -0.6313682888257779, -0.44888646040450014, -0.3911035868370399, -0.8453432660913722, -0.5662295767299865, -0.8737457183692139, -0.40114595161222283, -0.6758623169462271, -0.7930495251356178, -0.5921197274821888], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13974159592793062, "mean_inference_ms": 0.9743543594008588, "mean_action_processing_ms": 0.041381051785387264, "mean_env_wait_ms": 0.8996288711901007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 72000, "timers": {"sample_time_ms": 4150.181, "sample_throughput": 3469.728, "learn_time_ms": 3443.482, "learn_throughput": 4181.813, "update_time_ms": 1.604}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.01012542074859406, "policy_loss": -0.025002806505138895, "vf_loss": 0.0037487617763896693, "vf_explained_var": 0.7386220693588257, "kl": 0.011128624299524633, "entropy": -3.5325821880745676, "entropy_coeff": 0.0}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 72, "training_iteration": 5, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-18-44", "timestamp": 1617635924, "time_this_iter_s": 8.12410306930542, "time_total_s": 38.00309181213379, "pid": 9441, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.00309181213379, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 54.691666666666656, "ram_util_percent": 60.35833333333333}, "trial_id": "1bd20_00001"}
{"episode_reward_max": -0.22998251707788336, "episode_reward_min": -0.8737457183692139, "episode_reward_mean": -0.5962933875488133, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.650105866645837, -0.4965292619105173, -0.6959497103475407, -0.6921127987324003, -0.5704155891968526, -0.7193354855098661, -0.520336720021716, -0.6195664264784092, -0.6488425648633847, -0.6566129209265095, -0.24947330500207776, -0.6404220139400085, -0.7371774006773129, -0.7895248179840637, -0.6442829710303508, -0.3829674234223185, -0.22998251707788336, -0.676698953192475, -0.7255994266114805, -0.4499313387617719, -0.6143242885156396, -0.7137593977931935, -0.31606255465104516, -0.6484945312989496, -0.5986115783950853, -0.8651128120289899, -0.7496781420880192, -0.6050053302670069, -0.6861766838161967, -0.5275887059424147, -0.6792642777441233, -0.6771548970103605, -0.672723714298747, -0.7543879099498232, -0.578269849372026, -0.2800665239691146, -0.39767667687460395, -0.24930390999860963, -0.7885217402250144, -0.4924904015713265, -0.7392122696333846, -0.6441941431398865, -0.5758414517881321, -0.6525719512703108, -0.7156260939457928, -0.6212720062055739, -0.7613892255377547, -0.23525408895529965, -0.7931126799603838, -0.6975992707516457, -0.7152581674137268, -0.8214236814871202, -0.6098946835805689, -0.47042206805387443, -0.6313682888257779, -0.44888646040450014, -0.3911035868370399, -0.8453432660913722, -0.5662295767299865, -0.8737457183692139, -0.40114595161222283, -0.6758623169462271, -0.7930495251356178, -0.5921197274821888, -0.39817110297702657, -0.6642105398858374, -0.44758620652302594, -0.6292269902470059, -0.6605395898930766, -0.5556651300663672, -0.7743911385825727, -0.26838939725990485, -0.25866427269594494, -0.4944088639466879, -0.6821434173479757, -0.4680501267670669, -0.3094354002410734, -0.7889953905962952, -0.5959827231605772, -0.7451430754139632], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13985214026778398, "mean_inference_ms": 0.9725684612197145, "mean_action_processing_ms": 0.04130315336799989, "mean_env_wait_ms": 0.8967025218044696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 86400, "timers": {"sample_time_ms": 4049.409, "sample_throughput": 3556.074, "learn_time_ms": 3513.299, "learn_throughput": 4098.712, "update_time_ms": 1.583}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.012722603366833873, "policy_loss": -0.02730688424492502, "vf_loss": 0.0033607193623232633, "vf_explained_var": 0.742518961429596, "kl": 0.011223561798049285, "entropy": -3.5324843689403704, "entropy_coeff": 0.0}}, "num_steps_sampled": 86400, "num_steps_trained": 86400}, "done": false, "episodes_total": 80, "training_iteration": 6, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-18-52", "timestamp": 1617635932, "time_this_iter_s": 7.414444923400879, "time_total_s": 45.41753673553467, "pid": 9441, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.41753673553467, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 49.28999999999999, "ram_util_percent": 60.329999999999984}, "trial_id": "1bd20_00001"}
{"episode_reward_max": -0.06651897114915406, "episode_reward_min": -0.8737457183692139, "episode_reward_mean": -0.584212568294217, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.7021288041708186, -0.6381675728070434, -0.6799520650721602, -0.6514828026834723, -0.06651897114915406, -0.6423169576538261, -0.30733482573652626, -0.5623210384662606, -0.5692123128169654, -0.4824542105288905, -0.44061752224403883, -0.5931702698062846, -0.6286485229475705, -0.4033710995382642, -0.34855527035857164, -0.6646833063599189, -0.6488425648633847, -0.6566129209265095, -0.24947330500207776, -0.6404220139400085, -0.7371774006773129, -0.7895248179840637, -0.6442829710303508, -0.3829674234223185, -0.22998251707788336, -0.676698953192475, -0.7255994266114805, -0.4499313387617719, -0.6143242885156396, -0.7137593977931935, -0.31606255465104516, -0.6484945312989496, -0.5986115783950853, -0.8651128120289899, -0.7496781420880192, -0.6050053302670069, -0.6861766838161967, -0.5275887059424147, -0.6792642777441233, -0.6771548970103605, -0.672723714298747, -0.7543879099498232, -0.578269849372026, -0.2800665239691146, -0.39767667687460395, -0.24930390999860963, -0.7885217402250144, -0.4924904015713265, -0.7392122696333846, -0.6441941431398865, -0.5758414517881321, -0.6525719512703108, -0.7156260939457928, -0.6212720062055739, -0.7613892255377547, -0.23525408895529965, -0.7931126799603838, -0.6975992707516457, -0.7152581674137268, -0.8214236814871202, -0.6098946835805689, -0.47042206805387443, -0.6313682888257779, -0.44888646040450014, -0.3911035868370399, -0.8453432660913722, -0.5662295767299865, -0.8737457183692139, -0.40114595161222283, -0.6758623169462271, -0.7930495251356178, -0.5921197274821888, -0.39817110297702657, -0.6642105398858374, -0.44758620652302594, -0.6292269902470059, -0.6605395898930766, -0.5556651300663672, -0.7743911385825727, -0.26838939725990485, -0.25866427269594494, -0.4944088639466879, -0.6821434173479757, -0.4680501267670669, -0.3094354002410734, -0.7889953905962952, -0.5959827231605772, -0.7451430754139632, -0.650105866645837, -0.4965292619105173, -0.6959497103475407, -0.6921127987324003, -0.5704155891968526, -0.7193354855098661, -0.520336720021716, -0.6195664264784092], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1397861512164664, "mean_inference_ms": 0.9679309974094408, "mean_action_processing_ms": 0.04101536168852288, "mean_env_wait_ms": 0.8881530834997893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 100800, "timers": {"sample_time_ms": 3962.851, "sample_throughput": 3633.747, "learn_time_ms": 3521.587, "learn_throughput": 4089.065, "update_time_ms": 1.577}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.011343439348635421, "policy_loss": -0.02808064170000432, "vf_loss": 0.003909675105664451, "vf_explained_var": 0.7341094613075256, "kl": 0.012827527173588761, "entropy": -3.5616519577735293, "entropy_coeff": 0.0}}, "num_steps_sampled": 100800, "num_steps_trained": 100800}, "done": false, "episodes_total": 96, "training_iteration": 7, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-18-59", "timestamp": 1617635939, "time_this_iter_s": 7.024042844772339, "time_total_s": 52.44157958030701, "pid": 9441, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.44157958030701, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.27, "ram_util_percent": 60.29999999999999}, "trial_id": "1bd20_00001"}
{"episode_reward_max": -0.15825027465848296, "episode_reward_min": -0.7087945584236905, "episode_reward_mean": -0.46141878895649685, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3958914176584347, -0.6309406969654936, -0.3900275574737898, -0.5470910597546703, -0.4654126357042271, -0.7087945584236905, -0.39494211101318566, -0.15825027465848296], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1053693789630913, "mean_inference_ms": 0.9366643720041177, "mean_action_processing_ms": 0.04064166367153271, "mean_env_wait_ms": 0.8855082636604965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 115200, "timers": {"sample_time_ms": 4389.678, "sample_throughput": 3280.423, "learn_time_ms": 4022.494, "learn_throughput": 3579.869, "update_time_ms": 1.652}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.011813505437324005, "policy_loss": -0.02865366275067878, "vf_loss": 0.004218419624360657, "vf_explained_var": 0.6981343626976013, "kl": 0.012621736269345325, "entropy": -3.5543066970014996, "entropy_coeff": 0.0}}, "num_steps_sampled": 115200, "num_steps_trained": 115200}, "done": false, "episodes_total": 104, "training_iteration": 8, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-20-23", "timestamp": 1617636023, "time_this_iter_s": 8.416605710983276, "time_total_s": 60.85818529129028, "pid": 10304, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.416605710983276, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.092307692307685, "ram_util_percent": 60.084615384615404}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 0.2686691476130816, "episode_reward_min": -0.7087945584236905, "episode_reward_mean": -0.4579585556916763, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.7018004562220067, 0.2686691476130816, -0.6610300290962772, -0.33101685797390035, -0.5680226264413692, -0.4334062905186428, -0.5975540938728012, -0.4819725840659563, -0.2789981760525609, -0.4019165206383785, -0.544077336320399, -0.5200877832239417, -0.4792049401117462, -0.6215010001753571, -0.5349382142765332, -0.41279726357146757, -0.3958914176584347, -0.6309406969654936, -0.3900275574737898, -0.5470910597546703, -0.4654126357042271, -0.7087945584236905, -0.39494211101318566, -0.15825027465848296], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12588206454232495, "mean_inference_ms": 0.9360381521379694, "mean_action_processing_ms": 0.040474263659442004, "mean_env_wait_ms": 0.8702764698071047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 129600, "timers": {"sample_time_ms": 4231.927, "sample_throughput": 3402.705, "learn_time_ms": 4075.695, "learn_throughput": 3533.14, "update_time_ms": 1.486}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.009775113054773712, "policy_loss": -0.02723923346143117, "vf_loss": 0.004956312807260361, "vf_explained_var": 0.7642966508865356, "kl": 0.01250780689472382, "entropy": -3.5683784126180464, "entropy_coeff": 0.0}}, "num_steps_sampled": 129600, "num_steps_trained": 129600}, "done": false, "episodes_total": 120, "training_iteration": 9, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-20-31", "timestamp": 1617636031, "time_this_iter_s": 8.209084272384644, "time_total_s": 69.06726956367493, "pid": 10304, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.62568998336792, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.945454545454545, "ram_util_percent": 60.20000000000002}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 0.2686691476130816, "episode_reward_min": -0.7384196227542146, "episode_reward_mean": -0.43594677724863506, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6112498009237509, -0.5527009855135453, -0.6093057788659602, -0.4168348826370383, 0.019835559252694646, -0.42420272416026794, -0.08090037867551736, -0.7070497720414681, -0.33228802593460754, -0.4156846258793532, -0.12409340281196812, -0.7384196227542146, -0.6531297812622059, 0.2525540892834519, -0.7320395553318662, -0.32135606508955794, -0.3958914176584347, -0.6309406969654936, -0.3900275574737898, -0.5470910597546703, -0.4654126357042271, -0.7087945584236905, -0.39494211101318566, -0.15825027465848296, -0.7018004562220067, 0.2686691476130816, -0.6610300290962772, -0.33101685797390035, -0.5680226264413692, -0.4334062905186428, -0.5975540938728012, -0.4819725840659563, -0.2789981760525609, -0.4019165206383785, -0.544077336320399, -0.5200877832239417, -0.4792049401117462, -0.6215010001753571, -0.5349382142765332, -0.41279726357146757], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13610903800245217, "mean_inference_ms": 0.9472191574305414, "mean_action_processing_ms": 0.04045021410551937, "mean_env_wait_ms": 0.8646497034501589, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 144000, "timers": {"sample_time_ms": 4220.809, "sample_throughput": 3411.668, "learn_time_ms": 4150.866, "learn_throughput": 3469.156, "update_time_ms": 1.654}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.013042733085597247, "policy_loss": -0.03211606529631973, "vf_loss": 0.005765434840809455, "vf_explained_var": 0.7308993339538574, "kl": 0.013307895915236621, "entropy": -3.5540905927134827, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 136, "training_iteration": 10, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-20-40", "timestamp": 1617636040, "time_this_iter_s": 8.508987188339233, "time_total_s": 77.57625675201416, "pid": 10304, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.134677171707153, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.50833333333333, "ram_util_percent": 60.20000000000002}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 0.2686691476130816, "episode_reward_min": -0.7384196227542146, "episode_reward_mean": -0.41062483592693905, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.17496213652449388, -0.4761093032622559, -0.41745715826516294, -0.28215621585342876, -0.42927729020222677, -0.3611061174059411, -0.6748918175637276, -0.08902619299379089, -0.2645106455207755, -0.19047778983822672, -0.05103276459494532, -0.5882521559935461, -0.2797120530458084, -0.40356798884846845, -0.27813909908703466, -0.5964409929633439, -0.3958914176584347, -0.6309406969654936, -0.3900275574737898, -0.5470910597546703, -0.4654126357042271, -0.7087945584236905, -0.39494211101318566, -0.15825027465848296, -0.7018004562220067, 0.2686691476130816, -0.6610300290962772, -0.33101685797390035, -0.5680226264413692, -0.4334062905186428, -0.5975540938728012, -0.4819725840659563, -0.2789981760525609, -0.4019165206383785, -0.544077336320399, -0.5200877832239417, -0.4792049401117462, -0.6215010001753571, -0.5349382142765332, -0.41279726357146757, -0.6112498009237509, -0.5527009855135453, -0.6093057788659602, -0.4168348826370383, 0.019835559252694646, -0.42420272416026794, -0.08090037867551736, -0.7070497720414681, -0.33228802593460754, -0.4156846258793532, -0.12409340281196812, -0.7384196227542146, -0.6531297812622059, 0.2525540892834519, -0.7320395553318662, -0.32135606508955794], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13958912818117736, "mean_inference_ms": 0.9485847003366998, "mean_action_processing_ms": 0.04034808463139994, "mean_env_wait_ms": 0.8590800060718861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 158400, "timers": {"sample_time_ms": 4112.231, "sample_throughput": 3501.749, "learn_time_ms": 4175.218, "learn_throughput": 3448.922, "update_time_ms": 1.666}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.015004029872505802, "policy_loss": -0.035369102480466916, "vf_loss": 0.005110374025473025, "vf_explained_var": 0.7226635217666626, "kl": 0.015254700902552732, "entropy": -3.5427717360775026, "entropy_coeff": 0.0}}, "num_steps_sampled": 158400, "num_steps_trained": 158400}, "done": false, "episodes_total": 152, "training_iteration": 11, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-20-48", "timestamp": 1617636048, "time_this_iter_s": 8.04370379447937, "time_total_s": 85.61996054649353, "pid": 10304, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.17838096618652, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.24166666666667, "ram_util_percent": 60.20000000000002}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 0.2686691476130816, "episode_reward_min": -0.7702329659711303, "episode_reward_mean": -0.3849810722419581, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.008034991925921053, -0.35773721425117155, -0.49341980136095814, 0.02203713745661906, -0.09005188878548254, -0.4904319583206545, -0.5990901162787297, -0.5497349546262902, -0.3826818310943427, -0.16249618430199086, -0.7702329659711303, -0.6035956179433226, -0.09151346351861, 0.026033522093403816, -0.4548056252916514, 0.266039580755993, -0.3958914176584347, -0.6309406969654936, -0.3900275574737898, -0.5470910597546703, -0.4654126357042271, -0.7087945584236905, -0.39494211101318566, -0.15825027465848296, -0.7018004562220067, 0.2686691476130816, -0.6610300290962772, -0.33101685797390035, -0.5680226264413692, -0.4334062905186428, -0.5975540938728012, -0.4819725840659563, -0.2789981760525609, -0.4019165206383785, -0.544077336320399, -0.5200877832239417, -0.4792049401117462, -0.6215010001753571, -0.5349382142765332, -0.41279726357146757, -0.6112498009237509, -0.5527009855135453, -0.6093057788659602, -0.4168348826370383, 0.019835559252694646, -0.42420272416026794, -0.08090037867551736, -0.7070497720414681, -0.33228802593460754, -0.4156846258793532, -0.12409340281196812, -0.7384196227542146, -0.6531297812622059, 0.2525540892834519, -0.7320395553318662, -0.32135606508955794, -0.17496213652449388, -0.4761093032622559, -0.41745715826516294, -0.28215621585342876, -0.42927729020222677, -0.3611061174059411, -0.6748918175637276, -0.08902619299379089, -0.2645106455207755, -0.19047778983822672, -0.05103276459494532, -0.5882521559935461, -0.2797120530458084, -0.40356798884846845, -0.27813909908703466, -0.5964409929633439], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1425446492995926, "mean_inference_ms": 0.9464826592125536, "mean_action_processing_ms": 0.04020009654861074, "mean_env_wait_ms": 0.8535655020041196, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 172800, "timers": {"sample_time_ms": 4052.602, "sample_throughput": 3553.273, "learn_time_ms": 4220.597, "learn_throughput": 3411.839, "update_time_ms": 1.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.01474302843938359, "policy_loss": -0.034331117031387, "vf_loss": 0.005345358037332122, "vf_explained_var": 0.7417370080947876, "kl": 0.014242730012773413, "entropy": -3.5424725798379004, "entropy_coeff": 0.0}}, "num_steps_sampled": 172800, "num_steps_trained": 172800}, "done": false, "episodes_total": 168, "training_iteration": 12, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-20-56", "timestamp": 1617636056, "time_this_iter_s": 8.22288990020752, "time_total_s": 93.84285044670105, "pid": 10304, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.40127086639404, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.21666666666666, "ram_util_percent": 59.19166666666666}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 0.2686691476130816, "episode_reward_min": -0.7702329659711303, "episode_reward_mean": -0.37015372284186593, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2738634398286749, -0.424723629146323, -0.4715588578919499, 0.2009601944785817, -0.567851679309551, 0.1699306409731085, -0.323465030339698, -0.20308882486378754, -0.3958914176584347, -0.6309406969654936, -0.3900275574737898, -0.5470910597546703, -0.4654126357042271, -0.7087945584236905, -0.39494211101318566, -0.15825027465848296, -0.7018004562220067, 0.2686691476130816, -0.6610300290962772, -0.33101685797390035, -0.5680226264413692, -0.4334062905186428, -0.5975540938728012, -0.4819725840659563, -0.2789981760525609, -0.4019165206383785, -0.544077336320399, -0.5200877832239417, -0.4792049401117462, -0.6215010001753571, -0.5349382142765332, -0.41279726357146757, -0.6112498009237509, -0.5527009855135453, -0.6093057788659602, -0.4168348826370383, 0.019835559252694646, -0.42420272416026794, -0.08090037867551736, -0.7070497720414681, -0.33228802593460754, -0.4156846258793532, -0.12409340281196812, -0.7384196227542146, -0.6531297812622059, 0.2525540892834519, -0.7320395553318662, -0.32135606508955794, -0.17496213652449388, -0.4761093032622559, -0.41745715826516294, -0.28215621585342876, -0.42927729020222677, -0.3611061174059411, -0.6748918175637276, -0.08902619299379089, -0.2645106455207755, -0.19047778983822672, -0.05103276459494532, -0.5882521559935461, -0.2797120530458084, -0.40356798884846845, -0.27813909908703466, -0.5964409929633439, 0.008034991925921053, -0.35773721425117155, -0.49341980136095814, 0.02203713745661906, -0.09005188878548254, -0.4904319583206545, -0.5990901162787297, -0.5497349546262902, -0.3826818310943427, -0.16249618430199086, -0.7702329659711303, -0.6035956179433226, -0.09151346351861, 0.026033522093403816, -0.4548056252916514, 0.266039580755993], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14340374553695168, "mean_inference_ms": 0.9496480263731121, "mean_action_processing_ms": 0.040340511241369253, "mean_env_wait_ms": 0.8556275828471007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 187200, "timers": {"sample_time_ms": 4191.134, "sample_throughput": 3435.824, "learn_time_ms": 4218.297, "learn_throughput": 3413.7, "update_time_ms": 1.668}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.010629363242635685, "policy_loss": -0.03035154943230801, "vf_loss": 0.00594169381527906, "vf_explained_var": 0.7587617039680481, "kl": 0.013780492160106655, "entropy": -3.5528832874466887, "entropy_coeff": 0.0}}, "num_steps_sampled": 187200, "num_steps_trained": 187200}, "done": false, "episodes_total": 176, "training_iteration": 13, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-21-05", "timestamp": 1617636065, "time_this_iter_s": 9.09777569770813, "time_total_s": 102.94062614440918, "pid": 10304, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.49904656410217, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 54.79230769230768, "ram_util_percent": 58.77692307692307}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 0.047491237738134906, "episode_reward_min": -0.7289133214733275, "episode_reward_mean": -0.34209911107361846, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.7289133214733275, -0.17830243918484, -0.20070254017069644, -0.6115495561292633, -0.1932278820175123, -0.51969948528358, -0.351888902067863, 0.047491237738134906], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11284615449412935, "mean_inference_ms": 0.9219303090065336, "mean_action_processing_ms": 0.039554913132671246, "mean_env_wait_ms": 0.8835422535991084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 201600, "timers": {"sample_time_ms": 4427.258, "sample_throughput": 3252.578, "learn_time_ms": 4197.152, "learn_throughput": 3430.898, "update_time_ms": 1.417}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.011322068273032133, "policy_loss": -0.030952267027336413, "vf_loss": 0.006005987619766883, "vf_explained_var": 0.7572543621063232, "kl": 0.013624210108434204, "entropy": -3.594882254051951, "entropy_coeff": 0.0}}, "num_steps_sampled": 201600, "num_steps_trained": 201600}, "done": false, "episodes_total": 184, "training_iteration": 14, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-22-25", "timestamp": 1617636145, "time_this_iter_s": 8.629625797271729, "time_total_s": 111.57025194168091, "pid": 11229, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.629625797271729, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.23076923076922, "ram_util_percent": 60.23846153846152}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 0.19416386779694816, "episode_reward_min": -0.7289133214733275, "episode_reward_mean": -0.2607676354304605, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.06563542696055524, -0.2885962711861376, 0.09324302598924628, -0.15263465768838802, 0.19416386779694816, 0.048069306145653634, -0.4641429204089256, -0.43672220202073464, -0.379364923222769, -0.533688821302621, -0.5223692724133449, -0.06438116897205293, -0.49748990134146875, -0.015876617356717748, -0.2613617511885439, -0.30611348153280316, -0.7289133214733275, -0.17830243918484, -0.20070254017069644, -0.6115495561292633, -0.1932278820175123, -0.51969948528358, -0.351888902067863, 0.047491237738134906], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12719893689273476, "mean_inference_ms": 0.9266622427340606, "mean_action_processing_ms": 0.039749188205320946, "mean_env_wait_ms": 0.870518535310855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 216000, "timers": {"sample_time_ms": 4210.75, "sample_throughput": 3419.818, "learn_time_ms": 4309.922, "learn_throughput": 3341.127, "update_time_ms": 1.542}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.011634610065844207, "policy_loss": -0.03255572344745155, "vf_loss": 0.007160209230584117, "vf_explained_var": 0.7593502402305603, "kl": 0.013760904707344233, "entropy": -3.6409872021295326, "entropy_coeff": 0.0}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 200, "training_iteration": 15, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-22-33", "timestamp": 1617636153, "time_this_iter_s": 8.423768043518066, "time_total_s": 119.99401998519897, "pid": 11229, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.053393840789795, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.94166666666667, "ram_util_percent": 60.50833333333333}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 1.5595447164753793, "episode_reward_min": -0.7289133214733275, "episode_reward_mean": -0.15045358568831096, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.00111362276473026, 0.6185791334196595, -0.21579234325052077, -0.19618221160259108, -0.11095996292488186, 0.25831420191309284, -0.016083558393283126, -0.446673782600689, 1.5595447164753793, -0.22840834929829523, -0.16082942497319286, 0.2375146707883331, -0.6550462708296663, 0.13336051812797622, -0.08573725565176815, -0.45020663563620894, -0.7289133214733275, -0.17830243918484, -0.20070254017069644, -0.6115495561292633, -0.1932278820175123, -0.51969948528358, -0.351888902067863, 0.047491237738134906, 0.06563542696055524, -0.2885962711861376, 0.09324302598924628, -0.15263465768838802, 0.19416386779694816, 0.048069306145653634, -0.4641429204089256, -0.43672220202073464, -0.379364923222769, -0.533688821302621, -0.5223692724133449, -0.06438116897205293, -0.49748990134146875, -0.015876617356717748, -0.2613617511885439, -0.30611348153280316], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1316018325435347, "mean_inference_ms": 0.9425448648383435, "mean_action_processing_ms": 0.03988559025554354, "mean_env_wait_ms": 0.866925292876978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 230400, "timers": {"sample_time_ms": 4191.687, "sample_throughput": 3435.371, "learn_time_ms": 4324.262, "learn_throughput": 3330.048, "update_time_ms": 1.575}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.010162497087653759, "policy_loss": -0.035689529509539096, "vf_loss": 0.008730171273042143, "vf_explained_var": 0.7128196358680725, "kl": 0.01679686100873272, "entropy": -3.631080903838166, "entropy_coeff": 0.0}}, "num_steps_sampled": 230400, "num_steps_trained": 230400}, "done": false, "episodes_total": 216, "training_iteration": 16, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-22-42", "timestamp": 1617636162, "time_this_iter_s": 8.513366222381592, "time_total_s": 128.50738620758057, "pid": 11229, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.566760063171387, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.93333333333333, "ram_util_percent": 60.36666666666665}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 1.5595447164753793, "episode_reward_min": -0.7289133214733275, "episode_reward_mean": -0.16802686544579898, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4805089950499377, -0.09557611806550048, -0.283683449244164, 0.19630750049701096, 0.6086621509030965, -0.2514546137025018, -0.4331433825080713, 0.18891535640574886, -0.5476382360650347, -0.4716709530383384, -0.10352757710320437, -0.3994246385382738, -0.5894940767183594, -0.4755236206066463, -0.47582381241834715, 0.22222342782021864, -0.7289133214733275, -0.17830243918484, -0.20070254017069644, -0.6115495561292633, -0.1932278820175123, -0.51969948528358, -0.351888902067863, 0.047491237738134906, 0.06563542696055524, -0.2885962711861376, 0.09324302598924628, -0.15263465768838802, 0.19416386779694816, 0.048069306145653634, -0.4641429204089256, -0.43672220202073464, -0.379364923222769, -0.533688821302621, -0.5223692724133449, -0.06438116897205293, -0.49748990134146875, -0.015876617356717748, -0.2613617511885439, -0.30611348153280316, -0.00111362276473026, 0.6185791334196595, -0.21579234325052077, -0.19618221160259108, -0.11095996292488186, 0.25831420191309284, -0.016083558393283126, -0.446673782600689, 1.5595447164753793, -0.22840834929829523, -0.16082942497319286, 0.2375146707883331, -0.6550462708296663, 0.13336051812797622, -0.08573725565176815, -0.45020663563620894], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1340374167001461, "mean_inference_ms": 0.9496426608456526, "mean_action_processing_ms": 0.04002837524657981, "mean_env_wait_ms": 0.866068017025904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 244800, "timers": {"sample_time_ms": 4179.707, "sample_throughput": 3445.217, "learn_time_ms": 4268.991, "learn_throughput": 3373.162, "update_time_ms": 1.545}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.01045394986373397, "policy_loss": -0.034697463727696276, "vf_loss": 0.00898168644810145, "vf_explained_var": 0.6786423921585083, "kl": 0.015261827819708702, "entropy": -3.6470983682480536, "entropy_coeff": 0.0}}, "num_steps_sampled": 244800, "num_steps_trained": 244800}, "done": false, "episodes_total": 232, "training_iteration": 17, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-22-50", "timestamp": 1617636170, "time_this_iter_s": 8.254627704620361, "time_total_s": 136.76201391220093, "pid": 11229, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.82138776779175, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.3, "ram_util_percent": 60.383333333333326}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 1.5595447164753793, "episode_reward_min": -0.7289133214733275, "episode_reward_mean": -0.09722452651687218, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.20999947888914705, 0.3608615922927323, 0.15423643368842366, -0.04324873672117624, 1.3087158766894929, -0.19737095604639987, -0.2955007818298786, 0.3596881064575741, -0.1864947577571544, -0.2073578191235279, 0.49185875629220055, -0.47787144794904707, 1.055942314625352, -0.20653262067398148, -0.33683946376468543, 0.8392515384591681, -0.7289133214733275, -0.17830243918484, -0.20070254017069644, -0.6115495561292633, -0.1932278820175123, -0.51969948528358, -0.351888902067863, 0.047491237738134906, 0.06563542696055524, -0.2885962711861376, 0.09324302598924628, -0.15263465768838802, 0.19416386779694816, 0.048069306145653634, -0.4641429204089256, -0.43672220202073464, -0.379364923222769, -0.533688821302621, -0.5223692724133449, -0.06438116897205293, -0.49748990134146875, -0.015876617356717748, -0.2613617511885439, -0.30611348153280316, -0.00111362276473026, 0.6185791334196595, -0.21579234325052077, -0.19618221160259108, -0.11095996292488186, 0.25831420191309284, -0.016083558393283126, -0.446673782600689, 1.5595447164753793, -0.22840834929829523, -0.16082942497319286, 0.2375146707883331, -0.6550462708296663, 0.13336051812797622, -0.08573725565176815, -0.45020663563620894, -0.4805089950499377, -0.09557611806550048, -0.283683449244164, 0.19630750049701096, 0.6086621509030965, -0.2514546137025018, -0.4331433825080713, 0.18891535640574886, -0.5476382360650347, -0.4716709530383384, -0.10352757710320437, -0.3994246385382738, -0.5894940767183594, -0.4755236206066463, -0.47582381241834715, 0.22222342782021864], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13585872785665545, "mean_inference_ms": 0.9544316066151168, "mean_action_processing_ms": 0.04022793688096017, "mean_env_wait_ms": 0.8674500798091805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 259200, "timers": {"sample_time_ms": 4177.79, "sample_throughput": 3446.798, "learn_time_ms": 4339.927, "learn_throughput": 3318.028, "update_time_ms": 1.53}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.00940578375671026, "policy_loss": -0.036169806845585066, "vf_loss": 0.01079452275174909, "vf_explained_var": 0.7210438251495361, "kl": 0.01596949853629401, "entropy": -3.6861264220381207, "entropy_coeff": 0.0}}, "num_steps_sampled": 259200, "num_steps_trained": 259200}, "done": false, "episodes_total": 248, "training_iteration": 18, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-22-59", "timestamp": 1617636179, "time_this_iter_s": 8.801902770996094, "time_total_s": 145.56391668319702, "pid": 11229, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.62329053878784, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.68333333333333, "ram_util_percent": 57.44166666666667}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 1.5595447164753793, "episode_reward_min": -0.7289133214733275, "episode_reward_mean": -0.06445100534713896, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.13985414329579182, -0.04959600040077239, 0.14305717257596973, 0.03418071605812223, 0.28575232454089106, 0.05398226002753015, 0.41504473665970365, 0.8218101286864434, -0.7289133214733275, -0.17830243918484, -0.20070254017069644, -0.6115495561292633, -0.1932278820175123, -0.51969948528358, -0.351888902067863, 0.047491237738134906, 0.06563542696055524, -0.2885962711861376, 0.09324302598924628, -0.15263465768838802, 0.19416386779694816, 0.048069306145653634, -0.4641429204089256, -0.43672220202073464, -0.379364923222769, -0.533688821302621, -0.5223692724133449, -0.06438116897205293, -0.49748990134146875, -0.015876617356717748, -0.2613617511885439, -0.30611348153280316, -0.00111362276473026, 0.6185791334196595, -0.21579234325052077, -0.19618221160259108, -0.11095996292488186, 0.25831420191309284, -0.016083558393283126, -0.446673782600689, 1.5595447164753793, -0.22840834929829523, -0.16082942497319286, 0.2375146707883331, -0.6550462708296663, 0.13336051812797622, -0.08573725565176815, -0.45020663563620894, -0.4805089950499377, -0.09557611806550048, -0.283683449244164, 0.19630750049701096, 0.6086621509030965, -0.2514546137025018, -0.4331433825080713, 0.18891535640574886, -0.5476382360650347, -0.4716709530383384, -0.10352757710320437, -0.3994246385382738, -0.5894940767183594, -0.4755236206066463, -0.47582381241834715, 0.22222342782021864, -0.20999947888914705, 0.3608615922927323, 0.15423643368842366, -0.04324873672117624, 1.3087158766894929, -0.19737095604639987, -0.2955007818298786, 0.3596881064575741, -0.1864947577571544, -0.2073578191235279, 0.49185875629220055, -0.47787144794904707, 1.055942314625352, -0.20653262067398148, -0.33683946376468543, 0.8392515384591681], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13619665764191533, "mean_inference_ms": 0.9570265663187388, "mean_action_processing_ms": 0.040347321102402314, "mean_env_wait_ms": 0.8688949958597336, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 273600, "timers": {"sample_time_ms": 4169.258, "sample_throughput": 3453.852, "learn_time_ms": 4342.854, "learn_throughput": 3315.792, "update_time_ms": 1.528}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0007034605257580964, "total_loss": -0.008793008250011279, "policy_loss": -0.03566464724068621, "vf_loss": 0.010591664227896033, "vf_explained_var": 0.7452827095985413, "kl": 0.016279974062226515, "entropy": -3.690517526812258, "entropy_coeff": 0.0}}, "num_steps_sampled": 273600, "num_steps_trained": 273600}, "done": false, "episodes_total": 256, "training_iteration": 19, "experiment_id": "1f47f920055a4d66b20dd99fc7f29649", "date": "2021-04-05_08-23-07", "timestamp": 1617636187, "time_this_iter_s": 8.490839719772339, "time_total_s": 154.05475640296936, "pid": 11229, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 14028, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 5, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0007034605257580964, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9900149854845713, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.48794861614965035, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.11413025856018, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 49.57692307692308, "ram_util_percent": 60.48461538461539}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 12.312258752080066, "episode_reward_min": 2.360780059653334, "episode_reward_mean": 6.039885094879219, "episode_len_mean": 1000.0, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.65665741385892, 2.7502983655378634, 5.272097863248066, 7.783989131068655, 5.607629212490035, 10.506394209649718, 6.716966675177801, 3.6740226405385616, 5.880012884697057, 3.623168540913097, 5.1459718988806475, 4.572833704884868, 5.0242006413921105, 3.8822450513473026, 10.548520170132772, 8.514366558931675, 4.997879662268686, 3.7880342228102073, 2.9045124869237133, 6.045779271928745, 4.287617199714783, 7.754997325574308, 3.3771241030881765, 7.849154571647457, 4.3035514395539645, 4.414872178351461, 7.668379625338865, 3.5656779654981525, 2.360780059653334, 5.217670362957, 4.169797217105743, 11.833870415289649, 5.984062370323896, 5.633805545641618, 5.872094989036046, 7.2922631678239505, 3.8721575129997454, 10.631328604742103, 4.431975751338015, 12.312258752080066, 3.983431311155133, 7.982471716246209, 4.375017131472031, 4.602485088102906, 9.948534856830035, 3.5023737468575185, 10.513194291131995, 9.510554722609545, 5.805327033739928, 8.139013612469965, 6.490209054152164, 4.633931957235838, 7.193719364111091, 5.079520227616038, 9.043861608735778, 4.156660136597903, 5.7740652606049, 4.811583801825028, 6.34142509442081, 6.771470688590612, 4.520725177966731, 5.760070217152135, 5.56354071842297, 6.347194512009331, 7.436751543624954, 3.2317014416142555, 7.3452116711003175, 7.6973407187012555, 3.732209882344968, 8.033091659106075, 6.230396491888441, 6.46924845570645, 5.092122174134613, 6.978993753660004, 3.813301262947351, 5.115010669629992, 4.0638236672554084, 7.512486287077078, 3.336373488665652, 7.523343328385318], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1920450286681581, "mean_inference_ms": 0.9966608071015969, "mean_action_processing_ms": 0.041304051506332796, "mean_env_wait_ms": 0.9197792337179382, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 268800, "timers": {"sample_time_ms": 30407.891, "sample_throughput": 2841.368, "learn_time_ms": 19303.243, "learn_throughput": 4475.932, "update_time_ms": 1.769}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005, "total_loss": -0.00811644885497141, "policy_loss": -0.028832871833377294, "vf_loss": 0.005846897641246298, "vf_explained_var": 0.9651842713356018, "kl": 0.014869525265443113, "entropy": -3.796387659764923, "entropy_coeff": 0.0}}, "num_steps_sampled": 268800, "num_steps_trained": 268800}, "done": false, "episodes_total": 256, "training_iteration": 20, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-24-04", "timestamp": 1617636244, "time_this_iter_s": 49.717344760894775, "time_total_s": 158.44834733009338, "pid": 11668, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 84948, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7602998513300367, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.27010746378140704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.717344760894775, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 51.22112676056338, "ram_util_percent": 60.599999999999994}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 16.904805791028384, "episode_reward_min": 2.6395853855881497, "episode_reward_mean": 6.830731993000993, "episode_len_mean": 1000.0, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.976451649675642, 8.371960169481438, 6.324391416659004, 5.552427001225548, 6.997915451366813, 6.871680140674329, 9.460853752429804, 7.682908104242156, 6.295204959733718, 5.360074966836968, 7.686332507988263, 2.885990480991035, 4.578221754371649, 6.104508472653266, 3.0596245916222227, 4.630104094775909, 9.236170469195205, 7.872477967907667, 4.942166329922815, 10.041389525531056, 2.6395853855881497, 10.054226134452039, 5.982060789980193, 7.018914545176775, 13.566291949608589, 7.0093994425660195, 5.326520818951251, 6.650450273237135, 8.869011474357016, 7.094547169047358, 4.879877965826056, 4.571645052544395, 12.435328060734363, 4.958277733443654, 3.6280250317131504, 10.072660783413836, 8.6132154663251, 10.576457874071165, 9.298186988735825, 10.476325932283716, 6.650681734305775, 7.171974932280271, 8.805742075313239, 3.9240852092736347, 7.5468382585715865, 6.362920431186041, 9.921005380778265, 6.830023209855636, 3.4419622541742196, 5.427703974954744, 5.3051038169820375, 8.379095908356017, 2.8503470867538923, 9.522978817527653, 10.432928338916252, 3.381612847170473, 9.083185818425381, 9.918681302090476, 4.429032120523464, 6.717109999601885, 5.689112907970792, 3.878345773114753, 5.181212469981473, 3.065751549287821, 7.1845233167935465, 7.217149862977747, 6.844621501004902, 6.41953832977334, 16.904805791028384, 4.438237415424692, 8.012472762944995, 8.933807528780575, 12.142620993275626, 11.59684580320774, 3.824135915617794, 8.061985054634643, 6.2369215936716875, 3.604220733446623, 8.00248581389784, 6.059497854208505, 10.019938361739412, 8.81491339560906, 9.566590201233707, 4.998740292126765, 2.9506133698624817, 3.96950833729516, 4.113788558303353, 8.685536495703314, 3.732209882344968, 8.033091659106075, 6.230396491888441, 6.46924845570645, 5.092122174134613, 6.978993753660004, 3.813301262947351, 5.115010669629992, 4.0638236672554084, 7.512486287077078, 3.336373488665652, 7.523343328385318], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19853308553513613, "mean_inference_ms": 0.9893031941167817, "mean_action_processing_ms": 0.041295531614550705, "mean_env_wait_ms": 0.9179021050475785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 355200, "timers": {"sample_time_ms": 28151.132, "sample_throughput": 3069.148, "learn_time_ms": 19083.907, "learn_throughput": 4527.375, "update_time_ms": 1.706}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005, "total_loss": 0.003219539596260303, "policy_loss": -0.024830139102723317, "vf_loss": 0.007002705479024258, "vf_explained_var": 0.9622899889945984, "kl": 0.02104697293082697, "entropy": -3.831137469806502, "entropy_coeff": 0.0}}, "num_steps_sampled": 355200, "num_steps_trained": 355200}, "done": false, "episodes_total": 344, "training_iteration": 21, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-24-49", "timestamp": 1617636289, "time_this_iter_s": 44.78054714202881, "time_total_s": 203.2288944721222, "pid": 11668, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 84948, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7602998513300367, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.27010746378140704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 94.49789190292358, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.3125, "ram_util_percent": 61.576562499999994}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 27.05662490738397, "episode_reward_min": 4.955915717695402, "episode_reward_mean": 12.203518250043308, "episode_len_mean": 1000.0, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.081941162748841, 11.725492627355035, 18.853076388076207, 18.892761025873636, 7.9087304248148165, 6.20376907684981, 8.541338975694432, 14.928482055504693, 27.05662490738397, 9.417856118355706, 9.38789496092103, 7.735203972101996, 12.27573472175209, 16.5687080369723, 15.484947708241108, 13.050511957952024, 16.635686588261617, 22.805610881789345, 4.955915717695402, 9.751820283720303, 17.114699069669104, 17.290827213256893, 21.931756877645363, 5.534731654658785, 13.679703152364871, 5.6262952956869405, 9.326813509048154, 8.880547129063768, 12.568416734888968, 9.57759065011789, 11.798659865277694, 8.689340401493602, 6.918106906084716, 11.126609532725311, 18.11655177508728, 9.944819172800651, 9.575451455703668, 10.066674710397173, 13.235462154541505, 11.04421853609627, 9.793920972543663, 14.955778422530274, 10.73043360155098, 8.323772014586662, 12.45797124284526, 11.850590466768773, 10.235914850095059, 18.367148481380433, 9.787597044041672, 12.759896985498731, 13.594344768678997, 12.319846542153043, 13.63270803656788, 9.30153854934468, 18.92081380747032, 9.468269563393976, 10.311204631166348, 8.807968492926653, 12.647399004743331, 18.744121676815976, 19.16242449133027, 16.903355374584653, 12.804874833672905, 7.426769345839503, 6.896721511366608, 17.20015483021932, 20.78150081548631, 8.585051154714685, 7.809581237038593, 8.081725253040023, 10.383022949159427, 8.150706611332332, 15.318049502486264, 18.163962610753405, 12.332367184762207, 9.29241233304585, 13.784672793940036, 11.051669235513069, 8.80309622151028, 5.028719169893206], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991258546297511, "mean_inference_ms": 1.0130369914879283, "mean_action_processing_ms": 0.041928915235358535, "mean_env_wait_ms": 0.9355631545455065, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 441600, "timers": {"sample_time_ms": 26712.982, "sample_throughput": 3234.382, "learn_time_ms": 19249.047, "learn_throughput": 4488.534, "update_time_ms": 1.522}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005, "total_loss": 0.008245165788556193, "policy_loss": -0.023777555186915482, "vf_loss": 0.014310772804362057, "vf_explained_var": 0.9314200282096863, "kl": 0.017711947726464904, "entropy": -3.90541138269205, "entropy_coeff": 0.0}}, "num_steps_sampled": 441600, "num_steps_trained": 441600}, "done": false, "episodes_total": 424, "training_iteration": 22, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-26-45", "timestamp": 1617636405, "time_this_iter_s": 45.969573974609375, "time_total_s": 249.19846844673157, "pid": 14552, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 84948, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7602998513300367, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.27010746378140704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.969573974609375, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 49.801515151515154, "ram_util_percent": 60.75}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 53.56746918464059, "episode_reward_min": 5.028719169893206, "episode_reward_mean": 17.843895621449153, "episode_len_mean": 1000.0, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.117309965072614, 17.869049743333562, 20.860024834715137, 15.923549568746289, 23.339590516531114, 18.09759496263283, 16.143319024011955, 12.719717064349858, 16.770837156755146, 17.297251827241904, 16.021923073348862, 9.083269236417763, 25.448987213472165, 23.801653311272858, 13.534380502492574, 13.389351585416, 10.142928903155095, 14.792230167976822, 27.925496434596017, 15.730649891741088, 13.786125894972834, 7.706537218819507, 10.768335893101991, 20.76592042145938, 10.642351110313818, 10.481306361298024, 25.435698432315053, 15.727842024805707, 21.96627832477988, 9.526953698982885, 13.900543810961405, 13.927198589214902, 14.294339215223657, 18.86658858523172, 24.313729287397255, 17.682360030465194, 29.034983464061654, 18.74795627000587, 14.280037852912923, 32.73496587060293, 11.40003864088949, 21.512907450579092, 20.139781576819836, 17.690951620894673, 20.76023937812151, 15.894656885027786, 18.936273493884787, 19.799808022667438, 26.846685830508605, 13.120901384722318, 9.934992952274023, 17.140714081220423, 9.25718772782414, 15.708800362946608, 19.15387578369231, 26.06168004035204, 14.929224697549708, 6.931504502574877, 13.353184943636855, 20.82243181653584, 25.242879854808404, 34.71576782884051, 38.66841556616447, 18.558307129886018, 53.56746918464059, 15.763332309609876, 29.033605564730014, 19.29079590455031, 16.640276003278398, 14.074898534680223, 25.26312277833827, 29.01034378685817, 15.849044170563793, 16.61702276008824, 22.64015621194317, 16.496546975968638, 14.892545663108388, 15.019371920574034, 13.089271479820352, 25.9467908702426, 28.367914486679307, 30.425543909006475, 29.319149122083793, 21.013245999182903, 13.26313237332918, 14.005587590257214, 15.690307886575898, 15.72972264370263, 7.809581237038593, 8.081725253040023, 10.383022949159427, 8.150706611332332, 15.318049502486264, 18.163962610753405, 12.332367184762207, 9.29241233304585, 13.784672793940036, 11.051669235513069, 8.80309622151028, 5.028719169893206], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20122209204882074, "mean_inference_ms": 0.9963299965225025, "mean_action_processing_ms": 0.04152831099905278, "mean_env_wait_ms": 0.9245755955712107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 528000, "timers": {"sample_time_ms": 26179.01, "sample_throughput": 3300.354, "learn_time_ms": 19316.854, "learn_throughput": 4472.778, "update_time_ms": 1.654}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005, "total_loss": 0.024254081223722274, "policy_loss": -0.02111085297959518, "vf_loss": 0.029062001131870577, "vf_explained_var": 0.9033617973327637, "kl": 0.016302933136775957, "entropy": -3.940684717313378, "entropy_coeff": 0.0}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 512, "training_iteration": 23, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-30", "timestamp": 1617636450, "time_this_iter_s": 45.05317997932434, "time_total_s": 294.2516484260559, "pid": 14552, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 84948, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7602998513300367, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.27010746378140704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 91.02275395393372, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.8625, "ram_util_percent": 62.2859375}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 8.723142513309824, "episode_reward_min": 3.5616744443964707, "episode_reward_mean": 6.279655343412023, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.6785552402782535, 5.484989828069448, 6.637175394617549, 6.7055482666702195, 7.296801542905186, 6.533320506007594, 8.31591994154013, 5.743239927495173, 8.723142513309824, 3.6368186723661307, 7.4180434328084655, 7.221908753391926, 3.5616744443964707, 6.097096985296448, 5.101356044731204, 7.318894000708349], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20373890782403448, "mean_inference_ms": 0.9629204980973183, "mean_action_processing_ms": 0.04068545732779363, "mean_env_wait_ms": 0.9312894807822225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 288000, "timers": {"sample_time_ms": 5106.292, "sample_throughput": 3133.389, "learn_time_ms": 4402.544, "learn_throughput": 3634.263, "update_time_ms": 1.605}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.3147335725864678, "policy_loss": 0.02942497305555276, "vf_loss": 0.1572612520645965, "vf_explained_var": 0.9956607222557068, "kl": 0.12804734780255592, "entropy": -4.259916016549775, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 272, "training_iteration": 29, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-57", "timestamp": 1617636477, "time_this_iter_s": 9.513897895812988, "time_total_s": 221.86553978919983, "pid": 15803, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.513897895812988, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.44999999999999, "ram_util_percent": 61.22857142857142}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 8.723142513309824, "episode_reward_min": 2.466120741335126, "episode_reward_mean": 5.384638783763397, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.9928593240714045, 7.768972541819034, 3.5810171505025368, 3.799277991667143, 4.643172427822111, 3.072330248425125, 4.617560572627357, 2.4934199025214228, 4.879284878199386, 2.466120741335126, 2.590134289221758, 5.174285385594163, 3.651790065998388, 3.285268466177583, 8.186442924199667, 5.632018675654126, 4.6785552402782535, 5.484989828069448, 6.637175394617549, 6.7055482666702195, 7.296801542905186, 6.533320506007594, 8.31591994154013, 5.743239927495173, 8.723142513309824, 3.6368186723661307, 7.4180434328084655, 7.221908753391926, 3.5616744443964707, 6.097096985296448, 5.101356044731204, 7.318894000708349], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20972143668420368, "mean_inference_ms": 0.9955969392136956, "mean_action_processing_ms": 0.04207164958856333, "mean_env_wait_ms": 0.9582101841029391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 304000, "timers": {"sample_time_ms": 5226.702, "sample_throughput": 3061.204, "learn_time_ms": 4490.356, "learn_throughput": 3563.192, "update_time_ms": 1.535}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.25780879218611075, "policy_loss": -0.0011266761161316413, "vf_loss": 0.1773705014563871, "vf_explained_var": 0.9939523339271545, "kl": 0.05437664467502724, "entropy": -4.215057853496436, "entropy_coeff": 0.0}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 288, "training_iteration": 30, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-07", "timestamp": 1617636487, "time_this_iter_s": 9.932908296585083, "time_total_s": 231.7984480857849, "pid": 15803, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.44680619239807, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.65714285714285, "ram_util_percent": 61.721428571428575}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 8.723142513309824, "episode_reward_min": 1.9977986298189307, "episode_reward_mean": 4.780673797721971, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.3219526103410146, 2.2663861867664186, 1.9977986298189307, 2.8432214876885826, 2.7106877912662983, 5.3219569516161975, 3.745007049013485, 3.4131099032727015, 2.0156383717838544, 2.7006253578184647, 3.162281240568131, 5.486486834499942, 6.039284418224142, 3.2815315723111524, 3.953829300026749, 4.9041035052098545, 4.6785552402782535, 5.484989828069448, 6.637175394617549, 6.7055482666702195, 7.296801542905186, 6.533320506007594, 8.31591994154013, 5.743239927495173, 8.723142513309824, 3.6368186723661307, 7.4180434328084655, 7.221908753391926, 3.5616744443964707, 6.097096985296448, 5.101356044731204, 7.318894000708349, 5.9928593240714045, 7.768972541819034, 3.5810171505025368, 3.799277991667143, 4.643172427822111, 3.072330248425125, 4.617560572627357, 2.4934199025214228, 4.879284878199386, 2.466120741335126, 2.590134289221758, 5.174285385594163, 3.651790065998388, 3.285268466177583, 8.186442924199667, 5.632018675654126], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21157319305069514, "mean_inference_ms": 1.0169059316844347, "mean_action_processing_ms": 0.04249133620928317, "mean_env_wait_ms": 0.9646515431724915, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 320000, "timers": {"sample_time_ms": 5266.864, "sample_throughput": 3037.861, "learn_time_ms": 4625.389, "learn_throughput": 3459.169, "update_time_ms": 1.513}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.1453097884853681, "policy_loss": -0.013046542986006843, "vf_loss": 0.07321267333728346, "vf_explained_var": 0.996830940246582, "kl": 0.03784162489076456, "entropy": -4.202794533787352, "entropy_coeff": 0.0}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 304, "training_iteration": 31, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-17", "timestamp": 1617636497, "time_this_iter_s": 10.252860069274902, "time_total_s": 242.05130815505981, "pid": 15803, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.699666261672974, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.7, "ram_util_percent": 61.95333333333333}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 8.723142513309824, "episode_reward_min": 1.3615987789342419, "episode_reward_mean": 4.512955263657538, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.5003730366791537, 6.71918337263525, 3.826575502815662, 5.4362146038742045, 3.7050803853040852, 4.046853709711351, 1.7681954630426038, 2.2581056287860766, 8.57112209195532, 1.3615987789342419, 4.18281285289669, 4.09039713340432, 2.816736691244141, 1.8414964420363904, 3.0837469272608047, 2.1483019628475817, 4.6785552402782535, 5.484989828069448, 6.637175394617549, 6.7055482666702195, 7.296801542905186, 6.533320506007594, 8.31591994154013, 5.743239927495173, 8.723142513309824, 3.6368186723661307, 7.4180434328084655, 7.221908753391926, 3.5616744443964707, 6.097096985296448, 5.101356044731204, 7.318894000708349, 5.9928593240714045, 7.768972541819034, 3.5810171505025368, 3.799277991667143, 4.643172427822111, 3.072330248425125, 4.617560572627357, 2.4934199025214228, 4.879284878199386, 2.466120741335126, 2.590134289221758, 5.174285385594163, 3.651790065998388, 3.285268466177583, 8.186442924199667, 5.632018675654126, 3.3219526103410146, 2.2663861867664186, 1.9977986298189307, 2.8432214876885826, 2.7106877912662983, 5.3219569516161975, 3.745007049013485, 3.4131099032727015, 2.0156383717838544, 2.7006253578184647, 3.162281240568131, 5.486486834499942, 6.039284418224142, 3.2815315723111524, 3.953829300026749, 4.9041035052098545], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21116438164677165, "mean_inference_ms": 1.0224624359608943, "mean_action_processing_ms": 0.04258930190725242, "mean_env_wait_ms": 0.9637699104975535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 336000, "timers": {"sample_time_ms": 5137.946, "sample_throughput": 3114.085, "learn_time_ms": 4739.189, "learn_throughput": 3376.105, "update_time_ms": 1.541}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.13763286461427482, "policy_loss": -0.01542830751912499, "vf_loss": 0.06684030454154267, "vf_explained_var": 0.9963150024414062, "kl": 0.02554692370309071, "entropy": -4.205828608888568, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 320, "training_iteration": 32, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-27", "timestamp": 1617636507, "time_this_iter_s": 9.839163303375244, "time_total_s": 251.89047145843506, "pid": 15803, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.53882956504822, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.56428571428571, "ram_util_percent": 61.664285714285725}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 8.723142513309824, "episode_reward_min": 0.19407158347388687, "episode_reward_mean": 4.32669755648969, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.8829741107849074, 1.7899668984007788, 5.362208634338825, 2.561603833312579, 1.7017024685130973, 3.607609612654472, 7.513849138322064, 3.368344574398696, 2.6240898958014127, 1.061428225356253, 8.570297531945634, 2.694601701031324, 6.851977327678147, 3.951037915505104, 3.5709041935755605, 0.19407158347388687, 4.6785552402782535, 5.484989828069448, 6.637175394617549, 6.7055482666702195, 7.296801542905186, 6.533320506007594, 8.31591994154013, 5.743239927495173, 8.723142513309824, 3.6368186723661307, 7.4180434328084655, 7.221908753391926, 3.5616744443964707, 6.097096985296448, 5.101356044731204, 7.318894000708349, 5.9928593240714045, 7.768972541819034, 3.5810171505025368, 3.799277991667143, 4.643172427822111, 3.072330248425125, 4.617560572627357, 2.4934199025214228, 4.879284878199386, 2.466120741335126, 2.590134289221758, 5.174285385594163, 3.651790065998388, 3.285268466177583, 8.186442924199667, 5.632018675654126, 3.3219526103410146, 2.2663861867664186, 1.9977986298189307, 2.8432214876885826, 2.7106877912662983, 5.3219569516161975, 3.745007049013485, 3.4131099032727015, 2.0156383717838544, 2.7006253578184647, 3.162281240568131, 5.486486834499942, 6.039284418224142, 3.2815315723111524, 3.953829300026749, 4.9041035052098545, 3.5003730366791537, 6.71918337263525, 3.826575502815662, 5.4362146038742045, 3.7050803853040852, 4.046853709711351, 1.7681954630426038, 2.2581056287860766, 8.57112209195532, 1.3615987789342419, 4.18281285289669, 4.09039713340432, 2.816736691244141, 1.8414964420363904, 3.0837469272608047, 2.1483019628475817], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2094273807472312, "mean_inference_ms": 1.0174153928799667, "mean_action_processing_ms": 0.04234990864674121, "mean_env_wait_ms": 0.9551199880133291, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 352000, "timers": {"sample_time_ms": 4896.632, "sample_throughput": 3267.552, "learn_time_ms": 5145.996, "learn_throughput": 3109.213, "update_time_ms": 1.516}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.0625, "cur_lr": 0.01, "total_loss": 0.23549442959483713, "policy_loss": -0.007007981110126077, "vf_loss": 0.10718692048932567, "vf_explained_var": 0.9923951029777527, "kl": 0.026728986240358965, "entropy": -4.160819429339784, "entropy_coeff": 0.0}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 336, "training_iteration": 33, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-38", "timestamp": 1617636518, "time_this_iter_s": 10.71308422088623, "time_total_s": 262.6035556793213, "pid": 15803, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.25191378593445, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 53.92666666666667, "ram_util_percent": 59.620000000000005}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 7.029192875845945, "episode_reward_min": 1.5672220247312842, "episode_reward_mean": 3.008747019136817, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.1909081000591817, 3.785123603724137, 1.5672220247312842, 3.4965874137487383, 1.5968010847215153, 2.5874754004827363, 3.8214472916569493, 2.4721676599760847, 2.1137311795291587, 1.6577500658204989, 3.6941481954218567, 2.2915574488571617, 2.650681316307689, 1.921498650017365, 5.263659995288769, 7.029192875845945], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20056994243719053, "mean_inference_ms": 0.9946893716323143, "mean_action_processing_ms": 0.04232132333567713, "mean_env_wait_ms": 0.9621003310362259, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 368000, "timers": {"sample_time_ms": 4829.452, "sample_throughput": 3313.006, "learn_time_ms": 4745.206, "learn_throughput": 3371.824, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.12539495574685244, "policy_loss": 0.0032943223499883475, "vf_loss": 0.056227910332381725, "vf_explained_var": 0.9951670169830322, "kl": 0.06587272210780418, "entropy": -4.216887008060109, "entropy_coeff": 0.0}}, "num_steps_sampled": 368000, "num_steps_trained": 368000}, "done": false, "episodes_total": 352, "training_iteration": 34, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-56", "timestamp": 1617636536, "time_this_iter_s": 9.580989599227905, "time_total_s": 272.1845452785492, "pid": 16716, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.580989599227905, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.121428571428574, "ram_util_percent": 61.02857142857143}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 7.029192875845945, "episode_reward_min": 1.1905841375126136, "episode_reward_mean": 3.023943555997901, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.911480375132314, 4.494910161633291, 2.0805975300203885, 3.253086548979831, 1.1905841375126136, 2.4036165555762388, 2.99632391124533, 3.5445705955609625, 1.5407773504394386, 2.6764345657498256, 4.58851909481544, 5.313386827610577, 4.203924868645178, 2.2765479686905064, 2.9109764400188216, 2.2405045541129995, 2.1909081000591817, 3.785123603724137, 1.5672220247312842, 3.4965874137487383, 1.5968010847215153, 2.5874754004827363, 3.8214472916569493, 2.4721676599760847, 2.1137311795291587, 1.6577500658204989, 3.6941481954218567, 2.2915574488571617, 2.650681316307689, 1.921498650017365, 5.263659995288769, 7.029192875845945], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19974280698834393, "mean_inference_ms": 1.00013827763298, "mean_action_processing_ms": 0.042512919523937286, "mean_env_wait_ms": 0.9588170429592141, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 384000, "timers": {"sample_time_ms": 4842.419, "sample_throughput": 3304.133, "learn_time_ms": 4911.831, "learn_throughput": 3257.441, "update_time_ms": 1.554}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.1055001964299608, "policy_loss": -0.007080513707368289, "vf_loss": 0.057006419325868286, "vf_explained_var": 0.9943475723266602, "kl": 0.03704952702603557, "entropy": -4.224735939141476, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 368, "training_iteration": 35, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-06", "timestamp": 1617636546, "time_this_iter_s": 9.941750526428223, "time_total_s": 282.1262958049774, "pid": 16716, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.522740125656128, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.914285714285704, "ram_util_percent": 61.34999999999999}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 7.029192875845945, "episode_reward_min": 0.8769126673336125, "episode_reward_mean": 2.660721494102781, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.966436259606638, 4.250724913838719, 2.135979367151509, 1.892537720755802, 0.8769126673336125, 1.646432886345392, 1.667577166847587, 1.9850680511409573, 1.3187353478367103, 1.3722369077459127, 1.6338453892915754, 1.3459037567086618, 1.4783006017390035, 1.0410933514625715, 3.3720953278491974, 1.9645582093468268, 2.1909081000591817, 3.785123603724137, 1.5672220247312842, 3.4965874137487383, 1.5968010847215153, 2.5874754004827363, 3.8214472916569493, 2.4721676599760847, 2.1137311795291587, 1.6577500658204989, 3.6941481954218567, 2.2915574488571617, 2.650681316307689, 1.921498650017365, 5.263659995288769, 7.029192875845945, 2.911480375132314, 4.494910161633291, 2.0805975300203885, 3.253086548979831, 1.1905841375126136, 2.4036165555762388, 2.99632391124533, 3.5445705955609625, 1.5407773504394386, 2.6764345657498256, 4.58851909481544, 5.313386827610577, 4.203924868645178, 2.2765479686905064, 2.9109764400188216, 2.2405045541129995], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19996349802121982, "mean_inference_ms": 1.0102015764391117, "mean_action_processing_ms": 0.04254902117197868, "mean_env_wait_ms": 0.9549196660229433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 400000, "timers": {"sample_time_ms": 4954.266, "sample_throughput": 3229.54, "learn_time_ms": 4895.894, "learn_throughput": 3268.045, "update_time_ms": 1.655}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.08650510334480328, "policy_loss": -0.010087818785078443, "vf_loss": 0.03691238658784917, "vf_explained_var": 0.9954667687416077, "kl": 0.02652468319248521, "entropy": -4.2661625363610005, "entropy_coeff": 0.0}}, "num_steps_sampled": 400000, "num_steps_trained": 400000}, "done": false, "episodes_total": 384, "training_iteration": 36, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-16", "timestamp": 1617636556, "time_this_iter_s": 10.04944396018982, "time_total_s": 292.17573976516724, "pid": 16716, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.572184085845947, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.22, "ram_util_percent": 61.40666666666666}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 7.029192875845945, "episode_reward_min": 0.8741528651392585, "episode_reward_mean": 2.5860770526795713, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.707298413888691, 2.4950003835259724, 1.8136429856058531, 1.6423636036264861, 2.4290266004627012, 2.6880957024680168, 1.134801105124159, 0.8741528651392585, 2.049415249851818, 5.438918426743401, 2.323206861030417, 1.1982024275769216, 2.387365517326583, 4.750178458097769, 1.326096928052074, 2.5365341260389633, 2.1909081000591817, 3.785123603724137, 1.5672220247312842, 3.4965874137487383, 1.5968010847215153, 2.5874754004827363, 3.8214472916569493, 2.4721676599760847, 2.1137311795291587, 1.6577500658204989, 3.6941481954218567, 2.2915574488571617, 2.650681316307689, 1.921498650017365, 5.263659995288769, 7.029192875845945, 2.911480375132314, 4.494910161633291, 2.0805975300203885, 3.253086548979831, 1.1905841375126136, 2.4036165555762388, 2.99632391124533, 3.5445705955609625, 1.5407773504394386, 2.6764345657498256, 4.58851909481544, 5.313386827610577, 4.203924868645178, 2.2765479686905064, 2.9109764400188216, 2.2405045541129995, 2.966436259606638, 4.250724913838719, 2.135979367151509, 1.892537720755802, 0.8769126673336125, 1.646432886345392, 1.667577166847587, 1.9850680511409573, 1.3187353478367103, 1.3722369077459127, 1.6338453892915754, 1.3459037567086618, 1.4783006017390035, 1.0410933514625715, 3.3720953278491974, 1.9645582093468268], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20009936152692498, "mean_inference_ms": 1.0121748697748447, "mean_action_processing_ms": 0.04250869751523553, "mean_env_wait_ms": 0.9508089813557146, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 416000, "timers": {"sample_time_ms": 4919.357, "sample_throughput": 3252.458, "learn_time_ms": 4911.111, "learn_throughput": 3257.918, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.07714160457676784, "policy_loss": -0.01369681096460254, "vf_loss": 0.030894102683911722, "vf_explained_var": 0.995454728603363, "kl": 0.017761277648704974, "entropy": -4.282556826418096, "entropy_coeff": 0.0}}, "num_steps_sampled": 416000, "num_steps_trained": 416000}, "done": false, "episodes_total": 400, "training_iteration": 37, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-25", "timestamp": 1617636565, "time_this_iter_s": 9.779603481292725, "time_total_s": 301.95534324645996, "pid": 16716, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.35178756713867, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.628571428571426, "ram_util_percent": 61.449999999999996}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 7.029192875845945, "episode_reward_min": 0.8741528651392585, "episode_reward_mean": 2.5877648136412277, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.440633043623829, 0.9001644875443318, 2.3169387800393726, 2.7668652234408673, 5.455531201509061, 3.420244628177662, 1.5916627712956881, 2.8872079621628393, 2.0421041561016753, 2.617448950327641, 1.253060883306583, 3.4653596502206465, 1.913197734151125, 1.337064321058517, 4.801596786383342, 2.303173140462462, 2.1909081000591817, 3.785123603724137, 1.5672220247312842, 3.4965874137487383, 1.5968010847215153, 2.5874754004827363, 3.8214472916569493, 2.4721676599760847, 2.1137311795291587, 1.6577500658204989, 3.6941481954218567, 2.2915574488571617, 2.650681316307689, 1.921498650017365, 5.263659995288769, 7.029192875845945, 2.911480375132314, 4.494910161633291, 2.0805975300203885, 3.253086548979831, 1.1905841375126136, 2.4036165555762388, 2.99632391124533, 3.5445705955609625, 1.5407773504394386, 2.6764345657498256, 4.58851909481544, 5.313386827610577, 4.203924868645178, 2.2765479686905064, 2.9109764400188216, 2.2405045541129995, 2.966436259606638, 4.250724913838719, 2.135979367151509, 1.892537720755802, 0.8769126673336125, 1.646432886345392, 1.667577166847587, 1.9850680511409573, 1.3187353478367103, 1.3722369077459127, 1.6338453892915754, 1.3459037567086618, 1.4783006017390035, 1.0410933514625715, 3.3720953278491974, 1.9645582093468268, 2.707298413888691, 2.4950003835259724, 1.8136429856058531, 1.6423636036264861, 2.4290266004627012, 2.6880957024680168, 1.134801105124159, 0.8741528651392585, 2.049415249851818, 5.438918426743401, 2.323206861030417, 1.1982024275769216, 2.387365517326583, 4.750178458097769, 1.326096928052074, 2.5365341260389633], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20057994242634153, "mean_inference_ms": 1.0131381577450107, "mean_action_processing_ms": 0.04253898714207725, "mean_env_wait_ms": 0.9487919360067419, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 432000, "timers": {"sample_time_ms": 4934.187, "sample_throughput": 3242.682, "learn_time_ms": 5062.556, "learn_throughput": 3160.459, "update_time_ms": 1.59}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.06969958688356807, "policy_loss": -0.012317855291726257, "vf_loss": 0.026739025749548367, "vf_explained_var": 0.9952936172485352, "kl": 0.01637878982971112, "entropy": -4.2297316789627075, "entropy_coeff": 0.0}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 416, "training_iteration": 38, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-36", "timestamp": 1617636576, "time_this_iter_s": 10.669407367706299, "time_total_s": 312.62475061416626, "pid": 16716, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.02119493484497, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.08666666666666, "ram_util_percent": 59.67333333333333}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 3.615800759788179, "episode_reward_min": 0.5726945821791392, "episode_reward_mean": 1.5662075491318772, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.419009983793412, 1.2423965011457443, 0.5726945821791392, 2.7616189092620473, 2.1455888006311787, 1.1794863965926683, 3.615800759788179, 2.3183884154211625, 0.7846470498556515, 1.5782596889148808, 1.0109046877865904, 0.7241175032466765, 1.0605988893636917, 0.8441404048963361, 3.194239593645574, 0.6074286195871006], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20068377509586577, "mean_inference_ms": 0.9977961408680882, "mean_action_processing_ms": 0.042038029995279155, "mean_env_wait_ms": 0.9648406702181747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 448000, "timers": {"sample_time_ms": 5417.29, "sample_throughput": 2953.506, "learn_time_ms": 5060.199, "learn_throughput": 3161.931, "update_time_ms": 1.559}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.06619715411822351, "policy_loss": -0.00485866300681609, "vf_loss": 0.029086105095109706, "vf_explained_var": 0.9936826229095459, "kl": 0.041969712216858614, "entropy": -4.252883340373184, "entropy_coeff": 0.0}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 432, "training_iteration": 39, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-08", "timestamp": 1617636608, "time_this_iter_s": 10.482433319091797, "time_total_s": 323.10718393325806, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.482433319091797, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.2, "ram_util_percent": 61.073333333333345}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 4.566869175198996, "episode_reward_min": 0.32087020402859356, "episode_reward_mean": 1.6212272794416598, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.5085939466575793, 1.1336819286313173, 1.5702492793353722, 1.0355182581760216, 2.3611818765158397, 0.5429651336625794, 1.3012295993861867, 4.566869175198996, 0.9078549966056071, 1.5265838131020502, 0.9153873977504365, 0.32087020402859356, 3.2692365173716285, 1.3646693927048288, 0.8580238171912311, 2.6370368197048184, 1.419009983793412, 1.2423965011457443, 0.5726945821791392, 2.7616189092620473, 2.1455888006311787, 1.1794863965926683, 3.615800759788179, 2.3183884154211625, 0.7846470498556515, 1.5782596889148808, 1.0109046877865904, 0.7241175032466765, 1.0605988893636917, 0.8441404048963361, 3.194239593645574, 0.6074286195871006], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20201605223916286, "mean_inference_ms": 1.0029279483927447, "mean_action_processing_ms": 0.042259992724942755, "mean_env_wait_ms": 0.960585949895786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 464000, "timers": {"sample_time_ms": 5205.951, "sample_throughput": 3073.406, "learn_time_ms": 5152.656, "learn_throughput": 3105.195, "update_time_ms": 1.444}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.057247860592200814, "policy_loss": -0.009280474571631092, "vf_loss": 0.023250720393138403, "vf_explained_var": 0.9936502575874329, "kl": 0.028851743547640966, "entropy": -4.248198819882942, "entropy_coeff": 0.0}}, "num_steps_sampled": 464000, "num_steps_trained": 464000}, "done": false, "episodes_total": 448, "training_iteration": 40, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-18", "timestamp": 1617636618, "time_this_iter_s": 10.247618913650513, "time_total_s": 333.35480284690857, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.73005223274231, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.07333333333333, "ram_util_percent": 61.540000000000006}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 4.566869175198996, "episode_reward_min": 0.32087020402859356, "episode_reward_mean": 1.6919994474495923, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0453137339767702, 2.737127607332382, 2.3930089976926663, 1.5751574992749133, 1.350800979234133, 1.4038356106268393, 1.7331558568766887, 1.2279934844734268, 1.0558125978457884, 2.564457335395689, 1.5007296721209742, 3.3271288967509465, 1.744548020784594, 1.17268539720892, 1.964035803997648, 2.5409090418549436, 1.419009983793412, 1.2423965011457443, 0.5726945821791392, 2.7616189092620473, 2.1455888006311787, 1.1794863965926683, 3.615800759788179, 2.3183884154211625, 0.7846470498556515, 1.5782596889148808, 1.0109046877865904, 0.7241175032466765, 1.0605988893636917, 0.8441404048963361, 3.194239593645574, 0.6074286195871006, 2.5085939466575793, 1.1336819286313173, 1.5702492793353722, 1.0355182581760216, 2.3611818765158397, 0.5429651336625794, 1.3012295993861867, 4.566869175198996, 0.9078549966056071, 1.5265838131020502, 0.9153873977504365, 0.32087020402859356, 3.2692365173716285, 1.3646693927048288, 0.8580238171912311, 2.6370368197048184], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20271557520335629, "mean_inference_ms": 1.0131933518845686, "mean_action_processing_ms": 0.042328620467199374, "mean_env_wait_ms": 0.9560313171804085, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 480000, "timers": {"sample_time_ms": 5195.943, "sample_throughput": 3079.326, "learn_time_ms": 5066.574, "learn_throughput": 3157.952, "update_time_ms": 1.434}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.05140474716652975, "policy_loss": -0.01398133295835137, "vf_loss": 0.019949569980698554, "vf_explained_var": 0.9929770231246948, "kl": 0.020194003795922705, "entropy": -4.184158225854238, "entropy_coeff": 0.0}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 464, "training_iteration": 41, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-28", "timestamp": 1617636628, "time_this_iter_s": 10.077149152755737, "time_total_s": 343.4319519996643, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.807201385498047, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.51333333333333, "ram_util_percent": 61.68666666666665}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 4.566869175198996, "episode_reward_min": 0.32087020402859356, "episode_reward_mean": 1.8322618495372063, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.779820268661609, 1.0722914865338482, 3.2029046445010794, 0.7740158416741596, 3.7673500273332534, 1.6537900546109126, 3.9635767278554246, 1.9304886815439448, 1.748749517068196, 2.322616327859839, 3.0797337267337808, 3.5389655719190225, 2.8560558004192425, 1.4503421659239795, 2.5556427847974654, 0.35244126536500286, 1.419009983793412, 1.2423965011457443, 0.5726945821791392, 2.7616189092620473, 2.1455888006311787, 1.1794863965926683, 3.615800759788179, 2.3183884154211625, 0.7846470498556515, 1.5782596889148808, 1.0109046877865904, 0.7241175032466765, 1.0605988893636917, 0.8441404048963361, 3.194239593645574, 0.6074286195871006, 2.5085939466575793, 1.1336819286313173, 1.5702492793353722, 1.0355182581760216, 2.3611818765158397, 0.5429651336625794, 1.3012295993861867, 4.566869175198996, 0.9078549966056071, 1.5265838131020502, 0.9153873977504365, 0.32087020402859356, 3.2692365173716285, 1.3646693927048288, 0.8580238171912311, 2.6370368197048184, 1.0453137339767702, 2.737127607332382, 2.3930089976926663, 1.5751574992749133, 1.350800979234133, 1.4038356106268393, 1.7331558568766887, 1.2279934844734268, 1.0558125978457884, 2.564457335395689, 1.5007296721209742, 3.3271288967509465, 1.744548020784594, 1.17268539720892, 1.964035803997648, 2.5409090418549436], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20283240910329076, "mean_inference_ms": 1.0169000026418233, "mean_action_processing_ms": 0.04236369355641614, "mean_env_wait_ms": 0.9533424224167452, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 496000, "timers": {"sample_time_ms": 5119.186, "sample_throughput": 3125.497, "learn_time_ms": 5126.375, "learn_throughput": 3121.114, "update_time_ms": 1.415}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.059090925611654355, "policy_loss": -0.012744572390422973, "vf_loss": 0.01923790513043941, "vf_explained_var": 0.991277277469635, "kl": 0.015584471896572999, "entropy": -4.199374787735216, "entropy_coeff": 0.0}}, "num_steps_sampled": 496000, "num_steps_trained": 496000}, "done": false, "episodes_total": 480, "training_iteration": 42, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-38", "timestamp": 1617636638, "time_this_iter_s": 10.202922105789185, "time_total_s": 353.6348741054535, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.01012349128723, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.00000000000001, "ram_util_percent": 61.90714285714285}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 4.566869175198996, "episode_reward_min": 0.32087020402859356, "episode_reward_mean": 1.815356207786806, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.949271403007627, 0.6475792847289534, 1.6821413807092882, 1.0914199533385593, 1.3314078428692286, 1.234928202384085, 3.055722522969786, 3.6759150642477785, 1.9993429473326896, 1.9401930733467636, 0.8414124548504984, 1.6794446434207733, 1.7669334878028664, 0.9021087952020621, 0.8585225780409156, 4.307394618311419, 1.419009983793412, 1.2423965011457443, 0.5726945821791392, 2.7616189092620473, 2.1455888006311787, 1.1794863965926683, 3.615800759788179, 2.3183884154211625, 0.7846470498556515, 1.5782596889148808, 1.0109046877865904, 0.7241175032466765, 1.0605988893636917, 0.8441404048963361, 3.194239593645574, 0.6074286195871006, 2.5085939466575793, 1.1336819286313173, 1.5702492793353722, 1.0355182581760216, 2.3611818765158397, 0.5429651336625794, 1.3012295993861867, 4.566869175198996, 0.9078549966056071, 1.5265838131020502, 0.9153873977504365, 0.32087020402859356, 3.2692365173716285, 1.3646693927048288, 0.8580238171912311, 2.6370368197048184, 1.0453137339767702, 2.737127607332382, 2.3930089976926663, 1.5751574992749133, 1.350800979234133, 1.4038356106268393, 1.7331558568766887, 1.2279934844734268, 1.0558125978457884, 2.564457335395689, 1.5007296721209742, 3.3271288967509465, 1.744548020784594, 1.17268539720892, 1.964035803997648, 2.5409090418549436, 1.779820268661609, 1.0722914865338482, 3.2029046445010794, 0.7740158416741596, 3.7673500273332534, 1.6537900546109126, 3.9635767278554246, 1.9304886815439448, 1.748749517068196, 2.322616327859839, 3.0797337267337808, 3.5389655719190225, 2.8560558004192425, 1.4503421659239795, 2.5556427847974654, 0.35244126536500286], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20323196779787428, "mean_inference_ms": 1.0202026176386796, "mean_action_processing_ms": 0.04247924751752126, "mean_env_wait_ms": 0.9532385319437751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 512000, "timers": {"sample_time_ms": 5104.856, "sample_throughput": 3134.27, "learn_time_ms": 5233.548, "learn_throughput": 3057.2, "update_time_ms": 1.396}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.05850689939424311, "policy_loss": -0.010055001263743068, "vf_loss": 0.018200649851650902, "vf_explained_var": 0.9895095825195312, "kl": 0.014921852069991555, "entropy": -4.150187488758203, "entropy_coeff": 0.0}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 496, "training_iteration": 43, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-49", "timestamp": 1617636649, "time_this_iter_s": 10.720236539840698, "time_total_s": 364.3551106452942, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.73036003112793, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 50.73333333333334, "ram_util_percent": 61.97333333333333}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 4.566869175198996, "episode_reward_min": 0.32087020402859356, "episode_reward_mean": 1.891038237006332, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.432851040608905, 2.0291835748341174, 1.9680032582391753, 2.6422566227082656, 1.2115695855271267, 1.3261275774995496, 0.42792314195293013, 3.088250132656725, 3.33374062525649, 2.8428389604706275, 1.0110297548415579, 4.418890577631358, 2.5556917320685795, 1.768052596496815, 3.3335211068180914, 2.921243842053056, 1.419009983793412, 1.2423965011457443, 0.5726945821791392, 2.7616189092620473, 2.1455888006311787, 1.1794863965926683, 3.615800759788179, 2.3183884154211625, 0.7846470498556515, 1.5782596889148808, 1.0109046877865904, 0.7241175032466765, 1.0605988893636917, 0.8441404048963361, 3.194239593645574, 0.6074286195871006, 2.5085939466575793, 1.1336819286313173, 1.5702492793353722, 1.0355182581760216, 2.3611818765158397, 0.5429651336625794, 1.3012295993861867, 4.566869175198996, 0.9078549966056071, 1.5265838131020502, 0.9153873977504365, 0.32087020402859356, 3.2692365173716285, 1.3646693927048288, 0.8580238171912311, 2.6370368197048184, 1.0453137339767702, 2.737127607332382, 2.3930089976926663, 1.5751574992749133, 1.350800979234133, 1.4038356106268393, 1.7331558568766887, 1.2279934844734268, 1.0558125978457884, 2.564457335395689, 1.5007296721209742, 3.3271288967509465, 1.744548020784594, 1.17268539720892, 1.964035803997648, 2.5409090418549436, 1.779820268661609, 1.0722914865338482, 3.2029046445010794, 0.7740158416741596, 3.7673500273332534, 1.6537900546109126, 3.9635767278554246, 1.9304886815439448, 1.748749517068196, 2.322616327859839, 3.0797337267337808, 3.5389655719190225, 2.8560558004192425, 1.4503421659239795, 2.5556427847974654, 0.35244126536500286, 0.949271403007627, 0.6475792847289534, 1.6821413807092882, 1.0914199533385593, 1.3314078428692286, 1.234928202384085, 3.055722522969786, 3.6759150642477785, 1.9993429473326896, 1.9401930733467636, 0.8414124548504984, 1.6794446434207733, 1.7669334878028664, 0.9021087952020621, 0.8585225780409156, 4.307394618311419], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20395054652448655, "mean_inference_ms": 1.0237992832904668, "mean_action_processing_ms": 0.04264398200719494, "mean_env_wait_ms": 0.9548066808555099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 528000, "timers": {"sample_time_ms": 5114.044, "sample_throughput": 3128.64, "learn_time_ms": 5269.621, "learn_throughput": 3036.271, "update_time_ms": 1.416}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.06275957525984709, "policy_loss": -0.006658247493209218, "vf_loss": 0.01804421080812586, "vf_explained_var": 0.9871572852134705, "kl": 0.015221810815009203, "entropy": -4.152549855636828, "entropy_coeff": 0.0}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 512, "training_iteration": 44, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-00", "timestamp": 1617636660, "time_this_iter_s": 10.61722707748413, "time_total_s": 374.9723377227783, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 62.34758710861206, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 48.96875, "ram_util_percent": 61.95}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 4.566869175198996, "episode_reward_min": 0.32087020402859356, "episode_reward_mean": 1.8947659730342554, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6074317256799975, 2.4366420434078853, 1.8774223684208522, 1.136862471107953, 0.9441938596161381, 0.7645783597588813, 1.4890809011910418, 0.5943463375212179, 1.5120262613442907, 1.5157264842852793, 1.1673678598749402, 1.5499503852954342, 3.6605209188891257, 2.0136439078122663, 1.8377293057945914, 3.182316639435129, 1.0605988893636917, 0.8441404048963361, 3.194239593645574, 0.6074286195871006, 2.5085939466575793, 1.1336819286313173, 1.5702492793353722, 1.0355182581760216, 2.3611818765158397, 0.5429651336625794, 1.3012295993861867, 4.566869175198996, 0.9078549966056071, 1.5265838131020502, 0.9153873977504365, 0.32087020402859356, 3.2692365173716285, 1.3646693927048288, 0.8580238171912311, 2.6370368197048184, 1.0453137339767702, 2.737127607332382, 2.3930089976926663, 1.5751574992749133, 1.350800979234133, 1.4038356106268393, 1.7331558568766887, 1.2279934844734268, 1.0558125978457884, 2.564457335395689, 1.5007296721209742, 3.3271288967509465, 1.744548020784594, 1.17268539720892, 1.964035803997648, 2.5409090418549436, 1.779820268661609, 1.0722914865338482, 3.2029046445010794, 0.7740158416741596, 3.7673500273332534, 1.6537900546109126, 3.9635767278554246, 1.9304886815439448, 1.748749517068196, 2.322616327859839, 3.0797337267337808, 3.5389655719190225, 2.8560558004192425, 1.4503421659239795, 2.5556427847974654, 0.35244126536500286, 0.949271403007627, 0.6475792847289534, 1.6821413807092882, 1.0914199533385593, 1.3314078428692286, 1.234928202384085, 3.055722522969786, 3.6759150642477785, 1.9993429473326896, 1.9401930733467636, 0.8414124548504984, 1.6794446434207733, 1.7669334878028664, 0.9021087952020621, 0.8585225780409156, 4.307394618311419, 1.432851040608905, 2.0291835748341174, 1.9680032582391753, 2.6422566227082656, 1.2115695855271267, 1.3261275774995496, 0.42792314195293013, 3.088250132656725, 3.33374062525649, 2.8428389604706275, 1.0110297548415579, 4.418890577631358, 2.5556917320685795, 1.768052596496815, 3.3335211068180914, 2.921243842053056], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20507581808177455, "mean_inference_ms": 1.0299623410000103, "mean_action_processing_ms": 0.04286982753338144, "mean_env_wait_ms": 0.9553042540028328, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 544000, "timers": {"sample_time_ms": 5158.814, "sample_throughput": 3101.488, "learn_time_ms": 5374.456, "learn_throughput": 2977.046, "update_time_ms": 1.433}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.04596489286003899, "policy_loss": -0.012715370807475692, "vf_loss": 0.015117774639899531, "vf_explained_var": 0.9868412613868713, "kl": 0.01290740420562074, "entropy": -4.188198588111184, "entropy_coeff": 0.0}}, "num_steps_sampled": 544000, "num_steps_trained": 544000}, "done": false, "episodes_total": 528, "training_iteration": 45, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-11", "timestamp": 1617636671, "time_this_iter_s": 11.438358068466187, "time_total_s": 386.4106957912445, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 73.78594517707825, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 50.3875, "ram_util_percent": 61.949999999999996}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 4.418890577631358, "episode_reward_min": 0.35244126536500286, "episode_reward_mean": 1.9926108935159201, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.8194658132202042, 0.6873579388467801, 2.848793926953347, 1.5915678475590753, 3.7580685921020187, 2.244610334821192, 0.41208010400086903, 1.824562304899426, 1.7773206706600324, 1.2417357282890467, 2.151640008672437, 2.6840086131906746, 2.032084003123625, 3.881847743024344, 3.1775728195932498, 2.049168715753409, 3.2692365173716285, 1.3646693927048288, 0.8580238171912311, 2.6370368197048184, 1.0453137339767702, 2.737127607332382, 2.3930089976926663, 1.5751574992749133, 1.350800979234133, 1.4038356106268393, 1.7331558568766887, 1.2279934844734268, 1.0558125978457884, 2.564457335395689, 1.5007296721209742, 3.3271288967509465, 1.744548020784594, 1.17268539720892, 1.964035803997648, 2.5409090418549436, 1.779820268661609, 1.0722914865338482, 3.2029046445010794, 0.7740158416741596, 3.7673500273332534, 1.6537900546109126, 3.9635767278554246, 1.9304886815439448, 1.748749517068196, 2.322616327859839, 3.0797337267337808, 3.5389655719190225, 2.8560558004192425, 1.4503421659239795, 2.5556427847974654, 0.35244126536500286, 0.949271403007627, 0.6475792847289534, 1.6821413807092882, 1.0914199533385593, 1.3314078428692286, 1.234928202384085, 3.055722522969786, 3.6759150642477785, 1.9993429473326896, 1.9401930733467636, 0.8414124548504984, 1.6794446434207733, 1.7669334878028664, 0.9021087952020621, 0.8585225780409156, 4.307394618311419, 1.432851040608905, 2.0291835748341174, 1.9680032582391753, 2.6422566227082656, 1.2115695855271267, 1.3261275774995496, 0.42792314195293013, 3.088250132656725, 3.33374062525649, 2.8428389604706275, 1.0110297548415579, 4.418890577631358, 2.5556917320685795, 1.768052596496815, 3.3335211068180914, 2.921243842053056, 1.6074317256799975, 2.4366420434078853, 1.8774223684208522, 1.136862471107953, 0.9441938596161381, 0.7645783597588813, 1.4890809011910418, 0.5943463375212179, 1.5120262613442907, 1.5157264842852793, 1.1673678598749402, 1.5499503852954342, 3.6605209188891257, 2.0136439078122663, 1.8377293057945914, 3.182316639435129], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20667368994109178, "mean_inference_ms": 1.0390540294954838, "mean_action_processing_ms": 0.04320338967401023, "mean_env_wait_ms": 0.9596077047450663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 560000, "timers": {"sample_time_ms": 5170.18, "sample_throughput": 3094.67, "learn_time_ms": 5391.872, "learn_throughput": 2967.429, "update_time_ms": 1.484}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.05024248068278239, "policy_loss": -0.015269754552388225, "vf_loss": 0.017001754625446418, "vf_explained_var": 0.9828740954399109, "kl": 0.014373475713937572, "entropy": -4.198882832671657, "entropy_coeff": 0.0}}, "num_steps_sampled": 560000, "num_steps_trained": 560000}, "done": false, "episodes_total": 544, "training_iteration": 46, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-22", "timestamp": 1617636682, "time_this_iter_s": 10.771494150161743, "time_total_s": 397.18218994140625, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 84.55743932723999, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 51.080000000000005, "ram_util_percent": 61.87333333333332}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 4.418890577631358, "episode_reward_min": 0.35244126536500286, "episode_reward_mean": 1.9840493500306713, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.7417701262929977, 2.8513939555136263, 2.1524508636928656, 2.2287351851214847, 1.5588521153880772, 1.4276522794770794, 1.422521878255543, 1.444966926930916, 2.9130030397549076, 1.4185416861213294, 2.7392091339795837, 0.7343860738085288, 0.8844403830250482, 0.8963019293981911, 2.598997308713345, 2.1741115845753054, 1.744548020784594, 1.17268539720892, 1.964035803997648, 2.5409090418549436, 1.779820268661609, 1.0722914865338482, 3.2029046445010794, 0.7740158416741596, 3.7673500273332534, 1.6537900546109126, 3.9635767278554246, 1.9304886815439448, 1.748749517068196, 2.322616327859839, 3.0797337267337808, 3.5389655719190225, 2.8560558004192425, 1.4503421659239795, 2.5556427847974654, 0.35244126536500286, 0.949271403007627, 0.6475792847289534, 1.6821413807092882, 1.0914199533385593, 1.3314078428692286, 1.234928202384085, 3.055722522969786, 3.6759150642477785, 1.9993429473326896, 1.9401930733467636, 0.8414124548504984, 1.6794446434207733, 1.7669334878028664, 0.9021087952020621, 0.8585225780409156, 4.307394618311419, 1.432851040608905, 2.0291835748341174, 1.9680032582391753, 2.6422566227082656, 1.2115695855271267, 1.3261275774995496, 0.42792314195293013, 3.088250132656725, 3.33374062525649, 2.8428389604706275, 1.0110297548415579, 4.418890577631358, 2.5556917320685795, 1.768052596496815, 3.3335211068180914, 2.921243842053056, 1.6074317256799975, 2.4366420434078853, 1.8774223684208522, 1.136862471107953, 0.9441938596161381, 0.7645783597588813, 1.4890809011910418, 0.5943463375212179, 1.5120262613442907, 1.5157264842852793, 1.1673678598749402, 1.5499503852954342, 3.6605209188891257, 2.0136439078122663, 1.8377293057945914, 3.182316639435129, 1.8194658132202042, 0.6873579388467801, 2.848793926953347, 1.5915678475590753, 3.7580685921020187, 2.244610334821192, 0.41208010400086903, 1.824562304899426, 1.7773206706600324, 1.2417357282890467, 2.151640008672437, 2.6840086131906746, 2.032084003123625, 3.881847743024344, 3.1775728195932498, 2.049168715753409], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20824460581472143, "mean_inference_ms": 1.0445625233379459, "mean_action_processing_ms": 0.043542473607365316, "mean_env_wait_ms": 0.9654804417220201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 576000, "timers": {"sample_time_ms": 5220.62, "sample_throughput": 3064.77, "learn_time_ms": 5453.052, "learn_throughput": 2934.137, "update_time_ms": 1.482}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.06564325333602028, "policy_loss": -0.006975632574088222, "vf_loss": 0.0151332470334389, "vf_explained_var": 0.9811658263206482, "kl": 0.017032781693463523, "entropy": -4.200956633596709, "entropy_coeff": 0.0}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 560, "training_iteration": 47, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-34", "timestamp": 1617636694, "time_this_iter_s": 11.575029850006104, "time_total_s": 408.75721979141235, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 96.1324691772461, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 56.694117647058825, "ram_util_percent": 58.89411764705883}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 6.035743751187158, "episode_reward_min": 0.35244126536500286, "episode_reward_mean": 1.9793820447046984, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4863504011845476, 1.3988905268089562, 1.9042714911061887, 1.5823361368052704, 1.1678821347585773, 4.315900428123863, 1.6255724534319742, 1.8145519954039386, 1.870172845841207, 0.6616778599034949, 1.503732558978017, 4.4580349445018825, 2.00443784219486, 1.7373884303867846, 6.035743751187158, 2.222806806927166, 2.8560558004192425, 1.4503421659239795, 2.5556427847974654, 0.35244126536500286, 0.949271403007627, 0.6475792847289534, 1.6821413807092882, 1.0914199533385593, 1.3314078428692286, 1.234928202384085, 3.055722522969786, 3.6759150642477785, 1.9993429473326896, 1.9401930733467636, 0.8414124548504984, 1.6794446434207733, 1.7669334878028664, 0.9021087952020621, 0.8585225780409156, 4.307394618311419, 1.432851040608905, 2.0291835748341174, 1.9680032582391753, 2.6422566227082656, 1.2115695855271267, 1.3261275774995496, 0.42792314195293013, 3.088250132656725, 3.33374062525649, 2.8428389604706275, 1.0110297548415579, 4.418890577631358, 2.5556917320685795, 1.768052596496815, 3.3335211068180914, 2.921243842053056, 1.6074317256799975, 2.4366420434078853, 1.8774223684208522, 1.136862471107953, 0.9441938596161381, 0.7645783597588813, 1.4890809011910418, 0.5943463375212179, 1.5120262613442907, 1.5157264842852793, 1.1673678598749402, 1.5499503852954342, 3.6605209188891257, 2.0136439078122663, 1.8377293057945914, 3.182316639435129, 1.8194658132202042, 0.6873579388467801, 2.848793926953347, 1.5915678475590753, 3.7580685921020187, 2.244610334821192, 0.41208010400086903, 1.824562304899426, 1.7773206706600324, 1.2417357282890467, 2.151640008672437, 2.6840086131906746, 2.032084003123625, 3.881847743024344, 3.1775728195932498, 2.049168715753409, 1.7417701262929977, 2.8513939555136263, 2.1524508636928656, 2.2287351851214847, 1.5588521153880772, 1.4276522794770794, 1.422521878255543, 1.444966926930916, 2.9130030397549076, 1.4185416861213294, 2.7392091339795837, 0.7343860738085288, 0.8844403830250482, 0.8963019293981911, 2.598997308713345, 2.1741115845753054], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20951284240867898, "mean_inference_ms": 1.0488121637786525, "mean_action_processing_ms": 0.043857730450110315, "mean_env_wait_ms": 0.9710254174926084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 592000, "timers": {"sample_time_ms": 5194.378, "sample_throughput": 3080.253, "learn_time_ms": 5481.795, "learn_throughput": 2918.752, "update_time_ms": 1.479}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.061525004784484874, "policy_loss": -0.01003452496970016, "vf_loss": 0.016521539510876843, "vf_explained_var": 0.9769018888473511, "kl": 0.016307552239264955, "entropy": -4.210127599311598, "entropy_coeff": 0.0}}, "num_steps_sampled": 592000, "num_steps_trained": 592000}, "done": false, "episodes_total": 576, "training_iteration": 48, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-45", "timestamp": 1617636705, "time_this_iter_s": 10.70788311958313, "time_total_s": 419.4651029109955, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 106.84035229682922, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 46.33333333333334, "ram_util_percent": 62.18666666666668}, "trial_id": "1bd20_00001"}
{"episode_reward_max": 6.035743751187158, "episode_reward_min": 0.41208010400086903, "episode_reward_mean": 2.0489816081522942, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.280077849587167, 1.7362763417196323, 1.460739082812331, 1.4937559546000774, 0.8731577855624817, 2.0187020238574074, 1.3316662666346621, 3.4824562651620683, 1.4226752242903222, 4.621777625154261, 3.025742037125963, 1.7148692308123747, 1.5720416934621486, 1.9623382001085736, 2.9307557204791577, 1.376185833102713, 1.7669334878028664, 0.9021087952020621, 0.8585225780409156, 4.307394618311419, 1.432851040608905, 2.0291835748341174, 1.9680032582391753, 2.6422566227082656, 1.2115695855271267, 1.3261275774995496, 0.42792314195293013, 3.088250132656725, 3.33374062525649, 2.8428389604706275, 1.0110297548415579, 4.418890577631358, 2.5556917320685795, 1.768052596496815, 3.3335211068180914, 2.921243842053056, 1.6074317256799975, 2.4366420434078853, 1.8774223684208522, 1.136862471107953, 0.9441938596161381, 0.7645783597588813, 1.4890809011910418, 0.5943463375212179, 1.5120262613442907, 1.5157264842852793, 1.1673678598749402, 1.5499503852954342, 3.6605209188891257, 2.0136439078122663, 1.8377293057945914, 3.182316639435129, 1.8194658132202042, 0.6873579388467801, 2.848793926953347, 1.5915678475590753, 3.7580685921020187, 2.244610334821192, 0.41208010400086903, 1.824562304899426, 1.7773206706600324, 1.2417357282890467, 2.151640008672437, 2.6840086131906746, 2.032084003123625, 3.881847743024344, 3.1775728195932498, 2.049168715753409, 1.7417701262929977, 2.8513939555136263, 2.1524508636928656, 2.2287351851214847, 1.5588521153880772, 1.4276522794770794, 1.422521878255543, 1.444966926930916, 2.9130030397549076, 1.4185416861213294, 2.7392091339795837, 0.7343860738085288, 0.8844403830250482, 0.8963019293981911, 2.598997308713345, 2.1741115845753054, 1.4863504011845476, 1.3988905268089562, 1.9042714911061887, 1.5823361368052704, 1.1678821347585773, 4.315900428123863, 1.6255724534319742, 1.8145519954039386, 1.870172845841207, 0.6616778599034949, 1.503732558978017, 4.4580349445018825, 2.00443784219486, 1.7373884303867846, 6.035743751187158, 2.222806806927166], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21079371651070275, "mean_inference_ms": 1.0535114305580306, "mean_action_processing_ms": 0.04416021053936344, "mean_env_wait_ms": 0.9766396047761802, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 608000, "timers": {"sample_time_ms": 5197.826, "sample_throughput": 3078.21, "learn_time_ms": 5522.118, "learn_throughput": 2897.439, "update_time_ms": 1.471}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.04879825001857667, "policy_loss": -0.014419629670693681, "vf_loss": 0.014351805679104997, "vf_explained_var": 0.9766422510147095, "kl": 0.014478836215637399, "entropy": -4.277770038807031, "entropy_coeff": 0.0}}, "num_steps_sampled": 608000, "num_steps_trained": 608000}, "done": false, "episodes_total": 592, "training_iteration": 49, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-56", "timestamp": 1617636716, "time_this_iter_s": 10.92332911491394, "time_total_s": 430.3884320259094, "pid": 17612, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15256, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.912359821596044, "kl_coeff": 1.0, "sgd_minibatch_size": 122, "shuffle_sequences": true, "num_sgd_iter": 9, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2580602636281841, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 117.76368141174316, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 47.575, "ram_util_percent": 62.3}, "trial_id": "1bd20_00001"}
