{"episode_reward_max": -0.08491743991056999, "episode_reward_min": -0.7015718753164276, "episode_reward_mean": -0.4684847470178756, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2921956064795659, -0.5932554320207865, -0.5253674244208344, -0.7015718753164276, -0.638227559050143, -0.5060579523192031, -0.08491743991056999, -0.4062846866254748], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12012990690145553, "mean_inference_ms": 0.9996189465274307, "mean_action_processing_ms": 0.04239681360978556, "mean_env_wait_ms": 0.9975737754486868, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 11200, "timers": {"sample_time_ms": 3417.561, "sample_throughput": 3277.191, "learn_time_ms": 2830.679, "learn_throughput": 3956.647, "update_time_ms": 1.509}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.005076669608096804, "total_loss": 0.03151283735959706, "policy_loss": 0.003210727199488743, "vf_loss": 0.006311236938927323, "vf_explained_var": 0.7418053150177002, "kl": 0.021990872707895258, "entropy": -3.4601942978122016, "entropy_coeff": 0.0}}, "num_steps_sampled": 11200, "num_steps_trained": 11200}, "done": false, "episodes_total": 8, "training_iteration": 1, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_07-57-42", "timestamp": 1617634662, "time_this_iter_s": 6.252441644668579, "time_total_s": 6.252441644668579, "pid": 4358, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.252441644668579, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.455555555555556, "ram_util_percent": 59.78888888888889}, "trial_id": "3e406_00001"}
{"episode_reward_max": -0.08491743991056999, "episode_reward_min": -0.7015718753164276, "episode_reward_mean": -0.4618019271459486, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6557493328332467, -0.31267154120559176, -0.4153980188242743, -0.5732576086162056, -0.6510243511578143, -0.12534116142258978, -0.47303187353555226, -0.4344789705968979, -0.2921956064795659, -0.5932554320207865, -0.5253674244208344, -0.7015718753164276, -0.638227559050143, -0.5060579523192031, -0.08491743991056999, -0.4062846866254748], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12325705943346635, "mean_inference_ms": 0.9938885198348552, "mean_action_processing_ms": 0.0421255901376118, "mean_env_wait_ms": 0.9744454922876686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 22400, "timers": {"sample_time_ms": 3322.042, "sample_throughput": 3371.421, "learn_time_ms": 2912.064, "learn_throughput": 3846.069, "update_time_ms": 1.575}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.005076669608096804, "total_loss": 0.008439529792998324, "policy_loss": -0.007819002245510505, "vf_loss": 0.004820815991313959, "vf_explained_var": 0.7626217007637024, "kl": 0.007625144377181476, "entropy": -3.420829900286414, "entropy_coeff": 0.0}}, "num_steps_sampled": 22400, "num_steps_trained": 22400}, "done": false, "episodes_total": 16, "training_iteration": 2, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_07-57-48", "timestamp": 1617634668, "time_this_iter_s": 6.2267746925354, "time_total_s": 12.47921633720398, "pid": 4358, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.47921633720398, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.644444444444446, "ram_util_percent": 60.0}, "trial_id": "3e406_00001"}
{"episode_reward_max": -0.08491743991056999, "episode_reward_min": -0.7015718753164276, "episode_reward_mean": -0.44891153480006707, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6201037619217884, -0.365331592376556, -0.460995914877823, -0.6290739891014578, -0.2465218174171926, -0.566178507935877, -0.2074653789840467, -0.2384788909043275, -0.512516070198716, -0.40981574178507857, -0.6719287122919173, -0.1158564088824201, -0.5556583271046811, -0.3307718848569189, -0.4582522730011425, -0.587389007627025, -0.2921956064795659, -0.5932554320207865, -0.5253674244208344, -0.7015718753164276, -0.638227559050143, -0.5060579523192031, -0.08491743991056999, -0.4062846866254748, -0.6557493328332467, -0.31267154120559176, -0.4153980188242743, -0.5732576086162056, -0.6510243511578143, -0.12534116142258978, -0.47303187353555226, -0.4344789705968979], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13472031445139782, "mean_inference_ms": 0.9807476843757941, "mean_action_processing_ms": 0.04156290885071017, "mean_env_wait_ms": 0.9459704976562959, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 33600, "timers": {"sample_time_ms": 3261.341, "sample_throughput": 3434.17, "learn_time_ms": 2984.926, "learn_throughput": 3752.187, "update_time_ms": 1.463}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.005076669608096804, "total_loss": 0.009137424915520982, "policy_loss": -0.007081587560771202, "vf_loss": 0.005190327004212039, "vf_explained_var": 0.6627047061920166, "kl": 0.007352456894957207, "entropy": -3.422537635673176, "entropy_coeff": 0.0}}, "num_steps_sampled": 33600, "num_steps_trained": 33600}, "done": false, "episodes_total": 32, "training_iteration": 3, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_07-57-54", "timestamp": 1617634674, "time_this_iter_s": 6.276242971420288, "time_total_s": 18.755459308624268, "pid": 4358, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18.755459308624268, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.65555555555556, "ram_util_percent": 60.14444444444445}, "trial_id": "3e406_00001"}
{"episode_reward_max": -0.08491743991056999, "episode_reward_min": -0.7392897914881909, "episode_reward_mean": -0.46943685026624243, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6906448841049128, -0.7392897914881909, -0.3842423028104287, -0.4435560004089514, -0.41567340813525516, -0.5888484827022107, -0.686151197079838, -0.46389883031776336, -0.2921956064795659, -0.5932554320207865, -0.5253674244208344, -0.7015718753164276, -0.638227559050143, -0.5060579523192031, -0.08491743991056999, -0.4062846866254748, -0.6557493328332467, -0.31267154120559176, -0.4153980188242743, -0.5732576086162056, -0.6510243511578143, -0.12534116142258978, -0.47303187353555226, -0.4344789705968979, -0.6201037619217884, -0.365331592376556, -0.460995914877823, -0.6290739891014578, -0.2465218174171926, -0.566178507935877, -0.2074653789840467, -0.2384788909043275, -0.512516070198716, -0.40981574178507857, -0.6719287122919173, -0.1158564088824201, -0.5556583271046811, -0.3307718848569189, -0.4582522730011425, -0.587389007627025], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13529407721883394, "mean_inference_ms": 0.9747546520470541, "mean_action_processing_ms": 0.04130791410090275, "mean_env_wait_ms": 0.9356968716300524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 44800, "timers": {"sample_time_ms": 3173.284, "sample_throughput": 3529.467, "learn_time_ms": 3022.897, "learn_throughput": 3705.055, "update_time_ms": 1.434}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.005076669608096804, "total_loss": 0.01109124404716898, "policy_loss": -0.004273684097411619, "vf_loss": 0.005253832816379145, "vf_explained_var": 0.609389066696167, "kl": 0.0067407314887862994, "entropy": -3.3991828804666344, "entropy_coeff": 0.0}}, "num_steps_sampled": 44800, "num_steps_trained": 44800}, "done": false, "episodes_total": 40, "training_iteration": 4, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_07-58-00", "timestamp": 1617634680, "time_this_iter_s": 6.053090572357178, "time_total_s": 24.808549880981445, "pid": 4358, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.808549880981445, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.044444444444444, "ram_util_percent": 60.13333333333334}, "trial_id": "3e406_00001"}
{"episode_reward_max": -0.08491743991056999, "episode_reward_min": -0.7392897914881909, "episode_reward_mean": -0.46656167998023285, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.606129215879897, -0.4030805744292898, -0.4529628975212766, -0.4773372662017597, -0.3540795197943859, -0.6383998874040255, -0.4903799008117287, -0.19155865818892015, -0.42998885868384, -0.5453480861302982, -0.5508500143182, -0.16836572405539918, -0.6370550973876596, -0.26762509498817655, -0.5700172247452877, -0.5668020477031976, -0.2921956064795659, -0.5932554320207865, -0.5253674244208344, -0.7015718753164276, -0.638227559050143, -0.5060579523192031, -0.08491743991056999, -0.4062846866254748, -0.6557493328332467, -0.31267154120559176, -0.4153980188242743, -0.5732576086162056, -0.6510243511578143, -0.12534116142258978, -0.47303187353555226, -0.4344789705968979, -0.6201037619217884, -0.365331592376556, -0.460995914877823, -0.6290739891014578, -0.2465218174171926, -0.566178507935877, -0.2074653789840467, -0.2384788909043275, -0.512516070198716, -0.40981574178507857, -0.6719287122919173, -0.1158564088824201, -0.5556583271046811, -0.3307718848569189, -0.4582522730011425, -0.587389007627025, -0.6906448841049128, -0.7392897914881909, -0.3842423028104287, -0.4435560004089514, -0.41567340813525516, -0.5888484827022107, -0.686151197079838, -0.46389883031776336], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13829947104847287, "mean_inference_ms": 0.9661872421919698, "mean_action_processing_ms": 0.04092141953638011, "mean_env_wait_ms": 0.9207532097118404, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 56000, "timers": {"sample_time_ms": 3172.303, "sample_throughput": 3530.558, "learn_time_ms": 3031.591, "learn_throughput": 3694.429, "update_time_ms": 1.442}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.005076669608096804, "total_loss": 0.011423908607949588, "policy_loss": -0.0031994478988715195, "vf_loss": 0.004522304280809211, "vf_explained_var": 0.656214714050293, "kl": 0.0067340345386500385, "entropy": -3.416420820084485, "entropy_coeff": 0.0}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 56, "training_iteration": 5, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_07-58-07", "timestamp": 1617634687, "time_this_iter_s": 6.241878032684326, "time_total_s": 31.05042791366577, "pid": 4358, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.05042791366577, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 43.611111111111114, "ram_util_percent": 60.05555555555556}, "trial_id": "3e406_00001"}
{"episode_reward_max": -0.08491743991056999, "episode_reward_min": -0.7392897914881909, "episode_reward_mean": -0.4721116101163336, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.11888282274053896, -0.5962795044394991, -0.4222780569340263, -0.7304634783766767, -0.40539128573104743, -0.6525747147446336, -0.7385840865844319, -0.42323501900145855, -0.2921956064795659, -0.5932554320207865, -0.5253674244208344, -0.7015718753164276, -0.638227559050143, -0.5060579523192031, -0.08491743991056999, -0.4062846866254748, -0.6557493328332467, -0.31267154120559176, -0.4153980188242743, -0.5732576086162056, -0.6510243511578143, -0.12534116142258978, -0.47303187353555226, -0.4344789705968979, -0.6201037619217884, -0.365331592376556, -0.460995914877823, -0.6290739891014578, -0.2465218174171926, -0.566178507935877, -0.2074653789840467, -0.2384788909043275, -0.512516070198716, -0.40981574178507857, -0.6719287122919173, -0.1158564088824201, -0.5556583271046811, -0.3307718848569189, -0.4582522730011425, -0.587389007627025, -0.6906448841049128, -0.7392897914881909, -0.3842423028104287, -0.4435560004089514, -0.41567340813525516, -0.5888484827022107, -0.686151197079838, -0.46389883031776336, -0.606129215879897, -0.4030805744292898, -0.4529628975212766, -0.4773372662017597, -0.3540795197943859, -0.6383998874040255, -0.4903799008117287, -0.19155865818892015, -0.42998885868384, -0.5453480861302982, -0.5508500143182, -0.16836572405539918, -0.6370550973876596, -0.26762509498817655, -0.5700172247452877, -0.5668020477031976], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13868152583565685, "mean_inference_ms": 0.9631965433772849, "mean_action_processing_ms": 0.040790726630826286, "mean_env_wait_ms": 0.9154735375137387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 67200, "timers": {"sample_time_ms": 3142.63, "sample_throughput": 3563.894, "learn_time_ms": 3022.092, "learn_throughput": 3706.043, "update_time_ms": 1.477}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.005076669608096804, "total_loss": 0.010247029639272527, "policy_loss": -0.004338706642473963, "vf_loss": 0.004685470149111511, "vf_explained_var": 0.7211335897445679, "kl": 0.0066001774155831135, "entropy": -3.4439957954666833, "entropy_coeff": 0.0}}, "num_steps_sampled": 67200, "num_steps_trained": 67200}, "done": false, "episodes_total": 64, "training_iteration": 6, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_07-58-13", "timestamp": 1617634693, "time_this_iter_s": 5.975352048873901, "time_total_s": 37.02577996253967, "pid": 4358, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.02577996253967, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.4875, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": -0.08491743991056999, "episode_reward_min": -0.7392897914881909, "episode_reward_mean": -0.4604451101662829, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3911713175313838, -0.149645577031569, -0.26296581320225465, -0.45263736844671776, -0.18339085537358502, -0.7291222408362259, -0.5561799488942855, -0.21179176321099513, -0.2921956064795659, -0.5932554320207865, -0.5253674244208344, -0.7015718753164276, -0.638227559050143, -0.5060579523192031, -0.08491743991056999, -0.4062846866254748, -0.6557493328332467, -0.31267154120559176, -0.4153980188242743, -0.5732576086162056, -0.6510243511578143, -0.12534116142258978, -0.47303187353555226, -0.4344789705968979, -0.6201037619217884, -0.365331592376556, -0.460995914877823, -0.6290739891014578, -0.2465218174171926, -0.566178507935877, -0.2074653789840467, -0.2384788909043275, -0.512516070198716, -0.40981574178507857, -0.6719287122919173, -0.1158564088824201, -0.5556583271046811, -0.3307718848569189, -0.4582522730011425, -0.587389007627025, -0.6906448841049128, -0.7392897914881909, -0.3842423028104287, -0.4435560004089514, -0.41567340813525516, -0.5888484827022107, -0.686151197079838, -0.46389883031776336, -0.606129215879897, -0.4030805744292898, -0.4529628975212766, -0.4773372662017597, -0.3540795197943859, -0.6383998874040255, -0.4903799008117287, -0.19155865818892015, -0.42998885868384, -0.5453480861302982, -0.5508500143182, -0.16836572405539918, -0.6370550973876596, -0.26762509498817655, -0.5700172247452877, -0.5668020477031976, -0.11888282274053896, -0.5962795044394991, -0.4222780569340263, -0.7304634783766767, -0.40539128573104743, -0.6525747147446336, -0.7385840865844319, -0.42323501900145855], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13895834234424273, "mean_inference_ms": 0.961714529451712, "mean_action_processing_ms": 0.040725322138107894, "mean_env_wait_ms": 0.9121364504628142, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 78400, "timers": {"sample_time_ms": 3155.786, "sample_throughput": 3549.036, "learn_time_ms": 3014.059, "learn_throughput": 3715.919, "update_time_ms": 1.494}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.005076669608096804, "total_loss": 0.008246001919773831, "policy_loss": -0.006238759082572704, "vf_loss": 0.005274414357369427, "vf_explained_var": 0.5413191318511963, "kl": 0.0061402301838494495, "entropy": -3.4226653304967014, "entropy_coeff": 0.0}}, "num_steps_sampled": 78400, "num_steps_trained": 78400}, "done": false, "episodes_total": 72, "training_iteration": 7, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_07-58-19", "timestamp": 1617634699, "time_this_iter_s": 6.207373857498169, "time_total_s": 43.23315382003784, "pid": 4358, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.23315382003784, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 47.022222222222226, "ram_util_percent": 60.099999999999994}, "trial_id": "3e406_00001"}
{"episode_reward_max": -0.08491743991056999, "episode_reward_min": -0.8033749235098057, "episode_reward_mean": -0.4708495654385642, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5292825801922874, -0.16678378090621737, -0.3845471980460251, -0.6040933821226588, -0.4379879262848053, -0.7741584664489469, -0.7872333549427387, -0.7168227142440817, -0.31768847346151863, -0.8033749235098057, -0.3330935878371917, -0.3578405987289879, -0.5614406873263889, -0.46936300754934107, -0.610725921679544, -0.42827722334074814, -0.2921956064795659, -0.5932554320207865, -0.5253674244208344, -0.7015718753164276, -0.638227559050143, -0.5060579523192031, -0.08491743991056999, -0.4062846866254748, -0.6557493328332467, -0.31267154120559176, -0.4153980188242743, -0.5732576086162056, -0.6510243511578143, -0.12534116142258978, -0.47303187353555226, -0.4344789705968979, -0.6201037619217884, -0.365331592376556, -0.460995914877823, -0.6290739891014578, -0.2465218174171926, -0.566178507935877, -0.2074653789840467, -0.2384788909043275, -0.512516070198716, -0.40981574178507857, -0.6719287122919173, -0.1158564088824201, -0.5556583271046811, -0.3307718848569189, -0.4582522730011425, -0.587389007627025, -0.6906448841049128, -0.7392897914881909, -0.3842423028104287, -0.4435560004089514, -0.41567340813525516, -0.5888484827022107, -0.686151197079838, -0.46389883031776336, -0.606129215879897, -0.4030805744292898, -0.4529628975212766, -0.4773372662017597, -0.3540795197943859, -0.6383998874040255, -0.4903799008117287, -0.19155865818892015, -0.42998885868384, -0.5453480861302982, -0.5508500143182, -0.16836572405539918, -0.6370550973876596, -0.26762509498817655, -0.5700172247452877, -0.5668020477031976, -0.11888282274053896, -0.5962795044394991, -0.4222780569340263, -0.7304634783766767, -0.40539128573104743, -0.6525747147446336, -0.7385840865844319, -0.42323501900145855, -0.3911713175313838, -0.149645577031569, -0.26296581320225465, -0.45263736844671776, -0.18339085537358502, -0.7291222408362259, -0.5561799488942855, -0.21179176321099513], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14046357934541778, "mean_inference_ms": 0.960267677825049, "mean_action_processing_ms": 0.04065815432879214, "mean_env_wait_ms": 0.9077731458562845, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 89600, "timers": {"sample_time_ms": 3180.434, "sample_throughput": 3521.532, "learn_time_ms": 3011.304, "learn_throughput": 3719.319, "update_time_ms": 1.493}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.005076669608096804, "total_loss": 0.011248170810920948, "policy_loss": -0.0032196469202807002, "vf_loss": 0.005602531256789172, "vf_explained_var": 0.5602183938026428, "kl": 0.005910190798617391, "entropy": -3.42229070446708, "entropy_coeff": 0.0}}, "num_steps_sampled": 89600, "num_steps_trained": 89600}, "done": false, "episodes_total": 88, "training_iteration": 8, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_07-58-25", "timestamp": 1617634705, "time_this_iter_s": 6.351698160171509, "time_total_s": 49.58485198020935, "pid": 4358, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.58485198020935, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 44.74444444444444, "ram_util_percent": 60.1888888888889}, "trial_id": "3e406_00001"}
{"episode_reward_max": 0.04939476557423195, "episode_reward_min": -0.8033749235098057, "episode_reward_mean": -0.46496628528194, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4255511604812136, -0.3058820011844946, -0.4448448457940769, -0.3357011110338861, -0.7140731275634223, -0.3630703546667392, 0.04939476557423195, -0.6622737933229819, -0.2921956064795659, -0.5932554320207865, -0.5253674244208344, -0.7015718753164276, -0.638227559050143, -0.5060579523192031, -0.08491743991056999, -0.4062846866254748, -0.6557493328332467, -0.31267154120559176, -0.4153980188242743, -0.5732576086162056, -0.6510243511578143, -0.12534116142258978, -0.47303187353555226, -0.4344789705968979, -0.6201037619217884, -0.365331592376556, -0.460995914877823, -0.6290739891014578, -0.2465218174171926, -0.566178507935877, -0.2074653789840467, -0.2384788909043275, -0.512516070198716, -0.40981574178507857, -0.6719287122919173, -0.1158564088824201, -0.5556583271046811, -0.3307718848569189, -0.4582522730011425, -0.587389007627025, -0.6906448841049128, -0.7392897914881909, -0.3842423028104287, -0.4435560004089514, -0.41567340813525516, -0.5888484827022107, -0.686151197079838, -0.46389883031776336, -0.606129215879897, -0.4030805744292898, -0.4529628975212766, -0.4773372662017597, -0.3540795197943859, -0.6383998874040255, -0.4903799008117287, -0.19155865818892015, -0.42998885868384, -0.5453480861302982, -0.5508500143182, -0.16836572405539918, -0.6370550973876596, -0.26762509498817655, -0.5700172247452877, -0.5668020477031976, -0.11888282274053896, -0.5962795044394991, -0.4222780569340263, -0.7304634783766767, -0.40539128573104743, -0.6525747147446336, -0.7385840865844319, -0.42323501900145855, -0.3911713175313838, -0.149645577031569, -0.26296581320225465, -0.45263736844671776, -0.18339085537358502, -0.7291222408362259, -0.5561799488942855, -0.21179176321099513, -0.5292825801922874, -0.16678378090621737, -0.3845471980460251, -0.6040933821226588, -0.4379879262848053, -0.7741584664489469, -0.7872333549427387, -0.7168227142440817, -0.31768847346151863, -0.8033749235098057, -0.3330935878371917, -0.3578405987289879, -0.5614406873263889, -0.46936300754934107, -0.610725921679544, -0.42827722334074814], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14078508284491656, "mean_inference_ms": 0.9607522864054309, "mean_action_processing_ms": 0.040641563848593375, "mean_env_wait_ms": 0.9061214945120794, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 100800, "timers": {"sample_time_ms": 3197.696, "sample_throughput": 3502.521, "learn_time_ms": 3050.893, "learn_throughput": 3671.057, "update_time_ms": 1.542}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.005076669608096804, "total_loss": 0.009719488941217687, "policy_loss": -0.004138188023882156, "vf_loss": 0.006812032259238715, "vf_explained_var": 0.5826969146728516, "kl": 0.004697097116149962, "entropy": -3.4091030765663493, "entropy_coeff": 0.0}}, "num_steps_sampled": 100800, "num_steps_trained": 100800}, "done": false, "episodes_total": 96, "training_iteration": 9, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_07-58-32", "timestamp": 1617634712, "time_this_iter_s": 6.713280439376831, "time_total_s": 56.29813241958618, "pid": 4358, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 56.29813241958618, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 46.68, "ram_util_percent": 57.279999999999994}, "trial_id": "3e406_00001"}
{"episode_reward_max": -0.10843855340446595, "episode_reward_min": -0.6433625431234699, "episode_reward_mean": -0.39073247481240964, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.15264254822943946, -0.40280107103282403, -0.10843855340446595, -0.6433625431234699, -0.4402618645736789, -0.3136576354315326, -0.5444158283428322, -0.520279754361034], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13549960910380524, "mean_inference_ms": 1.0710720884893554, "mean_action_processing_ms": 0.04500942005590402, "mean_env_wait_ms": 1.0677503952377614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 112000, "timers": {"sample_time_ms": 4092.095, "sample_throughput": 2736.984, "learn_time_ms": 3426.234, "learn_throughput": 3268.895, "update_time_ms": 1.829}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.005076669608096804, "total_loss": 0.010659195488022471, "policy_loss": -0.003157428153578869, "vf_loss": 0.0064686511018821466, "vf_explained_var": 0.7407691478729248, "kl": 0.007347974492321638, "entropy": -3.4138163301077755, "entropy_coeff": 0.0}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 104, "training_iteration": 10, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_08-00-38", "timestamp": 1617634838, "time_this_iter_s": 7.523428201675415, "time_total_s": 63.8215606212616, "pid": 5471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.523428201675415, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.90909090909091, "ram_util_percent": 59.91818181818181}, "trial_id": "3e406_00001"}
{"episode_reward_max": 0.2574028213911095, "episode_reward_min": -0.6433625431234699, "episode_reward_mean": -0.3542738941579913, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4656916607823022, -0.4750999030368388, -0.4570672048015558, -0.6173896960517149, 0.2574028213911095, -0.2848400292671207, -0.3450962986276719, -0.15474053685248945, -0.15264254822943946, -0.40280107103282403, -0.10843855340446595, -0.6433625431234699, -0.4402618645736789, -0.3136576354315326, -0.5444158283428322, -0.520279754361034], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13779015119088275, "mean_inference_ms": 1.072051570997497, "mean_action_processing_ms": 0.0455553540503124, "mean_env_wait_ms": 1.0512224100541854, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 123200, "timers": {"sample_time_ms": 3780.024, "sample_throughput": 2962.944, "learn_time_ms": 3654.018, "learn_throughput": 3065.119, "update_time_ms": 1.835}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.005076669608096804, "total_loss": 0.012572467141911726, "policy_loss": -0.0020361732776192102, "vf_loss": 0.008793112726628104, "vf_explained_var": 0.5564531683921814, "kl": 0.005815528388748961, "entropy": -3.348984282125126, "entropy_coeff": 0.0}}, "num_steps_sampled": 123200, "num_steps_trained": 123200}, "done": false, "episodes_total": 112, "training_iteration": 11, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_08-00-46", "timestamp": 1617634846, "time_this_iter_s": 7.356964826583862, "time_total_s": 71.17852544784546, "pid": 5471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.880393028259277, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 57.36363636363637, "ram_util_percent": 56.9}, "trial_id": "3e406_00001"}
{"episode_reward_max": 0.9023126985733441, "episode_reward_min": -0.7080970457300129, "episode_reward_mean": -0.28908450589513135, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.10350336689344686, -0.45893964014928224, -0.4378126998879263, -0.33208966117193683, -0.6112526440745729, -0.43000384974449174, 0.06413426783091625, -0.5815466228870152, -0.7080970457300129, -0.564540297598805, 0.46757007596850353, -0.2415142117828919, 0.9023126985733441, -0.22738047138175488, 0.08820396222730253, -0.614869109201164, -0.15264254822943946, -0.40280107103282403, -0.10843855340446595, -0.6433625431234699, -0.4402618645736789, -0.3136576354315326, -0.5444158283428322, -0.520279754361034, -0.4656916607823022, -0.4750999030368388, -0.4570672048015558, -0.6173896960517149, 0.2574028213911095, -0.2848400292671207, -0.3450962986276719, -0.15474053685248945], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15213897072864535, "mean_inference_ms": 1.0849920375165245, "mean_action_processing_ms": 0.04624562964968354, "mean_env_wait_ms": 1.0502747981940186, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 134400, "timers": {"sample_time_ms": 3792.758, "sample_throughput": 2952.996, "learn_time_ms": 3568.948, "learn_throughput": 3138.18, "update_time_ms": 1.72}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.005076669608096804, "total_loss": 0.011181310729377648, "policy_loss": -0.003997525210830976, "vf_loss": 0.008609121649483726, "vf_explained_var": 0.6130161285400391, "kl": 0.006569714497097514, "entropy": -3.369264453649521, "entropy_coeff": 0.0}}, "num_steps_sampled": 134400, "num_steps_trained": 134400}, "done": false, "episodes_total": 128, "training_iteration": 12, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_08-00-53", "timestamp": 1617634853, "time_this_iter_s": 7.223317623138428, "time_total_s": 78.40184307098389, "pid": 5471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.103710651397705, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.76, "ram_util_percent": 60.14999999999999}, "trial_id": "3e406_00001"}
{"episode_reward_max": 0.9023126985733441, "episode_reward_min": -0.7852161205593478, "episode_reward_mean": -0.3230010489451006, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5014281746848694, -0.35654325656480124, -0.21252844439762253, -0.7852161205593478, -0.331164765544931, -0.40149785365750956, -0.5393387318666291, -0.5416204218841106, -0.15264254822943946, -0.40280107103282403, -0.10843855340446595, -0.6433625431234699, -0.4402618645736789, -0.3136576354315326, -0.5444158283428322, -0.520279754361034, -0.4656916607823022, -0.4750999030368388, -0.4570672048015558, -0.6173896960517149, 0.2574028213911095, -0.2848400292671207, -0.3450962986276719, -0.15474053685248945, 0.10350336689344686, -0.45893964014928224, -0.4378126998879263, -0.33208966117193683, -0.6112526440745729, -0.43000384974449174, 0.06413426783091625, -0.5815466228870152, -0.7080970457300129, -0.564540297598805, 0.46757007596850353, -0.2415142117828919, 0.9023126985733441, -0.22738047138175488, 0.08820396222730253, -0.614869109201164], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15212945194372113, "mean_inference_ms": 1.0805721706694715, "mean_action_processing_ms": 0.04581139962410259, "mean_env_wait_ms": 1.0358780614575918, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 145600, "timers": {"sample_time_ms": 3625.166, "sample_throughput": 3089.513, "learn_time_ms": 3643.184, "learn_throughput": 3074.234, "update_time_ms": 1.686}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.005076669608096804, "total_loss": 0.008673962565477599, "policy_loss": -0.0030727577236989005, "vf_loss": 0.005394528704610738, "vf_explained_var": 0.7858076691627502, "kl": 0.006352190663826398, "entropy": -3.3959027284925636, "entropy_coeff": 0.0}}, "num_steps_sampled": 145600, "num_steps_trained": 145600}, "done": false, "episodes_total": 136, "training_iteration": 13, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_08-01-00", "timestamp": 1617634860, "time_this_iter_s": 6.99504017829895, "time_total_s": 85.39688324928284, "pid": 5471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.098750829696655, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.09, "ram_util_percent": 60.29999999999999}, "trial_id": "3e406_00001"}
{"episode_reward_max": 0.9023126985733441, "episode_reward_min": -0.7852161205593478, "episode_reward_mean": -0.32485284132604325, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4908121792794165, -0.3736209083007178, -0.5191322210061409, -0.6355792481480127, -0.5294507659123426, -0.6066954030095884, -0.5941003296110867, 0.004094961609356407, -0.4086126507012592, 0.16553592438099307, 0.08396695714847136, -0.4526799722186161, -0.16509542461032545, -0.30979246934367743, -0.2106085005341657, -0.2291349269178683, -0.15264254822943946, -0.40280107103282403, -0.10843855340446595, -0.6433625431234699, -0.4402618645736789, -0.3136576354315326, -0.5444158283428322, -0.520279754361034, -0.4656916607823022, -0.4750999030368388, -0.4570672048015558, -0.6173896960517149, 0.2574028213911095, -0.2848400292671207, -0.3450962986276719, -0.15474053685248945, 0.10350336689344686, -0.45893964014928224, -0.4378126998879263, -0.33208966117193683, -0.6112526440745729, -0.43000384974449174, 0.06413426783091625, -0.5815466228870152, -0.7080970457300129, -0.564540297598805, 0.46757007596850353, -0.2415142117828919, 0.9023126985733441, -0.22738047138175488, 0.08820396222730253, -0.614869109201164, -0.5014281746848694, -0.35654325656480124, -0.21252844439762253, -0.7852161205593478, -0.331164765544931, -0.40149785365750956, -0.5393387318666291, -0.5416204218841106], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15421267232229724, "mean_inference_ms": 1.0703068539323883, "mean_action_processing_ms": 0.04512648363240801, "mean_env_wait_ms": 1.0147115138671203, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 156800, "timers": {"sample_time_ms": 3548.38, "sample_throughput": 3156.37, "learn_time_ms": 3580.836, "learn_throughput": 3127.761, "update_time_ms": 1.644}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.005076669608096804, "total_loss": 0.008941091142002155, "policy_loss": -0.0038818602227944543, "vf_loss": 0.005854102343701842, "vf_explained_var": 0.7386449575424194, "kl": 0.006968847814608704, "entropy": -3.4327677244489845, "entropy_coeff": 0.0}}, "num_steps_sampled": 156800, "num_steps_trained": 156800}, "done": false, "episodes_total": 152, "training_iteration": 14, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_08-01-07", "timestamp": 1617634867, "time_this_iter_s": 6.579470157623291, "time_total_s": 91.97635340690613, "pid": 5471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.678220987319946, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.56666666666666, "ram_util_percent": 60.36666666666666}, "trial_id": "3e406_00001"}
{"episode_reward_max": 0.9023126985733441, "episode_reward_min": -0.7852161205593478, "episode_reward_mean": -0.3311786013131729, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.44531676198099546, -0.5823124018254129, -0.5821844360014069, -0.19729783208526308, -0.03738628649518305, -0.2893511426764247, -0.3675176111971338, -0.5023048975228241, -0.15264254822943946, -0.40280107103282403, -0.10843855340446595, -0.6433625431234699, -0.4402618645736789, -0.3136576354315326, -0.5444158283428322, -0.520279754361034, -0.4656916607823022, -0.4750999030368388, -0.4570672048015558, -0.6173896960517149, 0.2574028213911095, -0.2848400292671207, -0.3450962986276719, -0.15474053685248945, 0.10350336689344686, -0.45893964014928224, -0.4378126998879263, -0.33208966117193683, -0.6112526440745729, -0.43000384974449174, 0.06413426783091625, -0.5815466228870152, -0.7080970457300129, -0.564540297598805, 0.46757007596850353, -0.2415142117828919, 0.9023126985733441, -0.22738047138175488, 0.08820396222730253, -0.614869109201164, -0.5014281746848694, -0.35654325656480124, -0.21252844439762253, -0.7852161205593478, -0.331164765544931, -0.40149785365750956, -0.5393387318666291, -0.5416204218841106, -0.4908121792794165, -0.3736209083007178, -0.5191322210061409, -0.6355792481480127, -0.5294507659123426, -0.6066954030095884, -0.5941003296110867, 0.004094961609356407, -0.4086126507012592, 0.16553592438099307, 0.08396695714847136, -0.4526799722186161, -0.16509542461032545, -0.30979246934367743, -0.2106085005341657, -0.2291349269178683], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15456823778526413, "mean_inference_ms": 1.0658231500677, "mean_action_processing_ms": 0.044868406368860816, "mean_env_wait_ms": 1.0069896236731268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 168000, "timers": {"sample_time_ms": 3501.604, "sample_throughput": 3198.534, "learn_time_ms": 3642.639, "learn_throughput": 3074.694, "update_time_ms": 1.666}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.005076669608096804, "total_loss": 0.0060927594101733784, "policy_loss": -0.003905690380964767, "vf_loss": 0.004698569878448986, "vf_explained_var": 0.7572605013847351, "kl": 0.005299879534339363, "entropy": -3.3890050920573147, "entropy_coeff": 0.0}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 160, "training_iteration": 15, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_08-01-14", "timestamp": 1617634874, "time_this_iter_s": 7.226135015487671, "time_total_s": 99.2024884223938, "pid": 5471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.90435600280762, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 49.56363636363637, "ram_util_percent": 60.4909090909091}, "trial_id": "3e406_00001"}
{"episode_reward_max": 0.9023126985733441, "episode_reward_min": -0.7852161205593478, "episode_reward_mean": -0.3299131837510032, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.10112082569895375, -0.49280720553415647, -0.1386903487013409, -0.5668312243152647, -0.5879137433857651, 0.011702703453948526, -0.4023089686552236, -0.2803491331924107, -0.15264254822943946, -0.40280107103282403, -0.10843855340446595, -0.6433625431234699, -0.4402618645736789, -0.3136576354315326, -0.5444158283428322, -0.520279754361034, -0.4656916607823022, -0.4750999030368388, -0.4570672048015558, -0.6173896960517149, 0.2574028213911095, -0.2848400292671207, -0.3450962986276719, -0.15474053685248945, 0.10350336689344686, -0.45893964014928224, -0.4378126998879263, -0.33208966117193683, -0.6112526440745729, -0.43000384974449174, 0.06413426783091625, -0.5815466228870152, -0.7080970457300129, -0.564540297598805, 0.46757007596850353, -0.2415142117828919, 0.9023126985733441, -0.22738047138175488, 0.08820396222730253, -0.614869109201164, -0.5014281746848694, -0.35654325656480124, -0.21252844439762253, -0.7852161205593478, -0.331164765544931, -0.40149785365750956, -0.5393387318666291, -0.5416204218841106, -0.4908121792794165, -0.3736209083007178, -0.5191322210061409, -0.6355792481480127, -0.5294507659123426, -0.6066954030095884, -0.5941003296110867, 0.004094961609356407, -0.4086126507012592, 0.16553592438099307, 0.08396695714847136, -0.4526799722186161, -0.16509542461032545, -0.30979246934367743, -0.2106085005341657, -0.2291349269178683, -0.44531676198099546, -0.5823124018254129, -0.5821844360014069, -0.19729783208526308, -0.03738628649518305, -0.2893511426764247, -0.3675176111971338, -0.5023048975228241], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1540787414037217, "mean_inference_ms": 1.0587013990914893, "mean_action_processing_ms": 0.044520562712445165, "mean_env_wait_ms": 0.9973376294165853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 179200, "timers": {"sample_time_ms": 3372.156, "sample_throughput": 3321.317, "learn_time_ms": 3586.772, "learn_throughput": 3122.585, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.005076669608096804, "total_loss": 0.008793955351310697, "policy_loss": -0.003939371556043625, "vf_loss": 0.005938342211514034, "vf_explained_var": 0.6880826354026794, "kl": 0.006794984084659849, "entropy": -3.357355163855986, "entropy_coeff": 0.0}}, "num_steps_sampled": 179200, "num_steps_trained": 179200}, "done": false, "episodes_total": 168, "training_iteration": 16, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_08-01-20", "timestamp": 1617634880, "time_this_iter_s": 5.852918386459351, "time_total_s": 105.05540680885315, "pid": 5471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.75727438926697, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.3125, "ram_util_percent": 60.3125}, "trial_id": "3e406_00001"}
{"episode_reward_max": 0.9023126985733441, "episode_reward_min": -0.7852161205593478, "episode_reward_mean": -0.3244618197636534, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.30664693859794045, -0.36624418566440164, -0.35902184254649117, 0.05019603348886936, -0.6140270821279125, -0.3550940517913802, -0.02906279159253422, -0.5543983910642898, -0.0312870071253859, -0.1903034431790046, -0.3252112774254673, -0.24428025826752608, -0.4370303774936358, -0.11719650749436206, -0.4182517359044161, -0.5010310523433887, -0.15264254822943946, -0.40280107103282403, -0.10843855340446595, -0.6433625431234699, -0.4402618645736789, -0.3136576354315326, -0.5444158283428322, -0.520279754361034, -0.4656916607823022, -0.4750999030368388, -0.4570672048015558, -0.6173896960517149, 0.2574028213911095, -0.2848400292671207, -0.3450962986276719, -0.15474053685248945, 0.10350336689344686, -0.45893964014928224, -0.4378126998879263, -0.33208966117193683, -0.6112526440745729, -0.43000384974449174, 0.06413426783091625, -0.5815466228870152, -0.7080970457300129, -0.564540297598805, 0.46757007596850353, -0.2415142117828919, 0.9023126985733441, -0.22738047138175488, 0.08820396222730253, -0.614869109201164, -0.5014281746848694, -0.35654325656480124, -0.21252844439762253, -0.7852161205593478, -0.331164765544931, -0.40149785365750956, -0.5393387318666291, -0.5416204218841106, -0.4908121792794165, -0.3736209083007178, -0.5191322210061409, -0.6355792481480127, -0.5294507659123426, -0.6066954030095884, -0.5941003296110867, 0.004094961609356407, -0.4086126507012592, 0.16553592438099307, 0.08396695714847136, -0.4526799722186161, -0.16509542461032545, -0.30979246934367743, -0.2106085005341657, -0.2291349269178683, -0.44531676198099546, -0.5823124018254129, -0.5821844360014069, -0.19729783208526308, -0.03738628649518305, -0.2893511426764247, -0.3675176111971338, -0.5023048975228241, -0.10112082569895375, -0.49280720553415647, -0.1386903487013409, -0.5668312243152647, -0.5879137433857651, 0.011702703453948526, -0.4023089686552236, -0.2803491331924107], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1546716612493403, "mean_inference_ms": 1.050785494798361, "mean_action_processing_ms": 0.04412557040419493, "mean_env_wait_ms": 0.9859275324683904, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 190400, "timers": {"sample_time_ms": 3414.588, "sample_throughput": 3280.045, "learn_time_ms": 3604.753, "learn_throughput": 3107.009, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.005076669608096804, "total_loss": 0.00647241159723225, "policy_loss": -0.004086736737835136, "vf_loss": 0.005104468563910235, "vf_explained_var": 0.8027794361114502, "kl": 0.0054546802659222685, "entropy": -3.3822371770035136, "entropy_coeff": 0.0}}, "num_steps_sampled": 190400, "num_steps_trained": 190400}, "done": false, "episodes_total": 184, "training_iteration": 17, "experiment_id": "0c7187432b2d45809356b0708678dd77", "date": "2021-04-05_08-01-27", "timestamp": 1617634887, "time_this_iter_s": 7.448218584060669, "time_total_s": 112.50362539291382, "pid": 5471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10005, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 23, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0050766696080968045, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9929673895970154, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23469167689024306, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 56.20549297332764, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 53.85454545454545, "ram_util_percent": 60.33636363636362}, "trial_id": "3e406_00001"}
{"episode_reward_max": 2.496889961804161, "episode_reward_min": 0.7792814992822035, "episode_reward_mean": 1.8168823405488408, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17124569261228884, "mean_inference_ms": 1.0079223435599132, "mean_action_processing_ms": 0.04307775349764677, "mean_env_wait_ms": 1.000306733719238, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 187200, "timers": {"sample_time_ms": 2649.993, "sample_throughput": 3018.876, "learn_time_ms": 376.794, "learn_throughput": 21231.768, "update_time_ms": 1.501}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001, "total_loss": 0.0011182718444615602, "policy_loss": -0.003528864122927189, "vf_loss": 0.0031225616112351418, "vf_explained_var": 0.9427306056022644, "kl": 0.0015245778486132622, "entropy": -3.46965754032135, "entropy_coeff": 0.0}}, "num_steps_sampled": 187200, "num_steps_trained": 187200}, "done": false, "episodes_total": 184, "training_iteration": 29, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-01-45", "timestamp": 1617634905, "time_this_iter_s": 3.0312583446502686, "time_total_s": 104.99435639381409, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3.0312583446502686, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 65.24, "ram_util_percent": 59.94}, "trial_id": "3e406_00001"}
{"episode_reward_max": 2.649509957640118, "episode_reward_min": 0.24637678564716192, "episode_reward_mean": 1.5960430691547278, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15980183950169297, "mean_inference_ms": 0.9567836900929054, "mean_action_processing_ms": 0.040856902972642314, "mean_env_wait_ms": 0.9306456201178699, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 195200, "timers": {"sample_time_ms": 2271.591, "sample_throughput": 3521.761, "learn_time_ms": 374.761, "learn_throughput": 21346.96, "update_time_ms": 1.481}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.001, "total_loss": -0.009947430342435837, "policy_loss": -0.013595635769888759, "vf_loss": 0.0028336389223113656, "vf_explained_var": 0.9475694298744202, "kl": 0.0016291263164021075, "entropy": -3.492488741874695, "entropy_coeff": 0.0}}, "num_steps_sampled": 195200, "num_steps_trained": 195200}, "done": false, "episodes_total": 192, "training_iteration": 30, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-01-47", "timestamp": 1617634907, "time_this_iter_s": 2.271721601486206, "time_total_s": 107.2660779953003, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.302979946136475, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.4, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 2.649509957640118, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 1.473161855564279, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15555106791830034, "mean_inference_ms": 0.9483724666164962, "mean_action_processing_ms": 0.040491881798435346, "mean_env_wait_ms": 0.9124818252203971, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 203200, "timers": {"sample_time_ms": 2296.598, "sample_throughput": 3483.413, "learn_time_ms": 358.85, "learn_throughput": 22293.437, "update_time_ms": 1.581}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.001, "total_loss": -0.005688643082976341, "policy_loss": -0.008557240711525083, "vf_loss": 0.002379246987402439, "vf_explained_var": 0.9551211595535278, "kl": 0.0019573894096538424, "entropy": -3.5114736557006836, "entropy_coeff": 0.0}}, "num_steps_sampled": 203200, "num_steps_trained": 203200}, "done": false, "episodes_total": 200, "training_iteration": 31, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-01-50", "timestamp": 1617634910, "time_this_iter_s": 2.679532766342163, "time_total_s": 109.94561076164246, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.982512712478638, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 61.3, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 5.161480447326071, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 1.7366247194157483, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15447793784970892, "mean_inference_ms": 0.9432435791739149, "mean_action_processing_ms": 0.040307544528556664, "mean_env_wait_ms": 0.9009226540168102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 211200, "timers": {"sample_time_ms": 2273.345, "sample_throughput": 3519.044, "learn_time_ms": 359.841, "learn_throughput": 22232.049, "update_time_ms": 1.624}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.001, "total_loss": -0.0007085994584485888, "policy_loss": -0.005194523371756077, "vf_loss": 0.004222539020702243, "vf_explained_var": 0.9258149862289429, "kl": 0.002107050735503435, "entropy": -3.5338947772979736, "entropy_coeff": 0.0}}, "num_steps_sampled": 211200, "num_steps_trained": 211200}, "done": false, "episodes_total": 208, "training_iteration": 32, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-01-53", "timestamp": 1617634913, "time_this_iter_s": 2.5725033283233643, "time_total_s": 112.51811408996582, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.555016040802002, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.975, "ram_util_percent": 60.150000000000006}, "trial_id": "3e406_00001"}
{"episode_reward_max": 5.161480447326071, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 1.849558156677159, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1529472918532963, "mean_inference_ms": 0.9403415246224146, "mean_action_processing_ms": 0.04008110014642438, "mean_env_wait_ms": 0.8904659605305826, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 219200, "timers": {"sample_time_ms": 2244.814, "sample_throughput": 3563.769, "learn_time_ms": 353.503, "learn_throughput": 22630.634, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.001, "total_loss": 0.0045509301126003265, "policy_loss": 0.0005072369240224361, "vf_loss": 0.0039332956075668335, "vf_explained_var": 0.9323478937149048, "kl": 0.0017663237522356212, "entropy": -3.554730534553528, "entropy_coeff": 0.0}}, "num_steps_sampled": 219200, "num_steps_trained": 219200}, "done": false, "episodes_total": 216, "training_iteration": 33, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-01-55", "timestamp": 1617634915, "time_this_iter_s": 2.464946746826172, "time_total_s": 114.98306083679199, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.019962787628174, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.1, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 7.633937302145915, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 2.053269056552941, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15177979163958186, "mean_inference_ms": 0.9431041193770389, "mean_action_processing_ms": 0.04007573646121118, "mean_env_wait_ms": 0.8866133583750035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 227200, "timers": {"sample_time_ms": 2301.921, "sample_throughput": 3475.358, "learn_time_ms": 347.799, "learn_throughput": 23001.761, "update_time_ms": 1.582}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 0.001, "total_loss": 0.016335838474333286, "policy_loss": 0.010666332207620144, "vf_loss": 0.005603000987321138, "vf_explained_var": 0.9109378457069397, "kl": 0.0021282335510477424, "entropy": -3.5702834129333496, "entropy_coeff": 0.0}}, "num_steps_sampled": 227200, "num_steps_trained": 227200}, "done": false, "episodes_total": 224, "training_iteration": 34, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-01-58", "timestamp": 1617634918, "time_this_iter_s": 2.913419485092163, "time_total_s": 117.89648032188416, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.933382272720337, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 62.3, "ram_util_percent": 60.125}, "trial_id": "3e406_00001"}
{"episode_reward_max": 7.633937302145915, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 2.111035896190438, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15068301134270762, "mean_inference_ms": 0.9434170509860488, "mean_action_processing_ms": 0.04001113198312724, "mean_env_wait_ms": 0.8824436893339602, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 235200, "timers": {"sample_time_ms": 2281.911, "sample_throughput": 3505.833, "learn_time_ms": 350.651, "learn_throughput": 22814.695, "update_time_ms": 1.624}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 0.001, "total_loss": -0.003625842451583594, "policy_loss": -0.007759858621284366, "vf_loss": 0.004096559481695294, "vf_explained_var": 0.9381504058837891, "kl": 0.0023973770439624786, "entropy": -3.6036784648895264, "entropy_coeff": 0.0}}, "num_steps_sampled": 235200, "num_steps_trained": 235200}, "done": false, "episodes_total": 232, "training_iteration": 35, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-01", "timestamp": 1617634921, "time_this_iter_s": 2.536573886871338, "time_total_s": 120.4330542087555, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18.469956159591675, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 44.775000000000006, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 7.633937302145915, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 2.309400643631963, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14972888588294175, "mean_inference_ms": 0.9439682225603746, "mean_action_processing_ms": 0.03998838633657398, "mean_env_wait_ms": 0.8797879326098073, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 243200, "timers": {"sample_time_ms": 2279.688, "sample_throughput": 3509.252, "learn_time_ms": 346.474, "learn_throughput": 23089.722, "update_time_ms": 1.603}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 0.001, "total_loss": 0.0010447695385664701, "policy_loss": -0.00468394614290446, "vf_loss": 0.005709928227588534, "vf_explained_var": 0.9237630367279053, "kl": 0.0024050886277109385, "entropy": -3.628554344177246, "entropy_coeff": 0.0}}, "num_steps_sampled": 243200, "num_steps_trained": 243200}, "done": false, "episodes_total": 240, "training_iteration": 36, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-03", "timestamp": 1617634923, "time_this_iter_s": 2.5881073474884033, "time_total_s": 123.0211615562439, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21.058063507080078, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 54.10000000000001, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 7.633937302145915, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 2.430153804014215, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14923737637364454, "mean_inference_ms": 0.9450841708425762, "mean_action_processing_ms": 0.040007651545079174, "mean_env_wait_ms": 0.8785492509771521, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 251200, "timers": {"sample_time_ms": 2309.843, "sample_throughput": 3463.438, "learn_time_ms": 345.487, "learn_throughput": 23155.742, "update_time_ms": 1.607}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 0.001, "total_loss": -0.014282542280852795, "policy_loss": -0.019598425831645727, "vf_loss": 0.005308657418936491, "vf_explained_var": 0.9335752129554749, "kl": 0.0018496711854822934, "entropy": -3.65412974357605, "entropy_coeff": 0.0}}, "num_steps_sampled": 251200, "num_steps_trained": 251200}, "done": false, "episodes_total": 248, "training_iteration": 37, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-06", "timestamp": 1617634926, "time_this_iter_s": 2.89495587348938, "time_total_s": 125.91611742973328, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.953019380569458, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 62.35, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 8.418455287688063, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 2.536945997601464, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14861670388359988, "mean_inference_ms": 0.9445282366309303, "mean_action_processing_ms": 0.03996720946684517, "mean_env_wait_ms": 0.8761584362548411, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 259200, "timers": {"sample_time_ms": 2269.193, "sample_throughput": 3525.482, "learn_time_ms": 351.513, "learn_throughput": 22758.778, "update_time_ms": 1.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 0.001, "total_loss": 0.004149337764829397, "policy_loss": -0.001889868639409542, "vf_loss": 0.006035041995346546, "vf_explained_var": 0.9284892082214355, "kl": 0.002131453948095441, "entropy": -3.670771837234497, "entropy_coeff": 0.0}}, "num_steps_sampled": 259200, "num_steps_trained": 259200}, "done": false, "episodes_total": 256, "training_iteration": 38, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-08", "timestamp": 1617634928, "time_this_iter_s": 2.317002773284912, "time_total_s": 128.2331202030182, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.27002215385437, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.699999999999996, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 8.418455287688063, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 2.589855025587083, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.474529894338775, 2.9773766334412097, 4.935615799521706, 5.38854390206298, 1.6004114781158347, 2.338771407459396, 1.6550665115016807, 2.581246817104605, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1480801501033101, "mean_inference_ms": 0.9446942819289852, "mean_action_processing_ms": 0.0399640691264195, "mean_env_wait_ms": 0.8749315796784859, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 267200, "timers": {"sample_time_ms": 2238.34, "sample_throughput": 3574.078, "learn_time_ms": 344.988, "learn_throughput": 23189.229, "update_time_ms": 1.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 0.001, "total_loss": 0.008272414095699787, "policy_loss": 0.0027091954834759235, "vf_loss": 0.005561204859986901, "vf_explained_var": 0.9398106336593628, "kl": 0.0020639189751818776, "entropy": -3.69093120098114, "entropy_coeff": 0.0}}, "num_steps_sampled": 267200, "num_steps_trained": 267200}, "done": false, "episodes_total": 264, "training_iteration": 39, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-11", "timestamp": 1617634931, "time_this_iter_s": 2.658651351928711, "time_total_s": 130.8917715549469, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.92867350578308, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 62.3, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 8.418455287688063, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 2.7245856480429396, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.97774822278818, 4.322797610119617, 4.8519085049655475, 3.6516972588343464, 2.547573304926087, 4.59573475931878, 5.703467420189349, 3.0020528793169827, 2.097244929887065, 2.366456928788914, 0.7792814992822035, 1.5788127087122743, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747, 3.474529894338775, 2.9773766334412097, 4.935615799521706, 5.38854390206298, 1.6004114781158347, 2.338771407459396, 1.6550665115016807, 2.581246817104605], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14786525214986487, "mean_inference_ms": 0.9448232245484771, "mean_action_processing_ms": 0.039964620288724446, "mean_env_wait_ms": 0.8739310678433408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 275200, "timers": {"sample_time_ms": 2274.634, "sample_throughput": 3517.05, "learn_time_ms": 343.945, "learn_throughput": 23259.555, "update_time_ms": 1.655}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00048828125, "cur_lr": 0.001, "total_loss": -0.019041604828089476, "policy_loss": -0.024961818475276232, "vf_loss": 0.005919042509049177, "vf_explained_var": 0.9395827054977417, "kl": 0.002404005383141339, "entropy": -3.702020764350891, "entropy_coeff": 0.0}}, "num_steps_sampled": 275200, "num_steps_trained": 275200}, "done": false, "episodes_total": 272, "training_iteration": 40, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-14", "timestamp": 1617634934, "time_this_iter_s": 2.626032829284668, "time_total_s": 133.51780438423157, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.55470633506775, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 55.55, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 8.418455287688063, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 2.892243115541961, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.764354389386358, 4.692678453926447, 3.3940170702191264, 3.082279172986337, 5.255620920151084, 3.1728004963760768, 3.153097969275513, 4.971036936423495, 1.873451786483122, 1.0306926806382934, 2.3122282287946936, 2.496889961804161, 1.2804600101691554, 0.5186224670901323, 1.5150045567006494, 1.9065711302579955, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747, 3.474529894338775, 2.9773766334412097, 4.935615799521706, 5.38854390206298, 1.6004114781158347, 2.338771407459396, 1.6550665115016807, 2.581246817104605, 4.97774822278818, 4.322797610119617, 4.8519085049655475, 3.6516972588343464, 2.547573304926087, 4.59573475931878, 5.703467420189349, 3.0020528793169827], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14632724086165738, "mean_inference_ms": 0.9422473305730594, "mean_action_processing_ms": 0.03984112689854363, "mean_env_wait_ms": 0.867972770956118, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 283200, "timers": {"sample_time_ms": 2233.032, "sample_throughput": 3582.572, "learn_time_ms": 342.426, "learn_throughput": 23362.701, "update_time_ms": 1.634}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000244140625, "cur_lr": 0.001, "total_loss": 0.0014425071622099495, "policy_loss": -0.005288912798278034, "vf_loss": 0.006730856606736779, "vf_explained_var": 0.9385645389556885, "kl": 0.002308347960934043, "entropy": -3.729645609855652, "entropy_coeff": 0.0}}, "num_steps_sampled": 283200, "num_steps_trained": 283200}, "done": false, "episodes_total": 280, "training_iteration": 41, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-16", "timestamp": 1617634936, "time_this_iter_s": 2.2487292289733887, "time_total_s": 135.76653361320496, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.80343556404114, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 50.4, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 8.418455287688063, "episode_reward_min": 0.19026464345809013, "episode_reward_mean": 3.0328465332404324, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.272679226522409, 2.9853209755249575, 3.7032529717551936, 2.40531670586814, 2.589405464991599, 2.9928953032823196, 2.011171653564925, 7.034220290275696, 2.649509957640118, 1.7416761754554364, 0.24637678564716192, 1.1434092991242695, 1.6322867316107899, 1.6525958917453192, 1.7551359931748394, 0.19026464345809013, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747, 3.474529894338775, 2.9773766334412097, 4.935615799521706, 5.38854390206298, 1.6004114781158347, 2.338771407459396, 1.6550665115016807, 2.581246817104605, 4.97774822278818, 4.322797610119617, 4.8519085049655475, 3.6516972588343464, 2.547573304926087, 4.59573475931878, 5.703467420189349, 3.0020528793169827, 6.764354389386358, 4.692678453926447, 3.3940170702191264, 3.082279172986337, 5.255620920151084, 3.1728004963760768, 3.153097969275513, 4.971036936423495], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14529806279211713, "mean_inference_ms": 0.9415908722339004, "mean_action_processing_ms": 0.03978743191645878, "mean_env_wait_ms": 0.8627571971118679, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 291200, "timers": {"sample_time_ms": 2264.761, "sample_throughput": 3532.382, "learn_time_ms": 338.483, "learn_throughput": 23634.847, "update_time_ms": 1.617}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001220703125, "cur_lr": 0.001, "total_loss": -0.008979571983218193, "policy_loss": -0.01404038560576737, "vf_loss": 0.005060530733317137, "vf_explained_var": 0.9570282697677612, "kl": 0.002308891504071653, "entropy": -3.7597910165786743, "entropy_coeff": 0.0}}, "num_steps_sampled": 291200, "num_steps_trained": 291200}, "done": false, "episodes_total": 288, "training_iteration": 42, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-19", "timestamp": 1617634939, "time_this_iter_s": 2.850983142852783, "time_total_s": 138.61751675605774, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 36.65441870689392, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 64.85000000000001, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 9.448918781900744, "episode_reward_min": 0.3959400132774362, "episode_reward_mean": 3.4067433580557265, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.990689067738158, 5.68774545028836, 7.78536031777956, 2.074805393982296, 3.501153162569822, 9.448918781900744, 8.06559878028445, 3.8466670048420433, 1.3622841535259358, 0.7255631847184254, 0.3959400132774362, 2.1051248155562168, 2.6975310155144006, 3.183503384474725, 1.6301189093537967, 5.161480447326071, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747, 3.474529894338775, 2.9773766334412097, 4.935615799521706, 5.38854390206298, 1.6004114781158347, 2.338771407459396, 1.6550665115016807, 2.581246817104605, 4.97774822278818, 4.322797610119617, 4.8519085049655475, 3.6516972588343464, 2.547573304926087, 4.59573475931878, 5.703467420189349, 3.0020528793169827, 6.764354389386358, 4.692678453926447, 3.3940170702191264, 3.082279172986337, 5.255620920151084, 3.1728004963760768, 3.153097969275513, 4.971036936423495, 3.272679226522409, 2.9853209755249575, 3.7032529717551936, 2.40531670586814, 2.589405464991599, 2.9928953032823196, 2.011171653564925, 7.034220290275696], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14513033039840204, "mean_inference_ms": 0.9426698857012518, "mean_action_processing_ms": 0.03981050389607233, "mean_env_wait_ms": 0.8611760121488081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 299200, "timers": {"sample_time_ms": 2250.36, "sample_throughput": 3554.986, "learn_time_ms": 344.217, "learn_throughput": 23241.165, "update_time_ms": 1.633}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-05, "cur_lr": 0.001, "total_loss": -0.0010050088167190552, "policy_loss": -0.012659216881729662, "vf_loss": 0.011654068250209093, "vf_explained_var": 0.9204823970794678, "kl": 0.0023053245386108756, "entropy": -3.781472325325012, "entropy_coeff": 0.0}}, "num_steps_sampled": 299200, "num_steps_trained": 299200}, "done": false, "episodes_total": 296, "training_iteration": 43, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-21", "timestamp": 1617634941, "time_this_iter_s": 2.3783743381500244, "time_total_s": 140.99589109420776, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.032793045043945, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 43.03333333333333, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 9.448918781900744, "episode_reward_min": 0.6335782139610016, "episode_reward_mean": 3.6930084833975005, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.970803647645926, 5.780255810034647, 5.620050678857452, 8.796947215721437, 9.292812424667765, 2.7856451357358494, 4.195858567723524, 6.445684977537857, 0.7740093753947563, 2.77387168569331, 1.3883994547901874, 2.6071922152139986, 2.8982141957348824, 1.3491030599692868, 2.0642362587270915, 3.52089779905274, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747, 3.474529894338775, 2.9773766334412097, 4.935615799521706, 5.38854390206298, 1.6004114781158347, 2.338771407459396, 1.6550665115016807, 2.581246817104605, 4.97774822278818, 4.322797610119617, 4.8519085049655475, 3.6516972588343464, 2.547573304926087, 4.59573475931878, 5.703467420189349, 3.0020528793169827, 6.764354389386358, 4.692678453926447, 3.3940170702191264, 3.082279172986337, 5.255620920151084, 3.1728004963760768, 3.153097969275513, 4.971036936423495, 3.272679226522409, 2.9853209755249575, 3.7032529717551936, 2.40531670586814, 2.589405464991599, 2.9928953032823196, 2.011171653564925, 7.034220290275696, 7.990689067738158, 5.68774545028836, 7.78536031777956, 2.074805393982296, 3.501153162569822, 9.448918781900744, 8.06559878028445, 3.8466670048420433], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14467086203229454, "mean_inference_ms": 0.9435308956654356, "mean_action_processing_ms": 0.039811934986704614, "mean_env_wait_ms": 0.8601136982868806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 307200, "timers": {"sample_time_ms": 2208.989, "sample_throughput": 3621.567, "learn_time_ms": 343.474, "learn_throughput": 23291.441, "update_time_ms": 1.654}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-05, "cur_lr": 0.001, "total_loss": -0.010930465534329414, "policy_loss": -0.019564654678106308, "vf_loss": 0.008634139783680439, "vf_explained_var": 0.9448235034942627, "kl": 0.0018256061594001949, "entropy": -3.8025141954421997, "entropy_coeff": 0.0}}, "num_steps_sampled": 307200, "num_steps_trained": 307200}, "done": false, "episodes_total": 304, "training_iteration": 44, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-24", "timestamp": 1617634944, "time_this_iter_s": 2.4923465251922607, "time_total_s": 143.48823761940002, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.525139570236206, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
{"episode_reward_max": 9.85102587802686, "episode_reward_min": 0.6335782139610016, "episode_reward_mean": 4.059329323748447, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.968710263207746, 9.85102587802686, 6.388694463263431, 9.126633726967887, 7.577100231640035, 7.128775811434053, 5.825578894092962, 3.141488811037867, 2.443384254627642, 1.4536784943628023, 3.1998624555976702, 1.4809587277103002, 1.8777353965558388, 0.6335782139610016, 1.253592594746872, 7.633937302145915, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747, 3.474529894338775, 2.9773766334412097, 4.935615799521706, 5.38854390206298, 1.6004114781158347, 2.338771407459396, 1.6550665115016807, 2.581246817104605, 4.97774822278818, 4.322797610119617, 4.8519085049655475, 3.6516972588343464, 2.547573304926087, 4.59573475931878, 5.703467420189349, 3.0020528793169827, 6.764354389386358, 4.692678453926447, 3.3940170702191264, 3.082279172986337, 5.255620920151084, 3.1728004963760768, 3.153097969275513, 4.971036936423495, 3.272679226522409, 2.9853209755249575, 3.7032529717551936, 2.40531670586814, 2.589405464991599, 2.9928953032823196, 2.011171653564925, 7.034220290275696, 7.990689067738158, 5.68774545028836, 7.78536031777956, 2.074805393982296, 3.501153162569822, 9.448918781900744, 8.06559878028445, 3.8466670048420433, 2.970803647645926, 5.780255810034647, 5.620050678857452, 8.796947215721437, 9.292812424667765, 2.7856451357358494, 4.195858567723524, 6.445684977537857], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14437672233098678, "mean_inference_ms": 0.9445290161805662, "mean_action_processing_ms": 0.039849361846165034, "mean_env_wait_ms": 0.8602116852986785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 315200, "timers": {"sample_time_ms": 2210.905, "sample_throughput": 3618.428, "learn_time_ms": 350.0, "learn_throughput": 22857.126, "update_time_ms": 1.636}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-05, "cur_lr": 0.001, "total_loss": -0.010277780704200268, "policy_loss": -0.021193719876464456, "vf_loss": 0.010915907565504313, "vf_explained_var": 0.9404505491256714, "kl": 0.0025093695148825645, "entropy": -3.837270140647888, "entropy_coeff": 0.0}}, "num_steps_sampled": 315200, "num_steps_trained": 315200}, "done": false, "episodes_total": 312, "training_iteration": 45, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-26", "timestamp": 1617634946, "time_this_iter_s": 2.6206142902374268, "time_total_s": 146.10885190963745, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.14575386047363, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 52.625, "ram_util_percent": 59.150000000000006}, "trial_id": "3e406_00001"}
{"episode_reward_max": 9.85102587802686, "episode_reward_min": 0.9414417160671782, "episode_reward_mean": 4.393703667956006, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.743245945587855, 8.113479512522218, 7.185860299806423, 3.7765782535093084, 6.4865059195298, 5.505964047559108, 6.877865572892601, 6.724662309056679, 2.920125730879805, 4.137454421319973, 4.926369941836363, 1.1917948460090204, 2.2032995630952286, 1.4482876900941029, 3.5028403721352808, 5.257401147900477, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747, 3.474529894338775, 2.9773766334412097, 4.935615799521706, 5.38854390206298, 1.6004114781158347, 2.338771407459396, 1.6550665115016807, 2.581246817104605, 4.97774822278818, 4.322797610119617, 4.8519085049655475, 3.6516972588343464, 2.547573304926087, 4.59573475931878, 5.703467420189349, 3.0020528793169827, 6.764354389386358, 4.692678453926447, 3.3940170702191264, 3.082279172986337, 5.255620920151084, 3.1728004963760768, 3.153097969275513, 4.971036936423495, 3.272679226522409, 2.9853209755249575, 3.7032529717551936, 2.40531670586814, 2.589405464991599, 2.9928953032823196, 2.011171653564925, 7.034220290275696, 7.990689067738158, 5.68774545028836, 7.78536031777956, 2.074805393982296, 3.501153162569822, 9.448918781900744, 8.06559878028445, 3.8466670048420433, 2.970803647645926, 5.780255810034647, 5.620050678857452, 8.796947215721437, 9.292812424667765, 2.7856451357358494, 4.195858567723524, 6.445684977537857, 4.968710263207746, 9.85102587802686, 6.388694463263431, 9.126633726967887, 7.577100231640035, 7.128775811434053, 5.825578894092962, 3.141488811037867], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1443840935061729, "mean_inference_ms": 0.9440891884080699, "mean_action_processing_ms": 0.039865546136032756, "mean_env_wait_ms": 0.8600586005731975, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 323200, "timers": {"sample_time_ms": 2191.637, "sample_throughput": 3650.24, "learn_time_ms": 355.99, "learn_throughput": 22472.556, "update_time_ms": 1.672}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-06, "cur_lr": 0.001, "total_loss": 0.005871904315426946, "policy_loss": -0.005624226992949843, "vf_loss": 0.01149612246081233, "vf_explained_var": 0.9446752071380615, "kl": 0.0024821620900183916, "entropy": -3.8770116567611694, "entropy_coeff": 0.0}}, "num_steps_sampled": 323200, "num_steps_trained": 323200}, "done": false, "episodes_total": 320, "training_iteration": 46, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-29", "timestamp": 1617634949, "time_this_iter_s": 2.4588897228240967, "time_total_s": 148.56774163246155, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.60464358329773, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 52.800000000000004, "ram_util_percent": 52.36666666666667}, "trial_id": "3e406_00001"}
{"episode_reward_max": 9.85102587802686, "episode_reward_min": 0.9414417160671782, "episode_reward_mean": 4.6519598242605715, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.3266153091722765, 5.29691360038242, 6.070664745126734, 7.415934664404585, 5.292480428371837, 5.32304527439102, 6.282899417262852, 9.404635904615008, 0.9414417160671782, 2.5462723084271937, 2.6200427601418346, 1.1415099142620821, 1.1248340365752787, 5.633059229482739, 6.057573506410834, 3.357295119502724, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747, 3.474529894338775, 2.9773766334412097, 4.935615799521706, 5.38854390206298, 1.6004114781158347, 2.338771407459396, 1.6550665115016807, 2.581246817104605, 4.97774822278818, 4.322797610119617, 4.8519085049655475, 3.6516972588343464, 2.547573304926087, 4.59573475931878, 5.703467420189349, 3.0020528793169827, 6.764354389386358, 4.692678453926447, 3.3940170702191264, 3.082279172986337, 5.255620920151084, 3.1728004963760768, 3.153097969275513, 4.971036936423495, 3.272679226522409, 2.9853209755249575, 3.7032529717551936, 2.40531670586814, 2.589405464991599, 2.9928953032823196, 2.011171653564925, 7.034220290275696, 7.990689067738158, 5.68774545028836, 7.78536031777956, 2.074805393982296, 3.501153162569822, 9.448918781900744, 8.06559878028445, 3.8466670048420433, 2.970803647645926, 5.780255810034647, 5.620050678857452, 8.796947215721437, 9.292812424667765, 2.7856451357358494, 4.195858567723524, 6.445684977537857, 4.968710263207746, 9.85102587802686, 6.388694463263431, 9.126633726967887, 7.577100231640035, 7.128775811434053, 5.825578894092962, 3.141488811037867, 8.743245945587855, 8.113479512522218, 7.185860299806423, 3.7765782535093084, 6.4865059195298, 5.505964047559108, 6.877865572892601, 6.724662309056679], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14469988546410273, "mean_inference_ms": 0.944151615424088, "mean_action_processing_ms": 0.039917680799646076, "mean_env_wait_ms": 0.8607523184843201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 331200, "timers": {"sample_time_ms": 2221.804, "sample_throughput": 3600.678, "learn_time_ms": 359.483, "learn_throughput": 22254.18, "update_time_ms": 1.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-06, "cur_lr": 0.001, "total_loss": 0.0052583025535568595, "policy_loss": -0.004970113397575915, "vf_loss": 0.010228411760181189, "vf_explained_var": 0.9560238718986511, "kl": 0.002241849317215383, "entropy": -3.9069108963012695, "entropy_coeff": 0.0}}, "num_steps_sampled": 331200, "num_steps_trained": 331200}, "done": false, "episodes_total": 328, "training_iteration": 47, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-32", "timestamp": 1617634952, "time_this_iter_s": 3.2326362133026123, "time_total_s": 151.80037784576416, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.83727979660034, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 75.88, "ram_util_percent": 57.86}, "trial_id": "3e406_00001"}
{"episode_reward_max": 11.108427769056329, "episode_reward_min": 1.247850954780756, "episode_reward_mean": 4.9856675965595665, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.401576961810399, 5.475859344684674, 9.968619568185405, 11.108427769056329, 8.32086000726576, 5.546341640715434, 5.219769879056177, 5.751350649995192, 2.164686091087657, 2.0135377123833917, 3.750773235359321, 5.481872074979157, 5.226913593017478, 1.247850954780756, 2.2614483341607317, 4.585752406923077, 3.1156965613473604, 2.304101945614946, 3.3303438197082746, 5.097325081025224, 2.5432802499318234, 8.418455287688063, 3.556783440005228, 1.6647359586304566, 3.174398811082848, 2.631776016189157, 2.2502749849913273, 3.744901170574747, 3.474529894338775, 2.9773766334412097, 4.935615799521706, 5.38854390206298, 1.6004114781158347, 2.338771407459396, 1.6550665115016807, 2.581246817104605, 4.97774822278818, 4.322797610119617, 4.8519085049655475, 3.6516972588343464, 2.547573304926087, 4.59573475931878, 5.703467420189349, 3.0020528793169827, 6.764354389386358, 4.692678453926447, 3.3940170702191264, 3.082279172986337, 5.255620920151084, 3.1728004963760768, 3.153097969275513, 4.971036936423495, 3.272679226522409, 2.9853209755249575, 3.7032529717551936, 2.40531670586814, 2.589405464991599, 2.9928953032823196, 2.011171653564925, 7.034220290275696, 7.990689067738158, 5.68774545028836, 7.78536031777956, 2.074805393982296, 3.501153162569822, 9.448918781900744, 8.06559878028445, 3.8466670048420433, 2.970803647645926, 5.780255810034647, 5.620050678857452, 8.796947215721437, 9.292812424667765, 2.7856451357358494, 4.195858567723524, 6.445684977537857, 4.968710263207746, 9.85102587802686, 6.388694463263431, 9.126633726967887, 7.577100231640035, 7.128775811434053, 5.825578894092962, 3.141488811037867, 8.743245945587855, 8.113479512522218, 7.185860299806423, 3.7765782535093084, 6.4865059195298, 5.505964047559108, 6.877865572892601, 6.724662309056679, 6.3266153091722765, 5.29691360038242, 6.070664745126734, 7.415934664404585, 5.292480428371837, 5.32304527439102, 6.282899417262852, 9.404635904615008], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14510911676047758, "mean_inference_ms": 0.9452846141800351, "mean_action_processing_ms": 0.04000787973187152, "mean_env_wait_ms": 0.8624392770666861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 339200, "timers": {"sample_time_ms": 2293.459, "sample_throughput": 3488.181, "learn_time_ms": 350.713, "learn_throughput": 22810.644, "update_time_ms": 1.643}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-06, "cur_lr": 0.001, "total_loss": 0.015937269083224237, "policy_loss": 0.0028454614803195, "vf_loss": 0.013091804925352335, "vf_explained_var": 0.9513209462165833, "kl": 0.0021712076850235462, "entropy": -3.9513230323791504, "entropy_coeff": 0.0}}, "num_steps_sampled": 339200, "num_steps_trained": 339200}, "done": false, "episodes_total": 336, "training_iteration": 48, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-02-35", "timestamp": 1617634955, "time_this_iter_s": 2.943427562713623, "time_total_s": 154.74380540847778, "pid": 6497, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.780707359313965, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 71.475, "ram_util_percent": 60.0}, "trial_id": "3e406_00001"}
{"episode_reward_max": 9.827889524017465, "episode_reward_min": 3.7508161412306267, "episode_reward_mean": 6.629385866843669, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.622631696342438, 8.185047530118133, 4.174477185705069, 6.656996166359431, 4.353905168999692, 7.463323521976497, 3.7508161412306267, 9.827889524017465], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13083895365079562, "mean_inference_ms": 0.8050033322104684, "mean_action_processing_ms": 0.03421866334044374, "mean_env_wait_ms": 0.8049311635496614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 347200, "timers": {"sample_time_ms": 7010.549, "sample_throughput": 1141.137, "learn_time_ms": 369.381, "learn_throughput": 21657.858, "update_time_ms": 1.369}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001, "total_loss": 0.011451635975390673, "policy_loss": -0.0007074656896293163, "vf_loss": 0.010890023317188025, "vf_explained_var": 0.9615447521209717, "kl": 0.0012690750882029533, "entropy": -3.970370650291443, "entropy_coeff": 0.0}}, "num_steps_sampled": 347200, "num_steps_trained": 347200}, "done": false, "episodes_total": 344, "training_iteration": 49, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-03-46", "timestamp": 1617635026, "time_this_iter_s": 7.384692668914795, "time_total_s": 162.12849807739258, "pid": 7462, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.384692668914795, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 60.49999999999999, "ram_util_percent": 60.08181818181819}, "trial_id": "3e406_00001"}
{"episode_reward_max": 11.61295986791197, "episode_reward_min": 3.7508161412306267, "episode_reward_mean": 7.27692386404187, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.37049321543923, 6.341915676518769, 6.204962081532552, 10.258378388888758, 9.642325986880284, 6.512254880465081, 11.61295986791197, 7.452404792283927, 8.622631696342438, 8.185047530118133, 4.174477185705069, 6.656996166359431, 4.353905168999692, 7.463323521976497, 3.7508161412306267, 9.827889524017465], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1328739877853643, "mean_inference_ms": 0.8528722173332213, "mean_action_processing_ms": 0.03626530683520057, "mean_env_wait_ms": 0.8325364173859253, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 355200, "timers": {"sample_time_ms": 4672.504, "sample_throughput": 1712.144, "learn_time_ms": 343.291, "learn_throughput": 23303.849, "update_time_ms": 1.585}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.001, "total_loss": 0.0074389062356203794, "policy_loss": -0.0077702978160232306, "vf_loss": 0.014537078328430653, "vf_explained_var": 0.9565200805664062, "kl": 0.0013442520867101848, "entropy": -4.002634525299072, "entropy_coeff": 0.0}}, "num_steps_sampled": 355200, "num_steps_trained": 355200}, "done": true, "episodes_total": 352, "training_iteration": 50, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-03-49", "timestamp": 1617635029, "time_this_iter_s": 2.657966375350952, "time_total_s": 164.78646445274353, "pid": 7462, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7771752205154938, "kl_coeff": 1.0, "sgd_minibatch_size": 6495, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.09295384811114514, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.042659044265747, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 61.275000000000006, "ram_util_percent": 60.1}, "trial_id": "3e406_00001"}
