{"episode_reward_max": 0.6158914730239617, "episode_reward_min": -0.3098437017870368, "episode_reward_mean": -0.11376358400080659, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2730057906698946, -0.3098437017870368, 0.05246686606202822, -0.28847109826207595, -0.20149102729828705, 0.6158914730239617, -0.2800418599765745, -0.2256135330985738], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1963422657746657, "mean_inference_ms": 0.934842102335057, "mean_action_processing_ms": 0.03943427913294148, "mean_env_wait_ms": 0.9506668377478454, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 9600, "timers": {"sample_time_ms": 2975.461, "sample_throughput": 3226.391, "learn_time_ms": 2480.094, "learn_throughput": 3870.821, "update_time_ms": 1.389}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.04351681102067232, "policy_loss": -0.056126533299684526, "vf_loss": 0.0018257715133950115, "vf_explained_var": 0.6402890682220459, "kl": 0.010783949680626393, "entropy": -3.316581608454386, "entropy_coeff": 0.0}}, "num_steps_sampled": 9600, "num_steps_trained": 9600}, "done": false, "episodes_total": 8, "training_iteration": 1, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-19-19", "timestamp": 1617635959, "time_this_iter_s": 5.4609215259552, "time_total_s": 5.4609215259552, "pid": 9872, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.4609215259552, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.525, "ram_util_percent": 60.087500000000006}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 0.6158914730239617, "episode_reward_min": -0.5792657433481356, "episode_reward_mean": -0.2338684628683544, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.09764532624006972, -0.5792657433481356, -0.3131686301137374, -0.3337962513790893, -0.3237455511238717, -0.3471530745022008, -0.3757209631685672, -0.461291194011546, -0.2730057906698946, -0.3098437017870368, 0.05246686606202822, -0.28847109826207595, -0.20149102729828705, 0.6158914730239617, -0.2800418599765745, -0.2256135330985738], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19603191172015572, "mean_inference_ms": 0.9454702987431987, "mean_action_processing_ms": 0.03977561064757965, "mean_env_wait_ms": 0.9414140612261719, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 19200, "timers": {"sample_time_ms": 2924.824, "sample_throughput": 3282.249, "learn_time_ms": 2458.839, "learn_throughput": 3904.282, "update_time_ms": 1.443}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.043436654408772785, "policy_loss": -0.05625718542685111, "vf_loss": 0.0013585968175902964, "vf_explained_var": 0.8056011199951172, "kl": 0.011461935838063557, "entropy": -3.345329465866089, "entropy_coeff": 0.0}}, "num_steps_sampled": 19200, "num_steps_trained": 19200}, "done": false, "episodes_total": 16, "training_iteration": 2, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-19-24", "timestamp": 1617635964, "time_this_iter_s": 5.31773567199707, "time_total_s": 10.77865719795227, "pid": 9872, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.77865719795227, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.925, "ram_util_percent": 60.3375}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 0.9436793790748828, "episode_reward_min": -0.5792657433481356, "episode_reward_mean": -0.08676338816603901, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.40187144950890885, -0.5389089928374595, 0.09694741505741189, 0.22456183419817166, 0.4068231516196743, 0.18826926906883856, -0.06366941578169438, 0.9436793790748828, -0.2730057906698946, -0.3098437017870368, 0.05246686606202822, -0.28847109826207595, -0.20149102729828705, 0.6158914730239617, -0.2800418599765745, -0.2256135330985738, -0.09764532624006972, -0.5792657433481356, -0.3131686301137374, -0.3337962513790893, -0.3237455511238717, -0.3471530745022008, -0.3757209631685672, -0.461291194011546], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1942781989411444, "mean_inference_ms": 0.9564272563146154, "mean_action_processing_ms": 0.04019318653777567, "mean_env_wait_ms": 0.9414184713557198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 28800, "timers": {"sample_time_ms": 2933.761, "sample_throughput": 3272.25, "learn_time_ms": 2464.55, "learn_throughput": 3895.235, "update_time_ms": 1.55}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.04482664001484712, "policy_loss": -0.05781690690666437, "vf_loss": 0.0020230026093001167, "vf_explained_var": 0.8094908595085144, "kl": 0.010967262759804726, "entropy": -3.32692995707194, "entropy_coeff": 0.0}}, "num_steps_sampled": 28800, "num_steps_trained": 28800}, "done": false, "episodes_total": 24, "training_iteration": 3, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-19-30", "timestamp": 1617635970, "time_this_iter_s": 5.435742139816284, "time_total_s": 16.214399337768555, "pid": 9872, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.214399337768555, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.537499999999994, "ram_util_percent": 60.4}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 0.9436793790748828, "episode_reward_min": -0.5792657433481356, "episode_reward_mean": -0.08414656669607877, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2711022328702336, 0.5507635302784748, -0.5643102888616142, 0.43979167470866765, -0.30022385740072843, -0.4440896304508291, 0.13706120019105783, -0.15825921388437936, -0.2730057906698946, -0.3098437017870368, 0.05246686606202822, -0.28847109826207595, -0.20149102729828705, 0.6158914730239617, -0.2800418599765745, -0.2256135330985738, -0.09764532624006972, -0.5792657433481356, -0.3131686301137374, -0.3337962513790893, -0.3237455511238717, -0.3471530745022008, -0.3757209631685672, -0.461291194011546, 0.40187144950890885, -0.5389089928374595, 0.09694741505741189, 0.22456183419817166, 0.4068231516196743, 0.18826926906883856, -0.06366941578169438, 0.9436793790748828], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1930148575621328, "mean_inference_ms": 0.9656097727416855, "mean_action_processing_ms": 0.04055444817708896, "mean_env_wait_ms": 0.9436613013528983, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 38400, "timers": {"sample_time_ms": 2943.033, "sample_throughput": 3261.941, "learn_time_ms": 2451.93, "learn_throughput": 3915.284, "update_time_ms": 1.541}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.045922183779378734, "policy_loss": -0.059956200793385504, "vf_loss": 0.0019577697462712725, "vf_explained_var": 0.8527573943138123, "kl": 0.01207624594370524, "entropy": -3.3388301849365236, "entropy_coeff": 0.0}}, "num_steps_sampled": 38400, "num_steps_trained": 38400}, "done": false, "episodes_total": 32, "training_iteration": 4, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-19-35", "timestamp": 1617635975, "time_this_iter_s": 5.391329765319824, "time_total_s": 21.60572910308838, "pid": 9872, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21.60572910308838, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 50.957142857142856, "ram_util_percent": 60.39999999999999}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 0.9436793790748828, "episode_reward_min": -0.5792657433481356, "episode_reward_mean": -0.09519440228009413, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3642644426645194, -0.10930129476112982, 0.7705439284894202, -0.3473381397776488, -0.23762231038082027, -0.28441587232153476, -0.32951199873353343, -0.543996104110615, -0.1737283421308946, -0.1644661518837427, -0.3929913289905753, -0.0744843319678774, 0.2083482013810709, -0.17829686949542511, -0.21609076713993036, -0.1675542360112804, -0.2730057906698946, -0.3098437017870368, 0.05246686606202822, -0.28847109826207595, -0.20149102729828705, 0.6158914730239617, -0.2800418599765745, -0.2256135330985738, -0.09764532624006972, -0.5792657433481356, -0.3131686301137374, -0.3337962513790893, -0.3237455511238717, -0.3471530745022008, -0.3757209631685672, -0.461291194011546, 0.40187144950890885, -0.5389089928374595, 0.09694741505741189, 0.22456183419817166, 0.4068231516196743, 0.18826926906883856, -0.06366941578169438, 0.9436793790748828, -0.2711022328702336, 0.5507635302784748, -0.5643102888616142, 0.43979167470866765, -0.30022385740072843, -0.4440896304508291, 0.13706120019105783, -0.15825921388437936], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19860716083497887, "mean_inference_ms": 0.9779874351822668, "mean_action_processing_ms": 0.04101574332665076, "mean_env_wait_ms": 0.9469814008742569, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 48000, "timers": {"sample_time_ms": 2997.041, "sample_throughput": 3203.16, "learn_time_ms": 2470.913, "learn_throughput": 3885.203, "update_time_ms": 1.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.048211679855982466, "policy_loss": -0.06236283821985125, "vf_loss": 0.0017981149426971872, "vf_explained_var": 0.9043338894844055, "kl": 0.012353044636547565, "entropy": -3.3775502268473305, "entropy_coeff": 0.0}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 5, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-19-41", "timestamp": 1617635981, "time_this_iter_s": 5.774994373321533, "time_total_s": 27.380723476409912, "pid": 9872, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.380723476409912, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 43.36666666666667, "ram_util_percent": 60.34444444444445}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 0.9436793790748828, "episode_reward_min": -0.5792657433481356, "episode_reward_mean": -0.05144922450757082, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4251194518986153, -0.03920690865993748, 0.10764922029803947, 0.0738024064627012, 0.35570312713052066, 0.24490454763305936, 0.5549924290819253, 0.8154493669728591, -0.2730057906698946, -0.3098437017870368, 0.05246686606202822, -0.28847109826207595, -0.20149102729828705, 0.6158914730239617, -0.2800418599765745, -0.2256135330985738, -0.09764532624006972, -0.5792657433481356, -0.3131686301137374, -0.3337962513790893, -0.3237455511238717, -0.3471530745022008, -0.3757209631685672, -0.461291194011546, 0.40187144950890885, -0.5389089928374595, 0.09694741505741189, 0.22456183419817166, 0.4068231516196743, 0.18826926906883856, -0.06366941578169438, 0.9436793790748828, -0.2711022328702336, 0.5507635302784748, -0.5643102888616142, 0.43979167470866765, -0.30022385740072843, -0.4440896304508291, 0.13706120019105783, -0.15825921388437936, 0.3642644426645194, -0.10930129476112982, 0.7705439284894202, -0.3473381397776488, -0.23762231038082027, -0.28441587232153476, -0.32951199873353343, -0.543996104110615, -0.1737283421308946, -0.1644661518837427, -0.3929913289905753, -0.0744843319678774, 0.2083482013810709, -0.17829686949542511, -0.21609076713993036, -0.1675542360112804], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20013411403923426, "mean_inference_ms": 0.9820073008503145, "mean_action_processing_ms": 0.04117137318216823, "mean_env_wait_ms": 0.9481044771714746, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 57600, "timers": {"sample_time_ms": 3004.518, "sample_throughput": 3195.189, "learn_time_ms": 2468.584, "learn_throughput": 3888.868, "update_time_ms": 1.584}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.0468458387379845, "policy_loss": -0.0620070441501836, "vf_loss": 0.0026376853277906777, "vf_explained_var": 0.857266366481781, "kl": 0.012523522240420182, "entropy": -3.3835866991678873, "entropy_coeff": 0.0}}, "num_steps_sampled": 57600, "num_steps_trained": 57600}, "done": false, "episodes_total": 56, "training_iteration": 6, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-19-46", "timestamp": 1617635986, "time_this_iter_s": 5.505019903182983, "time_total_s": 32.885743379592896, "pid": 9872, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.885743379592896, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 46.7, "ram_util_percent": 60.4}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 1.4918513601184058, "episode_reward_min": -0.5792657433481356, "episode_reward_mean": 0.024882872215508986, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.22673031148635758, 0.08707790943612848, 0.0583300730699472, 1.2487273529616196, 0.9738366123779683, 0.7971673189993682, 0.04340007873946128, 1.4918513601184058, -0.2730057906698946, -0.3098437017870368, 0.05246686606202822, -0.28847109826207595, -0.20149102729828705, 0.6158914730239617, -0.2800418599765745, -0.2256135330985738, -0.09764532624006972, -0.5792657433481356, -0.3131686301137374, -0.3337962513790893, -0.3237455511238717, -0.3471530745022008, -0.3757209631685672, -0.461291194011546, 0.40187144950890885, -0.5389089928374595, 0.09694741505741189, 0.22456183419817166, 0.4068231516196743, 0.18826926906883856, -0.06366941578169438, 0.9436793790748828, -0.2711022328702336, 0.5507635302784748, -0.5643102888616142, 0.43979167470866765, -0.30022385740072843, -0.4440896304508291, 0.13706120019105783, -0.15825921388437936, 0.3642644426645194, -0.10930129476112982, 0.7705439284894202, -0.3473381397776488, -0.23762231038082027, -0.28441587232153476, -0.32951199873353343, -0.543996104110615, -0.1737283421308946, -0.1644661518837427, -0.3929913289905753, -0.0744843319678774, 0.2083482013810709, -0.17829686949542511, -0.21609076713993036, -0.1675542360112804, -0.4251194518986153, -0.03920690865993748, 0.10764922029803947, 0.0738024064627012, 0.35570312713052066, 0.24490454763305936, 0.5549924290819253, 0.8154493669728591], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20075523085350994, "mean_inference_ms": 0.9849533965631595, "mean_action_processing_ms": 0.041285858730428046, "mean_env_wait_ms": 0.9486132958401852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 67200, "timers": {"sample_time_ms": 2993.413, "sample_throughput": 3207.042, "learn_time_ms": 2474.522, "learn_throughput": 3879.537, "update_time_ms": 1.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.04927583379670977, "policy_loss": -0.06410306666046381, "vf_loss": 0.0026952315028756857, "vf_explained_var": 0.881592333316803, "kl": 0.01213200310866038, "entropy": -3.4390750980377196, "entropy_coeff": 0.0}}, "num_steps_sampled": 67200, "num_steps_trained": 67200}, "done": false, "episodes_total": 64, "training_iteration": 7, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-19-52", "timestamp": 1617635992, "time_this_iter_s": 5.442854166030884, "time_total_s": 38.32859754562378, "pid": 9872, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.32859754562378, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 49.971428571428575, "ram_util_percent": 60.39999999999999}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 1.4918513601184058, "episode_reward_min": -0.5792657433481356, "episode_reward_mean": 0.06899213167092275, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5039649223300999, -0.046980152065858705, -0.19930716932625925, 0.6651297834806338, 1.4778832104246309, 0.6004196775383797, 0.26548790948551004, 0.10833147664672582, -0.2730057906698946, -0.3098437017870368, 0.05246686606202822, -0.28847109826207595, -0.20149102729828705, 0.6158914730239617, -0.2800418599765745, -0.2256135330985738, -0.09764532624006972, -0.5792657433481356, -0.3131686301137374, -0.3337962513790893, -0.3237455511238717, -0.3471530745022008, -0.3757209631685672, -0.461291194011546, 0.40187144950890885, -0.5389089928374595, 0.09694741505741189, 0.22456183419817166, 0.4068231516196743, 0.18826926906883856, -0.06366941578169438, 0.9436793790748828, -0.2711022328702336, 0.5507635302784748, -0.5643102888616142, 0.43979167470866765, -0.30022385740072843, -0.4440896304508291, 0.13706120019105783, -0.15825921388437936, 0.3642644426645194, -0.10930129476112982, 0.7705439284894202, -0.3473381397776488, -0.23762231038082027, -0.28441587232153476, -0.32951199873353343, -0.543996104110615, -0.1737283421308946, -0.1644661518837427, -0.3929913289905753, -0.0744843319678774, 0.2083482013810709, -0.17829686949542511, -0.21609076713993036, -0.1675542360112804, -0.4251194518986153, -0.03920690865993748, 0.10764922029803947, 0.0738024064627012, 0.35570312713052066, 0.24490454763305936, 0.5549924290819253, 0.8154493669728591, -0.22673031148635758, 0.08707790943612848, 0.0583300730699472, 1.2487273529616196, 0.9738366123779683, 0.7971673189993682, 0.04340007873946128, 1.4918513601184058], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20084199605306058, "mean_inference_ms": 0.9868264003807722, "mean_action_processing_ms": 0.04135856733963537, "mean_env_wait_ms": 0.9484476137922159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 76800, "timers": {"sample_time_ms": 2968.119, "sample_throughput": 3234.372, "learn_time_ms": 2496.186, "learn_throughput": 3845.867, "update_time_ms": 1.595}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.048218343084057175, "policy_loss": -0.06393999288479488, "vf_loss": 0.002534911101683974, "vf_explained_var": 0.8981689214706421, "kl": 0.013186740639309089, "entropy": -3.4292883523305258, "entropy_coeff": 0.0}}, "num_steps_sampled": 76800, "num_steps_trained": 76800}, "done": false, "episodes_total": 72, "training_iteration": 8, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-19-57", "timestamp": 1617635997, "time_this_iter_s": 5.447656631469727, "time_total_s": 43.776254177093506, "pid": 9872, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.776254177093506, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 43.975, "ram_util_percent": 60.3875}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 1.4918513601184058, "episode_reward_min": -0.5792657433481356, "episode_reward_mean": 0.1052972942897068, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.21854863068901853, 0.4770037178935258, 0.20033548600413953, 0.6058099389509839, 0.8052727049827031, 0.49861691239120165, 0.31240095524144684, 0.3383617167170867, -0.2730057906698946, -0.3098437017870368, 0.05246686606202822, -0.28847109826207595, -0.20149102729828705, 0.6158914730239617, -0.2800418599765745, -0.2256135330985738, -0.09764532624006972, -0.5792657433481356, -0.3131686301137374, -0.3337962513790893, -0.3237455511238717, -0.3471530745022008, -0.3757209631685672, -0.461291194011546, 0.40187144950890885, -0.5389089928374595, 0.09694741505741189, 0.22456183419817166, 0.4068231516196743, 0.18826926906883856, -0.06366941578169438, 0.9436793790748828, -0.2711022328702336, 0.5507635302784748, -0.5643102888616142, 0.43979167470866765, -0.30022385740072843, -0.4440896304508291, 0.13706120019105783, -0.15825921388437936, 0.3642644426645194, -0.10930129476112982, 0.7705439284894202, -0.3473381397776488, -0.23762231038082027, -0.28441587232153476, -0.32951199873353343, -0.543996104110615, -0.1737283421308946, -0.1644661518837427, -0.3929913289905753, -0.0744843319678774, 0.2083482013810709, -0.17829686949542511, -0.21609076713993036, -0.1675542360112804, -0.4251194518986153, -0.03920690865993748, 0.10764922029803947, 0.0738024064627012, 0.35570312713052066, 0.24490454763305936, 0.5549924290819253, 0.8154493669728591, -0.22673031148635758, 0.08707790943612848, 0.0583300730699472, 1.2487273529616196, 0.9738366123779683, 0.7971673189993682, 0.04340007873946128, 1.4918513601184058, 0.5039649223300999, -0.046980152065858705, -0.19930716932625925, 0.6651297834806338, 1.4778832104246309, 0.6004196775383797, 0.26548790948551004, 0.10833147664672582], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20051056326647046, "mean_inference_ms": 0.9871071530053944, "mean_action_processing_ms": 0.04136694937574062, "mean_env_wait_ms": 0.946920864347868, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 86400, "timers": {"sample_time_ms": 2917.799, "sample_throughput": 3290.151, "learn_time_ms": 2546.753, "learn_throughput": 3769.506, "update_time_ms": 1.558}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.04915539370228847, "policy_loss": -0.06493487879013021, "vf_loss": 0.002667548325844109, "vf_explained_var": 0.8910808563232422, "kl": 0.013111936238904795, "entropy": -3.4858380349477134, "entropy_coeff": 0.0}}, "num_steps_sampled": 86400, "num_steps_trained": 86400}, "done": false, "episodes_total": 80, "training_iteration": 9, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-20-03", "timestamp": 1617636003, "time_this_iter_s": 5.473344802856445, "time_total_s": 49.24959897994995, "pid": 9872, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.24959897994995, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 51.650000000000006, "ram_util_percent": 55.087500000000006}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 2.1986463471571245, "episode_reward_min": -0.5792657433481356, "episode_reward_mean": 0.2607834457260877, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1804230199755716, 0.9744374265645843, 0.33077142846349883, 1.565330100360533, 0.12135882730445346, 2.1986463471571245, 0.8197633363734413, 1.19333336405984, 0.5309272111251147, 1.303444322770495, 1.3201789433036768, 1.9543924873054035, 1.3195878679072122, 0.9257745771505372, 0.9292899576638982, -0.05623197095750998, -0.2730057906698946, -0.3098437017870368, 0.05246686606202822, -0.28847109826207595, -0.20149102729828705, 0.6158914730239617, -0.2800418599765745, -0.2256135330985738, -0.09764532624006972, -0.5792657433481356, -0.3131686301137374, -0.3337962513790893, -0.3237455511238717, -0.3471530745022008, -0.3757209631685672, -0.461291194011546, 0.40187144950890885, -0.5389089928374595, 0.09694741505741189, 0.22456183419817166, 0.4068231516196743, 0.18826926906883856, -0.06366941578169438, 0.9436793790748828, -0.2711022328702336, 0.5507635302784748, -0.5643102888616142, 0.43979167470866765, -0.30022385740072843, -0.4440896304508291, 0.13706120019105783, -0.15825921388437936, 0.3642644426645194, -0.10930129476112982, 0.7705439284894202, -0.3473381397776488, -0.23762231038082027, -0.28441587232153476, -0.32951199873353343, -0.543996104110615, -0.1737283421308946, -0.1644661518837427, -0.3929913289905753, -0.0744843319678774, 0.2083482013810709, -0.17829686949542511, -0.21609076713993036, -0.1675542360112804, -0.4251194518986153, -0.03920690865993748, 0.10764922029803947, 0.0738024064627012, 0.35570312713052066, 0.24490454763305936, 0.5549924290819253, 0.8154493669728591, -0.22673031148635758, 0.08707790943612848, 0.0583300730699472, 1.2487273529616196, 0.9738366123779683, 0.7971673189993682, 0.04340007873946128, 1.4918513601184058, 0.5039649223300999, -0.046980152065858705, -0.19930716932625925, 0.6651297834806338, 1.4778832104246309, 0.6004196775383797, 0.26548790948551004, 0.10833147664672582, 0.21854863068901853, 0.4770037178935258, 0.20033548600413953, 0.6058099389509839, 0.8052727049827031, 0.49861691239120165, 0.31240095524144684, 0.3383617167170867], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20137185115208797, "mean_inference_ms": 0.989430197834739, "mean_action_processing_ms": 0.04136750442961309, "mean_env_wait_ms": 0.9440731733427605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 96000, "timers": {"sample_time_ms": 2927.911, "sample_throughput": 3278.788, "learn_time_ms": 2542.557, "learn_throughput": 3775.726, "update_time_ms": 1.557}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.043997402998308344, "policy_loss": -0.06332471041629711, "vf_loss": 0.004627092564478516, "vf_explained_var": 0.8660265207290649, "kl": 0.014700213260948659, "entropy": -3.5132003084818524, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 10, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-20-08", "timestamp": 1617636008, "time_this_iter_s": 5.5304648876190186, "time_total_s": 54.78006386756897, "pid": 9872, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 54.78006386756897, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 48.7, "ram_util_percent": 60.375}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 3.1556770450052527, "episode_reward_min": 0.4350705065340026, "episode_reward_mean": 1.3266341039565965, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.1556770450052527, 0.8784349981116535, 1.1207526657629114, 0.4350705065340026, 1.3242121040272847, 1.106341361015994, 0.8433926994865462, 1.7491914517091267], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16552123003061564, "mean_inference_ms": 0.875820451533169, "mean_action_processing_ms": 0.03667184454912349, "mean_env_wait_ms": 0.8835752590014276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 105600, "timers": {"sample_time_ms": 3070.153, "sample_throughput": 3126.88, "learn_time_ms": 2734.712, "learn_throughput": 3510.425, "update_time_ms": 1.485}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.04687833414102594, "policy_loss": -0.0652162030339241, "vf_loss": 0.004221384776756167, "vf_explained_var": 0.8723809719085693, "kl": 0.014116485677659512, "entropy": -3.520949500401815, "entropy_coeff": 0.0}}, "num_steps_sampled": 105600, "num_steps_trained": 105600}, "done": false, "episodes_total": 104, "training_iteration": 11, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-21-06", "timestamp": 1617636066, "time_this_iter_s": 5.809231996536255, "time_total_s": 60.589295864105225, "pid": 10553, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.809231996536255, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.44444444444445, "ram_util_percent": 60.166666666666664}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 3.1686361372252634, "episode_reward_min": 0.4350705065340026, "episode_reward_mean": 1.3881527983391995, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5552091587682011, 2.7067479954712463, 1.025525510717272, 3.1686361372252634, 0.49652925245880075, 1.1647037391474844, 1.2727042400834114, 1.2073159079027405, 3.1556770450052527, 0.8784349981116535, 1.1207526657629114, 0.4350705065340026, 1.3242121040272847, 1.106341361015994, 0.8433926994865462, 1.7491914517091267], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16899658280394056, "mean_inference_ms": 0.9022705566767331, "mean_action_processing_ms": 0.037956463061076126, "mean_env_wait_ms": 0.8921068587414809, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 115200, "timers": {"sample_time_ms": 2950.067, "sample_throughput": 3254.163, "learn_time_ms": 3099.387, "learn_throughput": 3097.387, "update_time_ms": 1.635}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.04538474175458153, "policy_loss": -0.06554569122691949, "vf_loss": 0.0057534959974388285, "vf_explained_var": 0.8716577887535095, "kl": 0.014407453474899133, "entropy": -3.5846771399180093, "entropy_coeff": 0.0}}, "num_steps_sampled": 115200, "num_steps_trained": 115200}, "done": false, "episodes_total": 112, "training_iteration": 12, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-21-12", "timestamp": 1617636072, "time_this_iter_s": 6.301425457000732, "time_total_s": 66.89072132110596, "pid": 10553, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.110657453536987, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 52.25555555555556, "ram_util_percent": 56.28888888888889}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 6.454259805229261, "episode_reward_min": 0.4350705065340026, "episode_reward_mean": 1.874125148599064, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0906284387098104, 6.454259805229261, 1.5555252322959117, 2.1719762070294877, 0.9532747015377305, 1.7250256815703424, 3.4757121627714547, 3.3421565638063484, 3.1556770450052527, 0.8784349981116535, 1.1207526657629114, 0.4350705065340026, 1.3242121040272847, 1.106341361015994, 0.8433926994865462, 1.7491914517091267, 0.5552091587682011, 2.7067479954712463, 1.025525510717272, 3.1686361372252634, 0.49652925245880075, 1.1647037391474844, 1.2727042400834114, 1.2073159079027405], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17466741817237766, "mean_inference_ms": 0.9342555856007383, "mean_action_processing_ms": 0.03928022131192748, "mean_env_wait_ms": 0.9136981370717491, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 124800, "timers": {"sample_time_ms": 3101.399, "sample_throughput": 3095.377, "learn_time_ms": 3104.353, "learn_throughput": 3092.432, "update_time_ms": 1.644}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.03639487944543362, "policy_loss": -0.05839369078477224, "vf_loss": 0.009699580371379852, "vf_explained_var": 0.8596526980400085, "kl": 0.01229923324038585, "entropy": -3.5387893199920653, "entropy_coeff": 0.0}}, "num_steps_sampled": 124800, "num_steps_trained": 124800}, "done": false, "episodes_total": 120, "training_iteration": 13, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-21-19", "timestamp": 1617636079, "time_this_iter_s": 6.52459979057312, "time_total_s": 73.41532111167908, "pid": 10553, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18.635257244110107, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 58.044444444444444, "ram_util_percent": 60.34444444444445}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 6.454259805229261, "episode_reward_min": 0.4350705065340026, "episode_reward_mean": 1.9320949780457506, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7628535313321063, 1.9490917914429726, 3.367018330996687, 3.714060178337096, 2.947476312137002, 2.2268765861020903, 1.3497440585814315, 0.5309149421570958, 3.1556770450052527, 0.8784349981116535, 1.1207526657629114, 0.4350705065340026, 1.3242121040272847, 1.106341361015994, 0.8433926994865462, 1.7491914517091267, 0.5552091587682011, 2.7067479954712463, 1.025525510717272, 3.1686361372252634, 0.49652925245880075, 1.1647037391474844, 1.2727042400834114, 1.2073159079027405, 3.0906284387098104, 6.454259805229261, 1.5555252322959117, 2.1719762070294877, 0.9532747015377305, 1.7250256815703424, 3.4757121627714547, 3.3421565638063484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17553460818951527, "mean_inference_ms": 0.9464594086467387, "mean_action_processing_ms": 0.03944590090574246, "mean_env_wait_ms": 0.9106087637364103, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 134400, "timers": {"sample_time_ms": 2929.004, "sample_throughput": 3277.565, "learn_time_ms": 3066.459, "learn_throughput": 3130.647, "update_time_ms": 1.596}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.04486952030410369, "policy_loss": -0.06509303184847037, "vf_loss": 0.006235584678749243, "vf_explained_var": 0.9133003950119019, "kl": 0.013987928678592046, "entropy": -3.595861301422119, "entropy_coeff": 0.0}}, "num_steps_sampled": 134400, "num_steps_trained": 134400}, "done": false, "episodes_total": 128, "training_iteration": 14, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-21-24", "timestamp": 1617636084, "time_this_iter_s": 5.371575593948364, "time_total_s": 78.78689670562744, "pid": 10553, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.00683283805847, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 31.3625, "ram_util_percent": 60.412499999999994}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 6.454259805229261, "episode_reward_min": 0.3474159225183071, "episode_reward_mean": 2.033238626679976, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2013481915661979, 2.249830727727562, 0.7926768248482261, 3.7439510031418752, 0.9811563825529188, 0.3474159225183071, 1.6215548607050767, 2.726232149337222, 1.1789774398000437, 2.866434350460172, 1.004649964036184, 4.0365915095893, 1.7843037971052391, 4.118690839122839, 3.4526573065657056, 3.6619435140979553, 3.1556770450052527, 0.8784349981116535, 1.1207526657629114, 0.4350705065340026, 1.3242121040272847, 1.106341361015994, 0.8433926994865462, 1.7491914517091267, 0.5552091587682011, 2.7067479954712463, 1.025525510717272, 3.1686361372252634, 0.49652925245880075, 1.1647037391474844, 1.2727042400834114, 1.2073159079027405, 3.0906284387098104, 6.454259805229261, 1.5555252322959117, 2.1719762070294877, 0.9532747015377305, 1.7250256815703424, 3.4757121627714547, 3.3421565638063484, 0.7628535313321063, 1.9490917914429726, 3.367018330996687, 3.714060178337096, 2.947476312137002, 2.2268765861020903, 1.3497440585814315, 0.5309149421570958], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1846846902506347, "mean_inference_ms": 0.9702165144051599, "mean_action_processing_ms": 0.04011971285362129, "mean_env_wait_ms": 0.9192385581357279, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 144000, "timers": {"sample_time_ms": 3037.68, "sample_throughput": 3160.307, "learn_time_ms": 3036.094, "learn_throughput": 3161.958, "update_time_ms": 1.527}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.04157280392944813, "policy_loss": -0.06434134519348542, "vf_loss": 0.008966158467034498, "vf_explained_var": 0.9164339303970337, "kl": 0.013802382436891397, "entropy": -3.64003316561381, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 15, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-21-31", "timestamp": 1617636091, "time_this_iter_s": 6.392681121826172, "time_total_s": 85.17957782745361, "pid": 10553, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.399513959884644, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 53.4888888888889, "ram_util_percent": 60.34444444444445}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 7.218368318268626, "episode_reward_min": 0.3474159225183071, "episode_reward_mean": 2.297402426213697, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.095211339230265, 2.991007906859118, 4.774319515530025, 5.274207455667962, 2.9932422512754076, 2.192180992396802, 7.218368318268626, 2.520544008099998, 3.1556770450052527, 0.8784349981116535, 1.1207526657629114, 0.4350705065340026, 1.3242121040272847, 1.106341361015994, 0.8433926994865462, 1.7491914517091267, 0.5552091587682011, 2.7067479954712463, 1.025525510717272, 3.1686361372252634, 0.49652925245880075, 1.1647037391474844, 1.2727042400834114, 1.2073159079027405, 3.0906284387098104, 6.454259805229261, 1.5555252322959117, 2.1719762070294877, 0.9532747015377305, 1.7250256815703424, 3.4757121627714547, 3.3421565638063484, 0.7628535313321063, 1.9490917914429726, 3.367018330996687, 3.714060178337096, 2.947476312137002, 2.2268765861020903, 1.3497440585814315, 0.5309149421570958, 1.2013481915661979, 2.249830727727562, 0.7926768248482261, 3.7439510031418752, 0.9811563825529188, 0.3474159225183071, 1.6215548607050767, 2.726232149337222, 1.1789774398000437, 2.866434350460172, 1.004649964036184, 4.0365915095893, 1.7843037971052391, 4.118690839122839, 3.4526573065657056, 3.6619435140979553], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18623804347892436, "mean_inference_ms": 0.9722720136474555, "mean_action_processing_ms": 0.04013993052683547, "mean_env_wait_ms": 0.9170413051601499, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 153600, "timers": {"sample_time_ms": 2912.565, "sample_throughput": 3296.064, "learn_time_ms": 3025.915, "learn_throughput": 3172.595, "update_time_ms": 1.523}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.03886916602651278, "policy_loss": -0.06359301847716173, "vf_loss": 0.010784678943455219, "vf_explained_var": 0.8811787962913513, "kl": 0.013939176872372627, "entropy": -3.644416249593099, "entropy_coeff": 0.0}}, "num_steps_sampled": 153600, "num_steps_trained": 153600}, "done": false, "episodes_total": 152, "training_iteration": 16, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-21-36", "timestamp": 1617636096, "time_this_iter_s": 5.26908540725708, "time_total_s": 90.4486632347107, "pid": 10553, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.668599367141724, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.6875, "ram_util_percent": 60.625}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 9.474984276093759, "episode_reward_min": 0.3474159225183071, "episode_reward_mean": 2.514254945684902, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.29051793576069, 2.2842858042103935, 2.544073829343025, 2.2071882215734386, 3.5594294964125233, 5.44459737536747, 1.4527037171053894, 9.474984276093759, 3.1556770450052527, 0.8784349981116535, 1.1207526657629114, 0.4350705065340026, 1.3242121040272847, 1.106341361015994, 0.8433926994865462, 1.7491914517091267, 0.5552091587682011, 2.7067479954712463, 1.025525510717272, 3.1686361372252634, 0.49652925245880075, 1.1647037391474844, 1.2727042400834114, 1.2073159079027405, 3.0906284387098104, 6.454259805229261, 1.5555252322959117, 2.1719762070294877, 0.9532747015377305, 1.7250256815703424, 3.4757121627714547, 3.3421565638063484, 0.7628535313321063, 1.9490917914429726, 3.367018330996687, 3.714060178337096, 2.947476312137002, 2.2268765861020903, 1.3497440585814315, 0.5309149421570958, 1.2013481915661979, 2.249830727727562, 0.7926768248482261, 3.7439510031418752, 0.9811563825529188, 0.3474159225183071, 1.6215548607050767, 2.726232149337222, 1.1789774398000437, 2.866434350460172, 1.004649964036184, 4.0365915095893, 1.7843037971052391, 4.118690839122839, 3.4526573065657056, 3.6619435140979553, 3.095211339230265, 2.991007906859118, 4.774319515530025, 5.274207455667962, 2.9932422512754076, 2.192180992396802, 7.218368318268626, 2.520544008099998], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1878274556153531, "mean_inference_ms": 0.9772959902335578, "mean_action_processing_ms": 0.0403157129435073, "mean_env_wait_ms": 0.9191794919682751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 163200, "timers": {"sample_time_ms": 2976.171, "sample_throughput": 3225.622, "learn_time_ms": 3027.477, "learn_throughput": 3170.957, "update_time_ms": 1.529}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.037601022211213905, "policy_loss": -0.06324764919777712, "vf_loss": 0.013138256203383207, "vf_explained_var": 0.8902817964553833, "kl": 0.012508372875551383, "entropy": -3.694095195134481, "entropy_coeff": 0.0}}, "num_steps_sampled": 163200, "num_steps_trained": 163200}, "done": false, "episodes_total": 160, "training_iteration": 17, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-21-42", "timestamp": 1617636102, "time_this_iter_s": 6.401371002197266, "time_total_s": 96.85003423690796, "pid": 10553, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.06997036933899, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 52.75555555555555, "ram_util_percent": 60.78888888888889}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 9.474984276093759, "episode_reward_min": 0.3474159225183071, "episode_reward_mean": 2.7428360090712363, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.122491960470056, 2.5299180773312653, 4.128521481246067, 4.8519696329849165, 8.251145586343885, 2.39845987825624, 4.601446572352941, 3.6879229403098837, 3.1556770450052527, 0.8784349981116535, 1.1207526657629114, 0.4350705065340026, 1.3242121040272847, 1.106341361015994, 0.8433926994865462, 1.7491914517091267, 0.5552091587682011, 2.7067479954712463, 1.025525510717272, 3.1686361372252634, 0.49652925245880075, 1.1647037391474844, 1.2727042400834114, 1.2073159079027405, 3.0906284387098104, 6.454259805229261, 1.5555252322959117, 2.1719762070294877, 0.9532747015377305, 1.7250256815703424, 3.4757121627714547, 3.3421565638063484, 0.7628535313321063, 1.9490917914429726, 3.367018330996687, 3.714060178337096, 2.947476312137002, 2.2268765861020903, 1.3497440585814315, 0.5309149421570958, 1.2013481915661979, 2.249830727727562, 0.7926768248482261, 3.7439510031418752, 0.9811563825529188, 0.3474159225183071, 1.6215548607050767, 2.726232149337222, 1.1789774398000437, 2.866434350460172, 1.004649964036184, 4.0365915095893, 1.7843037971052391, 4.118690839122839, 3.4526573065657056, 3.6619435140979553, 3.095211339230265, 2.991007906859118, 4.774319515530025, 5.274207455667962, 2.9932422512754076, 2.192180992396802, 7.218368318268626, 2.520544008099998, 5.29051793576069, 2.2842858042103935, 2.544073829343025, 2.2071882215734386, 3.5594294964125233, 5.44459737536747, 1.4527037171053894, 9.474984276093759], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1885081539577965, "mean_inference_ms": 0.9789304575760683, "mean_action_processing_ms": 0.04036701039521936, "mean_env_wait_ms": 0.9185876754117503, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 172800, "timers": {"sample_time_ms": 2904.787, "sample_throughput": 3304.89, "learn_time_ms": 3027.553, "learn_throughput": 3170.878, "update_time_ms": 1.553}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.03976290907089909, "policy_loss": -0.06624664939939975, "vf_loss": 0.012506990283727646, "vf_explained_var": 0.9058644771575928, "kl": 0.013976751379668712, "entropy": -3.6841222508748372, "entropy_coeff": 0.0}}, "num_steps_sampled": 172800, "num_steps_trained": 172800}, "done": false, "episodes_total": 168, "training_iteration": 18, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-21-48", "timestamp": 1617636108, "time_this_iter_s": 5.441272020339966, "time_total_s": 102.29130625724792, "pid": 10553, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.511242389678955, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.457142857142856, "ram_util_percent": 60.67142857142858}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 9.474984276093759, "episode_reward_min": 0.3474159225183071, "episode_reward_mean": 2.9762917758502234, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.331186716410418, 4.536781707843813, 5.766798324645775, 5.821709862303241, 4.012278455388125, 3.387748092535202, 7.06901793952458, 2.6936283162377324, 3.1556770450052527, 0.8784349981116535, 1.1207526657629114, 0.4350705065340026, 1.3242121040272847, 1.106341361015994, 0.8433926994865462, 1.7491914517091267, 0.5552091587682011, 2.7067479954712463, 1.025525510717272, 3.1686361372252634, 0.49652925245880075, 1.1647037391474844, 1.2727042400834114, 1.2073159079027405, 3.0906284387098104, 6.454259805229261, 1.5555252322959117, 2.1719762070294877, 0.9532747015377305, 1.7250256815703424, 3.4757121627714547, 3.3421565638063484, 0.7628535313321063, 1.9490917914429726, 3.367018330996687, 3.714060178337096, 2.947476312137002, 2.2268765861020903, 1.3497440585814315, 0.5309149421570958, 1.2013481915661979, 2.249830727727562, 0.7926768248482261, 3.7439510031418752, 0.9811563825529188, 0.3474159225183071, 1.6215548607050767, 2.726232149337222, 1.1789774398000437, 2.866434350460172, 1.004649964036184, 4.0365915095893, 1.7843037971052391, 4.118690839122839, 3.4526573065657056, 3.6619435140979553, 3.095211339230265, 2.991007906859118, 4.774319515530025, 5.274207455667962, 2.9932422512754076, 2.192180992396802, 7.218368318268626, 2.520544008099998, 5.29051793576069, 2.2842858042103935, 2.544073829343025, 2.2071882215734386, 3.5594294964125233, 5.44459737536747, 1.4527037171053894, 9.474984276093759, 6.122491960470056, 2.5299180773312653, 4.128521481246067, 4.8519696329849165, 8.251145586343885, 2.39845987825624, 4.601446572352941, 3.6879229403098837], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1895624644769339, "mean_inference_ms": 0.9831457626348469, "mean_action_processing_ms": 0.04053983676129419, "mean_env_wait_ms": 0.9211251883028393, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 182400, "timers": {"sample_time_ms": 2979.543, "sample_throughput": 3221.971, "learn_time_ms": 3008.494, "learn_throughput": 3190.965, "update_time_ms": 1.56}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.03484934961423278, "policy_loss": -0.06451630868017673, "vf_loss": 0.014301291778683662, "vf_explained_var": 0.9173310399055481, "kl": 0.015365665853023529, "entropy": -3.7484316953023273, "entropy_coeff": 0.0}}, "num_steps_sampled": 182400, "num_steps_trained": 182400}, "done": false, "episodes_total": 176, "training_iteration": 19, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-21-54", "timestamp": 1617636114, "time_this_iter_s": 6.439696311950684, "time_total_s": 108.73100256919861, "pid": 10553, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.95093870162964, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 54.05999999999999, "ram_util_percent": 60.919999999999995}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 11.223854871918816, "episode_reward_min": 3.138961273069758, "episode_reward_mean": 6.611828394311481, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.752177966172156, 6.583531841565813, 7.0364520867370075, 9.3275557758661, 11.223854871918816, 6.7992479495783025, 3.138961273069758, 4.032845389583895], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2233948090193571, "mean_inference_ms": 1.1329665271368352, "mean_action_processing_ms": 0.04779081559002548, "mean_env_wait_ms": 1.1315472070422399, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 192000, "timers": {"sample_time_ms": 3567.634, "sample_throughput": 2690.859, "learn_time_ms": 2870.612, "learn_throughput": 3344.234, "update_time_ms": 1.633}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.029844047433386246, "policy_loss": -0.06046708397567272, "vf_loss": 0.017364295423030852, "vf_explained_var": 0.9020984172821045, "kl": 0.013258741945028305, "entropy": -3.761062218348185, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 184, "training_iteration": 20, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-23-05", "timestamp": 1617636185, "time_this_iter_s": 6.442794322967529, "time_total_s": 115.17379689216614, "pid": 11464, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.442794322967529, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 51.92, "ram_util_percent": 60.42}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 11.223854871918816, "episode_reward_min": 3.1141794624147963, "episode_reward_mean": 5.840649969660703, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.594771817269935, 4.152603515299722, 4.909702649468091, 6.908932189155083, 4.166439181946633, 7.433317248481508, 3.2758262960436273, 3.1141794624147963, 4.752177966172156, 6.583531841565813, 7.0364520867370075, 9.3275557758661, 11.223854871918816, 6.7992479495783025, 3.138961273069758, 4.032845389583895], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20772885944876812, "mean_inference_ms": 1.057205877367796, "mean_action_processing_ms": 0.044597682273224436, "mean_env_wait_ms": 1.0372893963205332, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 201600, "timers": {"sample_time_ms": 2933.687, "sample_throughput": 3272.333, "learn_time_ms": 2998.91, "learn_throughput": 3201.163, "update_time_ms": 1.654}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.04330007632573445, "policy_loss": -0.0691060805444916, "vf_loss": 0.011987883721788724, "vf_explained_var": 0.9419378638267517, "kl": 0.013818121328949929, "entropy": -3.806016887029012, "entropy_coeff": 0.0}}, "num_steps_sampled": 201600, "num_steps_trained": 201600}, "done": false, "episodes_total": 192, "training_iteration": 21, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-23-10", "timestamp": 1617636190, "time_this_iter_s": 5.43279767036438, "time_total_s": 120.60659456253052, "pid": 11464, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.87559199333191, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.542857142857144, "ram_util_percent": 59.74285714285714}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 14.803857668641749, "episode_reward_min": 3.1141794624147963, "episode_reward_mean": 6.6227505319619135, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.48511949737909, 6.0184637041954945, 9.701786618406183, 6.966950231200102, 5.723395299879751, 4.880906529407516, 14.803857668641749, 9.915133703404813, 4.752177966172156, 6.583531841565813, 7.0364520867370075, 9.3275557758661, 11.223854871918816, 6.7992479495783025, 3.138961273069758, 4.032845389583895, 6.594771817269935, 4.152603515299722, 4.909702649468091, 6.908932189155083, 4.166439181946633, 7.433317248481508, 3.2758262960436273, 3.1141794624147963], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2105368870006765, "mean_inference_ms": 1.0758991841000622, "mean_action_processing_ms": 0.045192191900491514, "mean_env_wait_ms": 1.0460915118132197, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 211200, "timers": {"sample_time_ms": 3250.231, "sample_throughput": 2953.636, "learn_time_ms": 3422.667, "learn_throughput": 2804.83, "update_time_ms": 1.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.008100707133611043, "policy_loss": -0.05499161389966806, "vf_loss": 0.03248025534053644, "vf_explained_var": 0.8880446553230286, "kl": 0.014410650320351125, "entropy": -3.813029400507609, "entropy_coeff": 0.0}}, "num_steps_sampled": 211200, "num_steps_trained": 211200}, "done": false, "episodes_total": 200, "training_iteration": 22, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-23-18", "timestamp": 1617636198, "time_this_iter_s": 8.16140866279602, "time_total_s": 128.76800322532654, "pid": 11464, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.03700065612793, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 71.31666666666666, "ram_util_percent": 59.92499999999999}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 14.803857668641749, "episode_reward_min": 3.1141794624147963, "episode_reward_mean": 6.941985209526033, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.473946456582287, 4.542575841549284, 8.023415078817536, 6.7436215303783875, 14.605454774731507, 7.341227597590715, 11.132241516430245, 4.335031141667152, 4.752177966172156, 6.583531841565813, 7.0364520867370075, 9.3275557758661, 11.223854871918816, 6.7992479495783025, 3.138961273069758, 4.032845389583895, 6.594771817269935, 4.152603515299722, 4.909702649468091, 6.908932189155083, 4.166439181946633, 7.433317248481508, 3.2758262960436273, 3.1141794624147963, 7.48511949737909, 6.0184637041954945, 9.701786618406183, 6.966950231200102, 5.723395299879751, 4.880906529407516, 14.803857668641749, 9.915133703404813], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2120691047110385, "mean_inference_ms": 1.098623343119498, "mean_action_processing_ms": 0.045675111838398154, "mean_env_wait_ms": 1.0535804840813983, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 220800, "timers": {"sample_time_ms": 3332.943, "sample_throughput": 2880.337, "learn_time_ms": 3429.028, "learn_throughput": 2799.627, "update_time_ms": 1.719}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.019811048054446778, "policy_loss": -0.06059443655113379, "vf_loss": 0.025875895793239276, "vf_explained_var": 0.9292111396789551, "kl": 0.014907494845489661, "entropy": -3.88946782430013, "entropy_coeff": 0.0}}, "num_steps_sampled": 220800, "num_steps_trained": 220800}, "done": false, "episodes_total": 208, "training_iteration": 23, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-23-25", "timestamp": 1617636205, "time_this_iter_s": 7.03797459602356, "time_total_s": 135.8059778213501, "pid": 11464, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.07497525215149, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 60.64999999999999, "ram_util_percent": 60.610000000000014}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 17.999878840998445, "episode_reward_min": 3.1141794624147963, "episode_reward_mean": 7.988163824271685, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.777117881762251, 7.51298229661087, 5.071684175201497, 17.34505985010356, 13.098453689748352, 7.959316856989126, 7.665299174503449, 11.843384470946392, 17.999878840998445, 4.642575556470925, 10.475441729338815, 6.682159052434655, 5.524671052353332, 15.357978934690173, 7.406427823649814, 6.925905474406173, 4.752177966172156, 6.583531841565813, 7.0364520867370075, 9.3275557758661, 11.223854871918816, 6.7992479495783025, 3.138961273069758, 4.032845389583895, 6.594771817269935, 4.152603515299722, 4.909702649468091, 6.908932189155083, 4.166439181946633, 7.433317248481508, 3.2758262960436273, 3.1141794624147963, 7.48511949737909, 6.0184637041954945, 9.701786618406183, 6.966950231200102, 5.723395299879751, 4.880906529407516, 14.803857668641749, 9.915133703404813, 6.473946456582287, 4.542575841549284, 8.023415078817536, 6.7436215303783875, 14.605454774731507, 7.341227597590715, 11.132241516430245, 4.335031141667152], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21797508475872876, "mean_inference_ms": 1.120613521731018, "mean_action_processing_ms": 0.04622244919682594, "mean_env_wait_ms": 1.061398440334006, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 230400, "timers": {"sample_time_ms": 3376.29, "sample_throughput": 2843.358, "learn_time_ms": 3440.35, "learn_throughput": 2790.414, "update_time_ms": 1.669}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.028721891269087793, "policy_loss": -0.05384779292469223, "vf_loss": 0.06680351942777633, "vf_explained_var": 0.8953477144241333, "kl": 0.015766164734959603, "entropy": -3.91543124516805, "entropy_coeff": 0.0}}, "num_steps_sampled": 230400, "num_steps_trained": 230400}, "done": false, "episodes_total": 224, "training_iteration": 24, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-23-32", "timestamp": 1617636212, "time_this_iter_s": 7.042375564575195, "time_total_s": 142.8483533859253, "pid": 11464, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.117350816726685, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 59.8, "ram_util_percent": 60.739999999999995}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 17.999878840998445, "episode_reward_min": 3.1141794624147963, "episode_reward_mean": 8.432906004411494, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.389065738359184, 10.890196203096615, 9.631409211942197, 13.673025982463976, 13.204166751923974, 10.49136848563639, 7.726257244239411, 11.805383064341086, 4.752177966172156, 6.583531841565813, 7.0364520867370075, 9.3275557758661, 11.223854871918816, 6.7992479495783025, 3.138961273069758, 4.032845389583895, 6.594771817269935, 4.152603515299722, 4.909702649468091, 6.908932189155083, 4.166439181946633, 7.433317248481508, 3.2758262960436273, 3.1141794624147963, 7.48511949737909, 6.0184637041954945, 9.701786618406183, 6.966950231200102, 5.723395299879751, 4.880906529407516, 14.803857668641749, 9.915133703404813, 6.473946456582287, 4.542575841549284, 8.023415078817536, 6.7436215303783875, 14.605454774731507, 7.341227597590715, 11.132241516430245, 4.335031141667152, 15.777117881762251, 7.51298229661087, 5.071684175201497, 17.34505985010356, 13.098453689748352, 7.959316856989126, 7.665299174503449, 11.843384470946392, 17.999878840998445, 4.642575556470925, 10.475441729338815, 6.682159052434655, 5.524671052353332, 15.357978934690173, 7.406427823649814, 6.925905474406173], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21961417572913097, "mean_inference_ms": 1.1275236353548002, "mean_action_processing_ms": 0.04644475974521647, "mean_env_wait_ms": 1.0648603457174397, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 240000, "timers": {"sample_time_ms": 3378.497, "sample_throughput": 2841.5, "learn_time_ms": 3417.404, "learn_throughput": 2809.15, "update_time_ms": 1.623}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.014304530769586564, "policy_loss": -0.06072825300196807, "vf_loss": 0.03272580421219269, "vf_explained_var": 0.9366554617881775, "kl": 0.013697916977107524, "entropy": -3.89641695022583, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 232, "training_iteration": 25, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-23-39", "timestamp": 1617636219, "time_this_iter_s": 6.6987364292144775, "time_total_s": 149.54708981513977, "pid": 11464, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.81608724594116, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 61.00999999999999, "ram_util_percent": 60.85999999999999}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 26.064302496013, "episode_reward_min": 3.1141794624147963, "episode_reward_mean": 8.921539741280718, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.109539269388963, 11.545156626385369, 15.055927715567218, 10.111327249694122, 5.878404907370705, 26.064302496013, 5.815398448259871, 11.155750482242988, 4.752177966172156, 6.583531841565813, 7.0364520867370075, 9.3275557758661, 11.223854871918816, 6.7992479495783025, 3.138961273069758, 4.032845389583895, 6.594771817269935, 4.152603515299722, 4.909702649468091, 6.908932189155083, 4.166439181946633, 7.433317248481508, 3.2758262960436273, 3.1141794624147963, 7.48511949737909, 6.0184637041954945, 9.701786618406183, 6.966950231200102, 5.723395299879751, 4.880906529407516, 14.803857668641749, 9.915133703404813, 6.473946456582287, 4.542575841549284, 8.023415078817536, 6.7436215303783875, 14.605454774731507, 7.341227597590715, 11.132241516430245, 4.335031141667152, 15.777117881762251, 7.51298229661087, 5.071684175201497, 17.34505985010356, 13.098453689748352, 7.959316856989126, 7.665299174503449, 11.843384470946392, 17.999878840998445, 4.642575556470925, 10.475441729338815, 6.682159052434655, 5.524671052353332, 15.357978934690173, 7.406427823649814, 6.925905474406173, 11.389065738359184, 10.890196203096615, 9.631409211942197, 13.673025982463976, 13.204166751923974, 10.49136848563639, 7.726257244239411, 11.805383064341086], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2204922844296713, "mean_inference_ms": 1.1320172357667475, "mean_action_processing_ms": 0.04661053108319384, "mean_env_wait_ms": 1.0671400598030105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 249600, "timers": {"sample_time_ms": 3367.078, "sample_throughput": 2851.137, "learn_time_ms": 3399.045, "learn_throughput": 2824.322, "update_time_ms": 1.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.01569249014680584, "policy_loss": -0.05187588267649213, "vf_loss": 0.05521557008226712, "vf_explained_var": 0.9238880276679993, "kl": 0.012352802741030853, "entropy": -3.9673824596405027, "entropy_coeff": 0.0}}, "num_steps_sampled": 249600, "num_steps_trained": 249600}, "done": false, "episodes_total": 240, "training_iteration": 26, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-23-46", "timestamp": 1617636226, "time_this_iter_s": 6.593622922897339, "time_total_s": 156.1407127380371, "pid": 11464, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.4097101688385, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 60.21111111111111, "ram_util_percent": 60.9888888888889}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 26.064302496013, "episode_reward_min": 3.1141794624147963, "episode_reward_mean": 9.419917115186816, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.912482394718195, 15.008404067681234, 13.132615791335724, 10.082050287068508, 13.701353686343717, 10.661657302736998, 13.93869153396594, 17.818233787634604, 4.752177966172156, 6.583531841565813, 7.0364520867370075, 9.3275557758661, 11.223854871918816, 6.7992479495783025, 3.138961273069758, 4.032845389583895, 6.594771817269935, 4.152603515299722, 4.909702649468091, 6.908932189155083, 4.166439181946633, 7.433317248481508, 3.2758262960436273, 3.1141794624147963, 7.48511949737909, 6.0184637041954945, 9.701786618406183, 6.966950231200102, 5.723395299879751, 4.880906529407516, 14.803857668641749, 9.915133703404813, 6.473946456582287, 4.542575841549284, 8.023415078817536, 6.7436215303783875, 14.605454774731507, 7.341227597590715, 11.132241516430245, 4.335031141667152, 15.777117881762251, 7.51298229661087, 5.071684175201497, 17.34505985010356, 13.098453689748352, 7.959316856989126, 7.665299174503449, 11.843384470946392, 17.999878840998445, 4.642575556470925, 10.475441729338815, 6.682159052434655, 5.524671052353332, 15.357978934690173, 7.406427823649814, 6.925905474406173, 11.389065738359184, 10.890196203096615, 9.631409211942197, 13.673025982463976, 13.204166751923974, 10.49136848563639, 7.726257244239411, 11.805383064341086, 13.109539269388963, 11.545156626385369, 15.055927715567218, 10.111327249694122, 5.878404907370705, 26.064302496013, 5.815398448259871, 11.155750482242988], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22021236878640066, "mean_inference_ms": 1.130928803571968, "mean_action_processing_ms": 0.046561885932582286, "mean_env_wait_ms": 1.064436914919116, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 259200, "timers": {"sample_time_ms": 3245.646, "sample_throughput": 2957.809, "learn_time_ms": 3320.359, "learn_throughput": 2891.254, "update_time_ms": 1.615}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.005606452487409114, "policy_loss": -0.05440540081510941, "vf_loss": 0.04505064032971859, "vf_explained_var": 0.9432043433189392, "kl": 0.014961213072141011, "entropy": -3.9508030128479006, "entropy_coeff": 0.0}}, "num_steps_sampled": 259200, "num_steps_trained": 259200}, "done": false, "episodes_total": 248, "training_iteration": 27, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-23-51", "timestamp": 1617636231, "time_this_iter_s": 5.172023296356201, "time_total_s": 161.3127360343933, "pid": 11464, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.5817334651947, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.4625, "ram_util_percent": 61.3625}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 23.35178473324, "episode_reward_min": 7.3380353730612615, "episode_reward_mean": 13.566418584402111, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.35178473324, 17.099258559548765, 19.927787909641204, 8.042088023676323, 12.706345097105016, 7.3380353730612615, 10.476036647648787, 9.59001233129553], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16295244850584312, "mean_inference_ms": 0.8707072564108385, "mean_action_processing_ms": 0.036779812829480577, "mean_env_wait_ms": 0.8840303337643485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 268800, "timers": {"sample_time_ms": 3076.956, "sample_throughput": 3119.967, "learn_time_ms": 2878.567, "learn_throughput": 3334.992, "update_time_ms": 2.095}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.025175908679763475, "policy_loss": -0.05186467967927456, "vf_loss": 0.06433450835446516, "vf_explained_var": 0.9349846243858337, "kl": 0.012706078787644704, "entropy": -3.9886636924743653, "entropy_coeff": 0.0}}, "num_steps_sampled": 268800, "num_steps_trained": 268800}, "done": false, "episodes_total": 256, "training_iteration": 28, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-25-52", "timestamp": 1617636352, "time_this_iter_s": 5.963718891143799, "time_total_s": 167.2764549255371, "pid": 14027, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.963718891143799, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 40.73333333333333, "ram_util_percent": 60.55555555555556}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 23.35178473324, "episode_reward_min": 7.3380353730612615, "episode_reward_mean": 12.43225616122633, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.362440449651094, 8.817833515341855, 8.941676139463077, 17.093901929911937, 8.740919694172902, 9.371813677445534, 18.22146607350978, 9.834698424908236, 23.35178473324, 17.099258559548765, 19.927787909641204, 8.042088023676323, 12.706345097105016, 7.3380353730612615, 10.476036647648787, 9.59001233129553], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17000124872020866, "mean_inference_ms": 0.911704838502889, "mean_action_processing_ms": 0.038838625315869665, "mean_env_wait_ms": 0.9077709254417639, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 278400, "timers": {"sample_time_ms": 3004.943, "sample_throughput": 3194.736, "learn_time_ms": 3280.716, "learn_throughput": 2926.19, "update_time_ms": 1.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": -0.008515318036079406, "policy_loss": -0.058138293934365114, "vf_loss": 0.03555636612077554, "vf_explained_var": 0.9646667242050171, "kl": 0.014066609839598338, "entropy": -4.059080111185709, "entropy_coeff": 0.0}}, "num_steps_sampled": 278400, "num_steps_trained": 278400}, "done": false, "episodes_total": 264, "training_iteration": 29, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-25-59", "timestamp": 1617636359, "time_this_iter_s": 6.622630596160889, "time_total_s": 173.899085521698, "pid": 14027, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.586349487304688, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 56.64444444444444, "ram_util_percent": 56.83333333333334}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 32.2396549706052, "episode_reward_min": 7.3380353730612615, "episode_reward_mean": 14.116575092473179, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.522915406880973, 17.09435423650587, 7.343669598440972, 23.689822295283356, 18.68422693104487, 19.45586939372965, 32.2396549706052, 8.851190807244134, 23.35178473324, 17.099258559548765, 19.927787909641204, 8.042088023676323, 12.706345097105016, 7.3380353730612615, 10.476036647648787, 9.59001233129553, 9.362440449651094, 8.817833515341855, 8.941676139463077, 17.093901929911937, 8.740919694172902, 9.371813677445534, 18.22146607350978, 9.834698424908236], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1783286197669641, "mean_inference_ms": 0.9476720440701438, "mean_action_processing_ms": 0.040389747361069074, "mean_env_wait_ms": 0.9342369442421473, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 288000, "timers": {"sample_time_ms": 3113.656, "sample_throughput": 3083.192, "learn_time_ms": 3288.253, "learn_throughput": 2919.484, "update_time_ms": 1.666}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.04960464116185904, "policy_loss": -0.04975560193260511, "vf_loss": 0.08583942763507366, "vf_explained_var": 0.9285964965820312, "kl": 0.01352081585675478, "entropy": -4.03037304242452, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 272, "training_iteration": 30, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-26-06", "timestamp": 1617636366, "time_this_iter_s": 6.640336751937866, "time_total_s": 180.53942227363586, "pid": 14027, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.226686239242554, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 60.239999999999995, "ram_util_percent": 60.749999999999986}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 32.2396549706052, "episode_reward_min": 7.319587608121401, "episode_reward_mean": 14.54957752484445, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.988233197478387, 18.974331956383686, 8.191297575981986, 12.228608385254644, 21.615425818619972, 7.319587608121401, 12.800815376465541, 21.670378657360427, 23.35178473324, 17.099258559548765, 19.927787909641204, 8.042088023676323, 12.706345097105016, 7.3380353730612615, 10.476036647648787, 9.59001233129553, 9.362440449651094, 8.817833515341855, 8.941676139463077, 17.093901929911937, 8.740919694172902, 9.371813677445534, 18.22146607350978, 9.834698424908236, 12.522915406880973, 17.09435423650587, 7.343669598440972, 23.689822295283356, 18.68422693104487, 19.45586939372965, 32.2396549706052, 8.851190807244134], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18450734802611424, "mean_inference_ms": 0.9858835020830838, "mean_action_processing_ms": 0.04160599775871836, "mean_env_wait_ms": 0.9560664565517789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 297600, "timers": {"sample_time_ms": 3246.334, "sample_throughput": 2957.182, "learn_time_ms": 3435.491, "learn_throughput": 2794.36, "update_time_ms": 1.705}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.035121050129334135, "policy_loss": -0.05544146875540416, "vf_loss": 0.07546841671069462, "vf_explained_var": 0.9534143805503845, "kl": 0.015094102409978707, "entropy": -4.1119160588582355, "entropy_coeff": 0.0}}, "num_steps_sampled": 297600, "num_steps_trained": 297600}, "done": false, "episodes_total": 280, "training_iteration": 31, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-26-13", "timestamp": 1617636373, "time_this_iter_s": 7.529401063919067, "time_total_s": 188.06882333755493, "pid": 14027, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.75608730316162, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 63.23636363636364, "ram_util_percent": 61.063636363636355}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 32.2396549706052, "episode_reward_min": 7.319587608121401, "episode_reward_mean": 14.764590349838548, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.336896933347543, 10.79729689038419, 17.1053011165925, 20.875842913255635, 26.026311968954126, 12.728522628539709, 21.38143585200724, 14.538217463027959, 11.666604692001215, 10.597299666059577, 9.1842203638321, 10.473397384486162, 14.769011947795105, 16.342178264747915, 14.097015762129102, 12.19430215006787, 23.35178473324, 17.099258559548765, 19.927787909641204, 8.042088023676323, 12.706345097105016, 7.3380353730612615, 10.476036647648787, 9.59001233129553, 9.362440449651094, 8.817833515341855, 8.941676139463077, 17.093901929911937, 8.740919694172902, 9.371813677445534, 18.22146607350978, 9.834698424908236, 12.522915406880973, 17.09435423650587, 7.343669598440972, 23.689822295283356, 18.68422693104487, 19.45586939372965, 32.2396549706052, 8.851190807244134, 23.988233197478387, 18.974331956383686, 8.191297575981986, 12.228608385254644, 21.615425818619972, 7.319587608121401, 12.800815376465541, 21.670378657360427], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1970832086060977, "mean_inference_ms": 1.0289871451773747, "mean_action_processing_ms": 0.04305126918626612, "mean_env_wait_ms": 0.9833753035808863, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 307200, "timers": {"sample_time_ms": 3307.92, "sample_throughput": 2902.126, "learn_time_ms": 3417.213, "learn_throughput": 2809.307, "update_time_ms": 1.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.061132703802237905, "policy_loss": -0.053717824791868526, "vf_loss": 0.10080304071307182, "vf_explained_var": 0.9520319700241089, "kl": 0.01404748806109031, "entropy": -4.155681285858154, "entropy_coeff": 0.0}}, "num_steps_sampled": 307200, "num_steps_trained": 307200}, "done": false, "episodes_total": 296, "training_iteration": 32, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-26-20", "timestamp": 1617636380, "time_this_iter_s": 6.904419898986816, "time_total_s": 194.97324323654175, "pid": 14027, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.66050720214844, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 59.69, "ram_util_percent": 61.220000000000006}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 32.2396549706052, "episode_reward_min": 7.319587608121401, "episode_reward_mean": 15.541456194623288, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.944248054659838, 18.27527593490895, 14.27996581004066, 27.84511870548193, 11.55201194006197, 14.873001100052043, 21.960014466208857, 31.891574095239562, 23.35178473324, 17.099258559548765, 19.927787909641204, 8.042088023676323, 12.706345097105016, 7.3380353730612615, 10.476036647648787, 9.59001233129553, 9.362440449651094, 8.817833515341855, 8.941676139463077, 17.093901929911937, 8.740919694172902, 9.371813677445534, 18.22146607350978, 9.834698424908236, 12.522915406880973, 17.09435423650587, 7.343669598440972, 23.689822295283356, 18.68422693104487, 19.45586939372965, 32.2396549706052, 8.851190807244134, 23.988233197478387, 18.974331956383686, 8.191297575981986, 12.228608385254644, 21.615425818619972, 7.319587608121401, 12.800815376465541, 21.670378657360427, 20.336896933347543, 10.79729689038419, 17.1053011165925, 20.875842913255635, 26.026311968954126, 12.728522628539709, 21.38143585200724, 14.538217463027959, 11.666604692001215, 10.597299666059577, 9.1842203638321, 10.473397384486162, 14.769011947795105, 16.342178264747915, 14.097015762129102, 12.19430215006787], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2006120059620265, "mean_inference_ms": 1.0423340790694982, "mean_action_processing_ms": 0.04353599699295707, "mean_env_wait_ms": 0.9927136098599517, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 316800, "timers": {"sample_time_ms": 3312.339, "sample_throughput": 2898.254, "learn_time_ms": 3370.699, "learn_throughput": 2848.074, "update_time_ms": 1.618}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.06077019618824124, "policy_loss": -0.050349394573519626, "vf_loss": 0.09803974618514379, "vf_explained_var": 0.9443432688713074, "kl": 0.013079843856394291, "entropy": -4.094834934870402, "entropy_coeff": 0.0}}, "num_steps_sampled": 316800, "num_steps_trained": 316800}, "done": false, "episodes_total": 304, "training_iteration": 33, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-26-27", "timestamp": 1617636387, "time_this_iter_s": 6.478963375091553, "time_total_s": 201.4522066116333, "pid": 14027, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.13947057723999, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 56.55555555555555, "ram_util_percent": 61.36666666666666}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 32.2396549706052, "episode_reward_min": 7.319587608121401, "episode_reward_mean": 15.952412243452278, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.740324847555366, 18.65729529659154, 28.152987015232142, 15.02943121451506, 14.207853636349599, 28.05429981441795, 17.618246871977362, 20.172397985402643, 23.35178473324, 17.099258559548765, 19.927787909641204, 8.042088023676323, 12.706345097105016, 7.3380353730612615, 10.476036647648787, 9.59001233129553, 9.362440449651094, 8.817833515341855, 8.941676139463077, 17.093901929911937, 8.740919694172902, 9.371813677445534, 18.22146607350978, 9.834698424908236, 12.522915406880973, 17.09435423650587, 7.343669598440972, 23.689822295283356, 18.68422693104487, 19.45586939372965, 32.2396549706052, 8.851190807244134, 23.988233197478387, 18.974331956383686, 8.191297575981986, 12.228608385254644, 21.615425818619972, 7.319587608121401, 12.800815376465541, 21.670378657360427, 20.336896933347543, 10.79729689038419, 17.1053011165925, 20.875842913255635, 26.026311968954126, 12.728522628539709, 21.38143585200724, 14.538217463027959, 11.666604692001215, 10.597299666059577, 9.1842203638321, 10.473397384486162, 14.769011947795105, 16.342178264747915, 14.097015762129102, 12.19430215006787, 20.944248054659838, 18.27527593490895, 14.27996581004066, 27.84511870548193, 11.55201194006197, 14.873001100052043, 21.960014466208857, 31.891574095239562], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20215939094283913, "mean_inference_ms": 1.0474571407962918, "mean_action_processing_ms": 0.043710606599004956, "mean_env_wait_ms": 0.9949554373212592, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 326400, "timers": {"sample_time_ms": 3199.047, "sample_throughput": 3000.893, "learn_time_ms": 3285.934, "learn_throughput": 2921.544, "update_time_ms": 1.627}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.023291620550056298, "policy_loss": -0.05598745641609033, "vf_loss": 0.06543734088540078, "vf_explained_var": 0.9663978219032288, "kl": 0.013841736254592736, "entropy": -4.143422819773356, "entropy_coeff": 0.0}}, "num_steps_sampled": 326400, "num_steps_trained": 326400}, "done": false, "episodes_total": 312, "training_iteration": 34, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-26-32", "timestamp": 1617636392, "time_this_iter_s": 5.302746772766113, "time_total_s": 206.7549533843994, "pid": 14027, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.4422173500061, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.7375, "ram_util_percent": 61.662499999999994}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 34.28442634458757, "episode_reward_min": 7.319587608121401, "episode_reward_mean": 16.604670905141404, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.28442634458757, 21.074195897119488, 18.87581411978654, 23.26105397755516, 25.242637336835166, 15.79798913562811, 15.57727014926947, 20.468534628453693, 23.35178473324, 17.099258559548765, 19.927787909641204, 8.042088023676323, 12.706345097105016, 7.3380353730612615, 10.476036647648787, 9.59001233129553, 9.362440449651094, 8.817833515341855, 8.941676139463077, 17.093901929911937, 8.740919694172902, 9.371813677445534, 18.22146607350978, 9.834698424908236, 12.522915406880973, 17.09435423650587, 7.343669598440972, 23.689822295283356, 18.68422693104487, 19.45586939372965, 32.2396549706052, 8.851190807244134, 23.988233197478387, 18.974331956383686, 8.191297575981986, 12.228608385254644, 21.615425818619972, 7.319587608121401, 12.800815376465541, 21.670378657360427, 20.336896933347543, 10.79729689038419, 17.1053011165925, 20.875842913255635, 26.026311968954126, 12.728522628539709, 21.38143585200724, 14.538217463027959, 11.666604692001215, 10.597299666059577, 9.1842203638321, 10.473397384486162, 14.769011947795105, 16.342178264747915, 14.097015762129102, 12.19430215006787, 20.944248054659838, 18.27527593490895, 14.27996581004066, 27.84511870548193, 11.55201194006197, 14.873001100052043, 21.960014466208857, 31.891574095239562, 8.740324847555366, 18.65729529659154, 28.152987015232142, 15.02943121451506, 14.207853636349599, 28.05429981441795, 17.618246871977362, 20.172397985402643], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20265360846254343, "mean_inference_ms": 1.0484053442985133, "mean_action_processing_ms": 0.043726817987023395, "mean_env_wait_ms": 0.9937460508822645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 336000, "timers": {"sample_time_ms": 3112.869, "sample_throughput": 3083.972, "learn_time_ms": 3243.437, "learn_throughput": 2959.823, "update_time_ms": 1.643}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.04787037170181672, "policy_loss": -0.052219333555549384, "vf_loss": 0.08638369873166084, "vf_explained_var": 0.9595692753791809, "kl": 0.013706008630494277, "entropy": -4.099050108591715, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 320, "training_iteration": 35, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-26-37", "timestamp": 1617636397, "time_this_iter_s": 5.462350130081177, "time_total_s": 212.2173035144806, "pid": 14027, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.90456748008728, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.87142857142857, "ram_util_percent": 61.58571428571429}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 37.6866357274358, "episode_reward_min": 15.308328288619741, "episode_reward_mean": 25.841533614645687, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.9007719661698, 36.26941268984726, 20.55659555120403, 15.308328288619741, 19.11025969219336, 25.123648406553812, 37.6866357274358, 20.776616595141707], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21121498944856643, "mean_inference_ms": 1.0584503238544576, "mean_action_processing_ms": 0.04491495351608746, "mean_env_wait_ms": 1.0468581634000578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 345600, "timers": {"sample_time_ms": 3346.22, "sample_throughput": 2868.909, "learn_time_ms": 3442.298, "learn_throughput": 2788.834, "update_time_ms": 1.42}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.10378917535146077, "policy_loss": -0.05018677320331335, "vf_loss": 0.14220078219970067, "vf_explained_var": 0.9469568729400635, "kl": 0.01177516592045625, "entropy": -4.121248871485392, "entropy_coeff": 0.0}}, "num_steps_sampled": 345600, "num_steps_trained": 345600}, "done": false, "episodes_total": 328, "training_iteration": 36, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-26-50", "timestamp": 1617636410, "time_this_iter_s": 6.7931623458862305, "time_total_s": 219.01046586036682, "pid": 14893, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.7931623458862305, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.69999999999999, "ram_util_percent": 61.580000000000005}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 41.117814561010725, "episode_reward_min": 10.8569591499067, "episode_reward_mean": 25.5426771667109, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.117814561010725, 15.407372952531588, 28.184859950887994, 32.48984027220172, 10.8569591499067, 23.804819687865397, 13.48169364801878, 36.60720552778599, 31.9007719661698, 36.26941268984726, 20.55659555120403, 15.308328288619741, 19.11025969219336, 25.123648406553812, 37.6866357274358, 20.776616595141707], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21421693231923913, "mean_inference_ms": 1.08597871228353, "mean_action_processing_ms": 0.045836548417511586, "mean_env_wait_ms": 1.0616571249150484, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 355200, "timers": {"sample_time_ms": 3379.353, "sample_throughput": 2840.781, "learn_time_ms": 3464.836, "learn_throughput": 2770.694, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.12608628774682681, "policy_loss": -0.04704524543136358, "vf_loss": 0.159360894660155, "vf_explained_var": 0.9493210911750793, "kl": 0.013770637127260368, "entropy": -4.183196099599202, "entropy_coeff": 0.0}}, "num_steps_sampled": 355200, "num_steps_trained": 355200}, "done": false, "episodes_total": 336, "training_iteration": 37, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-26-57", "timestamp": 1617636417, "time_this_iter_s": 6.90692925453186, "time_total_s": 225.91739511489868, "pid": 14893, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.70009160041809, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 60.67, "ram_util_percent": 61.75999999999999}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 47.95995569088027, "episode_reward_min": 9.98396751345772, "episode_reward_mean": 26.448378830629043, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.725420594200596, 40.364228569053026, 16.75335952178638, 37.01308635637309, 26.722413742471673, 23.555825279499903, 47.95995569088027, 9.98396751345772, 31.9007719661698, 36.26941268984726, 20.55659555120403, 15.308328288619741, 19.11025969219336, 25.123648406553812, 37.6866357274358, 20.776616595141707, 41.117814561010725, 15.407372952531588, 28.184859950887994, 32.48984027220172, 10.8569591499067, 23.804819687865397, 13.48169364801878, 36.60720552778599], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21646063397642554, "mean_inference_ms": 1.100742621476159, "mean_action_processing_ms": 0.04636234252213919, "mean_env_wait_ms": 1.0697481152923942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 364800, "timers": {"sample_time_ms": 3372.022, "sample_throughput": 2846.957, "learn_time_ms": 3477.122, "learn_throughput": 2760.904, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.16320205522080264, "policy_loss": -0.049472415366520486, "vf_loss": 0.19738221635421116, "vf_explained_var": 0.9456921219825745, "kl": 0.0152922523021698, "entropy": -4.161415646870931, "entropy_coeff": 0.0}}, "num_steps_sampled": 364800, "num_steps_trained": 364800}, "done": false, "episodes_total": 344, "training_iteration": 38, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-04", "timestamp": 1617636424, "time_this_iter_s": 6.865768194198608, "time_total_s": 232.7831633090973, "pid": 14893, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.5658597946167, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 61.25999999999999, "ram_util_percent": 62.16000000000001}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 47.95995569088027, "episode_reward_min": 9.98396751345772, "episode_reward_mean": 26.068554041186292, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.26894051429289, 23.344849484426387, 23.259566869742073, 29.371718929762263, 17.085638747562832, 20.270479031897263, 12.131227483650829, 32.700216321529695, 31.9007719661698, 36.26941268984726, 20.55659555120403, 15.308328288619741, 19.11025969219336, 25.123648406553812, 37.6866357274358, 20.776616595141707, 41.117814561010725, 15.407372952531588, 28.184859950887994, 32.48984027220172, 10.8569591499067, 23.804819687865397, 13.48169364801878, 36.60720552778599, 23.725420594200596, 40.364228569053026, 16.75335952178638, 37.01308635637309, 26.722413742471673, 23.555825279499903, 47.95995569088027, 9.98396751345772], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21707153253642125, "mean_inference_ms": 1.1178155139150463, "mean_action_processing_ms": 0.046639785327751475, "mean_env_wait_ms": 1.0733965181587926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 374400, "timers": {"sample_time_ms": 3405.418, "sample_throughput": 2819.037, "learn_time_ms": 3467.857, "learn_throughput": 2768.28, "update_time_ms": 1.695}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.10897811124722163, "policy_loss": -0.051994555791219074, "vf_loss": 0.1454990221063296, "vf_explained_var": 0.9679126739501953, "kl": 0.015473643938700357, "entropy": -4.205563500722249, "entropy_coeff": 0.0}}, "num_steps_sampled": 374400, "num_steps_trained": 374400}, "done": false, "episodes_total": 352, "training_iteration": 39, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-11", "timestamp": 1617636431, "time_this_iter_s": 6.952529668807983, "time_total_s": 239.73569297790527, "pid": 14893, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.518389463424683, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 58.830000000000005, "ram_util_percent": 62.29}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 59.23164678792239, "episode_reward_min": 9.98396751345772, "episode_reward_mean": 27.452431160301376, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.705314629084658, 26.64729985569824, 17.367013989746354, 29.3318288142878, 27.200221216117583, 59.23164678792239, 10.827491290909528, 30.67942948918372, 27.067352512442277, 42.256556269090105, 36.190830685935204, 26.537338129465926, 29.54590319373403, 19.052624695598603, 30.14402987429913, 40.738084942989104, 31.9007719661698, 36.26941268984726, 20.55659555120403, 15.308328288619741, 19.11025969219336, 25.123648406553812, 37.6866357274358, 20.776616595141707, 41.117814561010725, 15.407372952531588, 28.184859950887994, 32.48984027220172, 10.8569591499067, 23.804819687865397, 13.48169364801878, 36.60720552778599, 23.725420594200596, 40.364228569053026, 16.75335952178638, 37.01308635637309, 26.722413742471673, 23.555825279499903, 47.95995569088027, 9.98396751345772, 41.26894051429289, 23.344849484426387, 23.259566869742073, 29.371718929762263, 17.085638747562832, 20.270479031897263, 12.131227483650829, 32.700216321529695], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21726192344260853, "mean_inference_ms": 1.1128393280127211, "mean_action_processing_ms": 0.04606743604996983, "mean_env_wait_ms": 1.0550287870516832, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 384000, "timers": {"sample_time_ms": 3215.915, "sample_throughput": 2985.154, "learn_time_ms": 3327.524, "learn_throughput": 2885.028, "update_time_ms": 1.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.29254991392294566, "policy_loss": -0.04951488436510165, "vf_loss": 0.3266153476635615, "vf_explained_var": 0.9510624408721924, "kl": 0.015449454163511595, "entropy": -4.289969285329183, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 368, "training_iteration": 40, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-16", "timestamp": 1617636436, "time_this_iter_s": 5.230212450027466, "time_total_s": 244.96590542793274, "pid": 14893, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.74860191345215, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.585714285714285, "ram_util_percent": 62.642857142857146}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 59.23164678792239, "episode_reward_min": 9.98396751345772, "episode_reward_mean": 27.695140209060302, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.68638042783276, 37.18163524797597, 24.609540875548486, 23.74397838266118, 38.311459531189314, 28.306947575378413, 32.89436263803684, 30.476851334288053, 31.9007719661698, 36.26941268984726, 20.55659555120403, 15.308328288619741, 19.11025969219336, 25.123648406553812, 37.6866357274358, 20.776616595141707, 41.117814561010725, 15.407372952531588, 28.184859950887994, 32.48984027220172, 10.8569591499067, 23.804819687865397, 13.48169364801878, 36.60720552778599, 23.725420594200596, 40.364228569053026, 16.75335952178638, 37.01308635637309, 26.722413742471673, 23.555825279499903, 47.95995569088027, 9.98396751345772, 41.26894051429289, 23.344849484426387, 23.259566869742073, 29.371718929762263, 17.085638747562832, 20.270479031897263, 12.131227483650829, 32.700216321529695, 30.705314629084658, 26.64729985569824, 17.367013989746354, 29.3318288142878, 27.200221216117583, 59.23164678792239, 10.827491290909528, 30.67942948918372, 27.067352512442277, 42.256556269090105, 36.190830685935204, 26.537338129465926, 29.54590319373403, 19.052624695598603, 30.14402987429913, 40.738084942989104], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21600405150455762, "mean_inference_ms": 1.1055619547305617, "mean_action_processing_ms": 0.04568949300396747, "mean_env_wait_ms": 1.0442237503656637, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 393600, "timers": {"sample_time_ms": 3101.086, "sample_throughput": 3095.689, "learn_time_ms": 3258.449, "learn_throughput": 2946.187, "update_time_ms": 1.682}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.07856238171147803, "policy_loss": -0.05122027429441611, "vf_loss": 0.11638293315966924, "vf_explained_var": 0.9779118895530701, "kl": 0.013399723097681998, "entropy": -4.190729242960612, "entropy_coeff": 0.0}}, "num_steps_sampled": 393600, "num_steps_trained": 393600}, "done": false, "episodes_total": 376, "training_iteration": 41, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-22", "timestamp": 1617636442, "time_this_iter_s": 5.4478759765625, "time_total_s": 250.41378140449524, "pid": 14893, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.19647789001465, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.137500000000003, "ram_util_percent": 62.7625}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 59.23164678792239, "episode_reward_min": 9.98396751345772, "episode_reward_mean": 26.89029901589481, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.564420294959007, 26.989299377443785, 15.511916649303728, 15.26004333829216, 17.723896244493684, 31.521033845849253, 19.944362278985047, 24.536313280564116, 31.9007719661698, 36.26941268984726, 20.55659555120403, 15.308328288619741, 19.11025969219336, 25.123648406553812, 37.6866357274358, 20.776616595141707, 41.117814561010725, 15.407372952531588, 28.184859950887994, 32.48984027220172, 10.8569591499067, 23.804819687865397, 13.48169364801878, 36.60720552778599, 23.725420594200596, 40.364228569053026, 16.75335952178638, 37.01308635637309, 26.722413742471673, 23.555825279499903, 47.95995569088027, 9.98396751345772, 41.26894051429289, 23.344849484426387, 23.259566869742073, 29.371718929762263, 17.085638747562832, 20.270479031897263, 12.131227483650829, 32.700216321529695, 30.705314629084658, 26.64729985569824, 17.367013989746354, 29.3318288142878, 27.200221216117583, 59.23164678792239, 10.827491290909528, 30.67942948918372, 27.067352512442277, 42.256556269090105, 36.190830685935204, 26.537338129465926, 29.54590319373403, 19.052624695598603, 30.14402987429913, 40.738084942989104, 17.68638042783276, 37.18163524797597, 24.609540875548486, 23.74397838266118, 38.311459531189314, 28.306947575378413, 32.89436263803684, 30.476851334288053], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21411641429135297, "mean_inference_ms": 1.0959439915775024, "mean_action_processing_ms": 0.045249486170033174, "mean_env_wait_ms": 1.0321430672249827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 403200, "timers": {"sample_time_ms": 3005.407, "sample_throughput": 3194.243, "learn_time_ms": 3194.447, "learn_throughput": 3005.215, "update_time_ms": 1.664}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.06726062208414078, "policy_loss": -0.051481929228951534, "vf_loss": 0.10517431110143662, "vf_explained_var": 0.979630708694458, "kl": 0.013568240677316984, "entropy": -4.282645696004232, "entropy_coeff": 0.0}}, "num_steps_sampled": 403200, "num_steps_trained": 403200}, "done": false, "episodes_total": 384, "training_iteration": 42, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-27", "timestamp": 1617636447, "time_this_iter_s": 5.2479307651519775, "time_total_s": 255.66171216964722, "pid": 14893, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.444408655166626, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.5, "ram_util_percent": 62.775}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 59.23164678792239, "episode_reward_min": 9.98396751345772, "episode_reward_mean": 27.321029096134442, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.16745663372221, 29.45215986190709, 40.47185144159046, 23.875784750988768, 27.011699335037072, 30.465952673000874, 36.878106463218586, 36.81194674494695, 31.9007719661698, 36.26941268984726, 20.55659555120403, 15.308328288619741, 19.11025969219336, 25.123648406553812, 37.6866357274358, 20.776616595141707, 41.117814561010725, 15.407372952531588, 28.184859950887994, 32.48984027220172, 10.8569591499067, 23.804819687865397, 13.48169364801878, 36.60720552778599, 23.725420594200596, 40.364228569053026, 16.75335952178638, 37.01308635637309, 26.722413742471673, 23.555825279499903, 47.95995569088027, 9.98396751345772, 41.26894051429289, 23.344849484426387, 23.259566869742073, 29.371718929762263, 17.085638747562832, 20.270479031897263, 12.131227483650829, 32.700216321529695, 30.705314629084658, 26.64729985569824, 17.367013989746354, 29.3318288142878, 27.200221216117583, 59.23164678792239, 10.827491290909528, 30.67942948918372, 27.067352512442277, 42.256556269090105, 36.190830685935204, 26.537338129465926, 29.54590319373403, 19.052624695598603, 30.14402987429913, 40.738084942989104, 17.68638042783276, 37.18163524797597, 24.609540875548486, 23.74397838266118, 38.311459531189314, 28.306947575378413, 32.89436263803684, 30.476851334288053, 18.564420294959007, 26.989299377443785, 15.511916649303728, 15.26004333829216, 17.723896244493684, 31.521033845849253, 19.944362278985047, 24.536313280564116], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21202660465737277, "mean_inference_ms": 1.0856108584639286, "mean_action_processing_ms": 0.044799632802267425, "mean_env_wait_ms": 1.0199911919607831, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 412800, "timers": {"sample_time_ms": 2916.225, "sample_throughput": 3291.927, "learn_time_ms": 3235.302, "learn_throughput": 2967.265, "update_time_ms": 1.903}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.09330318264663219, "policy_loss": -0.05058592886974414, "vf_loss": 0.12952768057584763, "vf_explained_var": 0.975969135761261, "kl": 0.01436143010854721, "entropy": -4.238805402119954, "entropy_coeff": 0.0}}, "num_steps_sampled": 412800, "num_steps_trained": 412800}, "done": false, "episodes_total": 392, "training_iteration": 43, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-33", "timestamp": 1617636453, "time_this_iter_s": 5.8258655071258545, "time_total_s": 261.48757767677307, "pid": 14893, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.27027416229248, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 38.087500000000006, "ram_util_percent": 59.212500000000006}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 64.94634936367711, "episode_reward_min": 9.98396751345772, "episode_reward_mean": 28.375394718519964, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.927445927775675, 35.51950819258475, 23.987716394366387, 34.8795214409403, 41.339528857328226, 64.94634936367711, 36.01136524430798, 36.30604713893728, 31.9007719661698, 36.26941268984726, 20.55659555120403, 15.308328288619741, 19.11025969219336, 25.123648406553812, 37.6866357274358, 20.776616595141707, 41.117814561010725, 15.407372952531588, 28.184859950887994, 32.48984027220172, 10.8569591499067, 23.804819687865397, 13.48169364801878, 36.60720552778599, 23.725420594200596, 40.364228569053026, 16.75335952178638, 37.01308635637309, 26.722413742471673, 23.555825279499903, 47.95995569088027, 9.98396751345772, 41.26894051429289, 23.344849484426387, 23.259566869742073, 29.371718929762263, 17.085638747562832, 20.270479031897263, 12.131227483650829, 32.700216321529695, 30.705314629084658, 26.64729985569824, 17.367013989746354, 29.3318288142878, 27.200221216117583, 59.23164678792239, 10.827491290909528, 30.67942948918372, 27.067352512442277, 42.256556269090105, 36.190830685935204, 26.537338129465926, 29.54590319373403, 19.052624695598603, 30.14402987429913, 40.738084942989104, 17.68638042783276, 37.18163524797597, 24.609540875548486, 23.74397838266118, 38.311459531189314, 28.306947575378413, 32.89436263803684, 30.476851334288053, 18.564420294959007, 26.989299377443785, 15.511916649303728, 15.26004333829216, 17.723896244493684, 31.521033845849253, 19.944362278985047, 24.536313280564116, 21.16745663372221, 29.45215986190709, 40.47185144159046, 23.875784750988768, 27.011699335037072, 30.465952673000874, 36.878106463218586, 36.81194674494695], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21106353433327874, "mean_inference_ms": 1.0808691423354673, "mean_action_processing_ms": 0.044594671810435214, "mean_env_wait_ms": 1.0140142893790742, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 422400, "timers": {"sample_time_ms": 3007.269, "sample_throughput": 3192.265, "learn_time_ms": 3313.492, "learn_throughput": 2897.246, "update_time_ms": 1.874}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.2636654142042001, "policy_loss": -0.04746364916364352, "vf_loss": 0.2974923006693522, "vf_explained_var": 0.9597873687744141, "kl": 0.013636765343447526, "entropy": -4.309310499827067, "entropy_coeff": 0.0}}, "num_steps_sampled": 422400, "num_steps_trained": 422400}, "done": false, "episodes_total": 400, "training_iteration": 44, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-41", "timestamp": 1617636461, "time_this_iter_s": 7.681869745254517, "time_total_s": 269.1694474220276, "pid": 14893, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 56.952143907547, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 75.23636363636363, "ram_util_percent": 61.354545454545466}, "trial_id": "1bd20_00003"}
{"episode_reward_max": 70.57865522091944, "episode_reward_min": 23.488211402344103, "episode_reward_mean": 45.61331534215083, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.45156521746268, 23.488211402344103, 70.57865522091944, 64.15159064792236, 45.64572396527264, 58.206907979951495, 31.245711302534147, 26.1381570007998], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19254585686174658, "mean_inference_ms": 1.0022663951019362, "mean_action_processing_ms": 0.04253580508680764, "mean_env_wait_ms": 0.9956512969300509, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 432000, "timers": {"sample_time_ms": 3018.351, "sample_throughput": 3180.545, "learn_time_ms": 2968.262, "learn_throughput": 3234.216, "update_time_ms": 1.676}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00025671318726952605, "total_loss": 0.4237913151582082, "policy_loss": -0.03995191711932421, "vf_loss": 0.4502826122442881, "vf_explained_var": 0.9498499631881714, "kl": 0.013460620443026225, "entropy": -4.306922925313314, "entropy_coeff": 0.0}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": true, "episodes_total": 408, "training_iteration": 45, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-51", "timestamp": 1617636591, "time_this_iter_s": 5.992961406707764, "time_total_s": 275.16240882873535, "pid": 17560, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9201, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0002567131872695261, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9503748141625459, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2688127746126917, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.992961406707764, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.211111111111116, "ram_util_percent": 60.955555555555556}, "trial_id": "1bd20_00003"}
