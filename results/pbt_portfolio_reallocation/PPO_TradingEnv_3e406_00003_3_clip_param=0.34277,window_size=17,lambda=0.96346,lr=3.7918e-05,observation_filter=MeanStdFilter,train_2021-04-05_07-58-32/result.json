{"episode_reward_max": 0.07962919399599988, "episode_reward_min": -0.6579787343747405, "episode_reward_mean": -0.29640831209570834, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.10905071183970327, 0.029006100120898326, -0.6360752767101009, 0.020139767442187484, -0.3749263913483737, -0.27317878670959894, -0.6154352972215053, -0.5268686344573871, 0.07962919399599988, -0.03786571005873118, -0.5242891365368607, -0.002946253771279106, -0.31003778230312784, -0.6579787343747405, -0.3348582159462232, -0.46779712381278726], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17947414571255366, "mean_inference_ms": 0.9808651487078404, "mean_action_processing_ms": 0.04154818418254214, "mean_env_wait_ms": 0.9204941797788122, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 20800, "timers": {"sample_time_ms": 6480.189, "sample_throughput": 3209.783, "learn_time_ms": 5256.289, "learn_throughput": 3957.164, "update_time_ms": 1.698}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.005113031472325142, "policy_loss": -0.011746089194152801, "vf_loss": 0.0044980076558750835, "vf_explained_var": 0.561781644821167, "kl": 0.0021350499788196356, "entropy": -3.244761839966101, "entropy_coeff": 0.0}}, "num_steps_sampled": 20800, "num_steps_trained": 20800}, "done": false, "episodes_total": 16, "training_iteration": 1, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_07-58-51", "timestamp": 1617634731, "time_this_iter_s": 11.741315126419067, "time_total_s": 11.741315126419067, "pid": 4796, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.741315126419067, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 50.79411764705883, "ram_util_percent": 59.94705882352941}, "trial_id": "3e406_00003"}
{"episode_reward_max": 0.6885470202661155, "episode_reward_min": -0.6579787343747405, "episode_reward_mean": -0.17920110360631486, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6071234090828348, -0.29415650266983195, 0.1718900920419768, -0.48880208664259706, -0.2555884386269721, -0.08225945130553658, -0.45304906411335477, 0.1398627764558653, -0.1456359429608588, 0.6885470202661155, -0.6103474575405647, -0.12875532724724004, -0.2804928077396861, 0.4593763206375552, -0.22189550958312088, 0.36358924238408896, -0.6353706172644138, -0.39449256322810705, 0.3680238824720272, 0.2812537034042868, 0.005539094690500512, -0.5797527675107174, 0.26357080352038476, 0.010557858921774521, -0.10905071183970327, 0.029006100120898326, -0.6360752767101009, 0.020139767442187484, -0.3749263913483737, -0.27317878670959894, -0.6154352972215053, -0.5268686344573871, 0.07962919399599988, -0.03786571005873118, -0.5242891365368607, -0.002946253771279106, -0.31003778230312784, -0.6579787343747405, -0.3348582159462232, -0.46779712381278726], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18453917040130383, "mean_inference_ms": 0.9683696040671379, "mean_action_processing_ms": 0.04095838055310656, "mean_env_wait_ms": 0.8999698560909414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 41600, "timers": {"sample_time_ms": 6193.846, "sample_throughput": 3358.172, "learn_time_ms": 5299.351, "learn_throughput": 3925.009, "update_time_ms": 1.546}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.005749606881633493, "policy_loss": -0.012802721246894152, "vf_loss": 0.00445333690856772, "vf_explained_var": 0.7127388715744019, "kl": 0.005199554804826807, "entropy": -3.261796461292571, "entropy_coeff": 0.0}}, "num_steps_sampled": 41600, "num_steps_trained": 41600}, "done": false, "episodes_total": 40, "training_iteration": 2, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_07-59-02", "timestamp": 1617634742, "time_this_iter_s": 11.258893966674805, "time_total_s": 23.000209093093872, "pid": 4796, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.000209093093872, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.58125, "ram_util_percent": 60.150000000000006}, "trial_id": "3e406_00003"}
{"episode_reward_max": 0.6885470202661155, "episode_reward_min": -0.6579787343747405, "episode_reward_mean": -0.18204970905318035, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2798889974225981, -0.0034691112087689158, 0.02273261287056605, -0.5411300168843718, -0.07569190712330387, -0.17404671068656996, 0.4794399496969024, -0.4710210131889477, -0.3698735234146404, -0.17889670986003703, -0.042289352418788506, -0.14697875908308533, -0.5007626649672852, -0.3312601864694713, -0.13628566234163764, -0.27731751022346807, -0.10905071183970327, 0.029006100120898326, -0.6360752767101009, 0.020139767442187484, -0.3749263913483737, -0.27317878670959894, -0.6154352972215053, -0.5268686344573871, 0.07962919399599988, -0.03786571005873118, -0.5242891365368607, -0.002946253771279106, -0.31003778230312784, -0.6579787343747405, -0.3348582159462232, -0.46779712381278726, -0.6071234090828348, -0.29415650266983195, 0.1718900920419768, -0.48880208664259706, -0.2555884386269721, -0.08225945130553658, -0.45304906411335477, 0.1398627764558653, -0.1456359429608588, 0.6885470202661155, -0.6103474575405647, -0.12875532724724004, -0.2804928077396861, 0.4593763206375552, -0.22189550958312088, 0.36358924238408896, -0.6353706172644138, -0.39449256322810705, 0.3680238824720272, 0.2812537034042868, 0.005539094690500512, -0.5797527675107174, 0.26357080352038476, 0.010557858921774521], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18485311775403293, "mean_inference_ms": 0.9697524336485207, "mean_action_processing_ms": 0.04097018550043021, "mean_env_wait_ms": 0.8982694354433631, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 62400, "timers": {"sample_time_ms": 6211.977, "sample_throughput": 3348.371, "learn_time_ms": 5249.223, "learn_throughput": 3962.492, "update_time_ms": 1.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.008014591639301528, "policy_loss": -0.012916061315868347, "vf_loss": 0.0027030086283360614, "vf_explained_var": 0.8516106009483337, "kl": 0.004396921729360438, "entropy": -3.266684353717266, "entropy_coeff": 0.0}}, "num_steps_sampled": 62400, "num_steps_trained": 62400}, "done": false, "episodes_total": 56, "training_iteration": 3, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_07-59-13", "timestamp": 1617634753, "time_this_iter_s": 11.405735492706299, "time_total_s": 34.40594458580017, "pid": 4796, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.40594458580017, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.87058823529412, "ram_util_percent": 60.247058823529414}, "trial_id": "3e406_00003"}
{"episode_reward_max": 0.7121298870476478, "episode_reward_min": -0.6579787343747405, "episode_reward_mean": -0.16675206648134328, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5550041508336782, -0.3762042262348528, -0.20389642122417173, -0.08454968762986281, 0.08583817165014795, 0.10901618861061246, -0.371666530271761, -0.18177710971867223, -0.21223144424244178, 0.007461916362152987, -0.47887391376002036, -0.2569374254423682, -0.04647570370902343, -0.380800401480609, -0.48128332829672926, -0.16402249668470292, 0.6171128808789679, 0.38944719664422944, -0.07279910128099709, 0.7121298870476478, -0.2387854480288999, -0.3626359456694218, -0.1992175372095566, -0.3992269810053525, -0.10905071183970327, 0.029006100120898326, -0.6360752767101009, 0.020139767442187484, -0.3749263913483737, -0.27317878670959894, -0.6154352972215053, -0.5268686344573871, 0.07962919399599988, -0.03786571005873118, -0.5242891365368607, -0.002946253771279106, -0.31003778230312784, -0.6579787343747405, -0.3348582159462232, -0.46779712381278726, -0.6071234090828348, -0.29415650266983195, 0.1718900920419768, -0.48880208664259706, -0.2555884386269721, -0.08225945130553658, -0.45304906411335477, 0.1398627764558653, -0.1456359429608588, 0.6885470202661155, -0.6103474575405647, -0.12875532724724004, -0.2804928077396861, 0.4593763206375552, -0.22189550958312088, 0.36358924238408896, -0.6353706172644138, -0.39449256322810705, 0.3680238824720272, 0.2812537034042868, 0.005539094690500512, -0.5797527675107174, 0.26357080352038476, 0.010557858921774521, -0.2798889974225981, -0.0034691112087689158, 0.02273261287056605, -0.5411300168843718, -0.07569190712330387, -0.17404671068656996, 0.4794399496969024, -0.4710210131889477, -0.3698735234146404, -0.17889670986003703, -0.042289352418788506, -0.14697875908308533, -0.5007626649672852, -0.3312601864694713, -0.13628566234163764, -0.27731751022346807], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1867358277780788, "mean_inference_ms": 0.9711344995907456, "mean_action_processing_ms": 0.04099844975248408, "mean_env_wait_ms": 0.8968130533789751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 83200, "timers": {"sample_time_ms": 6224.471, "sample_throughput": 3341.65, "learn_time_ms": 5259.741, "learn_throughput": 3954.567, "update_time_ms": 1.548}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.010310235347575936, "policy_loss": -0.016463054961130662, "vf_loss": 0.003375484695246706, "vf_explained_var": 0.8595843315124512, "kl": 0.011109341313045449, "entropy": -3.2840086331396745, "entropy_coeff": 0.0}}, "num_steps_sampled": 83200, "num_steps_trained": 83200}, "done": false, "episodes_total": 80, "training_iteration": 4, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_07-59-25", "timestamp": 1617634765, "time_this_iter_s": 11.561230182647705, "time_total_s": 45.967174768447876, "pid": 4796, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.967174768447876, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.425, "ram_util_percent": 60.225}, "trial_id": "3e406_00003"}
{"episode_reward_max": 1.0378176022557422, "episode_reward_min": -0.6579787343747405, "episode_reward_mean": -0.11610041139457156, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6431338801504212, -0.33397443090949075, 0.2276602346943013, -0.22231293850106415, 0.49984185887945776, 0.8442066775072619, -0.2934091248892756, 0.0663013258335936, 0.05445649871452973, -0.17810878869322033, 1.0378176022557422, 0.027142838850053863, -0.18657463989779477, -0.5146126907044848, 0.20473619567822832, -0.4152832300883039, 0.13705044951108225, 0.2522770904896465, -0.2142080026132286, -0.07719332448280947, -0.26970747273649764, -0.3764567359864451, 0.2242122506228159, -0.10285146562093361, -0.3749263913483737, -0.27317878670959894, -0.6154352972215053, -0.5268686344573871, 0.07962919399599988, -0.03786571005873118, -0.5242891365368607, -0.002946253771279106, -0.31003778230312784, -0.6579787343747405, -0.3348582159462232, -0.46779712381278726, -0.6071234090828348, -0.29415650266983195, 0.1718900920419768, -0.48880208664259706, -0.2555884386269721, -0.08225945130553658, -0.45304906411335477, 0.1398627764558653, -0.1456359429608588, 0.6885470202661155, -0.6103474575405647, -0.12875532724724004, -0.2804928077396861, 0.4593763206375552, -0.22189550958312088, 0.36358924238408896, -0.6353706172644138, -0.39449256322810705, 0.3680238824720272, 0.2812537034042868, 0.005539094690500512, -0.5797527675107174, 0.26357080352038476, 0.010557858921774521, -0.2798889974225981, -0.0034691112087689158, 0.02273261287056605, -0.5411300168843718, -0.07569190712330387, -0.17404671068656996, 0.4794399496969024, -0.4710210131889477, -0.3698735234146404, -0.17889670986003703, -0.042289352418788506, -0.14697875908308533, -0.5007626649672852, -0.3312601864694713, -0.13628566234163764, -0.27731751022346807, -0.5550041508336782, -0.3762042262348528, -0.20389642122417173, -0.08454968762986281, 0.08583817165014795, 0.10901618861061246, -0.371666530271761, -0.18177710971867223, -0.21223144424244178, 0.007461916362152987, -0.47887391376002036, -0.2569374254423682, -0.04647570370902343, -0.380800401480609, -0.48128332829672926, -0.16402249668470292, 0.6171128808789679, 0.38944719664422944, -0.07279910128099709, 0.7121298870476478, -0.2387854480288999, -0.3626359456694218, -0.1992175372095566, -0.3992269810053525], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18826508078529777, "mean_inference_ms": 0.9706745653629606, "mean_action_processing_ms": 0.040863392686919825, "mean_env_wait_ms": 0.8905171089913807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 104000, "timers": {"sample_time_ms": 6118.079, "sample_throughput": 3399.76, "learn_time_ms": 5344.367, "learn_throughput": 3891.948, "update_time_ms": 1.528}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.010259688869004418, "policy_loss": -0.017257501991134298, "vf_loss": 0.00432126916390758, "vf_explained_var": 0.8447961807250977, "kl": 0.010706179535324954, "entropy": -3.301115612310866, "entropy_coeff": 0.0}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 104, "training_iteration": 5, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_07-59-36", "timestamp": 1617634776, "time_this_iter_s": 11.383214235305786, "time_total_s": 57.35038900375366, "pid": 4796, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 57.35038900375366, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.6875, "ram_util_percent": 58.1}, "trial_id": "3e406_00003"}
{"episode_reward_max": 1.6419660096709676, "episode_reward_min": -0.33301447808786955, "episode_reward_mean": 0.5412028989515107, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.41648481156042294, 0.919899866978017, 0.3878570989941106, -0.012025980958164428, 0.5637083326482892, 0.050981065213117516, 0.7568952542777385, 1.2945593957686627, 0.6660972461633676, -0.017175686817280877, 0.9057302497616913, -0.33301447808786955, 0.8206731596022769, 1.6419660096709676, 0.3512638481275123, 0.24534619032131255], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18832937702221486, "mean_inference_ms": 0.9918269378687042, "mean_action_processing_ms": 0.04223773957032142, "mean_env_wait_ms": 0.9407010251675509, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 124800, "timers": {"sample_time_ms": 6694.253, "sample_throughput": 3107.143, "learn_time_ms": 6251.678, "learn_throughput": 3327.107, "update_time_ms": 1.498}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.005764408042780095, "policy_loss": -0.013179176395610432, "vf_loss": 0.004478031115183618, "vf_explained_var": 0.873810350894928, "kl": 0.0029367372062217238, "entropy": -3.322748296831283, "entropy_coeff": 0.0}}, "num_steps_sampled": 124800, "num_steps_trained": 124800}, "done": false, "episodes_total": 120, "training_iteration": 6, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_08-00-56", "timestamp": 1617634856, "time_this_iter_s": 12.95271110534668, "time_total_s": 70.30310010910034, "pid": 5707, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.95271110534668, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.473684210526315, "ram_util_percent": 60.10526315789474}, "trial_id": "3e406_00003"}
{"episode_reward_max": 1.6419660096709676, "episode_reward_min": -0.33301447808786955, "episode_reward_mean": 0.5205500929430164, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.3744973368976567, -0.2723311468859251, 0.5487426161158047, 0.22342472847148476, 0.7474667829415433, 1.5551020884621445, 0.32487668569086114, 0.1791610550273932, 0.5333305354940439, 0.007337614313194685, 0.254285313988591, 0.926888502063973, 0.7259039010371748, 1.0021846426148908, -0.023765432133550424, 0.326670763615478, 1.0179939102857145, -0.08568851351214346, 0.557050021970716, -0.0735221135725519, 0.5765347405699428, 0.5327801269625196, 1.2156729804744857, -0.011839806396960584, 0.41648481156042294, 0.919899866978017, 0.3878570989941106, -0.012025980958164428, 0.5637083326482892, 0.050981065213117516, 0.7568952542777385, 1.2945593957686627, 0.6660972461633676, -0.017175686817280877, 0.9057302497616913, -0.33301447808786955, 0.8206731596022769, 1.6419660096709676, 0.3512638481275123, 0.24534619032131255], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1934599558146982, "mean_inference_ms": 0.9875855483232645, "mean_action_processing_ms": 0.04132462046747311, "mean_env_wait_ms": 0.9094532942304763, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 145600, "timers": {"sample_time_ms": 6343.161, "sample_throughput": 3279.122, "learn_time_ms": 6236.01, "learn_throughput": 3335.466, "update_time_ms": 1.485}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.007518876601079125, "policy_loss": -0.016517203506882204, "vf_loss": 0.0059064216283292855, "vf_explained_var": 0.8515797257423401, "kl": 0.006183807898107116, "entropy": -3.341271099137382, "entropy_coeff": 0.0}}, "num_steps_sampled": 145600, "num_steps_trained": 145600}, "done": false, "episodes_total": 144, "training_iteration": 7, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_08-01-08", "timestamp": 1617634868, "time_this_iter_s": 12.221306800842285, "time_total_s": 82.52440690994263, "pid": 5707, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.174017906188965, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.12352941176471, "ram_util_percent": 60.3470588235294}, "trial_id": "3e406_00003"}
{"episode_reward_max": 3.3882311633253064, "episode_reward_min": -0.33301447808786955, "episode_reward_mean": 0.6420101736203768, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1101875713015517, 0.9694664648427844, 0.001801991696268157, 0.26338859565087325, 0.23109049885543365, 3.3882311633253064, 1.5398723363296472, 0.6173113097448881, 2.453768643588597, 1.6261116231570654, 0.12472391979522346, 0.5743289265812734, 1.5774493705728654, 0.7236556961318141, -0.17115127060442592, 0.10032916405128, 0.41648481156042294, 0.919899866978017, 0.3878570989941106, -0.012025980958164428, 0.5637083326482892, 0.050981065213117516, 0.7568952542777385, 1.2945593957686627, 0.6660972461633676, -0.017175686817280877, 0.9057302497616913, -0.33301447808786955, 0.8206731596022769, 1.6419660096709676, 0.3512638481275123, 0.24534619032131255, 1.3744973368976567, -0.2723311468859251, 0.5487426161158047, 0.22342472847148476, 0.7474667829415433, 1.5551020884621445, 0.32487668569086114, 0.1791610550273932, 0.5333305354940439, 0.007337614313194685, 0.254285313988591, 0.926888502063973, 0.7259039010371748, 1.0021846426148908, -0.023765432133550424, 0.326670763615478, 1.0179939102857145, -0.08568851351214346, 0.557050021970716, -0.0735221135725519, 0.5765347405699428, 0.5327801269625196, 1.2156729804744857, -0.011839806396960584], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19114244105099823, "mean_inference_ms": 0.9795215710732391, "mean_action_processing_ms": 0.04094324970915814, "mean_env_wait_ms": 0.896928221720527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 166400, "timers": {"sample_time_ms": 6084.711, "sample_throughput": 3418.404, "learn_time_ms": 6304.573, "learn_throughput": 3299.192, "update_time_ms": 1.521}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.004808947064005341, "policy_loss": -0.015050469714851102, "vf_loss": 0.007867392878179535, "vf_explained_var": 0.8499458432197571, "kl": 0.004748261533677578, "entropy": -3.3541260453089614, "entropy_coeff": 0.0}}, "num_steps_sampled": 166400, "num_steps_trained": 166400}, "done": false, "episodes_total": 160, "training_iteration": 8, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_08-01-20", "timestamp": 1617634880, "time_this_iter_s": 12.018410444259644, "time_total_s": 94.54281735420227, "pid": 5707, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.19242835044861, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.0, "ram_util_percent": 60.416666666666664}, "trial_id": "3e406_00003"}
{"episode_reward_max": 3.3882311633253064, "episode_reward_min": -0.33301447808786955, "episode_reward_mean": 0.8285135822908132, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2481640488823373, 1.3993986811730617, 1.002174503460095, 0.8067100207556059, 1.3468327293594684, 1.1727929803886452, 1.030634244187775, 1.9485864233181651, 1.353853642954311, 3.2814829319449057, 1.0134986957265273, 0.3364554636957686, 0.09754024541852657, 1.5849743514102403, 1.684421916078413, 2.3847189378442453, 0.6833099048716307, 0.9228334683901567, 2.9204734709773192, 1.065099381631787, 0.026536960151093414, 1.6419215237670115, 1.0608567227342252, 0.31524561140263074, 0.41648481156042294, 0.919899866978017, 0.3878570989941106, -0.012025980958164428, 0.5637083326482892, 0.050981065213117516, 0.7568952542777385, 1.2945593957686627, 0.6660972461633676, -0.017175686817280877, 0.9057302497616913, -0.33301447808786955, 0.8206731596022769, 1.6419660096709676, 0.3512638481275123, 0.24534619032131255, 1.3744973368976567, -0.2723311468859251, 0.5487426161158047, 0.22342472847148476, 0.7474667829415433, 1.5551020884621445, 0.32487668569086114, 0.1791610550273932, 0.5333305354940439, 0.007337614313194685, 0.254285313988591, 0.926888502063973, 0.7259039010371748, 1.0021846426148908, -0.023765432133550424, 0.326670763615478, 1.0179939102857145, -0.08568851351214346, 0.557050021970716, -0.0735221135725519, 0.5765347405699428, 0.5327801269625196, 1.2156729804744857, -0.011839806396960584, 1.1101875713015517, 0.9694664648427844, 0.001801991696268157, 0.26338859565087325, 0.23109049885543365, 3.3882311633253064, 1.5398723363296472, 0.6173113097448881, 2.453768643588597, 1.6261116231570654, 0.12472391979522346, 0.5743289265812734, 1.5774493705728654, 0.7236556961318141, -0.17115127060442592, 0.10032916405128], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1912433808396796, "mean_inference_ms": 0.9747586203327664, "mean_action_processing_ms": 0.04077106612105148, "mean_env_wait_ms": 0.8897538692198144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 187200, "timers": {"sample_time_ms": 6101.288, "sample_throughput": 3409.116, "learn_time_ms": 6592.518, "learn_throughput": 3155.092, "update_time_ms": 1.476}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.007958803737273246, "policy_loss": -0.01717827983909041, "vf_loss": 0.007081377645668808, "vf_explained_var": 0.8900758624076843, "kl": 0.008552395655813576, "entropy": -3.402738332748413, "entropy_coeff": 0.0}}, "num_steps_sampled": 187200, "num_steps_trained": 187200}, "done": false, "episodes_total": 184, "training_iteration": 9, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_08-01-34", "timestamp": 1617634894, "time_this_iter_s": 13.615930557250977, "time_total_s": 108.15874791145325, "pid": 5707, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.808358907699585, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.4, "ram_util_percent": 59.10526315789474}, "trial_id": "3e406_00003"}
{"episode_reward_max": 3.3170944840849614, "episode_reward_min": -0.07685437100925396, "episode_reward_mean": 1.571601573719037, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4540013022209712, 2.6093569044594074, 2.279823563810346, 1.705958939047938, 3.3170944840849614, 0.7677312118447321, 3.1780479808040596, 2.734954839656014, -0.07685437100925396, 1.0826868001895211, 1.916613739486099, 1.6178427710939687, 0.15917913237683923, 1.4559802644033484, 0.21674279536933594, 0.7264648216663034], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.172377881615128, "mean_inference_ms": 0.9430970012660396, "mean_action_processing_ms": 0.039710339927893336, "mean_env_wait_ms": 0.8834800391140374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 208000, "timers": {"sample_time_ms": 6230.654, "sample_throughput": 3338.333, "learn_time_ms": 6306.602, "learn_throughput": 3298.131, "update_time_ms": 1.381}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.0008296358107697745, "policy_loss": -0.013162220736816983, "vf_loss": 0.009238214640552463, "vf_explained_var": 0.8690322041511536, "kl": 0.0030943711311127876, "entropy": -3.436342569947974, "entropy_coeff": 0.0}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 200, "training_iteration": 10, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_08-02-54", "timestamp": 1617634974, "time_this_iter_s": 12.544034004211426, "time_total_s": 120.70278191566467, "pid": 7031, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.544034004211426, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.40555555555556, "ram_util_percent": 60.04444444444445}, "trial_id": "3e406_00003"}
{"episode_reward_max": 5.6104902837146, "episode_reward_min": -0.07685437100925396, "episode_reward_mean": 1.9090792388834992, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6010768488901843, 0.3789371261768857, 5.6104902837146, 0.7423667923830637, 4.746505358212101, 1.8259140443906468, 2.659309181540559, 1.4401155471476765, 1.5601959394462077, 0.5217665661669966, 2.8386332762436366, 2.2899694008651896, 0.8151622698218266, 1.5973528155436005, 0.7759633259062853, 3.0732120216059693, 2.35644229647513, 2.262606698052063, 0.8043719210339493, 3.0332568244972986, 4.002990433678374, 1.3181853594882917, 2.2673017072764883, 3.695418337278344, 1.4540013022209712, 2.6093569044594074, 2.279823563810346, 1.705958939047938, 3.3170944840849614, 0.7677312118447321, 3.1780479808040596, 2.734954839656014, -0.07685437100925396, 1.0826868001895211, 1.916613739486099, 1.6178427710939687, 0.15917913237683923, 1.4559802644033484, 0.21674279536933594, 0.7264648216663034], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18096364261437287, "mean_inference_ms": 0.9609266830022453, "mean_action_processing_ms": 0.039662377010786246, "mean_env_wait_ms": 0.8729732117479252, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 228800, "timers": {"sample_time_ms": 6148.841, "sample_throughput": 3382.751, "learn_time_ms": 6273.954, "learn_throughput": 3315.294, "update_time_ms": 1.532}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 3.7918054878328314e-05, "total_loss": 0.003825374056179465, "policy_loss": -0.015421473618276829, "vf_loss": 0.016567986458539963, "vf_explained_var": 0.8411659002304077, "kl": 0.005357721657635061, "entropy": -3.459862372626556, "entropy_coeff": 0.0}}, "num_steps_sampled": 228800, "num_steps_trained": 228800}, "done": false, "episodes_total": 224, "training_iteration": 11, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_08-03-06", "timestamp": 1617634986, "time_this_iter_s": 12.31741976737976, "time_total_s": 133.02020168304443, "pid": 7031, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.861453771591187, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.27222222222222, "ram_util_percent": 60.25}, "trial_id": "3e406_00003"}
{"episode_reward_max": 5.6104902837146, "episode_reward_min": -0.07685437100925396, "episode_reward_mean": 2.0141853117281223, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.3284945391972904, 4.061840451583695, 3.067720584631606, 2.966495144657095, 2.633813883845009, 1.6276102155706051, 1.7932347301821294, 2.711291353514678, 2.3838413073124287, 2.1081614596415266, 1.7728781966209444, 0.45489751992976624, 1.2885931371312958, 3.815873504649951, 2.367476629071677, 1.0489852438951854, 1.4540013022209712, 2.6093569044594074, 2.279823563810346, 1.705958939047938, 3.3170944840849614, 0.7677312118447321, 3.1780479808040596, 2.734954839656014, -0.07685437100925396, 1.0826868001895211, 1.916613739486099, 1.6178427710939687, 0.15917913237683923, 1.4559802644033484, 0.21674279536933594, 0.7264648216663034, 0.6010768488901843, 0.3789371261768857, 5.6104902837146, 0.7423667923830637, 4.746505358212101, 1.8259140443906468, 2.659309181540559, 1.4401155471476765, 1.5601959394462077, 0.5217665661669966, 2.8386332762436366, 2.2899694008651896, 0.8151622698218266, 1.5973528155436005, 0.7759633259062853, 3.0732120216059693, 2.35644229647513, 2.262606698052063, 0.8043719210339493, 3.0332568244972986, 4.002990433678374, 1.3181853594882917, 2.2673017072764883, 3.695418337278344], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18213210343262223, "mean_inference_ms": 0.9646039187136469, "mean_action_processing_ms": 0.03976264689526876, "mean_env_wait_ms": 0.8722226166928585, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 249600, "timers": {"sample_time_ms": 6155.984, "sample_throughput": 3378.826, "learn_time_ms": 6274.375, "learn_throughput": 3315.071, "update_time_ms": 1.484}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.0009591183196638991, "policy_loss": -0.015214525234594118, "vf_loss": 0.01164039573203658, "vf_explained_var": 0.8941300511360168, "kl": 0.005230023445664374, "entropy": -3.4923684991941863, "entropy_coeff": 0.0}}, "num_steps_sampled": 249600, "num_steps_trained": 249600}, "done": false, "episodes_total": 240, "training_iteration": 12, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_08-03-19", "timestamp": 1617634999, "time_this_iter_s": 12.453502893447876, "time_total_s": 145.4737045764923, "pid": 7031, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.31495666503906, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.094444444444434, "ram_util_percent": 60.28888888888888}, "trial_id": "3e406_00003"}
{"episode_reward_max": 5.6104902837146, "episode_reward_min": -0.07685437100925396, "episode_reward_mean": 2.280488559764348, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.187353055999865, 5.384688096072363, 2.215346040141717, 1.4235239576614647, 3.148807010972142, 1.9629748769716708, 3.3908700571864507, 2.4890698665055546, 1.9404320829719333, 1.7544770493936857, 2.421822897141325, 2.9840687705914672, 4.964008653489453, 3.728127189542742, 3.290691914385472, 1.3955788915022835, 2.1858640152598805, 2.782846106966833, 2.0083337292127195, 3.1126598798467207, 3.0932073604371473, 2.947679623735002, 4.033460384589378, 3.798815813795728, 1.4540013022209712, 2.6093569044594074, 2.279823563810346, 1.705958939047938, 3.3170944840849614, 0.7677312118447321, 3.1780479808040596, 2.734954839656014, -0.07685437100925396, 1.0826868001895211, 1.916613739486099, 1.6178427710939687, 0.15917913237683923, 1.4559802644033484, 0.21674279536933594, 0.7264648216663034, 0.6010768488901843, 0.3789371261768857, 5.6104902837146, 0.7423667923830637, 4.746505358212101, 1.8259140443906468, 2.659309181540559, 1.4401155471476765, 1.5601959394462077, 0.5217665661669966, 2.8386332762436366, 2.2899694008651896, 0.8151622698218266, 1.5973528155436005, 0.7759633259062853, 3.0732120216059693, 2.35644229647513, 2.262606698052063, 0.8043719210339493, 3.0332568244972986, 4.002990433678374, 1.3181853594882917, 2.2673017072764883, 3.695418337278344, 2.3284945391972904, 4.061840451583695, 3.067720584631606, 2.966495144657095, 2.633813883845009, 1.6276102155706051, 1.7932347301821294, 2.711291353514678, 2.3838413073124287, 2.1081614596415266, 1.7728781966209444, 0.45489751992976624, 1.2885931371312958, 3.815873504649951, 2.367476629071677, 1.0489852438951854], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18426800858791395, "mean_inference_ms": 0.9655722317127575, "mean_action_processing_ms": 0.039832698479435366, "mean_env_wait_ms": 0.8709499169534844, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 270400, "timers": {"sample_time_ms": 6103.427, "sample_throughput": 3407.922, "learn_time_ms": 6450.715, "learn_throughput": 3224.449, "update_time_ms": 1.461}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 3.7918054878328314e-05, "total_loss": -0.0004697640860693221, "policy_loss": -0.017647900770024105, "vf_loss": 0.01405645251571218, "vf_explained_var": 0.9005954265594482, "kl": 0.006243369059260089, "entropy": -3.5396457464417064, "entropy_coeff": 0.0}}, "num_steps_sampled": 270400, "num_steps_trained": 270400}, "done": false, "episodes_total": 264, "training_iteration": 13, "experiment_id": "f834f8b8d2a8483d8ae87b53df6a96d1", "date": "2021-04-05_08-03-32", "timestamp": 1617635012, "time_this_iter_s": 12.934785842895508, "time_total_s": 158.40849041938782, "pid": 7031, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19583, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 17, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 3.7918054878328314e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9634621731214397, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34277107558426756, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.24974250793457, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.21666666666666, "ram_util_percent": 58.333333333333336}, "trial_id": "3e406_00003"}
{"episode_reward_max": 11.333113457924574, "episode_reward_min": 3.344735661510115, "episode_reward_mean": 6.6151785194865305, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.333113457924574, 3.344735661510115, 7.769585480007475, 6.00500846862141, 5.206533673234941, 8.772622039025318, 4.139166327268437, 6.350663048299977], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11724174072303739, "mean_inference_ms": 0.9034376011402978, "mean_action_processing_ms": 0.03833623353289525, "mean_env_wait_ms": 0.8957409094414246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 348800, "timers": {"sample_time_ms": 2909.497, "sample_throughput": 3299.54, "learn_time_ms": 95.962, "learn_throughput": 100039.549, "update_time_ms": 1.342}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.024751052260398865, "policy_loss": -0.005752959637902677, "vf_loss": 0.028584026731550694, "vf_explained_var": 0.910193681716919, "kl": 0.0019199852831661701, "entropy": -4.001768469810486, "entropy_coeff": 0.0}}, "num_steps_sampled": 348800, "num_steps_trained": 348800}, "done": false, "episodes_total": 344, "training_iteration": 49, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-03-59", "timestamp": 1617635039, "time_this_iter_s": 3.0095179080963135, "time_total_s": 157.7533233165741, "pid": 8190, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8344, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9326102646185925, "kl_coeff": 1.0, "sgd_minibatch_size": 7794, "shuffle_sequences": true, "num_sgd_iter": 3, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11154461773337417, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3.0095179080963135, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.739999999999995, "ram_util_percent": 59.9}, "trial_id": "3e406_00003"}
{"episode_reward_max": 13.12609241881366, "episode_reward_min": 3.344735661510115, "episode_reward_mean": 7.763507357326338, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.7473795745336504, 9.678620833832845, 4.357955258222498, 12.396575995175601, 13.12609241881366, 7.443501355476624, 8.52896234789992, 9.015601777374375, 11.333113457924574, 3.344735661510115, 7.769585480007475, 6.00500846862141, 5.206533673234941, 8.772622039025318, 4.139166327268437, 6.350663048299977], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1246408343016192, "mean_inference_ms": 0.9357087581893389, "mean_action_processing_ms": 0.03971445347866323, "mean_env_wait_ms": 0.9079698355145559, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 358400, "timers": {"sample_time_ms": 2889.087, "sample_throughput": 3322.849, "learn_time_ms": 94.662, "learn_throughput": 101412.992, "update_time_ms": 1.403}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.01, "total_loss": 0.04562521167099476, "policy_loss": 0.00343974307179451, "vf_loss": 0.03680235520005226, "vf_explained_var": 0.9113906621932983, "kl": 0.010766223538666964, "entropy": -4.022358417510986, "entropy_coeff": 0.0}}, "num_steps_sampled": 358400, "num_steps_trained": 358400}, "done": true, "episodes_total": 352, "training_iteration": 50, "experiment_id": "5fd7ba49d09944968c183d1704326f64", "date": "2021-04-05_08-04-02", "timestamp": 1617635042, "time_this_iter_s": 2.9674768447875977, "time_total_s": 160.7208001613617, "pid": 8190, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8344, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9326102646185925, "kl_coeff": 1.0, "sgd_minibatch_size": 7794, "shuffle_sequences": true, "num_sgd_iter": 3, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11154461773337417, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.976994752883911, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 68.05, "ram_util_percent": 60.1}, "trial_id": "3e406_00003"}
