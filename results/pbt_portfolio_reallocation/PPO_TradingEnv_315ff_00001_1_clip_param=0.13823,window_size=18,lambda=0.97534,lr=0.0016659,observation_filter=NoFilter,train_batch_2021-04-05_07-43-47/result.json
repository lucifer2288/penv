{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 7600, "timers": {"sample_time_ms": 1411.121, "sample_throughput": 5385.788, "learn_time_ms": 1678.831, "learn_throughput": 4526.959, "update_time_ms": 2.46}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0016658912420044608, "total_loss": 0.010523511205489437, "policy_loss": -0.0018310281758507094, "vf_loss": 0.003293288677620391, "vf_explained_var": 0.8894419074058533, "kl": 0.009061253055309255, "entropy": -3.5558287660280863, "entropy_coeff": 0.0}}, "num_steps_sampled": 7600, "num_steps_trained": 7600}, "done": false, "episodes_total": 0, "training_iteration": 1, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-43-59", "timestamp": 1617633839, "time_this_iter_s": 3.096601963043213, "time_total_s": 3.096601963043213, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3.096601963043213, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 53.9, "ram_util_percent": 61.42}, "trial_id": "315ff_00001"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 15200, "timers": {"sample_time_ms": 1273.649, "sample_throughput": 5967.109, "learn_time_ms": 1693.442, "learn_throughput": 4487.9, "update_time_ms": 2.689}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0016658912420044608, "total_loss": 0.0007004544138908386, "policy_loss": -0.005978843895718455, "vf_loss": 0.002360807745329415, "vf_explained_var": 0.8309217691421509, "kl": 0.004318491361724834, "entropy": -3.5609865546226502, "entropy_coeff": 0.0}}, "num_steps_sampled": 15200, "num_steps_trained": 15200}, "done": false, "episodes_total": 0, "training_iteration": 2, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-01", "timestamp": 1617633841, "time_this_iter_s": 2.852066993713379, "time_total_s": 5.948668956756592, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.948668956756592, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.575, "ram_util_percent": 61.650000000000006}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.7854520238788159, "episode_reward_min": -0.4729461843762158, "episode_reward_mean": -0.11331540037379896, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18023808281753598, "mean_inference_ms": 1.2682009978269086, "mean_action_processing_ms": 0.054834152198944296, "mean_env_wait_ms": 1.2879547173638688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 22800, "timers": {"sample_time_ms": 1259.704, "sample_throughput": 6033.165, "learn_time_ms": 1745.646, "learn_throughput": 4353.69, "update_time_ms": 2.769}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.0016658912420044608, "total_loss": -0.005860846349969506, "policy_loss": -0.010555272068207463, "vf_loss": 0.0018434425408486276, "vf_explained_var": 0.5341764092445374, "kl": 0.005701970157679171, "entropy": -3.642524981498718, "entropy_coeff": 0.0}}, "num_steps_sampled": 22800, "num_steps_trained": 22800}, "done": false, "episodes_total": 19, "training_iteration": 3, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-05", "timestamp": 1617633845, "time_this_iter_s": 3.0908310413360596, "time_total_s": 9.039499998092651, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.039499998092651, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.699999999999996, "ram_util_percent": 61.7}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.7854520238788159, "episode_reward_min": -0.4729461843762158, "episode_reward_mean": -0.11331540037379896, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18023808281753598, "mean_inference_ms": 1.2682009978269086, "mean_action_processing_ms": 0.054834152198944296, "mean_env_wait_ms": 1.2879547173638688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 30400, "timers": {"sample_time_ms": 1221.849, "sample_throughput": 6220.082, "learn_time_ms": 1753.737, "learn_throughput": 4333.603, "update_time_ms": 2.775}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.0016658912420044608, "total_loss": 0.0013597469932089248, "policy_loss": -0.0027728708616147437, "vf_loss": 0.0018830167575894544, "vf_explained_var": 0.6894380450248718, "kl": 0.004499199419903259, "entropy": -3.6902919967969257, "entropy_coeff": 0.0}}, "num_steps_sampled": 30400, "num_steps_trained": 30400}, "done": false, "episodes_total": 19, "training_iteration": 4, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-07", "timestamp": 1617633847, "time_this_iter_s": 2.894456624984741, "time_total_s": 11.933956623077393, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.933956623077393, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.58, "ram_util_percent": 61.7}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.7854520238788159, "episode_reward_min": -0.5923162250164682, "episode_reward_mean": -0.14427564317404115, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772, -0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1879314220593835, "mean_inference_ms": 1.2698127426854395, "mean_action_processing_ms": 0.054642917598711864, "mean_env_wait_ms": 1.2718262417802748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 38000, "timers": {"sample_time_ms": 1225.004, "sample_throughput": 6204.063, "learn_time_ms": 1753.874, "learn_throughput": 4333.265, "update_time_ms": 2.698}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.0016658912420044608, "total_loss": -0.0015940172287325063, "policy_loss": -0.004674557037651539, "vf_loss": 0.0015469997558587541, "vf_explained_var": 0.7056222558021545, "kl": 0.006134156312327832, "entropy": -3.622976235548655, "entropy_coeff": 0.0}}, "num_steps_sampled": 38000, "num_steps_trained": 38000}, "done": false, "episodes_total": 38, "training_iteration": 5, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-10", "timestamp": 1617633850, "time_this_iter_s": 3.000170946121216, "time_total_s": 14.934127569198608, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.934127569198608, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 45.175000000000004, "ram_util_percent": 61.75}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.7854520238788159, "episode_reward_min": -0.5923162250164682, "episode_reward_mean": -0.14427564317404115, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1879314220593835, "mean_inference_ms": 1.2698127426854393, "mean_action_processing_ms": 0.054642917598711864, "mean_env_wait_ms": 1.2718262417802748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 45600, "timers": {"sample_time_ms": 1212.133, "sample_throughput": 6269.94, "learn_time_ms": 1758.708, "learn_throughput": 4321.355, "update_time_ms": 2.769}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.0016658912420044608, "total_loss": -0.0009361841871092717, "policy_loss": -0.0043142127649237715, "vf_loss": 0.0021406589037117857, "vf_explained_var": 0.7570152282714844, "kl": 0.004949483139595637, "entropy": -3.5881378094355267, "entropy_coeff": 0.0}}, "num_steps_sampled": 45600, "num_steps_trained": 45600}, "done": false, "episodes_total": 38, "training_iteration": 6, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-13", "timestamp": 1617633853, "time_this_iter_s": 2.939657688140869, "time_total_s": 17.873785257339478, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.873785257339478, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 42.1, "ram_util_percent": 61.85}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.7854520238788159, "episode_reward_min": -0.5923162250164682, "episode_reward_mean": -0.14427564317404115, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1879314220593835, "mean_inference_ms": 1.2698127426854393, "mean_action_processing_ms": 0.054642917598711864, "mean_env_wait_ms": 1.2718262417802748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 53200, "timers": {"sample_time_ms": 1199.675, "sample_throughput": 6335.049, "learn_time_ms": 1770.732, "learn_throughput": 4292.009, "update_time_ms": 2.75}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.005656414541105429, "policy_loss": -0.008640489944567283, "vf_loss": 0.0021463120084566373, "vf_explained_var": 0.6983590722084045, "kl": 0.006702083209529519, "entropy": -3.5771254301071167, "entropy_coeff": 0.0}}, "num_steps_sampled": 53200, "num_steps_trained": 53200}, "done": false, "episodes_total": 38, "training_iteration": 7, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-16", "timestamp": 1617633856, "time_this_iter_s": 2.975796699523926, "time_total_s": 20.849581956863403, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.849581956863403, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 41.44999999999999, "ram_util_percent": 61.9}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.7854520238788159, "episode_reward_min": -0.7087116055643468, "episode_reward_mean": -0.118568205481768, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.08478649488082723, 0.18781938353852778, 0.20762421463907432, -0.01549841020967846, -0.38074979882699655, -0.19105568076311352, -0.49086331349781426, -0.4357286158234322, -0.05673933670162867, -0.1587771956648948, 0.22554438170800584, 0.23887718897377375, -0.18927568597517963, 0.17696470390905117, -0.055775526453808566, -0.7087116055643468, 0.41786201823886926, -0.16680773715058395, 0.034591248896135074, -0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18878059122197466, "mean_inference_ms": 1.271204511328249, "mean_action_processing_ms": 0.05454065665367787, "mean_env_wait_ms": 1.2604503676196968, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 60800, "timers": {"sample_time_ms": 1203.588, "sample_throughput": 6314.452, "learn_time_ms": 1778.708, "learn_throughput": 4272.764, "update_time_ms": 2.771}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.004449790560950836, "policy_loss": -0.00694244591674457, "vf_loss": 0.0018612239762054136, "vf_explained_var": 0.7171750664710999, "kl": 0.005051454971544444, "entropy": -3.6234734813372294, "entropy_coeff": 0.0}}, "num_steps_sampled": 60800, "num_steps_trained": 60800}, "done": false, "episodes_total": 57, "training_iteration": 8, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-20", "timestamp": 1617633860, "time_this_iter_s": 3.0744504928588867, "time_total_s": 23.92403244972229, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.92403244972229, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.96, "ram_util_percent": 61.82000000000001}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.7854520238788159, "episode_reward_min": -0.7087116055643468, "episode_reward_mean": -0.118568205481768, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772, 0.08478649488082723, 0.18781938353852778, 0.20762421463907432, -0.01549841020967846, -0.38074979882699655, -0.19105568076311352, -0.49086331349781426, -0.4357286158234322, -0.05673933670162867, -0.1587771956648948, 0.22554438170800584, 0.23887718897377375, -0.18927568597517963, 0.17696470390905117, -0.055775526453808566, -0.7087116055643468, 0.41786201823886926, -0.16680773715058395, 0.034591248896135074], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18878059122197466, "mean_inference_ms": 1.271204511328249, "mean_action_processing_ms": 0.05454065665367786, "mean_env_wait_ms": 1.2604503676196968, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 68400, "timers": {"sample_time_ms": 1193.164, "sample_throughput": 6369.621, "learn_time_ms": 1784.16, "learn_throughput": 4259.707, "update_time_ms": 2.744}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0020616489045399552, "policy_loss": -0.004889724826595435, "vf_loss": 0.0020872681925538927, "vf_explained_var": 0.8150967359542847, "kl": 0.005926448242583622, "entropy": -3.6475386023521423, "entropy_coeff": 0.0}}, "num_steps_sampled": 68400, "num_steps_trained": 68400}, "done": false, "episodes_total": 57, "training_iteration": 9, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-22", "timestamp": 1617633862, "time_this_iter_s": 2.946040391921997, "time_total_s": 26.870072841644287, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.870072841644287, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.800000000000004, "ram_util_percent": 61.825}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.9200469972784813, "episode_reward_min": -0.7087116055643468, "episode_reward_mean": -0.12807762364843614, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3812767482471721, -0.0032548028298425846, -0.49974762538170275, -0.27091341324406304, 0.07883717949355229, -0.14841789497018854, -0.1579979231729, -0.22221829651467817, -0.3434101933375642, -0.1306644135146886, 0.09420954209525934, -0.32951863090293076, -0.5087199761007479, -0.4226765355896466, -0.4612969061621428, -0.20164392232865136, 0.049936667252563405, 0.9200469972784813, -0.03678478864330936, -0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772, 0.08478649488082723, 0.18781938353852778, 0.20762421463907432, -0.01549841020967846, -0.38074979882699655, -0.19105568076311352, -0.49086331349781426, -0.4357286158234322, -0.05673933670162867, -0.1587771956648948, 0.22554438170800584, 0.23887718897377375, -0.18927568597517963, 0.17696470390905117, -0.055775526453808566, -0.7087116055643468, 0.41786201823886926, -0.16680773715058395, 0.034591248896135074], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1907408205682426, "mean_inference_ms": 1.2722331344823559, "mean_action_processing_ms": 0.05450362976947378, "mean_env_wait_ms": 1.2533773680869063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 76000, "timers": {"sample_time_ms": 1196.921, "sample_throughput": 6349.626, "learn_time_ms": 1785.736, "learn_throughput": 4255.948, "update_time_ms": 2.736}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0030549058069785436, "policy_loss": -0.006357481268544992, "vf_loss": 0.002677771218198662, "vf_explained_var": 0.7410414218902588, "kl": 0.004998426383826882, "entropy": -3.6322707335154214, "entropy_coeff": 0.0}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 76, "training_iteration": 10, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-26", "timestamp": 1617633866, "time_this_iter_s": 3.0393810272216797, "time_total_s": 29.909453868865967, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.909453868865967, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 45.45, "ram_util_percent": 61.825}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.9200469972784813, "episode_reward_min": -0.7087116055643468, "episode_reward_mean": -0.12807762364843617, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772, 0.08478649488082723, 0.18781938353852778, 0.20762421463907432, -0.01549841020967846, -0.38074979882699655, -0.19105568076311352, -0.49086331349781426, -0.4357286158234322, -0.05673933670162867, -0.1587771956648948, 0.22554438170800584, 0.23887718897377375, -0.18927568597517963, 0.17696470390905117, -0.055775526453808566, -0.7087116055643468, 0.41786201823886926, -0.16680773715058395, 0.034591248896135074, -0.3812767482471721, -0.0032548028298425846, -0.49974762538170275, -0.27091341324406304, 0.07883717949355229, -0.14841789497018854, -0.1579979231729, -0.22221829651467817, -0.3434101933375642, -0.1306644135146886, 0.09420954209525934, -0.32951863090293076, -0.5087199761007479, -0.4226765355896466, -0.4612969061621428, -0.20164392232865136, 0.049936667252563405, 0.9200469972784813, -0.03678478864330936], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19074082056824262, "mean_inference_ms": 1.2722331344823559, "mean_action_processing_ms": 0.05450362976947379, "mean_env_wait_ms": 1.2533773680869063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 83600, "timers": {"sample_time_ms": 1166.301, "sample_throughput": 6516.33, "learn_time_ms": 1795.636, "learn_throughput": 4232.483, "update_time_ms": 2.744}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.0019598479305083555, "policy_loss": -0.004384088019529979, "vf_loss": 0.0020092394261155277, "vf_explained_var": 0.817572295665741, "kl": 0.006640039787938198, "entropy": -3.6133207122484845, "entropy_coeff": 0.0}}, "num_steps_sampled": 83600, "num_steps_trained": 83600}, "done": false, "episodes_total": 76, "training_iteration": 11, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-28", "timestamp": 1617633868, "time_this_iter_s": 2.8910646438598633, "time_total_s": 32.80051851272583, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.80051851272583, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 41.425, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.9200469972784813, "episode_reward_min": -0.7087116055643468, "episode_reward_mean": -0.12807762364843617, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772, 0.08478649488082723, 0.18781938353852778, 0.20762421463907432, -0.01549841020967846, -0.38074979882699655, -0.19105568076311352, -0.49086331349781426, -0.4357286158234322, -0.05673933670162867, -0.1587771956648948, 0.22554438170800584, 0.23887718897377375, -0.18927568597517963, 0.17696470390905117, -0.055775526453808566, -0.7087116055643468, 0.41786201823886926, -0.16680773715058395, 0.034591248896135074, -0.3812767482471721, -0.0032548028298425846, -0.49974762538170275, -0.27091341324406304, 0.07883717949355229, -0.14841789497018854, -0.1579979231729, -0.22221829651467817, -0.3434101933375642, -0.1306644135146886, 0.09420954209525934, -0.32951863090293076, -0.5087199761007479, -0.4226765355896466, -0.4612969061621428, -0.20164392232865136, 0.049936667252563405, 0.9200469972784813, -0.03678478864330936], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19074082056824262, "mean_inference_ms": 1.2722331344823559, "mean_action_processing_ms": 0.05450362976947379, "mean_env_wait_ms": 1.2533773680869063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 91200, "timers": {"sample_time_ms": 1164.665, "sample_throughput": 6525.482, "learn_time_ms": 1806.373, "learn_throughput": 4207.327, "update_time_ms": 2.744}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.005272254953160882, "policy_loss": -0.0076028673443943266, "vf_loss": 0.0019643026636913417, "vf_explained_var": 0.8075717091560364, "kl": 0.005860977961371343, "entropy": -3.5959352135658262, "entropy_coeff": 0.0}}, "num_steps_sampled": 91200, "num_steps_trained": 91200}, "done": false, "episodes_total": 76, "training_iteration": 12, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-31", "timestamp": 1617633871, "time_this_iter_s": 2.9443225860595703, "time_total_s": 35.7448410987854, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.7448410987854, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.99999999999999, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.9200469972784813, "episode_reward_min": -0.7087116055643468, "episode_reward_mean": -0.1265611560678782, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2903870485067226, -0.07152982511261508, -0.45151958128620073, -0.3509598625492124, 0.04742222423784548, -0.19363290306765235, 0.1316657000888488, 0.0017835090996147773, -0.21621974800562627, -0.22460736199303355, -0.42802830914715695, -0.16533092884702438, 0.4955897780714693, -0.16659745262936032, -0.04351778445054655, -0.4455504417221595, -0.2058771937174615, 0.23052709938791427, 0.057359700981799655, -0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772, 0.08478649488082723, 0.18781938353852778, 0.20762421463907432, -0.01549841020967846, -0.38074979882699655, -0.19105568076311352, -0.49086331349781426, -0.4357286158234322, -0.05673933670162867, -0.1587771956648948, 0.22554438170800584, 0.23887718897377375, -0.18927568597517963, 0.17696470390905117, -0.055775526453808566, -0.7087116055643468, 0.41786201823886926, -0.16680773715058395, 0.034591248896135074, -0.3812767482471721, -0.0032548028298425846, -0.49974762538170275, -0.27091341324406304, 0.07883717949355229, -0.14841789497018854, -0.1579979231729, -0.22221829651467817, -0.3434101933375642, -0.1306644135146886, 0.09420954209525934, -0.32951863090293076, -0.5087199761007479, -0.4226765355896466, -0.4612969061621428, -0.20164392232865136, 0.049936667252563405, 0.9200469972784813, -0.03678478864330936], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910709455028129, "mean_inference_ms": 1.2729063970607524, "mean_action_processing_ms": 0.054464821830766126, "mean_env_wait_ms": 1.2477224077727433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 98800, "timers": {"sample_time_ms": 1170.24, "sample_throughput": 6494.394, "learn_time_ms": 1799.806, "learn_throughput": 4222.678, "update_time_ms": 2.716}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.004682302180056771, "policy_loss": -0.007593795750290155, "vf_loss": 0.0025425089232157918, "vf_explained_var": 0.6094675660133362, "kl": 0.005903776758350432, "entropy": -3.6836079796155294, "entropy_coeff": 0.0}}, "num_steps_sampled": 98800, "num_steps_trained": 98800}, "done": false, "episodes_total": 95, "training_iteration": 13, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-34", "timestamp": 1617633874, "time_this_iter_s": 3.0810537338256836, "time_total_s": 38.825894832611084, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.825894832611084, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 45.24999999999999, "ram_util_percent": 61.75}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.9200469972784813, "episode_reward_min": -0.7087116055643468, "episode_reward_mean": -0.1265611560678782, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2288973538878556, -0.4729461843762158, -0.44271203554109656, -0.14506292724051706, 0.09217629031064001, -0.07240234596731654, -0.44167948850027844, -0.4220791661365624, -0.4231475584215553, -0.03975001707207626, -0.12368308490596513, -0.06658504746290195, 0.7854520238788159, 0.030037822618697252, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772, 0.08478649488082723, 0.18781938353852778, 0.20762421463907432, -0.01549841020967846, -0.38074979882699655, -0.19105568076311352, -0.49086331349781426, -0.4357286158234322, -0.05673933670162867, -0.1587771956648948, 0.22554438170800584, 0.23887718897377375, -0.18927568597517963, 0.17696470390905117, -0.055775526453808566, -0.7087116055643468, 0.41786201823886926, -0.16680773715058395, 0.034591248896135074, -0.3812767482471721, -0.0032548028298425846, -0.49974762538170275, -0.27091341324406304, 0.07883717949355229, -0.14841789497018854, -0.1579979231729, -0.22221829651467817, -0.3434101933375642, -0.1306644135146886, 0.09420954209525934, -0.32951863090293076, -0.5087199761007479, -0.4226765355896466, -0.4612969061621428, -0.20164392232865136, 0.049936667252563405, 0.9200469972784813, -0.03678478864330936, -0.2903870485067226, -0.07152982511261508, -0.45151958128620073, -0.3509598625492124, 0.04742222423784548, -0.19363290306765235, 0.1316657000888488, 0.0017835090996147773, -0.21621974800562627, -0.22460736199303355, -0.42802830914715695, -0.16533092884702438, 0.4955897780714693, -0.16659745262936032, -0.04351778445054655, -0.4455504417221595, -0.2058771937174615, 0.23052709938791427, 0.057359700981799655], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910709455028129, "mean_inference_ms": 1.2729063970607524, "mean_action_processing_ms": 0.05446482183076612, "mean_env_wait_ms": 1.2477224077727431, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 106400, "timers": {"sample_time_ms": 1171.351, "sample_throughput": 6488.233, "learn_time_ms": 1801.301, "learn_throughput": 4219.172, "update_time_ms": 2.728}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.003750720247626305, "policy_loss": -0.006093871321839591, "vf_loss": 0.0020145288590962688, "vf_explained_var": 0.7101706266403198, "kl": 0.005257959136118492, "entropy": -3.6490089734395346, "entropy_coeff": 0.0}}, "num_steps_sampled": 106400, "num_steps_trained": 106400}, "done": false, "episodes_total": 95, "training_iteration": 14, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-37", "timestamp": 1617633877, "time_this_iter_s": 2.9214513301849365, "time_total_s": 41.74734616279602, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.74734616279602, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 41.775, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.9200469972784813, "episode_reward_min": -0.7087116055643468, "episode_reward_mean": -0.1458101881561218, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.15423442917552876, -0.4032489804981806, -0.5295032308623291, -0.29831129276876067, 0.7012989702010053, -0.3030706571022155, -0.26814314140560724, -0.5900555371728954, 0.345102904031523, -0.10439610299790891, -0.3418617537295705, -0.2828848528587159, -0.1670341218275725, -0.5911759896525459, 0.2056312524620283, -0.49626090253855937, -0.269071880130341, -0.468840531511529, -0.5129277843302333, -0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772, 0.08478649488082723, 0.18781938353852778, 0.20762421463907432, -0.01549841020967846, -0.38074979882699655, -0.19105568076311352, -0.49086331349781426, -0.4357286158234322, -0.05673933670162867, -0.1587771956648948, 0.22554438170800584, 0.23887718897377375, -0.18927568597517963, 0.17696470390905117, -0.055775526453808566, -0.7087116055643468, 0.41786201823886926, -0.16680773715058395, 0.034591248896135074, -0.3812767482471721, -0.0032548028298425846, -0.49974762538170275, -0.27091341324406304, 0.07883717949355229, -0.14841789497018854, -0.1579979231729, -0.22221829651467817, -0.3434101933375642, -0.1306644135146886, 0.09420954209525934, -0.32951863090293076, -0.5087199761007479, -0.4226765355896466, -0.4612969061621428, -0.20164392232865136, 0.049936667252563405, 0.9200469972784813, -0.03678478864330936, -0.2903870485067226, -0.07152982511261508, -0.45151958128620073, -0.3509598625492124, 0.04742222423784548, -0.19363290306765235, 0.1316657000888488, 0.0017835090996147773, -0.21621974800562627, -0.22460736199303355, -0.42802830914715695, -0.16533092884702438, 0.4955897780714693, -0.16659745262936032, -0.04351778445054655, -0.4455504417221595, -0.2058771937174615, 0.23052709938791427, 0.057359700981799655], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19363360404669364, "mean_inference_ms": 1.2745522563967966, "mean_action_processing_ms": 0.05442886416266183, "mean_env_wait_ms": 1.2380378078842387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 114000, "timers": {"sample_time_ms": 1169.576, "sample_throughput": 6498.083, "learn_time_ms": 1804.087, "learn_throughput": 4212.658, "update_time_ms": 2.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.0008625293926646312, "policy_loss": -0.0031259684357792137, "vf_loss": 0.001926999120041728, "vf_explained_var": 0.7447482943534851, "kl": 0.005383048536411176, "entropy": -3.701651438077291, "entropy_coeff": 0.0}}, "num_steps_sampled": 114000, "num_steps_trained": 114000}, "done": false, "episodes_total": 114, "training_iteration": 15, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-40", "timestamp": 1617633880, "time_this_iter_s": 3.011601209640503, "time_total_s": 44.75894737243652, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.75894737243652, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.78, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.9200469972784813, "episode_reward_min": -0.7087116055643468, "episode_reward_mean": -0.14581018815612176, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772, 0.08478649488082723, 0.18781938353852778, 0.20762421463907432, -0.01549841020967846, -0.38074979882699655, -0.19105568076311352, -0.49086331349781426, -0.4357286158234322, -0.05673933670162867, -0.1587771956648948, 0.22554438170800584, 0.23887718897377375, -0.18927568597517963, 0.17696470390905117, -0.055775526453808566, -0.7087116055643468, 0.41786201823886926, -0.16680773715058395, 0.034591248896135074, -0.3812767482471721, -0.0032548028298425846, -0.49974762538170275, -0.27091341324406304, 0.07883717949355229, -0.14841789497018854, -0.1579979231729, -0.22221829651467817, -0.3434101933375642, -0.1306644135146886, 0.09420954209525934, -0.32951863090293076, -0.5087199761007479, -0.4226765355896466, -0.4612969061621428, -0.20164392232865136, 0.049936667252563405, 0.9200469972784813, -0.03678478864330936, -0.2903870485067226, -0.07152982511261508, -0.45151958128620073, -0.3509598625492124, 0.04742222423784548, -0.19363290306765235, 0.1316657000888488, 0.0017835090996147773, -0.21621974800562627, -0.22460736199303355, -0.42802830914715695, -0.16533092884702438, 0.4955897780714693, -0.16659745262936032, -0.04351778445054655, -0.4455504417221595, -0.2058771937174615, 0.23052709938791427, 0.057359700981799655, -0.15423442917552876, -0.4032489804981806, -0.5295032308623291, -0.29831129276876067, 0.7012989702010053, -0.3030706571022155, -0.26814314140560724, -0.5900555371728954, 0.345102904031523, -0.10439610299790891, -0.3418617537295705, -0.2828848528587159, -0.1670341218275725, -0.5911759896525459, 0.2056312524620283, -0.49626090253855937, -0.269071880130341, -0.468840531511529, -0.5129277843302333], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1936336040466936, "mean_inference_ms": 1.2745522563967968, "mean_action_processing_ms": 0.05442886416266182, "mean_env_wait_ms": 1.2380378078842385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 121600, "timers": {"sample_time_ms": 1165.54, "sample_throughput": 6520.582, "learn_time_ms": 1804.6, "learn_throughput": 4211.46, "update_time_ms": 2.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.0009219483550017078, "policy_loss": -0.0037846531563748916, "vf_loss": 0.00249289766070433, "vf_explained_var": 0.7735528945922852, "kl": 0.005916917537494252, "entropy": -3.6686459024747213, "entropy_coeff": 0.0}}, "num_steps_sampled": 121600, "num_steps_trained": 121600}, "done": false, "episodes_total": 114, "training_iteration": 16, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-43", "timestamp": 1617633883, "time_this_iter_s": 2.903954267501831, "time_total_s": 47.662901639938354, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.662901639938354, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 41.449999999999996, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.9200469972784813, "episode_reward_min": -0.7087116055643468, "episode_reward_mean": -0.14581018815612176, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.24990385450784203, 0.20916960816258467, 0.0915484229246617, -0.08852695125611076, -0.1440007597212859, 0.11203874158219085, -0.006590919878277757, 0.41931515191074387, 0.055974820742605624, 0.15689537290779576, -0.22012162505506905, -0.3858973240067497, -0.5686890212402351, -0.415172388806702, -0.5923162250164682, -0.00971505378184967, -0.5508126318249775, -0.3341457467413218, -0.2830323594959511, -0.05481794994435385, 0.052620719763922796, -0.15825310316750818, -0.33732657441858993, -0.20943571704058772, 0.08478649488082723, 0.18781938353852778, 0.20762421463907432, -0.01549841020967846, -0.38074979882699655, -0.19105568076311352, -0.49086331349781426, -0.4357286158234322, -0.05673933670162867, -0.1587771956648948, 0.22554438170800584, 0.23887718897377375, -0.18927568597517963, 0.17696470390905117, -0.055775526453808566, -0.7087116055643468, 0.41786201823886926, -0.16680773715058395, 0.034591248896135074, -0.3812767482471721, -0.0032548028298425846, -0.49974762538170275, -0.27091341324406304, 0.07883717949355229, -0.14841789497018854, -0.1579979231729, -0.22221829651467817, -0.3434101933375642, -0.1306644135146886, 0.09420954209525934, -0.32951863090293076, -0.5087199761007479, -0.4226765355896466, -0.4612969061621428, -0.20164392232865136, 0.049936667252563405, 0.9200469972784813, -0.03678478864330936, -0.2903870485067226, -0.07152982511261508, -0.45151958128620073, -0.3509598625492124, 0.04742222423784548, -0.19363290306765235, 0.1316657000888488, 0.0017835090996147773, -0.21621974800562627, -0.22460736199303355, -0.42802830914715695, -0.16533092884702438, 0.4955897780714693, -0.16659745262936032, -0.04351778445054655, -0.4455504417221595, -0.2058771937174615, 0.23052709938791427, 0.057359700981799655, -0.15423442917552876, -0.4032489804981806, -0.5295032308623291, -0.29831129276876067, 0.7012989702010053, -0.3030706571022155, -0.26814314140560724, -0.5900555371728954, 0.345102904031523, -0.10439610299790891, -0.3418617537295705, -0.2828848528587159, -0.1670341218275725, -0.5911759896525459, 0.2056312524620283, -0.49626090253855937, -0.269071880130341, -0.468840531511529, -0.5129277843302333], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1936336040466936, "mean_inference_ms": 1.2745522563967968, "mean_action_processing_ms": 0.05442886416266182, "mean_env_wait_ms": 1.2380378078842385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 129200, "timers": {"sample_time_ms": 1163.246, "sample_throughput": 6533.444, "learn_time_ms": 1798.827, "learn_throughput": 4224.974, "update_time_ms": 2.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.004964016083007058, "policy_loss": -0.007907643696914117, "vf_loss": 0.0024982329244570187, "vf_explained_var": 0.7206481099128723, "kl": 0.007126336622362336, "entropy": -3.6254817605018617, "entropy_coeff": 0.0}}, "num_steps_sampled": 129200, "num_steps_trained": 129200}, "done": false, "episodes_total": 114, "training_iteration": 17, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-44-46", "timestamp": 1617633886, "time_this_iter_s": 2.89550518989563, "time_total_s": 50.558406829833984, "pid": 471, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.558406829833984, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 41.550000000000004, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 136800, "timers": {"sample_time_ms": 1281.697, "sample_throughput": 5929.64, "learn_time_ms": 2041.676, "learn_throughput": 3722.432, "update_time_ms": 2.358}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0016658912420044608, "total_loss": -0.0020886111228416364, "policy_loss": -0.007360367337241769, "vf_loss": 0.0022525600953182826, "vf_explained_var": 0.8313866257667542, "kl": 0.0030191972890558343, "entropy": -3.7299134890238443, "entropy_coeff": 0.0}}, "num_steps_sampled": 136800, "num_steps_trained": 136800}, "done": false, "episodes_total": 114, "training_iteration": 18, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-00", "timestamp": 1617634020, "time_this_iter_s": 3.3300604820251465, "time_total_s": 53.88846731185913, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3.3300604820251465, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.67999999999999, "ram_util_percent": 61.54}, "trial_id": "315ff_00001"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 144400, "timers": {"sample_time_ms": 1201.395, "sample_throughput": 6325.977, "learn_time_ms": 2071.669, "learn_throughput": 3668.54, "update_time_ms": 2.59}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.0016658912420044608, "total_loss": -0.0009254215595622858, "policy_loss": -0.0059540439241876205, "vf_loss": 0.0028813488238180677, "vf_explained_var": 0.6997773051261902, "kl": 0.004294547019526362, "entropy": -3.6972524245580036, "entropy_coeff": 0.0}}, "num_steps_sampled": 144400, "num_steps_trained": 144400}, "done": false, "episodes_total": 114, "training_iteration": 19, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-03", "timestamp": 1617634023, "time_this_iter_s": 3.230963706970215, "time_total_s": 57.119431018829346, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.561024188995361, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.44, "ram_util_percent": 61.7}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.3923474309882123, "episode_reward_mean": 0.12239436869375757, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1783282266051195, "mean_inference_ms": 1.2702085138166537, "mean_action_processing_ms": 0.05436018830903745, "mean_env_wait_ms": 1.2818853507937762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 152000, "timers": {"sample_time_ms": 1209.352, "sample_throughput": 6284.358, "learn_time_ms": 2101.689, "learn_throughput": 3616.138, "update_time_ms": 2.527}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.0016658912420044608, "total_loss": 0.0006579011057813962, "policy_loss": -0.004653487540781498, "vf_loss": 0.004136156403304388, "vf_explained_var": 0.6075550317764282, "kl": 0.004700936834948758, "entropy": -3.709131383895874, "entropy_coeff": 0.0}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 133, "training_iteration": 20, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-06", "timestamp": 1617634026, "time_this_iter_s": 3.3952956199645996, "time_total_s": 60.514726638793945, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.956319808959961, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.62, "ram_util_percent": 61.760000000000005}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.3923474309882123, "episode_reward_mean": 0.12239436869375757, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1783282266051195, "mean_inference_ms": 1.2702085138166537, "mean_action_processing_ms": 0.05436018830903745, "mean_env_wait_ms": 1.2818853507937762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 159600, "timers": {"sample_time_ms": 1193.266, "sample_throughput": 6369.075, "learn_time_ms": 2104.196, "learn_throughput": 3611.83, "update_time_ms": 2.61}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0037780729510510963, "policy_loss": -0.007075545440117518, "vf_loss": 0.0024927476847854753, "vf_explained_var": 0.8257095217704773, "kl": 0.006437802780419588, "entropy": -3.7353034734725954, "entropy_coeff": 0.0}}, "num_steps_sampled": 159600, "num_steps_trained": 159600}, "done": false, "episodes_total": 133, "training_iteration": 21, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-10", "timestamp": 1617634030, "time_this_iter_s": 3.265178680419922, "time_total_s": 63.77990531921387, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.221498489379883, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.85, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.44390166643154927, "episode_reward_mean": 0.09012254493706333, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484, -0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18730406473853675, "mean_inference_ms": 1.2707524765217773, "mean_action_processing_ms": 0.054320361074458104, "mean_env_wait_ms": 1.2659154850557328, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 167200, "timers": {"sample_time_ms": 1202.784, "sample_throughput": 6318.676, "learn_time_ms": 2103.043, "learn_throughput": 3613.81, "update_time_ms": 2.665}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0017994239693507551, "policy_loss": -0.005116624757647514, "vf_loss": 0.002644980774493888, "vf_explained_var": 0.6679716110229492, "kl": 0.005377754049065212, "entropy": -3.797705340385437, "entropy_coeff": 0.0}}, "num_steps_sampled": 167200, "num_steps_trained": 167200}, "done": false, "episodes_total": 152, "training_iteration": 22, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-13", "timestamp": 1617634033, "time_this_iter_s": 3.3483519554138184, "time_total_s": 67.12825727462769, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.5698504447937, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 37.54, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.44390166643154927, "episode_reward_mean": 0.09012254493706333, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817, -0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18730406473853672, "mean_inference_ms": 1.2707524765217773, "mean_action_processing_ms": 0.054320361074458104, "mean_env_wait_ms": 1.2659154850557328, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 174800, "timers": {"sample_time_ms": 1186.908, "sample_throughput": 6403.195, "learn_time_ms": 2112.995, "learn_throughput": 3596.79, "update_time_ms": 2.723}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.002178890242551764, "policy_loss": -0.005174052187552055, "vf_loss": 0.0022609407800094536, "vf_explained_var": 0.8543717861175537, "kl": 0.0058737539841483034, "entropy": -3.7980196793874104, "entropy_coeff": 0.0}}, "num_steps_sampled": 174800, "num_steps_trained": 174800}, "done": false, "episodes_total": 152, "training_iteration": 23, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-16", "timestamp": 1617634036, "time_this_iter_s": 3.27874755859375, "time_total_s": 70.40700483322144, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.84859800338745, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.6, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.44390166643154927, "episode_reward_mean": 0.09012254493706333, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817, -0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18730406473853672, "mean_inference_ms": 1.2707524765217773, "mean_action_processing_ms": 0.054320361074458104, "mean_env_wait_ms": 1.2659154850557328, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 182400, "timers": {"sample_time_ms": 1179.44, "sample_throughput": 6443.735, "learn_time_ms": 2123.635, "learn_throughput": 3578.769, "update_time_ms": 2.78}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.004095748788677156, "policy_loss": -0.007519644669567545, "vf_loss": 0.00265621142849947, "vf_explained_var": 0.7972627878189087, "kl": 0.00614146541726465, "entropy": -3.7769249081611633, "entropy_coeff": 0.0}}, "num_steps_sampled": 182400, "num_steps_trained": 182400}, "done": false, "episodes_total": 152, "training_iteration": 24, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-20", "timestamp": 1617634040, "time_this_iter_s": 3.3305201530456543, "time_total_s": 73.73752498626709, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.179118156433105, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.14, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.44390166643154927, "episode_reward_mean": 0.1241276939062877, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2466253810904653, 0.562082210959395, 0.23245756102064696, -0.21448389406058188, 0.45994396795815984, 0.08154577919016082, -0.07198562180557078, 0.025558700116501853, 0.2325135577898667, 0.5287028615379294, 0.39439511141931294, 0.0922813037150616, 0.3330772826342556, -0.1054294407623404, 0.1205312400894265, 0.18206699845691876, -0.17254083627743, -0.11755079234758015, -0.15916952567460452, -0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817, -0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18847750038631075, "mean_inference_ms": 1.2717616651571442, "mean_action_processing_ms": 0.05437774628827856, "mean_env_wait_ms": 1.2548692259907372, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 190000, "timers": {"sample_time_ms": 1186.913, "sample_throughput": 6403.165, "learn_time_ms": 2125.127, "learn_throughput": 3576.257, "update_time_ms": 2.762}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0008501367565865318, "policy_loss": -0.003688905294984579, "vf_loss": 0.0021838181283480177, "vf_explained_var": 0.7600519061088562, "kl": 0.005239605472888797, "entropy": -3.82384862502416, "entropy_coeff": 0.0}}, "num_steps_sampled": 190000, "num_steps_trained": 190000}, "done": false, "episodes_total": 171, "training_iteration": 25, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-23", "timestamp": 1617634043, "time_this_iter_s": 3.3834822177886963, "time_total_s": 77.12100720405579, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.5626003742218, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.959999999999994, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.44390166643154927, "episode_reward_mean": 0.12412769390628772, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817, -0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484, 1.2466253810904653, 0.562082210959395, 0.23245756102064696, -0.21448389406058188, 0.45994396795815984, 0.08154577919016082, -0.07198562180557078, 0.025558700116501853, 0.2325135577898667, 0.5287028615379294, 0.39439511141931294, 0.0922813037150616, 0.3330772826342556, -0.1054294407623404, 0.1205312400894265, 0.18206699845691876, -0.17254083627743, -0.11755079234758015, -0.15916952567460452], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18847750038631078, "mean_inference_ms": 1.2717616651571442, "mean_action_processing_ms": 0.05437774628827855, "mean_env_wait_ms": 1.2548692259907375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 197600, "timers": {"sample_time_ms": 1179.161, "sample_throughput": 6445.261, "learn_time_ms": 2126.259, "learn_throughput": 3574.353, "update_time_ms": 2.772}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0003962021010617415, "policy_loss": -0.0037790046849598487, "vf_loss": 0.002668722689850256, "vf_explained_var": 0.8149126172065735, "kl": 0.005712659831624478, "entropy": -3.886645273367564, "entropy_coeff": 0.0}}, "num_steps_sampled": 197600, "num_steps_trained": 197600}, "done": false, "episodes_total": 171, "training_iteration": 26, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-26", "timestamp": 1617634046, "time_this_iter_s": 3.260594129562378, "time_total_s": 80.38160133361816, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.82319450378418, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.6, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.46662324472836225, "episode_reward_mean": 0.14696821343811775, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9160541317987725, -0.12949977110099098, -0.039261709661134514, 0.30030422209312735, 0.15733847880413432, -0.12686557748439564, 0.6334066971816901, 0.9888199523211627, 1.0132759822447746, 0.04159309016203028, -0.46662324472836225, 0.061154875181511414, 0.3189303955316243, -0.26575307594644715, 0.047282831864568164, 0.5379723819836404, -0.14140012020819548, -0.2187706937566567, 0.4663468223576952, -0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817, -0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484, 1.2466253810904653, 0.562082210959395, 0.23245756102064696, -0.21448389406058188, 0.45994396795815984, 0.08154577919016082, -0.07198562180557078, 0.025558700116501853, 0.2325135577898667, 0.5287028615379294, 0.39439511141931294, 0.0922813037150616, 0.3330772826342556, -0.1054294407623404, 0.1205312400894265, 0.18206699845691876, -0.17254083627743, -0.11755079234758015, -0.15916952567460452], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904544976145708, "mean_inference_ms": 1.2723120737571318, "mean_action_processing_ms": 0.054396567109735845, "mean_env_wait_ms": 1.2475209666156928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 205200, "timers": {"sample_time_ms": 1183.393, "sample_throughput": 6422.212, "learn_time_ms": 2132.645, "learn_throughput": 3563.65, "update_time_ms": 2.765}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0010804033062110344, "policy_loss": -0.004786660770575205, "vf_loss": 0.003147923880411933, "vf_explained_var": 0.6995530724525452, "kl": 0.004466680879704654, "entropy": -3.925383941332499, "entropy_coeff": 0.0}}, "num_steps_sampled": 205200, "num_steps_trained": 205200}, "done": false, "episodes_total": 190, "training_iteration": 27, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-30", "timestamp": 1617634050, "time_this_iter_s": 3.420185089111328, "time_total_s": 83.80178642272949, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.24337959289551, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 37.96, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.46662324472836225, "episode_reward_mean": 0.14696821343811772, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817, -0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484, 1.2466253810904653, 0.562082210959395, 0.23245756102064696, -0.21448389406058188, 0.45994396795815984, 0.08154577919016082, -0.07198562180557078, 0.025558700116501853, 0.2325135577898667, 0.5287028615379294, 0.39439511141931294, 0.0922813037150616, 0.3330772826342556, -0.1054294407623404, 0.1205312400894265, 0.18206699845691876, -0.17254083627743, -0.11755079234758015, -0.15916952567460452, 0.9160541317987725, -0.12949977110099098, -0.039261709661134514, 0.30030422209312735, 0.15733847880413432, -0.12686557748439564, 0.6334066971816901, 0.9888199523211627, 1.0132759822447746, 0.04159309016203028, -0.46662324472836225, 0.061154875181511414, 0.3189303955316243, -0.26575307594644715, 0.047282831864568164, 0.5379723819836404, -0.14140012020819548, -0.2187706937566567, 0.4663468223576952], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904544976145708, "mean_inference_ms": 1.2723120737571318, "mean_action_processing_ms": 0.054396567109735845, "mean_env_wait_ms": 1.2475209666156926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 212800, "timers": {"sample_time_ms": 1165.937, "sample_throughput": 6518.36, "learn_time_ms": 2148.693, "learn_throughput": 3537.035, "update_time_ms": 2.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.0030011365345368785, "policy_loss": -0.00552180246450007, "vf_loss": 0.002195165630352373, "vf_explained_var": 0.8075682520866394, "kl": 0.005208000175965329, "entropy": -3.8935372114181517, "entropy_coeff": 0.0}}, "num_steps_sampled": 212800, "num_steps_trained": 212800}, "done": false, "episodes_total": 190, "training_iteration": 28, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-33", "timestamp": 1617634053, "time_this_iter_s": 3.317835569381714, "time_total_s": 87.1196219921112, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 36.56121516227722, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.2, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.46662324472836225, "episode_reward_mean": 0.14696821343811772, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817, -0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484, 1.2466253810904653, 0.562082210959395, 0.23245756102064696, -0.21448389406058188, 0.45994396795815984, 0.08154577919016082, -0.07198562180557078, 0.025558700116501853, 0.2325135577898667, 0.5287028615379294, 0.39439511141931294, 0.0922813037150616, 0.3330772826342556, -0.1054294407623404, 0.1205312400894265, 0.18206699845691876, -0.17254083627743, -0.11755079234758015, -0.15916952567460452, 0.9160541317987725, -0.12949977110099098, -0.039261709661134514, 0.30030422209312735, 0.15733847880413432, -0.12686557748439564, 0.6334066971816901, 0.9888199523211627, 1.0132759822447746, 0.04159309016203028, -0.46662324472836225, 0.061154875181511414, 0.3189303955316243, -0.26575307594644715, 0.047282831864568164, 0.5379723819836404, -0.14140012020819548, -0.2187706937566567, 0.4663468223576952], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1904544976145708, "mean_inference_ms": 1.2723120737571318, "mean_action_processing_ms": 0.054396567109735845, "mean_env_wait_ms": 1.2475209666156926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 220400, "timers": {"sample_time_ms": 1202.809, "sample_throughput": 6318.541, "learn_time_ms": 2154.263, "learn_throughput": 3527.888, "update_time_ms": 2.805}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.0014221690750370424, "policy_loss": -0.004500979821508129, "vf_loss": 0.002694002055795863, "vf_explained_var": 0.8078129291534424, "kl": 0.006156943296082318, "entropy": -3.8426506320635476, "entropy_coeff": 0.0}}, "num_steps_sampled": 220400, "num_steps_trained": 220400}, "done": false, "episodes_total": 190, "training_iteration": 29, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-37", "timestamp": 1617634057, "time_this_iter_s": 3.6551833152770996, "time_total_s": 90.7748053073883, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.21639847755432, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 43.12, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.46662324472836225, "episode_reward_mean": 0.1709135581935047, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.45011723289635275, 0.17058502705888223, 0.9209564055834489, 0.14362857110293192, 0.18171238590632544, 0.6641956476563637, 0.9932120819660242, 0.240104336290073, 0.09316557449236829, 0.2981441557995368, 0.14788047275285465, -0.12062931066257288, -0.04709874276169734, -0.09897257744341148, 0.4406477714691135, 0.4277200134513657, -0.10840939609298539, 0.31948013945144793, -0.04923598183042455, -0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817, -0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484, 1.2466253810904653, 0.562082210959395, 0.23245756102064696, -0.21448389406058188, 0.45994396795815984, 0.08154577919016082, -0.07198562180557078, 0.025558700116501853, 0.2325135577898667, 0.5287028615379294, 0.39439511141931294, 0.0922813037150616, 0.3330772826342556, -0.1054294407623404, 0.1205312400894265, 0.18206699845691876, -0.17254083627743, -0.11755079234758015, -0.15916952567460452, 0.9160541317987725, -0.12949977110099098, -0.039261709661134514, 0.30030422209312735, 0.15733847880413432, -0.12686557748439564, 0.6334066971816901, 0.9888199523211627, 1.0132759822447746, 0.04159309016203028, -0.46662324472836225, 0.061154875181511414, 0.3189303955316243, -0.26575307594644715, 0.047282831864568164, 0.5379723819836404, -0.14140012020819548, -0.2187706937566567, 0.4663468223576952], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19100112012898657, "mean_inference_ms": 1.285588556824801, "mean_action_processing_ms": 0.054411723092744155, "mean_env_wait_ms": 1.2419685569001728, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 228000, "timers": {"sample_time_ms": 1202.705, "sample_throughput": 6319.092, "learn_time_ms": 2150.12, "learn_throughput": 3534.686, "update_time_ms": 2.854}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.003455946035683155, "policy_loss": -0.006319121535246571, "vf_loss": 0.0025394223785648743, "vf_explained_var": 0.6996713876724243, "kl": 0.005180048639886081, "entropy": -3.895706820487976, "entropy_coeff": 0.0}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 209, "training_iteration": 30, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-40", "timestamp": 1617634060, "time_this_iter_s": 3.3536860942840576, "time_total_s": 94.12849140167236, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.57008457183838, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.34, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.6746518492464024, "episode_reward_min": -0.46662324472836225, "episode_reward_mean": 0.17091355819350465, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.15573237027831488, 1.6746518492464024, 0.4141270729297557, 0.5600635852965323, -0.3923474309882123, -0.11991067777838904, -0.20169591891925265, 0.8182737995981089, -0.2585946099233339, -0.0914186796917229, 0.5122667742555558, -0.3365992637853594, -0.3918063418629605, 0.37003759156473204, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817, -0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484, 1.2466253810904653, 0.562082210959395, 0.23245756102064696, -0.21448389406058188, 0.45994396795815984, 0.08154577919016082, -0.07198562180557078, 0.025558700116501853, 0.2325135577898667, 0.5287028615379294, 0.39439511141931294, 0.0922813037150616, 0.3330772826342556, -0.1054294407623404, 0.1205312400894265, 0.18206699845691876, -0.17254083627743, -0.11755079234758015, -0.15916952567460452, 0.9160541317987725, -0.12949977110099098, -0.039261709661134514, 0.30030422209312735, 0.15733847880413432, -0.12686557748439564, 0.6334066971816901, 0.9888199523211627, 1.0132759822447746, 0.04159309016203028, -0.46662324472836225, 0.061154875181511414, 0.3189303955316243, -0.26575307594644715, 0.047282831864568164, 0.5379723819836404, -0.14140012020819548, -0.2187706937566567, 0.4663468223576952, 0.45011723289635275, 0.17058502705888223, 0.9209564055834489, 0.14362857110293192, 0.18171238590632544, 0.6641956476563637, 0.9932120819660242, 0.240104336290073, 0.09316557449236829, 0.2981441557995368, 0.14788047275285465, -0.12062931066257288, -0.04709874276169734, -0.09897257744341148, 0.4406477714691135, 0.4277200134513657, -0.10840939609298539, 0.31948013945144793, -0.04923598183042455], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19100112012898657, "mean_inference_ms": 1.2855885568248009, "mean_action_processing_ms": 0.054411723092744155, "mean_env_wait_ms": 1.2419685569001728, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 235600, "timers": {"sample_time_ms": 1206.095, "sample_throughput": 6301.329, "learn_time_ms": 2157.01, "learn_throughput": 3523.396, "update_time_ms": 2.839}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.0006688841851428152, "policy_loss": -0.003409384524760147, "vf_loss": 0.0023075733954707783, "vf_explained_var": 0.8412313461303711, "kl": 0.006926824067098399, "entropy": -4.013032110532125, "entropy_coeff": 0.0}}, "num_steps_sampled": 235600, "num_steps_trained": 235600}, "done": false, "episodes_total": 209, "training_iteration": 31, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-44", "timestamp": 1617634064, "time_this_iter_s": 3.3685226440429688, "time_total_s": 97.49701404571533, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.93860721588135, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 35.58, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.2466253810904653, "episode_reward_min": -0.46662324472836225, "episode_reward_mean": 0.17820999477758231, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.41041330371580775, 0.377790248482887, 0.04375535039662637, 0.25199879290827387, 0.2144024207100388, 0.09987236491844742, 0.15213349398651377, -0.22573682918061888, -0.2134731181984656, 0.20349776794482133, 0.2278267586638576, -0.08839911573733916, 0.6728245127344696, 0.39557869666572043, -0.007436605454761103, 0.32005510881009047, 0.804010318508481, -0.03514803174090109, 0.38156139090487784, 0.48378008597215416, -0.08295359210258813, -0.2941139803241172, -0.2701939718904249, 0.08765908386282817, -0.024100551549019023, 0.46979789151615137, 0.4446371062986312, 0.15506982273877634, -0.058381154473359786, -0.36855843532199717, 0.47565735416021737, -0.3740444367901381, -0.12610137799310128, -0.07741099364313275, 0.13081633595608988, 0.47321352316487375, 0.6711516080218483, -0.03990852020651947, -0.3633081542750375, -0.29037130666701605, -0.44390166643154927, 0.516167473984779, -0.071260816063484, 1.2466253810904653, 0.562082210959395, 0.23245756102064696, -0.21448389406058188, 0.45994396795815984, 0.08154577919016082, -0.07198562180557078, 0.025558700116501853, 0.2325135577898667, 0.5287028615379294, 0.39439511141931294, 0.0922813037150616, 0.3330772826342556, -0.1054294407623404, 0.1205312400894265, 0.18206699845691876, -0.17254083627743, -0.11755079234758015, -0.15916952567460452, 0.9160541317987725, -0.12949977110099098, -0.039261709661134514, 0.30030422209312735, 0.15733847880413432, -0.12686557748439564, 0.6334066971816901, 0.9888199523211627, 1.0132759822447746, 0.04159309016203028, -0.46662324472836225, 0.061154875181511414, 0.3189303955316243, -0.26575307594644715, 0.047282831864568164, 0.5379723819836404, -0.14140012020819548, -0.2187706937566567, 0.4663468223576952, 0.45011723289635275, 0.17058502705888223, 0.9209564055834489, 0.14362857110293192, 0.18171238590632544, 0.6641956476563637, 0.9932120819660242, 0.240104336290073, 0.09316557449236829, 0.2981441557995368, 0.14788047275285465, -0.12062931066257288, -0.04709874276169734, -0.09897257744341148, 0.4406477714691135, 0.4277200134513657, -0.10840939609298539, 0.31948013945144793, -0.04923598183042455], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1941239248630467, "mean_inference_ms": 1.2962761457783412, "mean_action_processing_ms": 0.054400286080954485, "mean_env_wait_ms": 1.2313830461258675, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 243200, "timers": {"sample_time_ms": 1204.787, "sample_throughput": 6308.17, "learn_time_ms": 2162.504, "learn_throughput": 3514.444, "update_time_ms": 2.823}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.0010147068339089553, "policy_loss": -0.004171649490793546, "vf_loss": 0.0028182113155101737, "vf_explained_var": 0.733890175819397, "kl": 0.005419714407374461, "entropy": -3.9361717263857523, "entropy_coeff": 0.0}}, "num_steps_sampled": 243200, "num_steps_trained": 243200}, "done": false, "episodes_total": 228, "training_iteration": 32, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-47-47", "timestamp": 1617634067, "time_this_iter_s": 3.390281915664673, "time_total_s": 100.88729596138, "pid": 1494, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.32888913154602, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.44, "ram_util_percent": 61.8}, "trial_id": "315ff_00001"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 250800, "timers": {"sample_time_ms": 1315.537, "sample_throughput": 5777.107, "learn_time_ms": 2132.776, "learn_throughput": 3563.432, "update_time_ms": 2.514}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0016658912420044608, "total_loss": -0.00030987202189862727, "policy_loss": -0.005249765468761325, "vf_loss": 0.002149872153919811, "vf_explained_var": 0.822268545627594, "kl": 0.0027900204392305263, "entropy": -3.9503403425216677, "entropy_coeff": 0.0}}, "num_steps_sampled": 250800, "num_steps_trained": 250800}, "done": false, "episodes_total": 228, "training_iteration": 33, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-50-33", "timestamp": 1617634233, "time_this_iter_s": 3.4548871517181396, "time_total_s": 104.34218311309814, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3.4548871517181396, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 53.4, "ram_util_percent": 61.7}, "trial_id": "315ff_00001"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 258400, "timers": {"sample_time_ms": 1212.317, "sample_throughput": 6268.987, "learn_time_ms": 2153.459, "learn_throughput": 3529.205, "update_time_ms": 2.455}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.0016658912420044608, "total_loss": -0.00013476181775331497, "policy_loss": -0.005604082035521666, "vf_loss": 0.003161415702197701, "vf_explained_var": 0.7579149603843689, "kl": 0.004615808965172619, "entropy": -3.862149198849996, "entropy_coeff": 0.0}}, "num_steps_sampled": 258400, "num_steps_trained": 258400}, "done": false, "episodes_total": 228, "training_iteration": 34, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-50-36", "timestamp": 1617634236, "time_this_iter_s": 3.290900945663452, "time_total_s": 107.6330840587616, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.745788097381592, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.480000000000004, "ram_util_percent": 61.86}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.9275770400614356, "episode_reward_min": -0.11355590170681873, "episode_reward_mean": 0.21117742856787017, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1788424998371611, "mean_inference_ms": 1.2924548092730137, "mean_action_processing_ms": 0.05516525718915984, "mean_env_wait_ms": 1.2979068724340839, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 266000, "timers": {"sample_time_ms": 1234.751, "sample_throughput": 6155.087, "learn_time_ms": 2197.849, "learn_throughput": 3457.926, "update_time_ms": 2.472}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.0016658912420044608, "total_loss": -0.00287927589379251, "policy_loss": -0.00710987658239901, "vf_loss": 0.00313190195010975, "vf_explained_var": 0.719670832157135, "kl": 0.00439479105019321, "entropy": -3.931807827949524, "entropy_coeff": 0.0}}, "num_steps_sampled": 266000, "num_steps_trained": 266000}, "done": false, "episodes_total": 247, "training_iteration": 35, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-50-40", "timestamp": 1617634240, "time_this_iter_s": 3.5745112895965576, "time_total_s": 111.20759534835815, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.32029938697815, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.3, "ram_util_percent": 61.92}, "trial_id": "315ff_00001"}
{"episode_reward_max": 0.9275770400614356, "episode_reward_min": -0.11355590170681873, "episode_reward_mean": 0.21117742856787017, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1788424998371611, "mean_inference_ms": 1.2924548092730137, "mean_action_processing_ms": 0.05516525718915984, "mean_env_wait_ms": 1.2979068724340839, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 273600, "timers": {"sample_time_ms": 1217.135, "sample_throughput": 6244.172, "learn_time_ms": 2180.802, "learn_throughput": 3484.957, "update_time_ms": 2.574}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": 0.0011296894556532303, "policy_loss": -0.0022723406708488863, "vf_loss": 0.00264873964091142, "vf_explained_var": 0.8244603872299194, "kl": 0.0060263299538443485, "entropy": -4.060464775562286, "entropy_coeff": 0.0}}, "num_steps_sampled": 273600, "num_steps_trained": 273600}, "done": false, "episodes_total": 247, "training_iteration": 36, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-50-43", "timestamp": 1617634243, "time_this_iter_s": 3.302731513977051, "time_total_s": 114.5103268623352, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.6230309009552, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 37.02, "ram_util_percent": 61.92}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.14766036394173399, "episode_reward_mean": 0.2853465657411494, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346, -0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1879391034878206, "mean_inference_ms": 1.2949970555619854, "mean_action_processing_ms": 0.05522548782420905, "mean_env_wait_ms": 1.2841770940418513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 281200, "timers": {"sample_time_ms": 1220.413, "sample_throughput": 6227.402, "learn_time_ms": 2167.261, "learn_throughput": 3506.73, "update_time_ms": 2.617}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0014150334056466818, "policy_loss": -0.0052706582626948755, "vf_loss": 0.0031748068945792814, "vf_explained_var": 0.7025423049926758, "kl": 0.005446554464288056, "entropy": -4.005977427959442, "entropy_coeff": 0.0}}, "num_steps_sampled": 281200, "num_steps_trained": 281200}, "done": false, "episodes_total": 266, "training_iteration": 37, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-50-46", "timestamp": 1617634246, "time_this_iter_s": 3.355210542678833, "time_total_s": 117.86553740501404, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.978241443634033, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.54, "ram_util_percent": 61.9}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.14766036394173399, "episode_reward_mean": 0.2853465657411494, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087, 1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18793910348782064, "mean_inference_ms": 1.2949970555619854, "mean_action_processing_ms": 0.05522548782420905, "mean_env_wait_ms": 1.2841770940418515, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 288800, "timers": {"sample_time_ms": 1202.017, "sample_throughput": 6322.707, "learn_time_ms": 2155.81, "learn_throughput": 3525.357, "update_time_ms": 2.668}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0014410410542041064, "policy_loss": -0.004749787389300764, "vf_loss": 0.0025889388091551763, "vf_explained_var": 0.8426774144172668, "kl": 0.005758445663377643, "entropy": -4.003421700000763, "entropy_coeff": 0.0}}, "num_steps_sampled": 288800, "num_steps_trained": 288800}, "done": false, "episodes_total": 266, "training_iteration": 38, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-50-50", "timestamp": 1617634250, "time_this_iter_s": 3.2169971466064453, "time_total_s": 121.08253455162048, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.19523859024048, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.650000000000006, "ram_util_percent": 61.9}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.14766036394173399, "episode_reward_mean": 0.2853465657411494, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087, 1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18793910348782064, "mean_inference_ms": 1.2949970555619854, "mean_action_processing_ms": 0.05522548782420905, "mean_env_wait_ms": 1.2841770940418515, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 296400, "timers": {"sample_time_ms": 1188.459, "sample_throughput": 6394.838, "learn_time_ms": 2160.542, "learn_throughput": 3517.636, "update_time_ms": 2.659}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": 0.0004542946039388577, "policy_loss": -0.003381241609652837, "vf_loss": 0.003025024923651169, "vf_explained_var": 0.7591415047645569, "kl": 0.006484082030753294, "entropy": -3.9861145337422688, "entropy_coeff": 0.0}}, "num_steps_sampled": 296400, "num_steps_trained": 296400}, "done": false, "episodes_total": 266, "training_iteration": 39, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-50-53", "timestamp": 1617634253, "time_this_iter_s": 3.304394006729126, "time_total_s": 124.38692855834961, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.499632596969604, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.62, "ram_util_percent": 61.94}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.19760656790670128, "episode_reward_mean": 0.255144097433549, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.1739123468096313, 0.1208913936428957, 1.1182091646939685, 0.1585752899872277, -0.03576634781834376, -0.115331923076889, 0.03883902973328435, 0.0003094270993537762, 0.06409988772981645, 0.03975928396124884, 0.376923616038215, 0.5416911317167101, 0.1122830413512288, 0.26707672776198965, 0.039994374597392524, 0.061272910136187075, 0.041104292880896676, 0.8938069762105056, -0.19760656790670128, -0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087, 1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1888749683796411, "mean_inference_ms": 1.2930133434050386, "mean_action_processing_ms": 0.05513169723506989, "mean_env_wait_ms": 1.2712889205943363, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 304000, "timers": {"sample_time_ms": 1196.684, "sample_throughput": 6350.881, "learn_time_ms": 2166.521, "learn_throughput": 3507.928, "update_time_ms": 2.665}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.00406220443546772, "policy_loss": -0.008321751204008857, "vf_loss": 0.003614197749023636, "vf_explained_var": 0.7293458580970764, "kl": 0.005162772365535299, "entropy": -4.096558137734731, "entropy_coeff": 0.0}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 285, "training_iteration": 40, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-50-57", "timestamp": 1617634257, "time_this_iter_s": 3.4712653160095215, "time_total_s": 127.85819387435913, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.970897912979126, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.28000000000001, "ram_util_percent": 62.0}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.19760656790670128, "episode_reward_mean": 0.255144097433549, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087, 1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346, 0.1739123468096313, 0.1208913936428957, 1.1182091646939685, 0.1585752899872277, -0.03576634781834376, -0.115331923076889, 0.03883902973328435, 0.0003094270993537762, 0.06409988772981645, 0.03975928396124884, 0.376923616038215, 0.5416911317167101, 0.1122830413512288, 0.26707672776198965, 0.039994374597392524, 0.061272910136187075, 0.041104292880896676, 0.8938069762105056, -0.19760656790670128], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1888749683796411, "mean_inference_ms": 1.2930133434050386, "mean_action_processing_ms": 0.05513169723506989, "mean_env_wait_ms": 1.2712889205943365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 311600, "timers": {"sample_time_ms": 1190.863, "sample_throughput": 6381.926, "learn_time_ms": 2165.602, "learn_throughput": 3509.417, "update_time_ms": 2.667}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0027102301828563213, "policy_loss": -0.005797823301206032, "vf_loss": 0.002382957727725928, "vf_explained_var": 0.83194500207901, "kl": 0.0056370821703846255, "entropy": -4.148497025171916, "entropy_coeff": 0.0}}, "num_steps_sampled": 311600, "num_steps_trained": 311600}, "done": false, "episodes_total": 285, "training_iteration": 41, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-51-00", "timestamp": 1617634260, "time_this_iter_s": 3.311215400695801, "time_total_s": 131.16940927505493, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.282113313674927, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 36.879999999999995, "ram_util_percent": 62.0}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.19760656790670128, "episode_reward_mean": 0.2462807224647025, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.07457153755745338, -0.18374982834313014, -0.11171403827283422, 0.45074724725586557, 0.4079046089469862, -0.022289105014357546, 0.5236191183371532, 0.28142017796554186, 0.18774584996905608, 0.7327049447717822, 0.013479005128508303, 0.47370142864977827, 0.17556844950170514, 0.5260711465834995, 0.3193631568025763, 0.1783478474108744, 0.03867720318757972, 0.23191004938644855, 0.02518562889551701, -0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087, 1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346, 0.1739123468096313, 0.1208913936428957, 1.1182091646939685, 0.1585752899872277, -0.03576634781834376, -0.115331923076889, 0.03883902973328435, 0.0003094270993537762, 0.06409988772981645, 0.03975928396124884, 0.376923616038215, 0.5416911317167101, 0.1122830413512288, 0.26707672776198965, 0.039994374597392524, 0.061272910136187075, 0.041104292880896676, 0.8938069762105056, -0.19760656790670128], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909443254853279, "mean_inference_ms": 1.293536048641944, "mean_action_processing_ms": 0.05515310876504853, "mean_env_wait_ms": 1.2650097106860612, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 319200, "timers": {"sample_time_ms": 1202.632, "sample_throughput": 6319.47, "learn_time_ms": 2162.864, "learn_throughput": 3513.859, "update_time_ms": 2.654}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0016658912420044608, "total_loss": -0.0009336644783616066, "policy_loss": -0.004240527066091696, "vf_loss": 0.002703298901906237, "vf_explained_var": 0.7721121311187744, "kl": 0.00482850093782569, "entropy": -4.0871077140172325, "entropy_coeff": 0.0}}, "num_steps_sampled": 319200, "num_steps_trained": 319200}, "done": false, "episodes_total": 304, "training_iteration": 42, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-51-03", "timestamp": 1617634263, "time_this_iter_s": 3.455190658569336, "time_total_s": 134.62459993362427, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.73730397224426, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.54, "ram_util_percent": 62.0}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.19760656790670128, "episode_reward_mean": 0.24628072246470256, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087, 1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346, 0.1739123468096313, 0.1208913936428957, 1.1182091646939685, 0.1585752899872277, -0.03576634781834376, -0.115331923076889, 0.03883902973328435, 0.0003094270993537762, 0.06409988772981645, 0.03975928396124884, 0.376923616038215, 0.5416911317167101, 0.1122830413512288, 0.26707672776198965, 0.039994374597392524, 0.061272910136187075, 0.041104292880896676, 0.8938069762105056, -0.19760656790670128, -0.07457153755745338, -0.18374982834313014, -0.11171403827283422, 0.45074724725586557, 0.4079046089469862, -0.022289105014357546, 0.5236191183371532, 0.28142017796554186, 0.18774584996905608, 0.7327049447717822, 0.013479005128508303, 0.47370142864977827, 0.17556844950170514, 0.5260711465834995, 0.3193631568025763, 0.1783478474108744, 0.03867720318757972, 0.23191004938644855, 0.02518562889551701], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19094432548532791, "mean_inference_ms": 1.293536048641944, "mean_action_processing_ms": 0.055153108765048545, "mean_env_wait_ms": 1.2650097106860612, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 326800, "timers": {"sample_time_ms": 1187.98, "sample_throughput": 6397.415, "learn_time_ms": 2164.624, "learn_throughput": 3511.002, "update_time_ms": 2.67}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.004028968350030482, "policy_loss": -0.006983631352583567, "vf_loss": 0.002547548666674023, "vf_explained_var": 0.8461980223655701, "kl": 0.0065137974374617135, "entropy": -4.093472150961558, "entropy_coeff": 0.0}}, "num_steps_sampled": 326800, "num_steps_trained": 326800}, "done": false, "episodes_total": 304, "training_iteration": 43, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-51-07", "timestamp": 1617634267, "time_this_iter_s": 3.328017473220825, "time_total_s": 137.9526174068451, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.06532144546509, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 37.42, "ram_util_percent": 62.0}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.19760656790670128, "episode_reward_mean": 0.24628072246470256, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087, 1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346, 0.1739123468096313, 0.1208913936428957, 1.1182091646939685, 0.1585752899872277, -0.03576634781834376, -0.115331923076889, 0.03883902973328435, 0.0003094270993537762, 0.06409988772981645, 0.03975928396124884, 0.376923616038215, 0.5416911317167101, 0.1122830413512288, 0.26707672776198965, 0.039994374597392524, 0.061272910136187075, 0.041104292880896676, 0.8938069762105056, -0.19760656790670128, -0.07457153755745338, -0.18374982834313014, -0.11171403827283422, 0.45074724725586557, 0.4079046089469862, -0.022289105014357546, 0.5236191183371532, 0.28142017796554186, 0.18774584996905608, 0.7327049447717822, 0.013479005128508303, 0.47370142864977827, 0.17556844950170514, 0.5260711465834995, 0.3193631568025763, 0.1783478474108744, 0.03867720318757972, 0.23191004938644855, 0.02518562889551701], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19094432548532791, "mean_inference_ms": 1.293536048641944, "mean_action_processing_ms": 0.055153108765048545, "mean_env_wait_ms": 1.2650097106860612, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 334400, "timers": {"sample_time_ms": 1226.132, "sample_throughput": 6198.353, "learn_time_ms": 2162.412, "learn_throughput": 3514.594, "update_time_ms": 2.717}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.004580467768634359, "policy_loss": -0.007692245161160826, "vf_loss": 0.0027231374852514515, "vf_explained_var": 0.7869607210159302, "kl": 0.006218223964485029, "entropy": -3.9093041737874348, "entropy_coeff": 0.0}}, "num_steps_sampled": 334400, "num_steps_trained": 334400}, "done": false, "episodes_total": 304, "training_iteration": 44, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-51-10", "timestamp": 1617634270, "time_this_iter_s": 3.651564598083496, "time_total_s": 141.6041820049286, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.716886043548584, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 44.22, "ram_util_percent": 62.0}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.21725038417706388, "episode_reward_mean": 0.2544148559201095, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.17431987952501138, 0.19151901359025358, 0.051175695382451813, 0.014710568414730396, 0.5648419036715953, 0.10007164877409047, 1.053183971475542, 0.09099187437244782, 1.011781810149683, -0.21083278013150086, 1.136794026382895, -0.21725038417706388, 0.026321551525970488, 0.2530991383677046, -0.16744168493841594, 0.6514928426977096, 0.18212336919192307, 0.3940811031547411, 0.15109285766324176, -0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087, 1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346, 0.1739123468096313, 0.1208913936428957, 1.1182091646939685, 0.1585752899872277, -0.03576634781834376, -0.115331923076889, 0.03883902973328435, 0.0003094270993537762, 0.06409988772981645, 0.03975928396124884, 0.376923616038215, 0.5416911317167101, 0.1122830413512288, 0.26707672776198965, 0.039994374597392524, 0.061272910136187075, 0.041104292880896676, 0.8938069762105056, -0.19760656790670128, -0.07457153755745338, -0.18374982834313014, -0.11171403827283422, 0.45074724725586557, 0.4079046089469862, -0.022289105014357546, 0.5236191183371532, 0.28142017796554186, 0.18774584996905608, 0.7327049447717822, 0.013479005128508303, 0.47370142864977827, 0.17556844950170514, 0.5260711465834995, 0.3193631568025763, 0.1783478474108744, 0.03867720318757972, 0.23191004938644855, 0.02518562889551701], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1918595507371528, "mean_inference_ms": 1.308182575215891, "mean_action_processing_ms": 0.055205119846425725, "mean_env_wait_ms": 1.261271233113144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 342000, "timers": {"sample_time_ms": 1230.535, "sample_throughput": 6176.177, "learn_time_ms": 2154.406, "learn_throughput": 3527.654, "update_time_ms": 2.749}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.0025173367156336706, "policy_loss": -0.005652193631976843, "vf_loss": 0.0027258080798977366, "vf_explained_var": 0.8089583516120911, "kl": 0.006544781080447137, "entropy": -4.081282154719035, "entropy_coeff": 0.0}}, "num_steps_sampled": 342000, "num_steps_trained": 342000}, "done": false, "episodes_total": 323, "training_iteration": 45, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-51-14", "timestamp": 1617634274, "time_this_iter_s": 3.5390212535858154, "time_total_s": 145.1432032585144, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.2559072971344, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 40.699999999999996, "ram_util_percent": 62.239999999999995}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.21725038417706388, "episode_reward_mean": 0.2544148559201095, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.015166826296158176, 0.4837115217192114, 0.21142691691324944, 0.013437558894265011, -0.07473541908811143, 0.08105505516442157, 0.14931043311463688, 0.7825418216095661, 0.09751796293491699, 0.019686229841511693, -0.11355590170681873, 0.14009369060180066, 0.38833391676759654, 0.14678985787149057, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087, 1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346, 0.1739123468096313, 0.1208913936428957, 1.1182091646939685, 0.1585752899872277, -0.03576634781834376, -0.115331923076889, 0.03883902973328435, 0.0003094270993537762, 0.06409988772981645, 0.03975928396124884, 0.376923616038215, 0.5416911317167101, 0.1122830413512288, 0.26707672776198965, 0.039994374597392524, 0.061272910136187075, 0.041104292880896676, 0.8938069762105056, -0.19760656790670128, -0.07457153755745338, -0.18374982834313014, -0.11171403827283422, 0.45074724725586557, 0.4079046089469862, -0.022289105014357546, 0.5236191183371532, 0.28142017796554186, 0.18774584996905608, 0.7327049447717822, 0.013479005128508303, 0.47370142864977827, 0.17556844950170514, 0.5260711465834995, 0.3193631568025763, 0.1783478474108744, 0.03867720318757972, 0.23191004938644855, 0.02518562889551701, 0.17431987952501138, 0.19151901359025358, 0.051175695382451813, 0.014710568414730396, 0.5648419036715953, 0.10007164877409047, 1.053183971475542, 0.09099187437244782, 1.011781810149683, -0.21083278013150086, 1.136794026382895, -0.21725038417706388, 0.026321551525970488, 0.2530991383677046, -0.16744168493841594, 0.6514928426977096, 0.18212336919192307, 0.3940811031547411, 0.15109285766324176], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19185955073715286, "mean_inference_ms": 1.3081825752158909, "mean_action_processing_ms": 0.05520511984642572, "mean_env_wait_ms": 1.2612712331131437, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 349600, "timers": {"sample_time_ms": 1233.252, "sample_throughput": 6162.569, "learn_time_ms": 2163.075, "learn_throughput": 3513.516, "update_time_ms": 2.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.0012230421571681896, "policy_loss": -0.004461856745183468, "vf_loss": 0.002768055512569845, "vf_explained_var": 0.8309546709060669, "kl": 0.007532132719643414, "entropy": -4.053157595793406, "entropy_coeff": 0.0}}, "num_steps_sampled": 349600, "num_steps_trained": 349600}, "done": false, "episodes_total": 323, "training_iteration": 46, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-51-17", "timestamp": 1617634277, "time_this_iter_s": 3.4167275428771973, "time_total_s": 148.5599308013916, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.6726348400116, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 36.28, "ram_util_percent": 62.260000000000005}, "trial_id": "315ff_00001"}
{"episode_reward_max": 1.4539709158738652, "episode_reward_min": -0.330655990467703, "episode_reward_mean": 0.25865959140569467, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.330655990467703, 0.289289008738038, 0.5805858102195394, -0.10965399239695517, 0.5987209287742439, 0.0363082565709576, 0.23197659384854563, 0.4109193104155433, 0.17581370815703123, 0.3908463436539815, 0.5413509395424052, 0.0225236946088736, 0.21621196263332587, -0.2249089091334694, 0.20655569078206493, 0.7214415742808267, 0.1917995272233266, 0.02517211725621138, 0.03269807179385831, 0.13325719575766315, 0.9275770400614356, 0.6529859110787699, -0.000536589174060409, -0.011359233275853087, 1.4539709158738652, 0.15631258892611744, 0.181381709927247, 0.6405408044332432, 0.5404757047950792, 0.24316565036525795, 0.4601814770447592, -0.11308819614072263, -0.14766036394173399, 0.23950215755059956, 0.9533211121764711, 0.07648878549946225, 0.8647002515482995, -0.06158046830877051, -0.09939431281353162, 0.3827801896064309, 0.22946745673674696, 0.27655595547768796, 0.5536769366176346, 0.1739123468096313, 0.1208913936428957, 1.1182091646939685, 0.1585752899872277, -0.03576634781834376, -0.115331923076889, 0.03883902973328435, 0.0003094270993537762, 0.06409988772981645, 0.03975928396124884, 0.376923616038215, 0.5416911317167101, 0.1122830413512288, 0.26707672776198965, 0.039994374597392524, 0.061272910136187075, 0.041104292880896676, 0.8938069762105056, -0.19760656790670128, -0.07457153755745338, -0.18374982834313014, -0.11171403827283422, 0.45074724725586557, 0.4079046089469862, -0.022289105014357546, 0.5236191183371532, 0.28142017796554186, 0.18774584996905608, 0.7327049447717822, 0.013479005128508303, 0.47370142864977827, 0.17556844950170514, 0.5260711465834995, 0.3193631568025763, 0.1783478474108744, 0.03867720318757972, 0.23191004938644855, 0.02518562889551701, 0.17431987952501138, 0.19151901359025358, 0.051175695382451813, 0.014710568414730396, 0.5648419036715953, 0.10007164877409047, 1.053183971475542, 0.09099187437244782, 1.011781810149683, -0.21083278013150086, 1.136794026382895, -0.21725038417706388, 0.026321551525970488, 0.2530991383677046, -0.16744168493841594, 0.6514928426977096, 0.18212336919192307, 0.3940811031547411, 0.15109285766324176], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19494095401782233, "mean_inference_ms": 1.3201979520918388, "mean_action_processing_ms": 0.05535029182515607, "mean_env_wait_ms": 1.2527115126266748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 357200, "timers": {"sample_time_ms": 1231.503, "sample_throughput": 6171.323, "learn_time_ms": 2171.68, "learn_throughput": 3499.595, "update_time_ms": 2.793}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0016658912420044608, "total_loss": -0.003038527312067648, "policy_loss": -0.005772225845915576, "vf_loss": 0.0024605438365445783, "vf_explained_var": 0.7703472971916199, "kl": 0.004370473061377804, "entropy": -4.024374016125997, "entropy_coeff": 0.0}}, "num_steps_sampled": 357200, "num_steps_trained": 357200}, "done": false, "episodes_total": 342, "training_iteration": 47, "experiment_id": "8fbc600aff3c4223b91a7c1c7f534dde", "date": "2021-04-05_07-51-21", "timestamp": 1617634281, "time_this_iter_s": 3.425501585006714, "time_total_s": 151.98543238639832, "pid": 3181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6728, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 18, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0016658912420044608, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9753403099367262, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13822717740243837, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.09813642501831, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 38.32, "ram_util_percent": 62.14}, "trial_id": "315ff_00001"}
