{"episode_reward_max": 0.32474237446796117, "episode_reward_min": -0.5813812996330414, "episode_reward_mean": -0.23100337914694485, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5523602544110644, -0.19867896030851429, 0.32474237446796117, -0.35190002410554677, -0.5813812996330414, -0.3547693355341617, 0.0029851010743229267, 0.08337160440939528, -0.3598490164485372, -0.2864142154000481, 0.24228416771860162, -0.48167303269472656, -0.4764582262508664, 0.01062836921896304, -0.24054610728298276, -0.47603521117087166], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18967373427725095, "mean_inference_ms": 0.9849616409787929, "mean_action_processing_ms": 0.04123743997420534, "mean_env_wait_ms": 0.9371485252372427, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 19200, "timers": {"sample_time_ms": 6122.278, "sample_throughput": 3136.088, "learn_time_ms": 4706.761, "learn_throughput": 4079.238, "update_time_ms": 1.378}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.027902261608590682, "policy_loss": -0.04881150176748633, "vf_loss": 0.005216202895777921, "vf_explained_var": 0.731520414352417, "kl": 0.015693038913110892, "entropy": -3.2301223913828534, "entropy_coeff": 0.0}}, "num_steps_sampled": 19200, "num_steps_trained": 19200}, "done": false, "episodes_total": 16, "training_iteration": 1, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_11-57-37", "timestamp": 1617649057, "time_this_iter_s": 10.834599018096924, "time_total_s": 10.834599018096924, "pid": 18991, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.834599018096924, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.89375, "ram_util_percent": 61.587500000000006}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 0.32474237446796117, "episode_reward_min": -0.7219079787189779, "episode_reward_mean": -0.2361874259891592, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.7219079787189779, -0.2277910106000406, -0.4254340086228173, -0.4902346338104877, -0.33114081626660435, 0.05259054220689774, -0.2595221676734141, -0.2191795514944952, -0.43037333438905906, 0.21500779654023106, -0.2295253168916066, -0.0409127498013494, -0.20776889698639112, -0.3286518572237863, 0.09448169154056196, -0.3115812731106391, -0.5523602544110644, -0.19867896030851429, 0.32474237446796117, -0.35190002410554677, -0.5813812996330414, -0.3547693355341617, 0.0029851010743229267, 0.08337160440939528, -0.3598490164485372, -0.2864142154000481, 0.24228416771860162, -0.48167303269472656, -0.4764582262508664, 0.01062836921896304, -0.24054610728298276, -0.47603521117087166], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1858690013117162, "mean_inference_ms": 0.9672529527443643, "mean_action_processing_ms": 0.040494618792270835, "mean_env_wait_ms": 0.9117200629656029, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 38400, "timers": {"sample_time_ms": 5703.969, "sample_throughput": 3366.077, "learn_time_ms": 4885.281, "learn_throughput": 3930.173, "update_time_ms": 1.526}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.026669621157149475, "policy_loss": -0.04512527641219397, "vf_loss": 0.0048555448325350884, "vf_explained_var": 0.7428443431854248, "kl": 0.013600111330548921, "entropy": -3.2415897782643635, "entropy_coeff": 0.0}}, "num_steps_sampled": 38400, "num_steps_trained": 38400}, "done": false, "episodes_total": 32, "training_iteration": 2, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_11-57-47", "timestamp": 1617649067, "time_this_iter_s": 10.357826232910156, "time_total_s": 21.19242525100708, "pid": 18991, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21.19242525100708, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.25333333333332, "ram_util_percent": 61.77333333333332}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 0.5995344074021023, "episode_reward_min": -0.7219079787189779, "episode_reward_mean": -0.21065691052735616, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6060011146314044, -0.3233548210587863, -0.39845138374626365, -0.38710666457207465, -0.3490290110902927, -0.2288969570416739, -0.18201855096506292, -0.4693512673689931, 0.48722843296841667, -0.28653077098369056, -0.07513799059901405, -0.3162189991642297, -0.41456763522952594, 0.10509524187681851, 0.07535457222602293, 0.5995344074021023, -0.014092315175647352, -0.35512921525129104, -0.38580407050512217, -0.437204542906213, -0.5691108095499283, -0.08514329935402964, 0.13218180967399662, 0.2449655971670377, -0.5523602544110644, -0.19867896030851429, 0.32474237446796117, -0.35190002410554677, -0.5813812996330414, -0.3547693355341617, 0.0029851010743229267, 0.08337160440939528, -0.3598490164485372, -0.2864142154000481, 0.24228416771860162, -0.48167303269472656, -0.4764582262508664, 0.01062836921896304, -0.24054610728298276, -0.47603521117087166, -0.7219079787189779, -0.2277910106000406, -0.4254340086228173, -0.4902346338104877, -0.33114081626660435, 0.05259054220689774, -0.2595221676734141, -0.2191795514944952, -0.43037333438905906, 0.21500779654023106, -0.2295253168916066, -0.0409127498013494, -0.20776889698639112, -0.3286518572237863, 0.09448169154056196, -0.3115812731106391], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18932211800361295, "mean_inference_ms": 0.9702324016273458, "mean_action_processing_ms": 0.040571567123062306, "mean_env_wait_ms": 0.9085574841515035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 57600, "timers": {"sample_time_ms": 5865.233, "sample_throughput": 3273.527, "learn_time_ms": 4885.394, "learn_throughput": 3930.082, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.03468435026394824, "policy_loss": -0.056655847219129404, "vf_loss": 0.005205076827357213, "vf_explained_var": 0.7857222557067871, "kl": 0.016766419609387715, "entropy": -3.257600529988607, "entropy_coeff": 0.0}}, "num_steps_sampled": 57600, "num_steps_trained": 57600}, "done": false, "episodes_total": 56, "training_iteration": 3, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_11-57-59", "timestamp": 1617649079, "time_this_iter_s": 11.08311939239502, "time_total_s": 32.2755446434021, "pid": 18991, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.2755446434021, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.825, "ram_util_percent": 61.962500000000006}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 0.6973689914014534, "episode_reward_min": -0.7219079787189779, "episode_reward_mean": -0.17999383190543358, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.49752712107610075, -0.0410908845594774, -0.12429551721222853, -0.3510221971415586, -0.30970501342106077, 0.6973689914014534, 0.30826870640421133, -0.45373151728381544, 0.5141974894297872, -0.20269002371569356, -0.13978832263108332, -0.27712811901021495, -0.4835110777012742, -0.16862864014063694, 0.35272251396111987, 0.013791825037298144, -0.5523602544110644, -0.19867896030851429, 0.32474237446796117, -0.35190002410554677, -0.5813812996330414, -0.3547693355341617, 0.0029851010743229267, 0.08337160440939528, -0.3598490164485372, -0.2864142154000481, 0.24228416771860162, -0.48167303269472656, -0.4764582262508664, 0.01062836921896304, -0.24054610728298276, -0.47603521117087166, -0.7219079787189779, -0.2277910106000406, -0.4254340086228173, -0.4902346338104877, -0.33114081626660435, 0.05259054220689774, -0.2595221676734141, -0.2191795514944952, -0.43037333438905906, 0.21500779654023106, -0.2295253168916066, -0.0409127498013494, -0.20776889698639112, -0.3286518572237863, 0.09448169154056196, -0.3115812731106391, -0.6060011146314044, -0.3233548210587863, -0.39845138374626365, -0.38710666457207465, -0.3490290110902927, -0.2288969570416739, -0.18201855096506292, -0.4693512673689931, 0.48722843296841667, -0.28653077098369056, -0.07513799059901405, -0.3162189991642297, -0.41456763522952594, 0.10509524187681851, 0.07535457222602293, 0.5995344074021023, -0.014092315175647352, -0.35512921525129104, -0.38580407050512217, -0.437204542906213, -0.5691108095499283, -0.08514329935402964, 0.13218180967399662, 0.2449655971670377], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18874002580636065, "mean_inference_ms": 0.9668954381278279, "mean_action_processing_ms": 0.0404208010811345, "mean_env_wait_ms": 0.9028273599037698, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 76800, "timers": {"sample_time_ms": 5695.171, "sample_throughput": 3371.277, "learn_time_ms": 4899.826, "learn_throughput": 3918.506, "update_time_ms": 1.59}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.034318080469965935, "policy_loss": -0.055750782589117684, "vf_loss": 0.004994412621793648, "vf_explained_var": 0.7953096032142639, "kl": 0.01643828955789407, "entropy": -3.2651472234725953, "entropy_coeff": 0.0}}, "num_steps_sampled": 76800, "num_steps_trained": 76800}, "done": false, "episodes_total": 72, "training_iteration": 4, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_11-58-09", "timestamp": 1617649089, "time_this_iter_s": 10.136042594909668, "time_total_s": 42.41158723831177, "pid": 18991, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.41158723831177, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.892857142857146, "ram_util_percent": 61.98571428571428}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 0.6973689914014534, "episode_reward_min": -0.7219079787189779, "episode_reward_mean": -0.17746905974530947, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3735937036008927, -0.3654486225934298, -0.0913658736397055, -0.42578203742270887, 0.5282873792709488, -0.454489939422736, -0.514913838863921, -0.21587260655032725, -0.21025458210216075, -0.297717245797949, 0.08526368164460885, 0.12876901943471508, 0.006704051619641271, 0.2534412412805094, -0.33317011054336376, -0.25036020216767574, 0.0008992664458382649, 0.5354929142451033, 0.05367103396113393, -0.6949268188012174, -0.3008630069821761, -0.5351391899514408, -0.1597377321128124, -0.4463669157084721, -0.5523602544110644, -0.19867896030851429, 0.32474237446796117, -0.35190002410554677, -0.5813812996330414, -0.3547693355341617, 0.0029851010743229267, 0.08337160440939528, -0.3598490164485372, -0.2864142154000481, 0.24228416771860162, -0.48167303269472656, -0.4764582262508664, 0.01062836921896304, -0.24054610728298276, -0.47603521117087166, -0.7219079787189779, -0.2277910106000406, -0.4254340086228173, -0.4902346338104877, -0.33114081626660435, 0.05259054220689774, -0.2595221676734141, -0.2191795514944952, -0.43037333438905906, 0.21500779654023106, -0.2295253168916066, -0.0409127498013494, -0.20776889698639112, -0.3286518572237863, 0.09448169154056196, -0.3115812731106391, -0.6060011146314044, -0.3233548210587863, -0.39845138374626365, -0.38710666457207465, -0.3490290110902927, -0.2288969570416739, -0.18201855096506292, -0.4693512673689931, 0.48722843296841667, -0.28653077098369056, -0.07513799059901405, -0.3162189991642297, -0.41456763522952594, 0.10509524187681851, 0.07535457222602293, 0.5995344074021023, -0.014092315175647352, -0.35512921525129104, -0.38580407050512217, -0.437204542906213, -0.5691108095499283, -0.08514329935402964, 0.13218180967399662, 0.2449655971670377, -0.49752712107610075, -0.0410908845594774, -0.12429551721222853, -0.3510221971415586, -0.30970501342106077, 0.6973689914014534, 0.30826870640421133, -0.45373151728381544, 0.5141974894297872, -0.20269002371569356, -0.13978832263108332, -0.27712811901021495, -0.4835110777012742, -0.16862864014063694, 0.35272251396111987, 0.013791825037298144], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19058181516352746, "mean_inference_ms": 0.9710860880619485, "mean_action_processing_ms": 0.0404587818748822, "mean_env_wait_ms": 0.9015822332734319, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 96000, "timers": {"sample_time_ms": 5806.016, "sample_throughput": 3306.915, "learn_time_ms": 4906.011, "learn_throughput": 3913.567, "update_time_ms": 1.59}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.03995795221378406, "policy_loss": -0.06259924293185273, "vf_loss": 0.0048393671773374084, "vf_explained_var": 0.7729500532150269, "kl": 0.01780192316820224, "entropy": -3.286057785352071, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 5, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_11-58-20", "timestamp": 1617649100, "time_this_iter_s": 11.188481569290161, "time_total_s": 53.60006880760193, "pid": 18991, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.60006880760193, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 47.106249999999996, "ram_util_percent": 60.60625}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 1.8676173916753736, "episode_reward_min": -0.5925501062101389, "episode_reward_mean": 0.3553874700879581, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5925501062101389, 0.1068071910235826, 1.6302163518184631, 0.23505544219600316, -0.14648288707108725, 0.5792711885821131, 0.018103148394397195, 0.3569079465302001, 0.8520251123936537, 0.06457358488223575, 1.8676173916753736, 0.5890576580721878, 0.4510226125842327, -0.26245855044109534, 0.22177157383241952, -0.2847381368552105], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18092742913566695, "mean_inference_ms": 0.9447637695612783, "mean_action_processing_ms": 0.04029506099864574, "mean_env_wait_ms": 0.9023023614879451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 115200, "timers": {"sample_time_ms": 5792.075, "sample_throughput": 3314.874, "learn_time_ms": 5804.162, "learn_throughput": 3307.971, "update_time_ms": 1.707}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.03327352388451497, "policy_loss": -0.05940193316278358, "vf_loss": 0.008269352332378428, "vf_explained_var": 0.7403995990753174, "kl": 0.01785905584692955, "entropy": -3.2985544347763063, "entropy_coeff": 0.0}}, "num_steps_sampled": 115200, "num_steps_trained": 115200}, "done": false, "episodes_total": 112, "training_iteration": 6, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_11-58-38", "timestamp": 1617649118, "time_this_iter_s": 11.60134482383728, "time_total_s": 65.20141363143921, "pid": 19450, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.60134482383728, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.317647058823525, "ram_util_percent": 61.71176470588236}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 1.8676173916753736, "episode_reward_min": -0.5925501062101389, "episode_reward_mean": 0.28085505151651496, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.07273360738123946, -0.35251690035665884, 0.5379848620735399, -0.41796477827432343, 0.2646833024275701, 0.3042090279654852, 0.5738355733089211, 0.7905296856108148, 0.34628384241354704, 0.4931300347186196, 0.18536869885570395, 0.0292668327817458, 0.23128248351075786, -0.16885642704965348, 0.25429231506636363, 0.30236718144995445, -0.5925501062101389, 0.1068071910235826, 1.6302163518184631, 0.23505544219600316, -0.14648288707108725, 0.5792711885821131, 0.018103148394397195, 0.3569079465302001, 0.8520251123936537, 0.06457358488223575, 1.8676173916753736, 0.5890576580721878, 0.4510226125842327, -0.26245855044109534, 0.22177157383241952, -0.2847381368552105], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1812441336455647, "mean_inference_ms": 0.9645357854896741, "mean_action_processing_ms": 0.04032107697317022, "mean_env_wait_ms": 0.8940246073559557, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 134400, "timers": {"sample_time_ms": 5760.298, "sample_throughput": 3333.161, "learn_time_ms": 5908.775, "learn_throughput": 3249.404, "update_time_ms": 1.577}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.03810355873157581, "policy_loss": -0.06466961639312406, "vf_loss": 0.007481661463777225, "vf_explained_var": 0.7758204936981201, "kl": 0.019084396455436945, "entropy": -3.327003328005473, "entropy_coeff": 0.0}}, "num_steps_sampled": 134400, "num_steps_trained": 134400}, "done": false, "episodes_total": 128, "training_iteration": 7, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_11-58-50", "timestamp": 1617649130, "time_this_iter_s": 11.751235723495483, "time_total_s": 76.95264935493469, "pid": 19450, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.352580547332764, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.347058823529416, "ram_util_percent": 62.00588235294117}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 1.8676173916753736, "episode_reward_min": -0.5925501062101389, "episode_reward_mean": 0.2624422130571898, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.19497405221182973, 0.5846659342772731, 0.0694857180231685, -0.5752009171073001, 0.6657433845006875, 0.8829554341276742, 0.17267976756611425, 0.7602543865731983, 0.20489313872661508, 0.03522304278521293, 0.4882195632108888, -0.2042176797178874, 0.08793596564746453, -0.03667424661648222, 0.5471498416491367, 0.33562136535658893, 0.24392804814613323, 0.4033623471653891, -0.07613751655236767, 0.65529239698223, 0.22915695016957938, -0.035238138198034674, 0.38578601549866076, 0.07949153267203801, -0.5925501062101389, 0.1068071910235826, 1.6302163518184631, 0.23505544219600316, -0.14648288707108725, 0.5792711885821131, 0.018103148394397195, 0.3569079465302001, 0.8520251123936537, 0.06457358488223575, 1.8676173916753736, 0.5890576580721878, 0.4510226125842327, -0.26245855044109534, 0.22177157383241952, -0.2847381368552105, -0.07273360738123946, -0.35251690035665884, 0.5379848620735399, -0.41796477827432343, 0.2646833024275701, 0.3042090279654852, 0.5738355733089211, 0.7905296856108148, 0.34628384241354704, 0.4931300347186196, 0.18536869885570395, 0.0292668327817458, 0.23128248351075786, -0.16885642704965348, 0.25429231506636363, 0.30236718144995445], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18480006081079461, "mean_inference_ms": 0.9667574786227044, "mean_action_processing_ms": 0.04026970354542817, "mean_env_wait_ms": 0.8860948063545749, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 153600, "timers": {"sample_time_ms": 5665.311, "sample_throughput": 3389.046, "learn_time_ms": 5908.27, "learn_throughput": 3249.682, "update_time_ms": 1.543}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.040902764244625966, "policy_loss": -0.0680846973756949, "vf_loss": 0.006357028456404805, "vf_explained_var": 0.8223168849945068, "kl": 0.020824904404580593, "entropy": -3.3563472429911294, "entropy_coeff": 0.0}}, "num_steps_sampled": 153600, "num_steps_trained": 153600}, "done": false, "episodes_total": 152, "training_iteration": 8, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_11-59-02", "timestamp": 1617649142, "time_this_iter_s": 11.390460968017578, "time_total_s": 88.34311032295227, "pid": 19450, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.74304151535034, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.0625, "ram_util_percent": 62.1}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 2.5736844877782854, "episode_reward_min": -0.5925501062101389, "episode_reward_mean": 0.36459512060278254, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1859809231749736, -0.19895424553388796, 0.3566982111936836, 1.0086191343914432, 0.6147366827365182, 0.23384429387556538, -0.26893770456697685, 1.010486971693028, 0.45958895028004165, 1.403033615769635, 1.3069758092183825, 2.5736844877782854, 0.11328931760764571, 0.7959514900517832, 0.6004494372194555, 0.3586373773081397, -0.5925501062101389, 0.1068071910235826, 1.6302163518184631, 0.23505544219600316, -0.14648288707108725, 0.5792711885821131, 0.018103148394397195, 0.3569079465302001, 0.8520251123936537, 0.06457358488223575, 1.8676173916753736, 0.5890576580721878, 0.4510226125842327, -0.26245855044109534, 0.22177157383241952, -0.2847381368552105, -0.07273360738123946, -0.35251690035665884, 0.5379848620735399, -0.41796477827432343, 0.2646833024275701, 0.3042090279654852, 0.5738355733089211, 0.7905296856108148, 0.34628384241354704, 0.4931300347186196, 0.18536869885570395, 0.0292668327817458, 0.23128248351075786, -0.16885642704965348, 0.25429231506636363, 0.30236718144995445, -0.19497405221182973, 0.5846659342772731, 0.0694857180231685, -0.5752009171073001, 0.6657433845006875, 0.8829554341276742, 0.17267976756611425, 0.7602543865731983, 0.20489313872661508, 0.03522304278521293, 0.4882195632108888, -0.2042176797178874, 0.08793596564746453, -0.03667424661648222, 0.5471498416491367, 0.33562136535658893, 0.24392804814613323, 0.4033623471653891, -0.07613751655236767, 0.65529239698223, 0.22915695016957938, -0.035238138198034674, 0.38578601549866076, 0.07949153267203801], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18562508792017066, "mean_inference_ms": 0.9677892699780618, "mean_action_processing_ms": 0.04033168819025878, "mean_env_wait_ms": 0.8849408754337316, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 172800, "timers": {"sample_time_ms": 5665.61, "sample_throughput": 3388.867, "learn_time_ms": 5896.675, "learn_throughput": 3256.072, "update_time_ms": 1.682}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": -0.03084597480793794, "policy_loss": -0.06319500955442588, "vf_loss": 0.009699382968246937, "vf_explained_var": 0.8020412921905518, "kl": 0.015099766589701176, "entropy": -3.3618021043141684, "entropy_coeff": 0.0}}, "num_steps_sampled": 172800, "num_steps_trained": 172800}, "done": false, "episodes_total": 168, "training_iteration": 9, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_11-59-13", "timestamp": 1617649153, "time_this_iter_s": 11.537019968032837, "time_total_s": 99.88013029098511, "pid": 19450, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.28006148338318, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.21764705882353, "ram_util_percent": 61.98823529411764}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 3.6054406239923473, "episode_reward_min": -0.5925501062101389, "episode_reward_mean": 0.49980278062966804, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5051228042274207, 0.6924113936246619, 0.354242111835984, 0.6746638941217646, 1.4779514877237943, 0.4932354916580408, 0.9580820880054226, 0.9509971743782639, 0.7303571355380938, 0.7216243608285762, 1.529722859709242, -0.19655847600483384, -0.13349005646943823, 2.118973147946613, 0.6319577811948851, 2.142607033045604, 0.555048571565369, 0.4422084134880233, -0.06708293791895692, 1.0715205125432306, 3.6054406239923473, 0.8755896772349057, 1.8180063647302207, -0.22241319995144893, -0.5925501062101389, 0.1068071910235826, 1.6302163518184631, 0.23505544219600316, -0.14648288707108725, 0.5792711885821131, 0.018103148394397195, 0.3569079465302001, 0.8520251123936537, 0.06457358488223575, 1.8676173916753736, 0.5890576580721878, 0.4510226125842327, -0.26245855044109534, 0.22177157383241952, -0.2847381368552105, -0.07273360738123946, -0.35251690035665884, 0.5379848620735399, -0.41796477827432343, 0.2646833024275701, 0.3042090279654852, 0.5738355733089211, 0.7905296856108148, 0.34628384241354704, 0.4931300347186196, 0.18536869885570395, 0.0292668327817458, 0.23128248351075786, -0.16885642704965348, 0.25429231506636363, 0.30236718144995445, -0.19497405221182973, 0.5846659342772731, 0.0694857180231685, -0.5752009171073001, 0.6657433845006875, 0.8829554341276742, 0.17267976756611425, 0.7602543865731983, 0.20489313872661508, 0.03522304278521293, 0.4882195632108888, -0.2042176797178874, 0.08793596564746453, -0.03667424661648222, 0.5471498416491367, 0.33562136535658893, 0.24392804814613323, 0.4033623471653891, -0.07613751655236767, 0.65529239698223, 0.22915695016957938, -0.035238138198034674, 0.38578601549866076, 0.07949153267203801, 1.1859809231749736, -0.19895424553388796, 0.3566982111936836, 1.0086191343914432, 0.6147366827365182, 0.23384429387556538, -0.26893770456697685, 1.010486971693028, 0.45958895028004165, 1.403033615769635, 1.3069758092183825, 2.5736844877782854, 0.11328931760764571, 0.7959514900517832, 0.6004494372194555, 0.3586373773081397], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18793049272983287, "mean_inference_ms": 0.9691098376675583, "mean_action_processing_ms": 0.04046235243067293, "mean_env_wait_ms": 0.885021253773813, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 192000, "timers": {"sample_time_ms": 5672.002, "sample_throughput": 3385.048, "learn_time_ms": 5992.088, "learn_throughput": 3204.225, "update_time_ms": 1.644}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": -0.024026663017769654, "policy_loss": -0.06135111751034856, "vf_loss": 0.01593468038365245, "vf_explained_var": 0.7813969254493713, "kl": 0.014259848936150472, "entropy": -3.3890112988154093, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 192, "training_iteration": 10, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_11-59-25", "timestamp": 1617649165, "time_this_iter_s": 12.078970670700073, "time_total_s": 111.95910096168518, "pid": 19450, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 58.35903215408325, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 50.94117647058823, "ram_util_percent": 59.88823529411765}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 2.292758692927155, "episode_reward_min": -0.19616297590005327, "episode_reward_mean": 0.6375660868744704, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0558908376261318, 0.4167101208918125, -0.19616297590005327, 2.292758692927155, 0.2883448584782893, 0.2993215869250665, 0.310394440140759, 0.19241486893784066, 0.5487860236502757, 0.5149283487442928, 0.04801835685245237, 1.784613819931276, 0.3420633773389241, -0.042945381509923664, 1.7165142507745905, 0.629406164182637], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1639809175512782, "mean_inference_ms": 0.8973936670177036, "mean_action_processing_ms": 0.03785077406435597, "mean_env_wait_ms": 0.858672816571669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 211200, "timers": {"sample_time_ms": 5564.909, "sample_throughput": 3450.191, "learn_time_ms": 5820.064, "learn_throughput": 3298.933, "update_time_ms": 1.769}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.0360815918383499, "policy_loss": -0.06807836902638277, "vf_loss": 0.011837955533216397, "vf_explained_var": 0.8047111630439758, "kl": 0.02015882154305776, "entropy": -3.404096202850342, "entropy_coeff": 0.0}}, "num_steps_sampled": 211200, "num_steps_trained": 211200}, "done": false, "episodes_total": 208, "training_iteration": 11, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-02-26", "timestamp": 1617649346, "time_this_iter_s": 11.389724254608154, "time_total_s": 123.34882521629333, "pid": 21455, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.389724254608154, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.42941176470588, "ram_util_percent": 61.92941176470588}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 2.292758692927155, "episode_reward_min": -0.19616297590005327, "episode_reward_mean": 0.7185378130468745, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5570952719066962, 1.567434502256107, 1.019349939830195, 1.3557195408258051, -0.08657156116960352, 0.38306023252379884, 0.3821606970871456, 0.6534284193492257, 0.29914030729996965, 0.8798891356407212, 0.16006480596041572, 0.3498370124396637, 0.5741939271878376, 1.3682691751861684, 1.995268980313504, 0.33381224087080974, 1.0558908376261318, 0.4167101208918125, -0.19616297590005327, 2.292758692927155, 0.2883448584782893, 0.2993215869250665, 0.310394440140759, 0.19241486893784066, 0.5487860236502757, 0.5149283487442928, 0.04801835685245237, 1.784613819931276, 0.3420633773389241, -0.042945381509923664, 1.7165142507745905, 0.629406164182637], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16700814473933392, "mean_inference_ms": 0.9289884104962314, "mean_action_processing_ms": 0.03868899483321531, "mean_env_wait_ms": 0.8660552921846086, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 230400, "timers": {"sample_time_ms": 5600.654, "sample_throughput": 3428.171, "learn_time_ms": 6063.807, "learn_throughput": 3166.328, "update_time_ms": 1.551}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": -0.03119004569326838, "policy_loss": -0.06596792499845226, "vf_loss": 0.011203097583105167, "vf_explained_var": 0.8136402368545532, "kl": 0.01571652042369048, "entropy": -3.4230731280644733, "entropy_coeff": 0.0}}, "num_steps_sampled": 230400, "num_steps_trained": 230400}, "done": false, "episodes_total": 224, "training_iteration": 12, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-02-38", "timestamp": 1617649358, "time_this_iter_s": 11.951325416564941, "time_total_s": 135.30015063285828, "pid": 21455, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.341049671173096, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 48.85882352941176, "ram_util_percent": 59.705882352941174}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 3.3777103994584605, "episode_reward_min": -0.19616297590005327, "episode_reward_mean": 0.8681944380741022, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.28536272720381106, 0.9016153642794429, 0.4320955211105988, 0.08632845955935808, 1.33990163538091, 1.8910992946470615, 0.5773793672640184, 1.4104445076474081, 0.6926059055357487, 0.2603160534231066, 1.5095834780709345, 0.027545653164502193, 0.4014121345541357, 1.9819388388529404, 0.9502124082406853, 2.833295508850984, 0.7822684125329602, 0.7110570435504864, 0.8545998697548665, 0.5106396452159478, 3.3777103994584605, 0.6870912260122015, 1.4798226369348169, 1.6413524234043542, 1.0558908376261318, 0.4167101208918125, -0.19616297590005327, 2.292758692927155, 0.2883448584782893, 0.2993215869250665, 0.310394440140759, 0.19241486893784066, 0.5487860236502757, 0.5149283487442928, 0.04801835685245237, 1.784613819931276, 0.3420633773389241, -0.042945381509923664, 1.7165142507745905, 0.629406164182637, 1.5570952719066962, 1.567434502256107, 1.019349939830195, 1.3557195408258051, -0.08657156116960352, 0.38306023252379884, 0.3821606970871456, 0.6534284193492257, 0.29914030729996965, 0.8798891356407212, 0.16006480596041572, 0.3498370124396637, 0.5741939271878376, 1.3682691751861684, 1.995268980313504, 0.33381224087080974], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1743581015936208, "mean_inference_ms": 0.9448560665987288, "mean_action_processing_ms": 0.039246014480650446, "mean_env_wait_ms": 0.8730203860897755, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 249600, "timers": {"sample_time_ms": 5644.411, "sample_throughput": 3401.595, "learn_time_ms": 6020.104, "learn_throughput": 3189.314, "update_time_ms": 1.539}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": -0.02614412795752287, "policy_loss": -0.06505119374487549, "vf_loss": 0.015119760477294525, "vf_explained_var": 0.8269626498222351, "kl": 0.015858202402790386, "entropy": -3.4476931873957315, "entropy_coeff": 0.0}}, "num_steps_sampled": 249600, "num_steps_trained": 249600}, "done": false, "episodes_total": 248, "training_iteration": 13, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-02-50", "timestamp": 1617649370, "time_this_iter_s": 11.672769546508789, "time_total_s": 146.97292017936707, "pid": 21455, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.013819217681885, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.625, "ram_util_percent": 62.05625}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 3.5532691406121364, "episode_reward_min": -0.19616297590005327, "episode_reward_mean": 0.9818216491504531, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6578393508120182, 0.5589417770090122, 1.3606570365594997, 1.623225842086613, 3.2979499156381715, 0.8632431016938735, 1.2757691571419687, 3.5532691406121364, 0.9543361241211881, 2.061930994494561, 0.34702715215443924, 1.4988730539903616, 0.726966649466184, 1.351249139720847, 0.6479963975184257, 0.29299537366359707, 1.0558908376261318, 0.4167101208918125, -0.19616297590005327, 2.292758692927155, 0.2883448584782893, 0.2993215869250665, 0.310394440140759, 0.19241486893784066, 0.5487860236502757, 0.5149283487442928, 0.04801835685245237, 1.784613819931276, 0.3420633773389241, -0.042945381509923664, 1.7165142507745905, 0.629406164182637, 1.5570952719066962, 1.567434502256107, 1.019349939830195, 1.3557195408258051, -0.08657156116960352, 0.38306023252379884, 0.3821606970871456, 0.6534284193492257, 0.29914030729996965, 0.8798891356407212, 0.16006480596041572, 0.3498370124396637, 0.5741939271878376, 1.3682691751861684, 1.995268980313504, 0.33381224087080974, 0.28536272720381106, 0.9016153642794429, 0.4320955211105988, 0.08632845955935808, 1.33990163538091, 1.8910992946470615, 0.5773793672640184, 1.4104445076474081, 0.6926059055357487, 0.2603160534231066, 1.5095834780709345, 0.027545653164502193, 0.4014121345541357, 1.9819388388529404, 0.9502124082406853, 2.833295508850984, 0.7822684125329602, 0.7110570435504864, 0.8545998697548665, 0.5106396452159478, 3.3777103994584605, 0.6870912260122015, 1.4798226369348169, 1.6413524234043542], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17658926612414724, "mean_inference_ms": 0.9509185664839193, "mean_action_processing_ms": 0.039500393555785815, "mean_env_wait_ms": 0.876869791009926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 268800, "timers": {"sample_time_ms": 5645.179, "sample_throughput": 3401.132, "learn_time_ms": 5982.941, "learn_throughput": 3209.124, "update_time_ms": 1.606}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": -0.022784932209178807, "policy_loss": -0.06212965405235688, "vf_loss": 0.017274000210066635, "vf_explained_var": 0.8133257031440735, "kl": 0.014713815009842316, "entropy": -3.435670320192973, "entropy_coeff": 0.0}}, "num_steps_sampled": 268800, "num_steps_trained": 268800}, "done": false, "episodes_total": 264, "training_iteration": 14, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-03-01", "timestamp": 1617649381, "time_this_iter_s": 11.526680707931519, "time_total_s": 158.49960088729858, "pid": 21455, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.5404999256134, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.57647058823529, "ram_util_percent": 62.07058823529412}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 3.5532691406121364, "episode_reward_min": -0.19616297590005327, "episode_reward_mean": 1.015473647935243, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6604089177995571, 1.5443172828684575, 0.7602870728640472, 0.7653400699785724, 0.21388394780417563, 0.981782855982865, 0.42103047657635817, 1.6737611727983253, 1.1202578800170429, 2.1939932001882485, 1.0323956730867416, 0.33157349064012265, -0.03013845927973169, 0.2865883123645272, 1.4597317006679003, 2.50013198131583, 1.6775369328710057, 2.1759137071654826, 1.3663913482019905, 2.0347892263040825, 1.3539956958386314, 0.07587456429252937, 1.2869372333941156, -0.09247282079018393, 1.0558908376261318, 0.4167101208918125, -0.19616297590005327, 2.292758692927155, 0.2883448584782893, 0.2993215869250665, 0.310394440140759, 0.19241486893784066, 0.5487860236502757, 0.5149283487442928, 0.04801835685245237, 1.784613819931276, 0.3420633773389241, -0.042945381509923664, 1.7165142507745905, 0.629406164182637, 1.5570952719066962, 1.567434502256107, 1.019349939830195, 1.3557195408258051, -0.08657156116960352, 0.38306023252379884, 0.3821606970871456, 0.6534284193492257, 0.29914030729996965, 0.8798891356407212, 0.16006480596041572, 0.3498370124396637, 0.5741939271878376, 1.3682691751861684, 1.995268980313504, 0.33381224087080974, 0.28536272720381106, 0.9016153642794429, 0.4320955211105988, 0.08632845955935808, 1.33990163538091, 1.8910992946470615, 0.5773793672640184, 1.4104445076474081, 0.6926059055357487, 0.2603160534231066, 1.5095834780709345, 0.027545653164502193, 0.4014121345541357, 1.9819388388529404, 0.9502124082406853, 2.833295508850984, 0.7822684125329602, 0.7110570435504864, 0.8545998697548665, 0.5106396452159478, 3.3777103994584605, 0.6870912260122015, 1.4798226369348169, 1.6413524234043542, 1.6578393508120182, 0.5589417770090122, 1.3606570365594997, 1.623225842086613, 3.2979499156381715, 0.8632431016938735, 1.2757691571419687, 3.5532691406121364, 0.9543361241211881, 2.061930994494561, 0.34702715215443924, 1.4988730539903616, 0.726966649466184, 1.351249139720847, 0.6479963975184257, 0.29299537366359707], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1800691649185504, "mean_inference_ms": 0.9564556801363865, "mean_action_processing_ms": 0.03975867767128722, "mean_env_wait_ms": 0.8809962348397778, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 288000, "timers": {"sample_time_ms": 5655.378, "sample_throughput": 3394.999, "learn_time_ms": 5926.903, "learn_throughput": 3239.466, "update_time_ms": 1.58}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": -0.02679767015390098, "policy_loss": -0.06743045368542273, "vf_loss": 0.015541538931429386, "vf_explained_var": 0.8578277826309204, "kl": 0.016727496689806384, "entropy": -3.456940894126892, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 288, "training_iteration": 15, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-03-13", "timestamp": 1617649393, "time_this_iter_s": 11.40647292137146, "time_total_s": 169.90607380867004, "pid": 21455, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 57.94697284698486, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.96875, "ram_util_percent": 62.150000000000006}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 3.232077179705251, "episode_reward_min": 0.3280623711416202, "episode_reward_mean": 1.5164958786620195, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6136443406564482, 3.232077179705251, 0.8523827650377542, 1.0530010801450667, 1.645109008290039, 1.427217248882259, 1.5995307237139662, 0.3280623711416202, 2.392277362394614, 2.4510817481178044, 1.2350564023814083, 1.147691116236754, 0.7193682883799197, 2.352265263819219, 1.4082670724355268, 0.8069020872546597], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19816231946059437, "mean_inference_ms": 1.0385553397917837, "mean_action_processing_ms": 0.04414288712660008, "mean_env_wait_ms": 0.9999497142348475, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 307200, "timers": {"sample_time_ms": 6367.931, "sample_throughput": 3015.108, "learn_time_ms": 5769.683, "learn_throughput": 3327.739, "update_time_ms": 1.586}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.03454852801437179, "policy_loss": -0.06926263332056502, "vf_loss": 0.01388455777739485, "vf_explained_var": 0.8435671925544739, "kl": 0.020829547494649887, "entropy": -3.4566452805201213, "entropy_coeff": 0.0}}, "num_steps_sampled": 307200, "num_steps_trained": 307200}, "done": false, "episodes_total": 304, "training_iteration": 16, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-04-32", "timestamp": 1617649472, "time_this_iter_s": 12.141927242279053, "time_total_s": 182.0480010509491, "pid": 22361, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.141927242279053, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.03888888888889, "ram_util_percent": 60.83333333333332}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 5.514529849361329, "episode_reward_min": 0.3280623711416202, "episode_reward_mean": 1.8827506425515066, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.212490346853935, 1.7641613451574774, 1.7661957675255686, 2.1522568218644587, 2.3295637385237544, 3.9174560550566078, 0.9501745537379047, 1.3406873322195354, 3.231901866295021, 1.7467069554167098, 2.5846419479686773, 1.1851493881311792, 2.0306154216137626, 5.514529849361329, 1.6113669668460653, 1.6461881464839125, 1.6136443406564482, 3.232077179705251, 0.8523827650377542, 1.0530010801450667, 1.645109008290039, 1.427217248882259, 1.5995307237139662, 0.3280623711416202, 2.392277362394614, 2.4510817481178044, 1.2350564023814083, 1.147691116236754, 0.7193682883799197, 2.352265263819219, 1.4082670724355268, 0.8069020872546597], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20991123241551982, "mean_inference_ms": 1.112907351669436, "mean_action_processing_ms": 0.04652663897911708, "mean_env_wait_ms": 1.0459792296633124, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 326400, "timers": {"sample_time_ms": 6901.821, "sample_throughput": 2781.875, "learn_time_ms": 5897.668, "learn_throughput": 3255.524, "update_time_ms": 1.616}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": -0.016951637404660384, "policy_loss": -0.06406682756418983, "vf_loss": 0.024200457700838646, "vf_explained_var": 0.8185125589370728, "kl": 0.015276488487919172, "entropy": -3.4955819781621296, "entropy_coeff": 0.0}}, "num_steps_sampled": 326400, "num_steps_trained": 326400}, "done": false, "episodes_total": 320, "training_iteration": 17, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-04-45", "timestamp": 1617649485, "time_this_iter_s": 13.468568325042725, "time_total_s": 195.51656937599182, "pid": 22361, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.610495567321777, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 57.96315789473685, "ram_util_percent": 60.926315789473676}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 5.514529849361329, "episode_reward_min": 0.3280623711416202, "episode_reward_mean": 2.1033485275271313, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.2112164685218247, 1.84014142316079, 1.9668038070663418, 0.8271682782950536, 3.8064958361219894, 2.2363812070388933, 4.784873447550833, 5.445438780273673, 3.0045064195462654, 1.648855594884481, 1.6785912485806502, 1.9456591107333656, 0.751471204968774, 1.6535457560336915, 3.7922262003245244, 2.5080918955523313, 2.004399681176679, 3.5502072386129173, 0.9265667408849374, 1.0227569522262, 1.4107875221978001, 0.7845343724126208, 5.152094113207899, 2.586683680498593, 1.6136443406564482, 3.232077179705251, 0.8523827650377542, 1.0530010801450667, 1.645109008290039, 1.427217248882259, 1.5995307237139662, 0.3280623711416202, 2.392277362394614, 2.4510817481178044, 1.2350564023814083, 1.147691116236754, 0.7193682883799197, 2.352265263819219, 1.4082670724355268, 0.8069020872546597, 2.212490346853935, 1.7641613451574774, 1.7661957675255686, 2.1522568218644587, 2.3295637385237544, 3.9174560550566078, 0.9501745537379047, 1.3406873322195354, 3.231901866295021, 1.7467069554167098, 2.5846419479686773, 1.1851493881311792, 2.0306154216137626, 5.514529849361329, 1.6113669668460653, 1.6461881464839125], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21395035475079904, "mean_inference_ms": 1.114106891458469, "mean_action_processing_ms": 0.04641301607379419, "mean_env_wait_ms": 1.03760434623081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 345600, "timers": {"sample_time_ms": 6473.129, "sample_throughput": 2966.108, "learn_time_ms": 5891.487, "learn_throughput": 3258.94, "update_time_ms": 1.734}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": 0.014744022159526745, "policy_loss": -0.06092191221192479, "vf_loss": 0.05211489188174407, "vf_explained_var": 0.7930651307106018, "kl": 0.015700695949296156, "entropy": -3.5197971630096436, "entropy_coeff": 0.0}}, "num_steps_sampled": 345600, "num_steps_trained": 345600}, "done": false, "episodes_total": 344, "training_iteration": 18, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-04-57", "timestamp": 1617649497, "time_this_iter_s": 11.50513505935669, "time_total_s": 207.0217044353485, "pid": 22361, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.11563062667847, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.525, "ram_util_percent": 62.3}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 7.4613564530316925, "episode_reward_min": 0.3280623711416202, "episode_reward_mean": 2.384976149381232, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6475415891285063, 4.585666110744368, 6.282330563284956, 2.076827621286212, 2.499376031681238, 2.502729198389164, 1.256342888600921, 1.8320493551239423, 2.093162864942286, 7.4613564530316925, 2.493142475896365, 2.3023757881895053, 2.4099821199118368, 4.771601479689748, 6.131360314277624, 2.584920359750997, 1.6136443406564482, 3.232077179705251, 0.8523827650377542, 1.0530010801450667, 1.645109008290039, 1.427217248882259, 1.5995307237139662, 0.3280623711416202, 2.392277362394614, 2.4510817481178044, 1.2350564023814083, 1.147691116236754, 0.7193682883799197, 2.352265263819219, 1.4082670724355268, 0.8069020872546597, 2.212490346853935, 1.7641613451574774, 1.7661957675255686, 2.1522568218644587, 2.3295637385237544, 3.9174560550566078, 0.9501745537379047, 1.3406873322195354, 3.231901866295021, 1.7467069554167098, 2.5846419479686773, 1.1851493881311792, 2.0306154216137626, 5.514529849361329, 1.6113669668460653, 1.6461881464839125, 2.2112164685218247, 1.84014142316079, 1.9668038070663418, 0.8271682782950536, 3.8064958361219894, 2.2363812070388933, 4.784873447550833, 5.445438780273673, 3.0045064195462654, 1.648855594884481, 1.6785912485806502, 1.9456591107333656, 0.751471204968774, 1.6535457560336915, 3.7922262003245244, 2.5080918955523313, 2.004399681176679, 3.5502072386129173, 0.9265667408849374, 1.0227569522262, 1.4107875221978001, 0.7845343724126208, 5.152094113207899, 2.586683680498593], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21324447112335754, "mean_inference_ms": 1.1076608156404513, "mean_action_processing_ms": 0.046149869438852416, "mean_env_wait_ms": 1.0293705682181777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 364800, "timers": {"sample_time_ms": 6290.744, "sample_throughput": 3052.103, "learn_time_ms": 5905.11, "learn_throughput": 3251.421, "update_time_ms": 1.777}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": 0.012494153377289574, "policy_loss": -0.06040443315481146, "vf_loss": 0.04982819120089213, "vf_explained_var": 0.7892546653747559, "kl": 0.015380262490361929, "entropy": -3.529615257581075, "entropy_coeff": 0.0}}, "num_steps_sampled": 364800, "num_steps_trained": 364800}, "done": false, "episodes_total": 360, "training_iteration": 19, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-05-08", "timestamp": 1617649508, "time_this_iter_s": 11.69776463508606, "time_total_s": 218.71946907043457, "pid": 22361, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.813395261764526, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.535294117647055, "ram_util_percent": 62.188235294117646}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 7.4613564530316925, "episode_reward_min": 0.3280623711416202, "episode_reward_mean": 2.4157117698473116, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.764935385007084, 0.4452550825289372, 2.454261147276024, 4.921199694383486, 1.7730933165156513, 2.308389755972468, 1.7981323163703817, 4.210213595211363, 1.5469685707410288, 2.5544924571061483, 2.710982756946693, 1.8727172839268618, 1.1527402904169595, 2.944275312395801, 3.2116504309582012, 4.350744989006172, 2.812159158793306, 1.8726201458256293, 2.541092027111953, 2.7649824962339467, 3.6203414640579563, 2.625342605390021, 1.869768536075707, 2.0636883316414423, 1.6136443406564482, 3.232077179705251, 0.8523827650377542, 1.0530010801450667, 1.645109008290039, 1.427217248882259, 1.5995307237139662, 0.3280623711416202, 2.392277362394614, 2.4510817481178044, 1.2350564023814083, 1.147691116236754, 0.7193682883799197, 2.352265263819219, 1.4082670724355268, 0.8069020872546597, 2.212490346853935, 1.7641613451574774, 1.7661957675255686, 2.1522568218644587, 2.3295637385237544, 3.9174560550566078, 0.9501745537379047, 1.3406873322195354, 3.231901866295021, 1.7467069554167098, 2.5846419479686773, 1.1851493881311792, 2.0306154216137626, 5.514529849361329, 1.6113669668460653, 1.6461881464839125, 2.2112164685218247, 1.84014142316079, 1.9668038070663418, 0.8271682782950536, 3.8064958361219894, 2.2363812070388933, 4.784873447550833, 5.445438780273673, 3.0045064195462654, 1.648855594884481, 1.6785912485806502, 1.9456591107333656, 0.751471204968774, 1.6535457560336915, 3.7922262003245244, 2.5080918955523313, 2.004399681176679, 3.5502072386129173, 0.9265667408849374, 1.0227569522262, 1.4107875221978001, 0.7845343724126208, 5.152094113207899, 2.586683680498593, 2.6475415891285063, 4.585666110744368, 6.282330563284956, 2.076827621286212, 2.499376031681238, 2.502729198389164, 1.256342888600921, 1.8320493551239423, 2.093162864942286, 7.4613564530316925, 2.493142475896365, 2.3023757881895053, 2.4099821199118368, 4.771601479689748, 6.131360314277624, 2.584920359750997], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21302376757678312, "mean_inference_ms": 1.0974671846041297, "mean_action_processing_ms": 0.0457627879038223, "mean_env_wait_ms": 1.0181894880913525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 384000, "timers": {"sample_time_ms": 6178.077, "sample_throughput": 3107.763, "learn_time_ms": 5949.902, "learn_throughput": 3226.944, "update_time_ms": 1.716}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": -0.013085465179756284, "policy_loss": -0.06800400522227089, "vf_loss": 0.03017478721216321, "vf_explained_var": 0.8733094334602356, "kl": 0.016495835750053325, "entropy": -3.555076780319214, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 384, "training_iteration": 20, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-05-20", "timestamp": 1617649520, "time_this_iter_s": 11.864535570144653, "time_total_s": 230.58400464057922, "pid": 22361, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 60.67793083190918, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 45.19411764705882, "ram_util_percent": 62.170588235294126}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 7.052705869238235, "episode_reward_min": 1.513164179284657, "episode_reward_mean": 3.390389211439904, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.1863973392177987, 2.9900508065225684, 2.4269797201151566, 2.8538226025208946, 2.825064404818029, 1.513164179284657, 1.945999227643711, 4.551453622592005, 5.318625560335436, 1.7177334564284874, 3.5111512415083936, 7.052705869238235, 3.6957310394081118, 4.167762330217613, 4.639159359979844, 2.8504266232075226], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17318776228784374, "mean_inference_ms": 0.9476454592605077, "mean_action_processing_ms": 0.040478914392734267, "mean_env_wait_ms": 0.9008726195860088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 403200, "timers": {"sample_time_ms": 5904.011, "sample_throughput": 3252.026, "learn_time_ms": 6448.971, "learn_throughput": 2977.219, "update_time_ms": 1.963}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005115736894539944, "total_loss": -0.011104595406601827, "policy_loss": -0.0684319865082701, "vf_loss": 0.036445706896483895, "vf_explained_var": 0.8493611812591553, "kl": 0.020881684770186742, "entropy": -3.5505645942687987, "entropy_coeff": 0.0}}, "num_steps_sampled": 403200, "num_steps_trained": 403200}, "done": false, "episodes_total": 400, "training_iteration": 21, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-06-44", "timestamp": 1617649604, "time_this_iter_s": 12.358218669891357, "time_total_s": 242.94222331047058, "pid": 23243, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.358218669891357, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 50.82222222222222, "ram_util_percent": 59.94444444444444}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 8.921551220718886, "episode_reward_min": 1.513164179284657, "episode_reward_mean": 3.395478169246246, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.9852992871674076, 1.808099763277856, 2.8185839122889527, 2.217300598161301, 2.390990363838509, 6.143004044127288, 4.705765049085457, 1.6385268492732594, 2.5116124664942916, 2.0866539345244735, 3.368776235084227, 2.7778887287793093, 3.8733703413396485, 8.921551220718886, 3.2446352417508892, 2.917015996929649, 2.1863973392177987, 2.9900508065225684, 2.4269797201151566, 2.8538226025208946, 2.825064404818029, 1.513164179284657, 1.945999227643711, 4.551453622592005, 5.318625560335436, 1.7177334564284874, 3.5111512415083936, 7.052705869238235, 3.6957310394081118, 4.167762330217613, 4.639159359979844, 2.8504266232075226], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1778413015581892, "mean_inference_ms": 0.975556469238235, "mean_action_processing_ms": 0.04075280042637805, "mean_env_wait_ms": 0.9019442966636428, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 422400, "timers": {"sample_time_ms": 5914.955, "sample_throughput": 3246.009, "learn_time_ms": 6231.432, "learn_throughput": 3081.154, "update_time_ms": 1.861}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": -0.00498215268055598, "policy_loss": -0.06380456944927573, "vf_loss": 0.03618340569237868, "vf_explained_var": 0.8681814670562744, "kl": 0.015092673903952043, "entropy": -3.583451798756917, "entropy_coeff": 0.0}}, "num_steps_sampled": 422400, "num_steps_trained": 422400}, "done": false, "episodes_total": 416, "training_iteration": 22, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-06-56", "timestamp": 1617649616, "time_this_iter_s": 11.947349548339844, "time_total_s": 254.88957285881042, "pid": 23243, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.3055682182312, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.07647058823529, "ram_util_percent": 62.15882352941177}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 8.921551220718886, "episode_reward_min": 0.4648017800170441, "episode_reward_mean": 3.263070592499464, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.4648017800170441, 1.3067161637826028, 2.939882161664278, 2.3472861858967358, 2.4958794991263313, 4.055286655388866, 3.3723867100857454, 3.0371410647847146, 4.103239228986714, 2.931025326361818, 1.1775991501554843, 4.288838475200769, 3.5823150997707005, 2.4212100089719897, 7.911808389101601, 2.4859888590807726, 6.947913253210374, 0.9148431996340529, 3.039248831296991, 4.292553638211809, 2.9975389383324686, 2.420278251613889, 2.3270961765683023, 2.2157747168460693, 2.1863973392177987, 2.9900508065225684, 2.4269797201151566, 2.8538226025208946, 2.825064404818029, 1.513164179284657, 1.945999227643711, 4.551453622592005, 5.318625560335436, 1.7177334564284874, 3.5111512415083936, 7.052705869238235, 3.6957310394081118, 4.167762330217613, 4.639159359979844, 2.8504266232075226, 2.9852992871674076, 1.808099763277856, 2.8185839122889527, 2.217300598161301, 2.390990363838509, 6.143004044127288, 4.705765049085457, 1.6385268492732594, 2.5116124664942916, 2.0866539345244735, 3.368776235084227, 2.7778887287793093, 3.8733703413396485, 8.921551220718886, 3.2446352417508892, 2.917015996929649], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1845977042186748, "mean_inference_ms": 0.9853390172365505, "mean_action_processing_ms": 0.04097386508797381, "mean_env_wait_ms": 0.9034500486694227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 441600, "timers": {"sample_time_ms": 5853.105, "sample_throughput": 3280.31, "learn_time_ms": 6136.212, "learn_throughput": 3128.966, "update_time_ms": 1.844}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": 0.015375953555727998, "policy_loss": -0.06383722891410192, "vf_loss": 0.05349649752179782, "vf_explained_var": 0.8061091899871826, "kl": 0.017144456387807927, "entropy": -3.614342583020528, "entropy_coeff": 0.0}}, "num_steps_sampled": 441600, "num_steps_trained": 441600}, "done": false, "episodes_total": 440, "training_iteration": 23, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-07-08", "timestamp": 1617649628, "time_this_iter_s": 11.683225631713867, "time_total_s": 266.5727984905243, "pid": 23243, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.98879384994507, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.37647058823529, "ram_util_percent": 62.19411764705882}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 8.921551220718886, "episode_reward_min": 0.4648017800170441, "episode_reward_mean": 3.3429168357981767, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.268514973732302, 2.6426338822762965, 2.852015720658255, 4.721769229139835, 1.7623208145340254, 3.5338462589142328, 2.951382159588063, 2.775363355521959, 3.3512693476341653, 3.427840979720643, 0.8715079496824938, 6.857362803689192, 4.0179103477056515, 4.719334008785732, 3.997264394049231, 5.20772277186668, 2.1863973392177987, 2.9900508065225684, 2.4269797201151566, 2.8538226025208946, 2.825064404818029, 1.513164179284657, 1.945999227643711, 4.551453622592005, 5.318625560335436, 1.7177334564284874, 3.5111512415083936, 7.052705869238235, 3.6957310394081118, 4.167762330217613, 4.639159359979844, 2.8504266232075226, 2.9852992871674076, 1.808099763277856, 2.8185839122889527, 2.217300598161301, 2.390990363838509, 6.143004044127288, 4.705765049085457, 1.6385268492732594, 2.5116124664942916, 2.0866539345244735, 3.368776235084227, 2.7778887287793093, 3.8733703413396485, 8.921551220718886, 3.2446352417508892, 2.917015996929649, 0.4648017800170441, 1.3067161637826028, 2.939882161664278, 2.3472861858967358, 2.4958794991263313, 4.055286655388866, 3.3723867100857454, 3.0371410647847146, 4.103239228986714, 2.931025326361818, 1.1775991501554843, 4.288838475200769, 3.5823150997707005, 2.4212100089719897, 7.911808389101601, 2.4859888590807726, 6.947913253210374, 0.9148431996340529, 3.039248831296991, 4.292553638211809, 2.9975389383324686, 2.420278251613889, 2.3270961765683023, 2.2157747168460693], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18615298421925197, "mean_inference_ms": 0.9876609726171972, "mean_action_processing_ms": 0.04106528892035502, "mean_env_wait_ms": 0.9043329203890187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 460800, "timers": {"sample_time_ms": 5797.465, "sample_throughput": 3311.793, "learn_time_ms": 6055.806, "learn_throughput": 3170.511, "update_time_ms": 1.824}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": -1.2293007845679919e-05, "policy_loss": -0.06164267840484778, "vf_loss": 0.0383676956842343, "vf_explained_var": 0.8526949882507324, "kl": 0.015508460315565268, "entropy": -3.60064967473348, "entropy_coeff": 0.0}}, "num_steps_sampled": 460800, "num_steps_trained": 460800}, "done": false, "episodes_total": 456, "training_iteration": 24, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-07-19", "timestamp": 1617649639, "time_this_iter_s": 11.45320177078247, "time_total_s": 278.02600026130676, "pid": 23243, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.44199562072754, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.59375, "ram_util_percent": 62.0625}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 8.921551220718886, "episode_reward_min": 0.4648017800170441, "episode_reward_mean": 3.532777177289034, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.6050066740374236, 4.328212386258175, 4.268536401199888, 2.3784294985051946, 2.6475881370070566, 5.475009216991429, 3.1135623776987886, 3.8746334596087335, 2.309437276763866, 3.883237571464325, 3.3833487674357645, 2.381068721677884, 5.268923184670189, 3.639211391883893, 5.6090423608156765, 2.30095166614901, 6.0133626651812095, 5.647333201069419, 4.960063989614421, 7.022566306832319, 5.527461418249501, 2.882661330858089, 4.277828692563369, 3.659120145742871, 2.1863973392177987, 2.9900508065225684, 2.4269797201151566, 2.8538226025208946, 2.825064404818029, 1.513164179284657, 1.945999227643711, 4.551453622592005, 5.318625560335436, 1.7177334564284874, 3.5111512415083936, 7.052705869238235, 3.6957310394081118, 4.167762330217613, 4.639159359979844, 2.8504266232075226, 2.9852992871674076, 1.808099763277856, 2.8185839122889527, 2.217300598161301, 2.390990363838509, 6.143004044127288, 4.705765049085457, 1.6385268492732594, 2.5116124664942916, 2.0866539345244735, 3.368776235084227, 2.7778887287793093, 3.8733703413396485, 8.921551220718886, 3.2446352417508892, 2.917015996929649, 0.4648017800170441, 1.3067161637826028, 2.939882161664278, 2.3472861858967358, 2.4958794991263313, 4.055286655388866, 3.3723867100857454, 3.0371410647847146, 4.103239228986714, 2.931025326361818, 1.1775991501554843, 4.288838475200769, 3.5823150997707005, 2.4212100089719897, 7.911808389101601, 2.4859888590807726, 6.947913253210374, 0.9148431996340529, 3.039248831296991, 4.292553638211809, 2.9975389383324686, 2.420278251613889, 2.3270961765683023, 2.2157747168460693, 4.268514973732302, 2.6426338822762965, 2.852015720658255, 4.721769229139835, 1.7623208145340254, 3.5338462589142328, 2.951382159588063, 2.775363355521959, 3.3512693476341653, 3.427840979720643, 0.8715079496824938, 6.857362803689192, 4.0179103477056515, 4.719334008785732, 3.997264394049231, 5.20772277186668], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18935109297459884, "mean_inference_ms": 0.9889601557417476, "mean_action_processing_ms": 0.04114898284979718, "mean_env_wait_ms": 0.90490584702391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 480000, "timers": {"sample_time_ms": 5782.142, "sample_throughput": 3320.569, "learn_time_ms": 6014.261, "learn_throughput": 3192.412, "update_time_ms": 1.828}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005115736894539944, "total_loss": 0.010405130324264367, "policy_loss": -0.06219713463758429, "vf_loss": 0.04760044640551011, "vf_explained_var": 0.8785128593444824, "kl": 0.0166678784104685, "entropy": -3.654406776428223, "entropy_coeff": 0.0}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 480, "training_iteration": 25, "experiment_id": "1909da822f364ac3816ee48a59de5543", "date": "2021-04-05_12-07-31", "timestamp": 1617649651, "time_this_iter_s": 11.577184915542603, "time_total_s": 289.60318517684937, "pid": 23243, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 17954, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 27, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0005115736894539945, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9945987522415973, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3597109425247236, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 59.01918053627014, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.847058823529416, "ram_util_percent": 62.111764705882344}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 57.016633231376, "episode_reward_min": 17.98306664587949, "episode_reward_mean": 34.37718213524933, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.328140857422046, 30.721069028186577, 17.98306664587949, 45.69142978690832, 57.016633231376, 26.001711170532023, 43.46448181192517, 26.810924549765016], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14477350332655575, "mean_inference_ms": 0.7880724885878614, "mean_action_processing_ms": 0.03354954878356832, "mean_env_wait_ms": 0.7543141746600402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 470400, "timers": {"sample_time_ms": 7551.897, "sample_throughput": 1271.204, "learn_time_ms": 4812.363, "learn_throughput": 1994.862, "update_time_ms": 1.648}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001, "total_loss": 4.745668258913701e+22, "policy_loss": 0.028776614956321226, "vf_loss": 4.745668258913701e+22, "vf_explained_var": 0.0, "kl": 0.3870189379131983, "entropy": -4.317869875166151, "entropy_coeff": 0.0}}, "num_steps_sampled": 470400, "num_steps_trained": 470400}, "done": false, "episodes_total": 456, "training_iteration": 37, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-07-51", "timestamp": 1617649671, "time_this_iter_s": 12.368651628494263, "time_total_s": 285.5552372932434, "pid": 23818, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.167095548616784, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 19, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.368651628494263, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.516666666666666, "ram_util_percent": 61.62777777777777}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 57.016633231376, "episode_reward_min": 16.42924438956795, "episode_reward_mean": 29.85207138428425, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.73212111953196, 23.530559491244084, 29.387308003628547, 18.113437785830687, 20.44355833438103, 33.75716070863665, 16.42924438956795, 31.22229523373244, 27.328140857422046, 30.721069028186577, 17.98306664587949, 45.69142978690832, 57.016633231376, 26.001711170532023, 43.46448181192517, 26.810924549765016], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1478584023683731, "mean_inference_ms": 0.8028420114263415, "mean_action_processing_ms": 0.03419184242836682, "mean_env_wait_ms": 0.7537310407957086, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 480000, "timers": {"sample_time_ms": 4997.857, "sample_throughput": 1920.823, "learn_time_ms": 4776.224, "learn_throughput": 2009.956, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001, "total_loss": 1.2809164564208401e+25, "policy_loss": 0.04934222532051896, "vf_loss": 1.2809164564208401e+25, "vf_explained_var": 0.0, "kl": 0.32246812373872785, "entropy": -4.010263972812229, "entropy_coeff": 0.0}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 464, "training_iteration": 38, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-07-59", "timestamp": 1617649679, "time_this_iter_s": 7.189976692199707, "time_total_s": 292.7452139854431, "pid": 23818, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.167095548616784, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 19, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.55862832069397, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 38.040000000000006, "ram_util_percent": 61.96}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 57.016633231376, "episode_reward_min": 4.363532179903989, "episode_reward_mean": 23.70699982944244, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.71669870731213, 12.020635889693105, 4.363532179903989, 16.631182662204225, 9.021957420641332, 11.305933233531235, 13.601587203508165, 7.673326461276378, 27.328140857422046, 30.721069028186577, 17.98306664587949, 45.69142978690832, 57.016633231376, 26.001711170532023, 43.46448181192517, 26.810924549765016, 29.73212111953196, 23.530559491244084, 29.387308003628547, 18.113437785830687, 20.44355833438103, 33.75716070863665, 16.42924438956795, 31.22229523373244], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14902106742743612, "mean_inference_ms": 0.8098120677066921, "mean_action_processing_ms": 0.034520974073798984, "mean_env_wait_ms": 0.7521078885940254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 489600, "timers": {"sample_time_ms": 4116.279, "sample_throughput": 2332.204, "learn_time_ms": 4772.632, "learn_throughput": 2011.469, "update_time_ms": 1.534}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001, "total_loss": 5.2580011748793175e+23, "policy_loss": 0.013917313522792287, "vf_loss": 5.2580011748793175e+23, "vf_explained_var": 0.0, "kl": 0.12024186977318355, "entropy": -3.85843555132548, "entropy_coeff": 0.0}}, "num_steps_sampled": 489600, "num_steps_trained": 489600}, "done": false, "episodes_total": 472, "training_iteration": 39, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-06", "timestamp": 1617649686, "time_this_iter_s": 7.124762058258057, "time_total_s": 299.8699760437012, "pid": 23818, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.167095548616784, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 19, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.683390378952026, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.127272727272725, "ram_util_percent": 61.95454545454545}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 57.016633231376, "episode_reward_min": 1.0541324885828773, "episode_reward_mean": 18.619633336628407, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.7094519854744221, 1.0541324885828773, 2.4292725973915923, 5.552830512519382, 5.286606441518336, 5.760287644399928, 2.935729888836391, 2.1319593067676226, 27.328140857422046, 30.721069028186577, 17.98306664587949, 45.69142978690832, 57.016633231376, 26.001711170532023, 43.46448181192517, 26.810924549765016, 29.73212111953196, 23.530559491244084, 29.387308003628547, 18.113437785830687, 20.44355833438103, 33.75716070863665, 16.42924438956795, 31.22229523373244, 16.71669870731213, 12.020635889693105, 4.363532179903989, 16.631182662204225, 9.021957420641332, 11.305933233531235, 13.601587203508165, 7.673326461276378], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14944940018802805, "mean_inference_ms": 0.8111417305286138, "mean_action_processing_ms": 0.03458391156623693, "mean_env_wait_ms": 0.7478415583087057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 499200, "timers": {"sample_time_ms": 3655.835, "sample_throughput": 2625.939, "learn_time_ms": 4765.527, "learn_throughput": 2014.468, "update_time_ms": 1.583}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.001, "total_loss": 8.386603441690234e+24, "policy_loss": 0.01992573253283765, "vf_loss": 8.386603441690234e+24, "vf_explained_var": 0.0, "kl": 0.12457034985224406, "entropy": -3.6853926787300715, "entropy_coeff": 0.0}}, "num_steps_sampled": 499200, "num_steps_trained": 499200}, "done": false, "episodes_total": 480, "training_iteration": 40, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-13", "timestamp": 1617649693, "time_this_iter_s": 7.024834156036377, "time_total_s": 306.89481019973755, "pid": 23818, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.167095548616784, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 19, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.7082245349884, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.7, "ram_util_percent": 61.94}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 57.016633231376, "episode_reward_min": -0.3093205559696398, "episode_reward_mean": 12.806609088939355, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8736296166057547, -0.3093205559696398, 1.7636711303863168, 0.6058675546617482, 1.0226908455638903, -0.021747002405562932, 2.6036491797346906, 0.7911393169421939, 1.6071136905777292, 0.5923826920213329, 3.0567859696779296, 0.07857382514431377, 4.807060793666805, 0.44561047161453127, 1.172659083328834, -0.2007971145708185, 27.328140857422046, 30.721069028186577, 17.98306664587949, 45.69142978690832, 57.016633231376, 26.001711170532023, 43.46448181192517, 26.810924549765016, 29.73212111953196, 23.530559491244084, 29.387308003628547, 18.113437785830687, 20.44355833438103, 33.75716070863665, 16.42924438956795, 31.22229523373244, 16.71669870731213, 12.020635889693105, 4.363532179903989, 16.631182662204225, 9.021957420641332, 11.305933233531235, 13.601587203508165, 7.673326461276378, 1.7094519854744221, 1.0541324885828773, 2.4292725973915923, 5.552830512519382, 5.286606441518336, 5.760287644399928, 2.935729888836391, 2.1319593067676226], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1534510988637562, "mean_inference_ms": 0.8193053906024274, "mean_action_processing_ms": 0.034547930435654156, "mean_env_wait_ms": 0.7406795292020886, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 508800, "timers": {"sample_time_ms": 3417.804, "sample_throughput": 2808.821, "learn_time_ms": 4767.472, "learn_throughput": 2013.646, "update_time_ms": 1.62}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.0625, "cur_lr": 0.001, "total_loss": 3.5691645132451114e+22, "policy_loss": -5.793560431191018e-05, "vf_loss": 3.5691645132451114e+22, "vf_explained_var": 0.0, "kl": 0.033471961520493976, "entropy": -3.708798991309272, "entropy_coeff": 0.0}}, "num_steps_sampled": 508800, "num_steps_trained": 508800}, "done": false, "episodes_total": 496, "training_iteration": 41, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-20", "timestamp": 1617649700, "time_this_iter_s": 7.247375011444092, "time_total_s": 314.14218521118164, "pid": 23818, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.167095548616784, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 19, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.955599546432495, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 36.55, "ram_util_percent": 61.9}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 57.016633231376, "episode_reward_min": -0.437310518562252, "episode_reward_mean": 10.983169020527168, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.296103287316104, -0.11151192639133956, -0.10367238059350437, -0.437310518562252, 0.04088683351289513, 0.48742859309025777, 0.08390912512546578, 0.08439586693456214, 27.328140857422046, 30.721069028186577, 17.98306664587949, 45.69142978690832, 57.016633231376, 26.001711170532023, 43.46448181192517, 26.810924549765016, 29.73212111953196, 23.530559491244084, 29.387308003628547, 18.113437785830687, 20.44355833438103, 33.75716070863665, 16.42924438956795, 31.22229523373244, 16.71669870731213, 12.020635889693105, 4.363532179903989, 16.631182662204225, 9.021957420641332, 11.305933233531235, 13.601587203508165, 7.673326461276378, 1.7094519854744221, 1.0541324885828773, 2.4292725973915923, 5.552830512519382, 5.286606441518336, 5.760287644399928, 2.935729888836391, 2.1319593067676226, 0.8736296166057547, -0.3093205559696398, 1.7636711303863168, 0.6058675546617482, 1.0226908455638903, -0.021747002405562932, 2.6036491797346906, 0.7911393169421939, 1.6071136905777292, 0.5923826920213329, 3.0567859696779296, 0.07857382514431377, 4.807060793666805, 0.44561047161453127, 1.172659083328834, -0.2007971145708185], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15422427890500784, "mean_inference_ms": 0.8208406238658645, "mean_action_processing_ms": 0.03452326726500961, "mean_env_wait_ms": 0.7381409080951339, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 518400, "timers": {"sample_time_ms": 3228.778, "sample_throughput": 2973.261, "learn_time_ms": 4770.727, "learn_throughput": 2012.272, "update_time_ms": 1.617}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.59375, "cur_lr": 0.001, "total_loss": 1.9735208050410366e+25, "policy_loss": 0.006147201867803695, "vf_loss": 1.9735208050410366e+25, "vf_explained_var": 0.0, "kl": 0.013857529498636723, "entropy": -3.764634783305819, "entropy_coeff": 0.0}}, "num_steps_sampled": 518400, "num_steps_trained": 518400}, "done": false, "episodes_total": 504, "training_iteration": 42, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-27", "timestamp": 1617649707, "time_this_iter_s": 7.076655864715576, "time_total_s": 321.2188410758972, "pid": 23818, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.167095548616784, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 19, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.03225541114807, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.94, "ram_util_percent": 61.9}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 57.016633231376, "episode_reward_min": -0.437310518562252, "episode_reward_mean": 9.642630622025822, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.008255113162304095, 0.18872462574832483, 0.2798580882113191, -0.016101079738633395, 0.3133564004800966, 0.7868738084432687, 0.5279873310320973, -0.018059627207555273, 27.328140857422046, 30.721069028186577, 17.98306664587949, 45.69142978690832, 57.016633231376, 26.001711170532023, 43.46448181192517, 26.810924549765016, 29.73212111953196, 23.530559491244084, 29.387308003628547, 18.113437785830687, 20.44355833438103, 33.75716070863665, 16.42924438956795, 31.22229523373244, 16.71669870731213, 12.020635889693105, 4.363532179903989, 16.631182662204225, 9.021957420641332, 11.305933233531235, 13.601587203508165, 7.673326461276378, 1.7094519854744221, 1.0541324885828773, 2.4292725973915923, 5.552830512519382, 5.286606441518336, 5.760287644399928, 2.935729888836391, 2.1319593067676226, 0.8736296166057547, -0.3093205559696398, 1.7636711303863168, 0.6058675546617482, 1.0226908455638903, -0.021747002405562932, 2.6036491797346906, 0.7911393169421939, 1.6071136905777292, 0.5923826920213329, 3.0567859696779296, 0.07857382514431377, 4.807060793666805, 0.44561047161453127, 1.172659083328834, -0.2007971145708185, 0.296103287316104, -0.11151192639133956, -0.10367238059350437, -0.437310518562252, 0.04088683351289513, 0.48742859309025777, 0.08390912512546578, 0.08439586693456214], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15455023769374904, "mean_inference_ms": 0.8211159386627379, "mean_action_processing_ms": 0.03448170735305246, "mean_env_wait_ms": 0.7355652768293998, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 528000, "timers": {"sample_time_ms": 3072.409, "sample_throughput": 3124.584, "learn_time_ms": 4785.984, "learn_throughput": 2005.857, "update_time_ms": 1.573}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.59375, "cur_lr": 0.001, "total_loss": 4.456742986066998e+26, "policy_loss": 0.0009927647336134835, "vf_loss": 4.456742986066998e+26, "vf_explained_var": 0.0, "kl": 0.008410714041914732, "entropy": -3.881761123263647, "entropy_coeff": 0.0}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 512, "training_iteration": 43, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-34", "timestamp": 1617649714, "time_this_iter_s": 7.017749786376953, "time_total_s": 328.23659086227417, "pid": 23818, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.167095548616784, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 19, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 55.050005197525024, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 33.31, "ram_util_percent": 59.81}, "trial_id": "9a1ab_00003"}
{"episode_reward_max": 59.96939150554101, "episode_reward_min": 20.69403556547184, "episode_reward_mean": 36.75592683731618, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.81421302606769, 28.347082043570104, 37.483524781819945, 32.36858730879658, 20.69403556547184, 59.96939150554101, 35.94492968690499, 45.42565078035727], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15299132622648137, "mean_inference_ms": 0.8344666646183976, "mean_action_processing_ms": 0.035573178584331476, "mean_env_wait_ms": 0.7939938452718259, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 560000, "timers": {"sample_time_ms": 2566.236, "sample_throughput": 3740.887, "learn_time_ms": 3008.193, "learn_throughput": 3191.284, "update_time_ms": 1.49}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.010000000000000002, "total_loss": 9.541038099003289e+22, "policy_loss": 0.02089411404819065, "vf_loss": 9.541038099003289e+22, "vf_explained_var": 0.0, "kl": 0.42369736612789216, "entropy": -4.59070696906438, "entropy_coeff": 0.0}}, "num_steps_sampled": 560000, "num_steps_trained": 560000}, "done": true, "episodes_total": 544, "training_iteration": 44, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-09-50", "timestamp": 1617649790, "time_this_iter_s": 5.579413175582886, "time_total_s": 329.7391347885132, "pid": 25545, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.167095548616784, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.579413175582886, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.0625, "ram_util_percent": 62.3125}, "trial_id": "9a1ab_00003"}
