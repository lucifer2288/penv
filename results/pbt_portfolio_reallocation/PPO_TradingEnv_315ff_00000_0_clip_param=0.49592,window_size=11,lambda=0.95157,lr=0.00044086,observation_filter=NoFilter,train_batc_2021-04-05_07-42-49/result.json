{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 3800, "timers": {"sample_time_ms": 965.871, "sample_throughput": 3934.274, "learn_time_ms": 830.38, "learn_throughput": 4576.22, "update_time_ms": 2.781}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.014787107830246289, "policy_loss": -0.030351568572223188, "vf_loss": 0.004218757734633982, "vf_explained_var": 0.6320265531539917, "kl": 0.011345702487354477, "entropy": -3.7195995648701987, "entropy_coeff": 0.0}}, "num_steps_sampled": 3800, "num_steps_trained": 3800}, "done": false, "episodes_total": 0, "training_iteration": 1, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-42-57", "timestamp": 1617633777, "time_this_iter_s": 1.8372528553009033, "time_total_s": 1.8372528553009033, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1.8372528553009033, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.599999999999994, "ram_util_percent": 61.23333333333333}, "trial_id": "315ff_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 7600, "timers": {"sample_time_ms": 753.358, "sample_throughput": 5044.086, "learn_time_ms": 825.752, "learn_throughput": 4601.866, "update_time_ms": 2.689}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.012283133094509442, "policy_loss": -0.030162049767871697, "vf_loss": 0.004007215177019437, "vf_explained_var": 0.9107435345649719, "kl": 0.01387170258288582, "entropy": -3.668540120124817, "entropy_coeff": 0.0}}, "num_steps_sampled": 7600, "num_steps_trained": 7600}, "done": false, "episodes_total": 0, "training_iteration": 2, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-42-59", "timestamp": 1617633779, "time_this_iter_s": 1.3947505950927734, "time_total_s": 3.2320034503936768, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3.2320034503936768, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.7, "ram_util_percent": 61.5}, "trial_id": "315ff_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 11400, "timers": {"sample_time_ms": 684.999, "sample_throughput": 5547.453, "learn_time_ms": 826.534, "learn_throughput": 4597.514, "update_time_ms": 2.77}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.01337561324859659, "policy_loss": -0.026362549203137558, "vf_loss": 0.002772165066562593, "vf_explained_var": 0.9335026144981384, "kl": 0.010214769979938865, "entropy": -3.7314003864924112, "entropy_coeff": 0.0}}, "num_steps_sampled": 11400, "num_steps_trained": 11400}, "done": false, "episodes_total": 0, "training_iteration": 3, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-00", "timestamp": 1617633780, "time_this_iter_s": 1.3835792541503906, "time_total_s": 4.615582704544067, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4.615582704544067, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.25, "ram_util_percent": 61.5}, "trial_id": "315ff_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 15200, "timers": {"sample_time_ms": 650.586, "sample_throughput": 5840.884, "learn_time_ms": 832.521, "learn_throughput": 4564.447, "update_time_ms": 2.789}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.016094423551112413, "policy_loss": -0.03137944812575976, "vf_loss": 0.0021638173105505607, "vf_explained_var": 0.7968776822090149, "kl": 0.013121207912142078, "entropy": -3.7652015606562297, "entropy_coeff": 0.0}}, "num_steps_sampled": 15200, "num_steps_trained": 15200}, "done": false, "episodes_total": 0, "training_iteration": 4, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-01", "timestamp": 1617633781, "time_this_iter_s": 1.405796766281128, "time_total_s": 6.021379470825195, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.021379470825195, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.45, "ram_util_percent": 61.5}, "trial_id": "315ff_00000"}
{"episode_reward_max": 0.8095293915887871, "episode_reward_min": -0.6068467365764718, "episode_reward_mean": -0.07489447467224922, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19277821292172184, "mean_inference_ms": 1.2537017029801831, "mean_action_processing_ms": 0.05315099644281115, "mean_env_wait_ms": 1.2707083977022797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 19000, "timers": {"sample_time_ms": 665.354, "sample_throughput": 5711.246, "learn_time_ms": 837.487, "learn_throughput": 4537.385, "update_time_ms": 2.835}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.014998973192026218, "policy_loss": -0.029920631057272353, "vf_loss": 0.003162550856359303, "vf_explained_var": 0.7883790731430054, "kl": 0.011759104998782277, "entropy": -3.9182233174641925, "entropy_coeff": 0.0}}, "num_steps_sampled": 19000, "num_steps_trained": 19000}, "done": false, "episodes_total": 19, "training_iteration": 5, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-03", "timestamp": 1617633783, "time_this_iter_s": 1.5902140140533447, "time_total_s": 7.61159348487854, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.61159348487854, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 46.8, "ram_util_percent": 61.5}, "trial_id": "315ff_00000"}
{"episode_reward_max": 0.8095293915887871, "episode_reward_min": -0.6068467365764718, "episode_reward_mean": -0.07489447467224922, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19277821292172184, "mean_inference_ms": 1.2537017029801831, "mean_action_processing_ms": 0.05315099644281115, "mean_env_wait_ms": 1.2707083977022797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 22800, "timers": {"sample_time_ms": 646.031, "sample_throughput": 5882.072, "learn_time_ms": 839.806, "learn_throughput": 4524.856, "update_time_ms": 2.853}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.013144312333315611, "policy_loss": -0.02681702032374839, "vf_loss": 0.002369193457222233, "vf_explained_var": 0.5132908821105957, "kl": 0.011303513140107194, "entropy": -3.7471796751022337, "entropy_coeff": 0.0}}, "num_steps_sampled": 22800, "num_steps_trained": 22800}, "done": false, "episodes_total": 19, "training_iteration": 6, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-04", "timestamp": 1617633784, "time_this_iter_s": 1.4084877967834473, "time_total_s": 9.020081281661987, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.020081281661987, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.7, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 0.8095293915887871, "episode_reward_min": -0.6068467365764718, "episode_reward_mean": -0.07489447467224922, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19277821292172184, "mean_inference_ms": 1.2537017029801831, "mean_action_processing_ms": 0.05315099644281115, "mean_env_wait_ms": 1.2707083977022797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 26600, "timers": {"sample_time_ms": 631.996, "sample_throughput": 6012.693, "learn_time_ms": 841.693, "learn_throughput": 4514.709, "update_time_ms": 2.887}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.017775599223872025, "policy_loss": -0.031863345702489214, "vf_loss": 0.0026544801114747924, "vf_explained_var": 0.9243072271347046, "kl": 0.011433263837049405, "entropy": -3.7294121185938516, "entropy_coeff": 0.0}}, "num_steps_sampled": 26600, "num_steps_trained": 26600}, "done": false, "episodes_total": 19, "training_iteration": 7, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-06", "timestamp": 1617633786, "time_this_iter_s": 1.4085404872894287, "time_total_s": 10.428621768951416, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.428621768951416, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 41.15, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 0.8095293915887871, "episode_reward_min": -0.6068467365764718, "episode_reward_mean": -0.07489447467224922, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19277821292172184, "mean_inference_ms": 1.2537017029801831, "mean_action_processing_ms": 0.05315099644281115, "mean_env_wait_ms": 1.2707083977022797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 30400, "timers": {"sample_time_ms": 620.986, "sample_throughput": 6119.305, "learn_time_ms": 841.186, "learn_throughput": 4517.429, "update_time_ms": 2.879}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.017698211378107467, "policy_loss": -0.03133873008191586, "vf_loss": 0.001841466373298317, "vf_explained_var": 0.8774826526641846, "kl": 0.011799054158230623, "entropy": -3.8838643550872805, "entropy_coeff": 0.0}}, "num_steps_sampled": 30400, "num_steps_trained": 30400}, "done": false, "episodes_total": 19, "training_iteration": 8, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-07", "timestamp": 1617633787, "time_this_iter_s": 1.388979434967041, "time_total_s": 11.817601203918457, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.817601203918457, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 40.7, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 0.8095293915887871, "episode_reward_min": -0.6068467365764718, "episode_reward_mean": -0.07489447467224922, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19277821292172184, "mean_inference_ms": 1.2537017029801831, "mean_action_processing_ms": 0.05315099644281115, "mean_env_wait_ms": 1.2707083977022797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 34200, "timers": {"sample_time_ms": 613.382, "sample_throughput": 6195.16, "learn_time_ms": 840.286, "learn_throughput": 4522.27, "update_time_ms": 2.878}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.020324684493243695, "policy_loss": -0.0338329093841215, "vf_loss": 0.0019437073923957845, "vf_explained_var": 0.7203700542449951, "kl": 0.011564516027768453, "entropy": -3.755038261413574, "entropy_coeff": 0.0}}, "num_steps_sampled": 34200, "num_steps_trained": 34200}, "done": false, "episodes_total": 19, "training_iteration": 9, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-09", "timestamp": 1617633789, "time_this_iter_s": 1.393202781677246, "time_total_s": 13.210803985595703, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.210803985595703, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 40.949999999999996, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 0.8095293915887871, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": -0.17054365418586584, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, -0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19313545147859545, "mean_inference_ms": 1.255364944310047, "mean_action_processing_ms": 0.05321075221113563, "mean_env_wait_ms": 1.2471497963183669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 38000, "timers": {"sample_time_ms": 617.623, "sample_throughput": 6152.623, "learn_time_ms": 840.578, "learn_throughput": 4520.701, "update_time_ms": 2.84}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.015196434454992414, "policy_loss": -0.026759400498121977, "vf_loss": 0.001946743845473975, "vf_explained_var": 0.8171513676643372, "kl": 0.009616222387800613, "entropy": -3.938671628634135, "entropy_coeff": 0.0}}, "num_steps_sampled": 38000, "num_steps_trained": 38000}, "done": false, "episodes_total": 38, "training_iteration": 10, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-10", "timestamp": 1617633790, "time_this_iter_s": 1.5064570903778076, "time_total_s": 14.71726107597351, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.71726107597351, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 0.8095293915887871, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": -0.1705436541858659, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19313545147859545, "mean_inference_ms": 1.2553649443100465, "mean_action_processing_ms": 0.05321075221113563, "mean_env_wait_ms": 1.2471497963183669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 41800, "timers": {"sample_time_ms": 575.772, "sample_throughput": 6599.829, "learn_time_ms": 842.609, "learn_throughput": 4509.804, "update_time_ms": 2.806}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.016566829041888317, "policy_loss": -0.02925728807846705, "vf_loss": 0.0019808897865004837, "vf_explained_var": 0.7206993103027344, "kl": 0.010709570798402032, "entropy": -3.9242661158243815, "entropy_coeff": 0.0}}, "num_steps_sampled": 41800, "num_steps_trained": 41800}, "done": false, "episodes_total": 38, "training_iteration": 11, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-12", "timestamp": 1617633792, "time_this_iter_s": 1.4052791595458984, "time_total_s": 16.12254023551941, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.12254023551941, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.949999999999996, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 0.8095293915887871, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": -0.1705436541858659, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19313545147859545, "mean_inference_ms": 1.2553649443100465, "mean_action_processing_ms": 0.05321075221113563, "mean_env_wait_ms": 1.2471497963183669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 45600, "timers": {"sample_time_ms": 577.032, "sample_throughput": 6585.426, "learn_time_ms": 845.786, "learn_throughput": 4492.86, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.017626115245123704, "policy_loss": -0.031135583606859047, "vf_loss": 0.002193163393530995, "vf_explained_var": 0.9362517595291138, "kl": 0.011316305647293726, "entropy": -3.7617786248524983, "entropy_coeff": 0.0}}, "num_steps_sampled": 45600, "num_steps_trained": 45600}, "done": false, "episodes_total": 38, "training_iteration": 12, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-13", "timestamp": 1617633793, "time_this_iter_s": 1.4147346019744873, "time_total_s": 17.537274837493896, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.537274837493896, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.349999999999994, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 0.8095293915887871, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": -0.1705436541858659, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19313545147859545, "mean_inference_ms": 1.2553649443100465, "mean_action_processing_ms": 0.05321075221113563, "mean_env_wait_ms": 1.2471497963183669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 49400, "timers": {"sample_time_ms": 576.781, "sample_throughput": 6588.294, "learn_time_ms": 849.472, "learn_throughput": 4473.364, "update_time_ms": 2.883}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.01470706310744087, "policy_loss": -0.027985999981562298, "vf_loss": 0.0023613927769474685, "vf_explained_var": 0.9376800060272217, "kl": 0.01091754346465071, "entropy": -4.065859524408976, "entropy_coeff": 0.0}}, "num_steps_sampled": 49400, "num_steps_trained": 49400}, "done": false, "episodes_total": 38, "training_iteration": 13, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-14", "timestamp": 1617633794, "time_this_iter_s": 1.4182486534118652, "time_total_s": 18.95552349090576, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18.95552349090576, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 41.35, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 0.8095293915887871, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": -0.1705436541858659, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19313545147859545, "mean_inference_ms": 1.2553649443100465, "mean_action_processing_ms": 0.05321075221113563, "mean_env_wait_ms": 1.2471497963183669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 53200, "timers": {"sample_time_ms": 577.626, "sample_throughput": 6578.648, "learn_time_ms": 847.781, "learn_throughput": 4482.288, "update_time_ms": 2.855}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.012105362334599098, "policy_loss": -0.024763899389654398, "vf_loss": 0.0030498340570678313, "vf_explained_var": 0.7378236055374146, "kl": 0.009608705388382077, "entropy": -3.8350729942321777, "entropy_coeff": 0.0}}, "num_steps_sampled": 53200, "num_steps_trained": 53200}, "done": false, "episodes_total": 38, "training_iteration": 14, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-16", "timestamp": 1617633796, "time_this_iter_s": 1.3968186378479004, "time_total_s": 20.352342128753662, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.352342128753662, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.1, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.011543576167289, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": -0.08678934630786825, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, -0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19378175651625695, "mean_inference_ms": 1.2565344004480494, "mean_action_processing_ms": 0.053285467351549896, "mean_env_wait_ms": 1.2345122746937658, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 57000, "timers": {"sample_time_ms": 570.358, "sample_throughput": 6662.484, "learn_time_ms": 846.545, "learn_throughput": 4488.835, "update_time_ms": 2.823}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.014092150703072548, "policy_loss": -0.0341511810819308, "vf_loss": 0.005479100501785675, "vf_explained_var": 0.8206848502159119, "kl": 0.014579927362501622, "entropy": -3.9914796988169354, "entropy_coeff": 0.0}}, "num_steps_sampled": 57000, "num_steps_trained": 57000}, "done": false, "episodes_total": 57, "training_iteration": 15, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-17", "timestamp": 1617633797, "time_this_iter_s": 1.5050222873687744, "time_total_s": 21.857364416122437, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21.857364416122437, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 47.25, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.011543576167289, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": -0.08678934630786825, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19378175651625698, "mean_inference_ms": 1.2565344004480492, "mean_action_processing_ms": 0.053285467351549896, "mean_env_wait_ms": 1.2345122746937656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 60800, "timers": {"sample_time_ms": 569.692, "sample_throughput": 6670.268, "learn_time_ms": 848.377, "learn_throughput": 4479.141, "update_time_ms": 2.825}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.02012481146181623, "policy_loss": -0.03581519033759832, "vf_loss": 0.0029644530654574434, "vf_explained_var": 0.8052529692649841, "kl": 0.012725924265881379, "entropy": -4.0007128318150835, "entropy_coeff": 0.0}}, "num_steps_sampled": 60800, "num_steps_trained": 60800}, "done": false, "episodes_total": 57, "training_iteration": 16, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-19", "timestamp": 1617633799, "time_this_iter_s": 1.420363187789917, "time_total_s": 23.277727603912354, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.277727603912354, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.65, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.011543576167289, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": -0.08678934630786825, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19378175651625698, "mean_inference_ms": 1.2565344004480492, "mean_action_processing_ms": 0.053285467351549896, "mean_env_wait_ms": 1.2345122746937656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 64600, "timers": {"sample_time_ms": 569.09, "sample_throughput": 6677.323, "learn_time_ms": 849.165, "learn_throughput": 4474.985, "update_time_ms": 2.793}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.02235628788669904, "policy_loss": -0.04091880839938919, "vf_loss": 0.004145475189822416, "vf_explained_var": 0.9200515747070312, "kl": 0.014417044104387362, "entropy": -3.852959068616231, "entropy_coeff": 0.0}}, "num_steps_sampled": 64600, "num_steps_trained": 64600}, "done": false, "episodes_total": 57, "training_iteration": 17, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-20", "timestamp": 1617633800, "time_this_iter_s": 1.4104504585266113, "time_total_s": 24.688178062438965, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.688178062438965, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 40.3, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.011543576167289, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": -0.08678934630786825, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19378175651625698, "mean_inference_ms": 1.2565344004480492, "mean_action_processing_ms": 0.053285467351549896, "mean_env_wait_ms": 1.2345122746937656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 68400, "timers": {"sample_time_ms": 570.184, "sample_throughput": 6664.52, "learn_time_ms": 851.888, "learn_throughput": 4460.681, "update_time_ms": 2.784}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.011561375749685491, "policy_loss": -0.027891946180413168, "vf_loss": 0.003089917652929823, "vf_explained_var": 0.9545720815658569, "kl": 0.013240652872870367, "entropy": -4.33523006439209, "entropy_coeff": 0.0}}, "num_steps_sampled": 68400, "num_steps_trained": 68400}, "done": false, "episodes_total": 57, "training_iteration": 18, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-22", "timestamp": 1617633802, "time_this_iter_s": 1.4274084568023682, "time_total_s": 26.115586519241333, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.115586519241333, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 40.35, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.011543576167289, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": -0.08678934630786825, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19378175651625698, "mean_inference_ms": 1.2565344004480492, "mean_action_processing_ms": 0.053285467351549896, "mean_env_wait_ms": 1.2345122746937656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 72200, "timers": {"sample_time_ms": 569.488, "sample_throughput": 6672.658, "learn_time_ms": 854.9, "learn_throughput": 4444.964, "update_time_ms": 2.754}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.013797801857193311, "policy_loss": -0.03091444633125017, "vf_loss": 0.005598559742793441, "vf_explained_var": 0.7486680150032043, "kl": 0.011518085685869059, "entropy": -3.8873560031255088, "entropy_coeff": 0.0}}, "num_steps_sampled": 72200, "num_steps_trained": 72200}, "done": false, "episodes_total": 57, "training_iteration": 19, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-23", "timestamp": 1617633803, "time_this_iter_s": 1.4165353775024414, "time_total_s": 27.532121896743774, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.532121896743774, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 40.05, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.11184830163856922, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, -0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19421551644600632, "mean_inference_ms": 1.2573085517394396, "mean_action_processing_ms": 0.053336787040502986, "mean_env_wait_ms": 1.226397583508725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 76000, "timers": {"sample_time_ms": 569.709, "sample_throughput": 6670.077, "learn_time_ms": 856.717, "learn_throughput": 4435.536, "update_time_ms": 2.793}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.013297629604736964, "policy_loss": -0.035540102918942766, "vf_loss": 0.008797704863051573, "vf_explained_var": 0.8478549718856812, "kl": 0.013444767116258543, "entropy": -4.115773884455363, "entropy_coeff": 0.0}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 76, "training_iteration": 20, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-25", "timestamp": 1617633805, "time_this_iter_s": 1.5278165340423584, "time_total_s": 29.059938430786133, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.059938430786133, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 47.150000000000006, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.11184830163856922, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19421551644600632, "mean_inference_ms": 1.2573085517394396, "mean_action_processing_ms": 0.053336787040502986, "mean_env_wait_ms": 1.2263975835087246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 79800, "timers": {"sample_time_ms": 569.92, "sample_throughput": 6667.598, "learn_time_ms": 858.038, "learn_throughput": 4428.708, "update_time_ms": 2.818}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.011558474072565635, "policy_loss": -0.027724283126493294, "vf_loss": 0.0030811130146806438, "vf_explained_var": 0.8928191661834717, "kl": 0.013084695177773635, "entropy": -4.2167807420094805, "entropy_coeff": 0.0}}, "num_steps_sampled": 79800, "num_steps_trained": 79800}, "done": false, "episodes_total": 76, "training_iteration": 21, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-26", "timestamp": 1617633806, "time_this_iter_s": 1.4212782382965088, "time_total_s": 30.48121666908264, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.48121666908264, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 40.05, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.11184830163856922, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19421551644600632, "mean_inference_ms": 1.2573085517394396, "mean_action_processing_ms": 0.053336787040502986, "mean_env_wait_ms": 1.2263975835087246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 83600, "timers": {"sample_time_ms": 569.096, "sample_throughput": 6677.258, "learn_time_ms": 858.396, "learn_throughput": 4426.861, "update_time_ms": 2.745}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.011684230963389079, "policy_loss": -0.025842531273762386, "vf_loss": 0.003199041347640256, "vf_explained_var": 0.9481943249702454, "kl": 0.010959257123370965, "entropy": -3.995031150182088, "entropy_coeff": 0.0}}, "num_steps_sampled": 83600, "num_steps_trained": 83600}, "done": false, "episodes_total": 76, "training_iteration": 22, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-27", "timestamp": 1617633807, "time_this_iter_s": 1.4095849990844727, "time_total_s": 31.890801668167114, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.890801668167114, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 40.65, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.11184830163856922, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19421551644600632, "mean_inference_ms": 1.2573085517394396, "mean_action_processing_ms": 0.053336787040502986, "mean_env_wait_ms": 1.2263975835087246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 87400, "timers": {"sample_time_ms": 568.588, "sample_throughput": 6683.218, "learn_time_ms": 859.057, "learn_throughput": 4423.454, "update_time_ms": 2.74}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.014904920849949122, "policy_loss": -0.026307172995681565, "vf_loss": 0.0030670263028393188, "vf_explained_var": 0.9713112115859985, "kl": 0.008335223079969485, "entropy": -4.319627714157105, "entropy_coeff": 0.0}}, "num_steps_sampled": 87400, "num_steps_trained": 87400}, "done": false, "episodes_total": 76, "training_iteration": 23, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-29", "timestamp": 1617633809, "time_this_iter_s": 1.4201111793518066, "time_total_s": 33.31091284751892, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.31091284751892, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 40.65, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.11184830163856922, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19421551644600632, "mean_inference_ms": 1.2573085517394396, "mean_action_processing_ms": 0.053336787040502986, "mean_env_wait_ms": 1.2263975835087246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 91200, "timers": {"sample_time_ms": 567.794, "sample_throughput": 6692.568, "learn_time_ms": 862.258, "learn_throughput": 4407.031, "update_time_ms": 2.772}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.011384093668311834, "policy_loss": -0.02406975325817863, "vf_loss": 0.0032756926181415715, "vf_explained_var": 0.8653871417045593, "kl": 0.009409967716783285, "entropy": -3.9257594267527263, "entropy_coeff": 0.0}}, "num_steps_sampled": 91200, "num_steps_trained": 91200}, "done": false, "episodes_total": 76, "training_iteration": 24, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-30", "timestamp": 1617633810, "time_this_iter_s": 1.4219543933868408, "time_total_s": 34.73286724090576, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.73286724090576, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 40.6, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.12934732903982987, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621, -0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19430592097476626, "mean_inference_ms": 1.2581269555896593, "mean_action_processing_ms": 0.05337913078122612, "mean_env_wait_ms": 1.2204966864845268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 95000, "timers": {"sample_time_ms": 573.978, "sample_throughput": 6620.468, "learn_time_ms": 863.799, "learn_throughput": 4399.174, "update_time_ms": 2.798}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.017283278051763773, "policy_loss": -0.03303413819521665, "vf_loss": 0.004185241887656351, "vf_explained_var": 0.9106350541114807, "kl": 0.011565616385390361, "entropy": -4.255539417266846, "entropy_coeff": 0.0}}, "num_steps_sampled": 95000, "num_steps_trained": 95000}, "done": false, "episodes_total": 95, "training_iteration": 25, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-32", "timestamp": 1617633812, "time_this_iter_s": 1.582552433013916, "time_total_s": 36.31541967391968, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 36.31541967391968, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 34.96666666666667, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.12934732903982982, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, 0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1943059209747663, "mean_inference_ms": 1.258126955589659, "mean_action_processing_ms": 0.05337913078122614, "mean_env_wait_ms": 1.220496686484527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 98800, "timers": {"sample_time_ms": 575.364, "sample_throughput": 6604.517, "learn_time_ms": 864.178, "learn_throughput": 4397.241, "update_time_ms": 2.816}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.021540577181925376, "policy_loss": -0.03532566350574295, "vf_loss": 0.002193196304142475, "vf_explained_var": 0.8712897896766663, "kl": 0.011591891292482615, "entropy": -4.265512768427531, "entropy_coeff": 0.0}}, "num_steps_sampled": 98800, "num_steps_trained": 98800}, "done": false, "episodes_total": 95, "training_iteration": 26, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-33", "timestamp": 1617633813, "time_this_iter_s": 1.4384126663208008, "time_total_s": 37.75383234024048, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.75383234024048, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 41.2, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.12934732903982982, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, 0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1943059209747663, "mean_inference_ms": 1.258126955589659, "mean_action_processing_ms": 0.05337913078122614, "mean_env_wait_ms": 1.220496686484527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 102600, "timers": {"sample_time_ms": 576.495, "sample_throughput": 6591.557, "learn_time_ms": 864.354, "learn_throughput": 4396.347, "update_time_ms": 2.887}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.018633832565198342, "policy_loss": -0.030794683021182816, "vf_loss": 0.002684294998956223, "vf_explained_var": 0.9388526082038879, "kl": 0.009476555495833356, "entropy": -3.9800206899642943, "entropy_coeff": 0.0}}, "num_steps_sampled": 102600, "num_steps_trained": 102600}, "done": false, "episodes_total": 95, "training_iteration": 27, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-35", "timestamp": 1617633815, "time_this_iter_s": 1.424532175064087, "time_total_s": 39.178364515304565, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.178364515304565, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 40.7, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.12934732903982982, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, 0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1943059209747663, "mean_inference_ms": 1.258126955589659, "mean_action_processing_ms": 0.05337913078122614, "mean_env_wait_ms": 1.220496686484527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 106400, "timers": {"sample_time_ms": 576.583, "sample_throughput": 6590.551, "learn_time_ms": 862.114, "learn_throughput": 4407.768, "update_time_ms": 2.933}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.012637658386180799, "policy_loss": -0.029660771957909067, "vf_loss": 0.0025848685142894584, "vf_explained_var": 0.9687699675559998, "kl": 0.014438244110594193, "entropy": -4.287203709284465, "entropy_coeff": 0.0}}, "num_steps_sampled": 106400, "num_steps_trained": 106400}, "done": false, "episodes_total": 95, "training_iteration": 28, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-36", "timestamp": 1617633816, "time_this_iter_s": 1.4065659046173096, "time_total_s": 40.584930419921875, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.584930419921875, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 40.45, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.12934732903982982, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42146897002065475, -0.1224667971852621, -0.022956693045611765, -0.6068467365764718, -0.3584914572501665, -0.16891057302082257, -0.1931491045474829, -0.43429589751558706, -0.5347821436728201, 0.4141305630124055, 0.054091872849979294, -0.09531207576572176, 0.044625313616913465, 0.04377946756087714, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, 0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1943059209747663, "mean_inference_ms": 1.258126955589659, "mean_action_processing_ms": 0.05337913078122614, "mean_env_wait_ms": 1.220496686484527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 110200, "timers": {"sample_time_ms": 576.907, "sample_throughput": 6586.852, "learn_time_ms": 859.63, "learn_throughput": 4420.506, "update_time_ms": 2.923}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.015489197646578154, "policy_loss": -0.03260585746417443, "vf_loss": 0.0031100901775062083, "vf_explained_var": 0.8339993357658386, "kl": 0.014006567311783631, "entropy": -3.9282644033432006, "entropy_coeff": 0.0}}, "num_steps_sampled": 110200, "num_steps_trained": 110200}, "done": false, "episodes_total": 95, "training_iteration": 29, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-38", "timestamp": 1617633818, "time_this_iter_s": 1.3951377868652344, "time_total_s": 41.98006820678711, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.98006820678711, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 40.9, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.19393849067839747, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.42269684405792973, -0.1057005620076219, 1.0195396917886144, -0.06982840178808114, 0.0009570455624603458, -0.24895184060659603, 0.13041608338531918, -0.23919207136520482, -0.13053445422578636, 1.5493631795702765, 0.2447233936311548, 0.10059232701843368, 0.36159587034774154, 0.6395503216851275, 0.0588149875178865, 0.4558950326287161, -0.3263940929880117, 0.22027193781899412, 0.6199842854641291, -0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, 0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19457690109516723, "mean_inference_ms": 1.2596495243836228, "mean_action_processing_ms": 0.05342309188285145, "mean_env_wait_ms": 1.2088537119644043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 114000, "timers": {"sample_time_ms": 577.751, "sample_throughput": 6577.232, "learn_time_ms": 857.667, "learn_throughput": 4430.626, "update_time_ms": 2.914}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.014297969235728184, "policy_loss": -0.03430543839931488, "vf_loss": 0.004357097391039133, "vf_explained_var": 0.8939327001571655, "kl": 0.01565037090331316, "entropy": -4.245427735646566, "entropy_coeff": 0.0}}, "num_steps_sampled": 114000, "num_steps_trained": 114000}, "done": false, "episodes_total": 114, "training_iteration": 30, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-39", "timestamp": 1617633819, "time_this_iter_s": 1.516758680343628, "time_total_s": 43.49682688713074, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.49682688713074, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 48.150000000000006, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.1939384906783974, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, 0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621, 0.42269684405792973, -0.1057005620076219, 1.0195396917886144, -0.06982840178808114, 0.0009570455624603458, -0.24895184060659603, 0.13041608338531918, -0.23919207136520482, -0.13053445422578636, 1.5493631795702765, 0.2447233936311548, 0.10059232701843368, 0.36159587034774154, 0.6395503216851275, 0.0588149875178865, 0.4558950326287161, -0.3263940929880117, 0.22027193781899412, 0.6199842854641291], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1945769010951673, "mean_inference_ms": 1.2596495243836228, "mean_action_processing_ms": 0.053423091882851444, "mean_env_wait_ms": 1.2088537119644038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 117800, "timers": {"sample_time_ms": 576.83, "sample_throughput": 6587.732, "learn_time_ms": 855.569, "learn_throughput": 4441.49, "update_time_ms": 2.894}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.014281830781449874, "policy_loss": -0.03117319820448756, "vf_loss": 0.0023509828140959145, "vf_explained_var": 0.8795115351676941, "kl": 0.014540382412572701, "entropy": -4.26808876991272, "entropy_coeff": 0.0}}, "num_steps_sampled": 117800, "num_steps_trained": 117800}, "done": false, "episodes_total": 114, "training_iteration": 31, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-41", "timestamp": 1617633821, "time_this_iter_s": 1.3911633491516113, "time_total_s": 44.88799023628235, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.88799023628235, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 40.8, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.1939384906783974, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, 0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621, 0.42269684405792973, -0.1057005620076219, 1.0195396917886144, -0.06982840178808114, 0.0009570455624603458, -0.24895184060659603, 0.13041608338531918, -0.23919207136520482, -0.13053445422578636, 1.5493631795702765, 0.2447233936311548, 0.10059232701843368, 0.36159587034774154, 0.6395503216851275, 0.0588149875178865, 0.4558950326287161, -0.3263940929880117, 0.22027193781899412, 0.6199842854641291], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1945769010951673, "mean_inference_ms": 1.2596495243836228, "mean_action_processing_ms": 0.053423091882851444, "mean_env_wait_ms": 1.2088537119644038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 121600, "timers": {"sample_time_ms": 577.011, "sample_throughput": 6585.663, "learn_time_ms": 854.583, "learn_throughput": 4446.611, "update_time_ms": 2.925}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.01819258825853467, "policy_loss": -0.0317861463719358, "vf_loss": 0.002581984045294424, "vf_explained_var": 0.9305351972579956, "kl": 0.011011575721204281, "entropy": -4.025593336423238, "entropy_coeff": 0.0}}, "num_steps_sampled": 121600, "num_steps_trained": 121600}, "done": false, "episodes_total": 114, "training_iteration": 32, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-42", "timestamp": 1617633822, "time_this_iter_s": 1.4017255306243896, "time_total_s": 46.28971576690674, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.28971576690674, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 41.0, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.1939384906783974, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, 0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621, 0.42269684405792973, -0.1057005620076219, 1.0195396917886144, -0.06982840178808114, 0.0009570455624603458, -0.24895184060659603, 0.13041608338531918, -0.23919207136520482, -0.13053445422578636, 1.5493631795702765, 0.2447233936311548, 0.10059232701843368, 0.36159587034774154, 0.6395503216851275, 0.0588149875178865, 0.4558950326287161, -0.3263940929880117, 0.22027193781899412, 0.6199842854641291], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1945769010951673, "mean_inference_ms": 1.2596495243836228, "mean_action_processing_ms": 0.053423091882851444, "mean_env_wait_ms": 1.2088537119644038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 125400, "timers": {"sample_time_ms": 577.336, "sample_throughput": 6581.955, "learn_time_ms": 853.212, "learn_throughput": 4453.756, "update_time_ms": 2.928}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.0129786500086387, "policy_loss": -0.024859510144839683, "vf_loss": 0.0026760261816283068, "vf_explained_var": 0.9702524542808533, "kl": 0.00920483482380708, "entropy": -4.280903736750285, "entropy_coeff": 0.0}}, "num_steps_sampled": 125400, "num_steps_trained": 125400}, "done": false, "episodes_total": 114, "training_iteration": 33, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-44", "timestamp": 1617633824, "time_this_iter_s": 1.4095232486724854, "time_total_s": 47.699239015579224, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.699239015579224, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 40.75, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.6706909254468147, "episode_reward_mean": 0.1939384906783974, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.11718258861759467, -0.027545349868806412, -0.07868437333929568, 0.8095293915887871, 0.39294113302460065, -0.16300627282636293, -0.5667065107608411, -0.34739815465160995, 0.32707933959863533, 0.20227774012141841, -0.3757505298158952, -0.17713399326190749, -0.550355063732578, -0.11945577151410802, 0.1855739280033828, -0.41166039034411667, -0.20948229446202005, -0.6706909254468147, -0.15351786685889957, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, 0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621, 0.42269684405792973, -0.1057005620076219, 1.0195396917886144, -0.06982840178808114, 0.0009570455624603458, -0.24895184060659603, 0.13041608338531918, -0.23919207136520482, -0.13053445422578636, 1.5493631795702765, 0.2447233936311548, 0.10059232701843368, 0.36159587034774154, 0.6395503216851275, 0.0588149875178865, 0.4558950326287161, -0.3263940929880117, 0.22027193781899412, 0.6199842854641291], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1945769010951673, "mean_inference_ms": 1.2596495243836228, "mean_action_processing_ms": 0.053423091882851444, "mean_env_wait_ms": 1.2088537119644038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 129200, "timers": {"sample_time_ms": 576.679, "sample_throughput": 6589.455, "learn_time_ms": 854.138, "learn_throughput": 4448.93, "update_time_ms": 2.932}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.014277047601838906, "policy_loss": -0.027098101936280726, "vf_loss": 0.0035849719929198424, "vf_explained_var": 0.8486238121986389, "kl": 0.009236082093169291, "entropy": -4.042108233769735, "entropy_coeff": 0.0}}, "num_steps_sampled": 129200, "num_steps_trained": 129200}, "done": false, "episodes_total": 114, "training_iteration": 34, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-45", "timestamp": 1617633825, "time_this_iter_s": 1.42449951171875, "time_total_s": 49.123738527297974, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.123738527297974, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 41.0, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": 1.9365279760538678, "episode_reward_min": -0.5573092889931971, "episode_reward_mean": 0.2899045731457441, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.20121269356510163, -0.15676959583900496, 0.2466739828073159, 0.8265005455930197, 0.34465185299808976, 0.12776999348861784, 0.694763949208083, 0.5690826742281747, 0.3441268325673901, 0.08179347847914609, 0.36577948205093325, 0.3024356664255774, -0.050783367885622877, 0.4824061502692263, 0.6473929772030884, 1.0899600116859491, 0.9613355698869763, 0.40184786573180675, 0.46768431823697765, -0.2943393216805974, -0.2293383132158925, -0.5573092889931971, -0.5473545741487611, -0.3990955763000024, 0.7637965861714957, 1.011543576167289, 0.4756500954585883, 0.28317367066222454, -0.12355778988607813, -0.28429052713499425, -0.2059671202959409, 0.15487906082366587, -0.18590751103163639, 0.09782357611758541, -0.2333572348263928, -0.14563033804432346, -0.3639128327525303, 0.7281299643866872, 0.11023281367351001, -0.3519821876179432, -0.306462736212726, 0.14948847566468904, -0.03998342180875625, 0.8368439318316852, 0.4371868217799133, 0.8300877091488263, 0.4903064906571535, 1.6524439366052053, 0.2006577594498451, 0.20591428216712337, 0.3858115656609724, 1.4577884598149309, 0.3554172436948584, 0.7560569894631046, 0.05330436836229091, 0.03227905118554797, 1.0196142073649352, 1.9365279760538678, 0.3179322327133769, -0.051933672734504666, 1.3358173248036094, 1.1954069860570073, 0.21591792305138813, 0.3893323902359844, -0.04638258528817274, 0.29599674256924824, 1.0688541156821065, 0.10877837255052736, -0.23743016714318088, 0.44205176200006613, 0.3458142672723723, -0.055458497640998305, -0.006997384351155045, -0.11883329791097719, 0.6424339381859054, 0.2793794646858858, -0.30178186615652547, -0.041942343360183876, 0.36917074007888395, 0.3967471824738942, 0.04187457731750621, 0.42269684405792973, -0.1057005620076219, 1.0195396917886144, -0.06982840178808114, 0.0009570455624603458, -0.24895184060659603, 0.13041608338531918, -0.23919207136520482, -0.13053445422578636, 1.5493631795702765, 0.2447233936311548, 0.10059232701843368, 0.36159587034774154, 0.6395503216851275, 0.0588149875178865, 0.4558950326287161, -0.3263940929880117, 0.22027193781899412, 0.6199842854641291], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19500678855221903, "mean_inference_ms": 1.2600691508798796, "mean_action_processing_ms": 0.053463056961024116, "mean_env_wait_ms": 1.1998837303674863, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 133000, "timers": {"sample_time_ms": 570.923, "sample_throughput": 6655.887, "learn_time_ms": 856.136, "learn_throughput": 4438.549, "update_time_ms": 2.883}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.015825918565193813, "policy_loss": -0.0315516817693909, "vf_loss": 0.004864475169839958, "vf_explained_var": 0.8983725905418396, "kl": 0.010861285729333758, "entropy": -4.330485916137695, "entropy_coeff": 0.0}}, "num_steps_sampled": 133000, "num_steps_trained": 133000}, "done": false, "episodes_total": 133, "training_iteration": 35, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-43-47", "timestamp": 1617633827, "time_this_iter_s": 1.5446085929870605, "time_total_s": 50.668347120285034, "pid": 134, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.668347120285034, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 34.53333333333334, "ram_util_percent": 61.6}, "trial_id": "315ff_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 136800, "timers": {"sample_time_ms": 1199.984, "sample_throughput": 3166.708, "learn_time_ms": 1091.153, "learn_throughput": 3482.553, "update_time_ms": 3.092}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.022207480482757093, "policy_loss": -0.03688910907755295, "vf_loss": 0.0025733765641537806, "vf_explained_var": 0.8563715219497681, "kl": 0.012108250272770722, "entropy": -4.361015208562216, "entropy_coeff": 0.0}}, "num_steps_sampled": 136800, "num_steps_trained": 136800}, "done": false, "episodes_total": 133, "training_iteration": 36, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-47-58", "timestamp": 1617634078, "time_this_iter_s": 2.2987868785858154, "time_total_s": 52.96713399887085, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2.2987868785858154, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 60.675, "ram_util_percent": 61.625}, "trial_id": "315ff_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 140600, "timers": {"sample_time_ms": 924.178, "sample_throughput": 4111.762, "learn_time_ms": 1104.919, "learn_throughput": 3439.166, "update_time_ms": 2.975}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.016069403383880854, "policy_loss": -0.03238992484984919, "vf_loss": 0.002964976887839536, "vf_explained_var": 0.9283232092857361, "kl": 0.013355542377879222, "entropy": -3.983140055338542, "entropy_coeff": 0.0}}, "num_steps_sampled": 140600, "num_steps_trained": 140600}, "done": false, "episodes_total": 133, "training_iteration": 37, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-00", "timestamp": 1617634080, "time_this_iter_s": 1.7745606899261475, "time_total_s": 54.741694688797, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4.073347568511963, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 49.85, "ram_util_percent": 61.849999999999994}, "trial_id": "315ff_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 144400, "timers": {"sample_time_ms": 805.392, "sample_throughput": 4718.197, "learn_time_ms": 1090.164, "learn_throughput": 3485.715, "update_time_ms": 2.874}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.018804077121118704, "policy_loss": -0.035134996745424966, "vf_loss": 0.004117963269042472, "vf_explained_var": 0.9468339681625366, "kl": 0.012212957628071308, "entropy": -4.144381952285767, "entropy_coeff": 0.0}}, "num_steps_sampled": 144400, "num_steps_trained": 144400}, "done": false, "episodes_total": 133, "training_iteration": 38, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-02", "timestamp": 1617634082, "time_this_iter_s": 1.6357226371765137, "time_total_s": 56.37741732597351, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.709070205688477, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 32.00000000000001, "ram_util_percent": 61.79999999999999}, "trial_id": "315ff_00000"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 148200, "timers": {"sample_time_ms": 742.101, "sample_throughput": 5120.594, "learn_time_ms": 1103.808, "learn_throughput": 3442.629, "update_time_ms": 2.814}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.01618826190630595, "policy_loss": -0.034327380793790024, "vf_loss": 0.0060900452934826415, "vf_explained_var": 0.7645888924598694, "kl": 0.01204907422264417, "entropy": -4.057068912188212, "entropy_coeff": 0.0}}, "num_steps_sampled": 148200, "num_steps_trained": 148200}, "done": false, "episodes_total": 133, "training_iteration": 39, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-04", "timestamp": 1617634084, "time_this_iter_s": 1.704338550567627, "time_total_s": 58.08175587654114, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.4134087562561035, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.6, "ram_util_percent": 61.8}, "trial_id": "315ff_00000"}
{"episode_reward_max": 2.9174318380975177, "episode_reward_min": -0.21301684439786128, "episode_reward_mean": 0.714514437512883, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19890100360888216, "mean_inference_ms": 1.335936644656581, "mean_action_processing_ms": 0.057515551962557386, "mean_env_wait_ms": 1.3700137034820903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 152000, "timers": {"sample_time_ms": 731.304, "sample_throughput": 5196.196, "learn_time_ms": 1094.067, "learn_throughput": 3473.279, "update_time_ms": 2.788}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.003150631207972765, "policy_loss": -0.03302997996409734, "vf_loss": 0.015717650235941013, "vf_explained_var": 0.8215327858924866, "kl": 0.01416169578830401, "entropy": -4.272440767288208, "entropy_coeff": 0.0}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 152, "training_iteration": 40, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-05", "timestamp": 1617634085, "time_this_iter_s": 1.751603364944458, "time_total_s": 59.833359241485596, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.165012121200562, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.86666666666667, "ram_util_percent": 61.9}, "trial_id": "315ff_00000"}
{"episode_reward_max": 2.9174318380975177, "episode_reward_min": -0.21301684439786128, "episode_reward_mean": 0.714514437512883, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19890100360888216, "mean_inference_ms": 1.335936644656581, "mean_action_processing_ms": 0.057515551962557386, "mean_env_wait_ms": 1.3700137034820903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 155800, "timers": {"sample_time_ms": 701.046, "sample_throughput": 5420.471, "learn_time_ms": 1088.741, "learn_throughput": 3490.269, "update_time_ms": 2.748}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.02171232346445322, "policy_loss": -0.037632364717622595, "vf_loss": 0.0025259206304326653, "vf_explained_var": 0.906122624874115, "kl": 0.01339412002513806, "entropy": -4.397172164916992, "entropy_coeff": 0.0}}, "num_steps_sampled": 155800, "num_steps_trained": 155800}, "done": false, "episodes_total": 152, "training_iteration": 41, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-07", "timestamp": 1617634087, "time_this_iter_s": 1.6195766925811768, "time_total_s": 61.45293593406677, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.784588813781738, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 42.5, "ram_util_percent": 61.9}, "trial_id": "315ff_00000"}
{"episode_reward_max": 2.9174318380975177, "episode_reward_min": -0.21301684439786128, "episode_reward_mean": 0.714514437512883, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19890100360888216, "mean_inference_ms": 1.335936644656581, "mean_action_processing_ms": 0.057515551962557386, "mean_env_wait_ms": 1.3700137034820903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 159600, "timers": {"sample_time_ms": 680.482, "sample_throughput": 5584.278, "learn_time_ms": 1084.886, "learn_throughput": 3502.671, "update_time_ms": 2.758}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.015697621367871763, "policy_loss": -0.0357653030504783, "vf_loss": 0.0034673230179275076, "vf_explained_var": 0.9456108808517456, "kl": 0.016600357306500276, "entropy": -4.020523508389791, "entropy_coeff": 0.0}}, "num_steps_sampled": 159600, "num_steps_trained": 159600}, "done": false, "episodes_total": 152, "training_iteration": 42, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-09", "timestamp": 1617634089, "time_this_iter_s": 1.6261589527130127, "time_total_s": 63.079094886779785, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.410747766494751, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 42.35, "ram_util_percent": 61.9}, "trial_id": "315ff_00000"}
{"episode_reward_max": 2.9174318380975177, "episode_reward_min": -0.21301684439786128, "episode_reward_mean": 0.714514437512883, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19890100360888216, "mean_inference_ms": 1.335936644656581, "mean_action_processing_ms": 0.057515551962557386, "mean_env_wait_ms": 1.3700137034820903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 163400, "timers": {"sample_time_ms": 665.412, "sample_throughput": 5710.743, "learn_time_ms": 1082.702, "learn_throughput": 3509.739, "update_time_ms": 2.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.013251246387759845, "policy_loss": -0.030158634266505637, "vf_loss": 0.004710753277565042, "vf_explained_var": 0.9572757482528687, "kl": 0.01219663688292106, "entropy": -4.185746018091837, "entropy_coeff": 0.0}}, "num_steps_sampled": 163400, "num_steps_trained": 163400}, "done": false, "episodes_total": 152, "training_iteration": 43, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-10", "timestamp": 1617634090, "time_this_iter_s": 1.6353607177734375, "time_total_s": 64.71445560455322, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.046108484268188, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 31.066666666666666, "ram_util_percent": 61.9}, "trial_id": "315ff_00000"}
{"episode_reward_max": 2.9174318380975177, "episode_reward_min": -0.21301684439786128, "episode_reward_mean": 0.714514437512883, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19890100360888216, "mean_inference_ms": 1.335936644656581, "mean_action_processing_ms": 0.057515551962557386, "mean_env_wait_ms": 1.3700137034820903, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 167200, "timers": {"sample_time_ms": 654.159, "sample_throughput": 5808.987, "learn_time_ms": 1080.551, "learn_throughput": 3516.725, "update_time_ms": 2.821}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.013749870161215464, "policy_loss": -0.03379661037276189, "vf_loss": 0.007106323012461265, "vf_explained_var": 0.8409742712974548, "kl": 0.01294041561583678, "entropy": -4.200701475143433, "entropy_coeff": 0.0}}, "num_steps_sampled": 167200, "num_steps_trained": 167200}, "done": false, "episodes_total": 152, "training_iteration": 44, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-12", "timestamp": 1617634092, "time_this_iter_s": 1.6352622509002686, "time_total_s": 66.34971785545349, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.681370735168457, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.25, "ram_util_percent": 61.9}, "trial_id": "315ff_00000"}
{"episode_reward_max": 3.1367104566859485, "episode_reward_min": -0.23503210247822204, "episode_reward_mean": 0.8910061203564026, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1443924695505534, 3.1367104566859485, 0.9959588626629066, 0.973636044180997, 0.4088312675459618, 0.6362983377214488, 0.801379017694777, 0.9076347528495938, 1.9968563873662926, 1.3844720533390977, 1.2356158953540528, 0.5076870327173237, 0.3142701260286709, 2.447559018720971, 0.24579846942911932, 1.288416759367562, 1.746982927535551, -0.23503210247822204, 0.3449904845259193, 0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19824846067533133, "mean_inference_ms": 1.3201182412530654, "mean_action_processing_ms": 0.05704908244897637, "mean_env_wait_ms": 1.3233915044638895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 171000, "timers": {"sample_time_ms": 655.511, "sample_throughput": 5797.001, "learn_time_ms": 1080.802, "learn_throughput": 3515.906, "update_time_ms": 2.805}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": 0.002610051880280177, "policy_loss": -0.025153066559384266, "vf_loss": 0.01468527407074968, "vf_explained_var": 0.8778246641159058, "kl": 0.013077845300237338, "entropy": -4.267992337544759, "entropy_coeff": 0.0}}, "num_steps_sampled": 171000, "num_steps_trained": 171000}, "done": false, "episodes_total": 171, "training_iteration": 45, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-14", "timestamp": 1617634094, "time_this_iter_s": 1.7592172622680664, "time_total_s": 68.10893511772156, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.440587997436523, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.86666666666667, "ram_util_percent": 61.9}, "trial_id": "315ff_00000"}
{"episode_reward_max": 3.1367104566859485, "episode_reward_min": -0.23503210247822204, "episode_reward_mean": 0.8910061203564026, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579, 1.1443924695505534, 3.1367104566859485, 0.9959588626629066, 0.973636044180997, 0.4088312675459618, 0.6362983377214488, 0.801379017694777, 0.9076347528495938, 1.9968563873662926, 1.3844720533390977, 1.2356158953540528, 0.5076870327173237, 0.3142701260286709, 2.447559018720971, 0.24579846942911932, 1.288416759367562, 1.746982927535551, -0.23503210247822204, 0.3449904845259193], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982484606753313, "mean_inference_ms": 1.3201182412530654, "mean_action_processing_ms": 0.05704908244897637, "mean_env_wait_ms": 1.3233915044638893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 174800, "timers": {"sample_time_ms": 591.156, "sample_throughput": 6428.086, "learn_time_ms": 1078.922, "learn_throughput": 3522.033, "update_time_ms": 2.777}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.019346778172378738, "policy_loss": -0.03290649730091293, "vf_loss": 0.0034949763134742777, "vf_explained_var": 0.9433967471122742, "kl": 0.010064740044375261, "entropy": -4.525396283467611, "entropy_coeff": 0.0}}, "num_steps_sampled": 174800, "num_steps_trained": 174800}, "done": false, "episodes_total": 171, "training_iteration": 46, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-15", "timestamp": 1617634095, "time_this_iter_s": 1.6365764141082764, "time_total_s": 69.74551153182983, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.0771644115448, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 41.050000000000004, "ram_util_percent": 61.9}, "trial_id": "315ff_00000"}
{"episode_reward_max": 3.1367104566859485, "episode_reward_min": -0.23503210247822204, "episode_reward_mean": 0.8910061203564026, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579, 1.1443924695505534, 3.1367104566859485, 0.9959588626629066, 0.973636044180997, 0.4088312675459618, 0.6362983377214488, 0.801379017694777, 0.9076347528495938, 1.9968563873662926, 1.3844720533390977, 1.2356158953540528, 0.5076870327173237, 0.3142701260286709, 2.447559018720971, 0.24579846942911932, 1.288416759367562, 1.746982927535551, -0.23503210247822204, 0.3449904845259193], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982484606753313, "mean_inference_ms": 1.3201182412530654, "mean_action_processing_ms": 0.05704908244897637, "mean_env_wait_ms": 1.3233915044638893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 178600, "timers": {"sample_time_ms": 581.085, "sample_throughput": 6539.489, "learn_time_ms": 1074.036, "learn_throughput": 3538.057, "update_time_ms": 2.782}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.01886246185749769, "policy_loss": -0.03742571529000997, "vf_loss": 0.004849335357236365, "vf_explained_var": 0.9504668712615967, "kl": 0.013713920023292303, "entropy": -4.005096968015035, "entropy_coeff": 0.0}}, "num_steps_sampled": 178600, "num_steps_trained": 178600}, "done": false, "episodes_total": 171, "training_iteration": 47, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-17", "timestamp": 1617634097, "time_this_iter_s": 1.6250231266021729, "time_total_s": 71.370534658432, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.702187538146973, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.4, "ram_util_percent": 61.9}, "trial_id": "315ff_00000"}
{"episode_reward_max": 3.1367104566859485, "episode_reward_min": -0.23503210247822204, "episode_reward_mean": 0.8910061203564026, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579, 1.1443924695505534, 3.1367104566859485, 0.9959588626629066, 0.973636044180997, 0.4088312675459618, 0.6362983377214488, 0.801379017694777, 0.9076347528495938, 1.9968563873662926, 1.3844720533390977, 1.2356158953540528, 0.5076870327173237, 0.3142701260286709, 2.447559018720971, 0.24579846942911932, 1.288416759367562, 1.746982927535551, -0.23503210247822204, 0.3449904845259193], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982484606753313, "mean_inference_ms": 1.3201182412530654, "mean_action_processing_ms": 0.05704908244897637, "mean_env_wait_ms": 1.3233915044638893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 182400, "timers": {"sample_time_ms": 578.751, "sample_throughput": 6565.864, "learn_time_ms": 1075.686, "learn_throughput": 3532.631, "update_time_ms": 2.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.013950444913158814, "policy_loss": -0.03231575679965317, "vf_loss": 0.006203529611229897, "vf_explained_var": 0.9526346325874329, "kl": 0.012161780303965012, "entropy": -4.2144454638163245, "entropy_coeff": 0.0}}, "num_steps_sampled": 182400, "num_steps_trained": 182400}, "done": false, "episodes_total": 171, "training_iteration": 48, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-19", "timestamp": 1617634099, "time_this_iter_s": 1.6293542385101318, "time_total_s": 72.99988889694214, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.331541776657104, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 29.433333333333334, "ram_util_percent": 61.9}, "trial_id": "315ff_00000"}
{"episode_reward_max": 3.1367104566859485, "episode_reward_min": -0.23503210247822204, "episode_reward_mean": 0.8910061203564026, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579, 1.1443924695505534, 3.1367104566859485, 0.9959588626629066, 0.973636044180997, 0.4088312675459618, 0.6362983377214488, 0.801379017694777, 0.9076347528495938, 1.9968563873662926, 1.3844720533390977, 1.2356158953540528, 0.5076870327173237, 0.3142701260286709, 2.447559018720971, 0.24579846942911932, 1.288416759367562, 1.746982927535551, -0.23503210247822204, 0.3449904845259193], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982484606753313, "mean_inference_ms": 1.3201182412530654, "mean_action_processing_ms": 0.05704908244897637, "mean_env_wait_ms": 1.3233915044638893, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 186200, "timers": {"sample_time_ms": 578.437, "sample_throughput": 6569.425, "learn_time_ms": 1065.465, "learn_throughput": 3566.518, "update_time_ms": 2.793}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": -0.010758632545669873, "policy_loss": -0.0326003219311436, "vf_loss": 0.010521200951188803, "vf_explained_var": 0.8270502686500549, "kl": 0.011320489350085457, "entropy": -4.11863816579183, "entropy_coeff": 0.0}}, "num_steps_sampled": 186200, "num_steps_trained": 186200}, "done": false, "episodes_total": 171, "training_iteration": 49, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-20", "timestamp": 1617634100, "time_this_iter_s": 1.5990557670593262, "time_total_s": 74.59894466400146, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.93059754371643, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 41.300000000000004, "ram_util_percent": 61.8}, "trial_id": "315ff_00000"}
{"episode_reward_max": 3.1367104566859485, "episode_reward_min": -0.23503210247822204, "episode_reward_mean": 1.1438235796252125, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0300061353188883, 0.768100021065715, 1.1926661728580874, 1.5589795661863288, 1.16113863072741, 1.189827257126173, 1.16390954349083, 2.016875047550473, 1.55015018926012, 1.4731077254840645, 2.7812304400819956, 1.123046622494893, 1.9511749596508317, 2.26908680969192, 1.0964952095246043, 1.0011822311303322, 2.591234717033407, 2.3949846662866436, 3.026515520131105, 0.6215763012408273, -0.21301684439786128, 2.052051382518249, -0.07655062543136637, 0.016123003519730172, 1.7602525203795776, -0.17730288058677168, 0.007723826454622662, 0.4455276452895296, 0.3062833114022092, 1.1280202778926558, 0.6318419167935614, 0.3089269837727091, 0.7292726773553231, 0.5566571943861318, 2.9174318380975177, 0.1757147000327255, -0.023670477679175073, 2.408911561704579, 1.1443924695505534, 3.1367104566859485, 0.9959588626629066, 0.973636044180997, 0.4088312675459618, 0.6362983377214488, 0.801379017694777, 0.9076347528495938, 1.9968563873662926, 1.3844720533390977, 1.2356158953540528, 0.5076870327173237, 0.3142701260286709, 2.447559018720971, 0.24579846942911932, 1.288416759367562, 1.746982927535551, -0.23503210247822204, 0.3449904845259193], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1979050815376752, "mean_inference_ms": 1.3114958951010038, "mean_action_processing_ms": 0.05669633991747994, "mean_env_wait_ms": 1.2977632830161803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 190000, "timers": {"sample_time_ms": 576.914, "sample_throughput": 6586.768, "learn_time_ms": 1066.492, "learn_throughput": 3563.085, "update_time_ms": 2.793}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00044085940469045117, "total_loss": 0.001903535674015681, "policy_loss": -0.02773977892162899, "vf_loss": 0.015804260534544787, "vf_explained_var": 0.9153944849967957, "kl": 0.01383905615657568, "entropy": -4.3245646794637045, "entropy_coeff": 0.0}}, "num_steps_sampled": 190000, "num_steps_trained": 190000}, "done": true, "episodes_total": 190, "training_iteration": 50, "experiment_id": "183d9ae466274c85946ab688dab38769", "date": "2021-04-05_07-48-22", "timestamp": 1617634102, "time_this_iter_s": 1.7464559078216553, "time_total_s": 76.34540057182312, "pid": 1838, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 3414, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 11, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0004408594046904511, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9515675161507442, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4959225606914397, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.677053451538086, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 48.25, "ram_util_percent": 61.849999999999994}, "trial_id": "315ff_00000"}
