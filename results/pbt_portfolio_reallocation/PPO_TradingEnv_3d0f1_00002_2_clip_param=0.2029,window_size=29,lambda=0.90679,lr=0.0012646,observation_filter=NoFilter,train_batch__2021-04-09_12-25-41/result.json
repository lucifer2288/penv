{"episode_reward_max": 0.2427615734387445, "episode_reward_min": -0.4079002919257212, "episode_reward_mean": -0.18091878817320423, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15274246970375815, "mean_inference_ms": 1.0349381934631836, "mean_action_processing_ms": 0.04515501407238391, "mean_env_wait_ms": 1.0701263403439976, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 8000, "timers": {"sample_time_ms": 2835.613, "sample_throughput": 2821.26, "learn_time_ms": 2213.685, "learn_throughput": 3613.884, "update_time_ms": 1.372}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.006787861113451303, "policy_loss": -0.012112454644271306, "vf_loss": 0.0026298537406893004, "vf_explained_var": 0.7501872181892395, "kl": 0.016270460235694097, "entropy": -3.334921431919885, "entropy_coeff": 0.0}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 8, "training_iteration": 1, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-25-53", "timestamp": 1617996353, "time_this_iter_s": 5.0550336837768555, "time_total_s": 5.0550336837768555, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.0550336837768555, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 49.525000000000006, "ram_util_percent": 75.6}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 0.2427615734387445, "episode_reward_min": -0.5625380891258005, "episode_reward_mean": -0.25785809665594345, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.43496539425039366, -0.1280816020457124, -0.407126811127402, -0.3606734931133465, -0.2820342310144578, -0.21691316444653097, -0.5625380891258005, -0.28604645598581746, 0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16156095743824822, "mean_inference_ms": 1.0745509962744504, "mean_action_processing_ms": 0.04660138102925677, "mean_env_wait_ms": 1.0870743408380772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 16000, "timers": {"sample_time_ms": 2830.032, "sample_throughput": 2826.823, "learn_time_ms": 2322.894, "learn_throughput": 3443.98, "update_time_ms": 1.414}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.004201746619646511, "policy_loss": -0.012159281513757177, "vf_loss": 0.0016025939867610024, "vf_explained_var": 0.6408056616783142, "kl": 0.006354940434296926, "entropy": -3.32735622496832, "entropy_coeff": 0.0}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 16, "training_iteration": 2, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-25-58", "timestamp": 1617996358, "time_this_iter_s": 5.262842416763306, "time_total_s": 10.317876100540161, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.317876100540161, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 64.11428571428571, "ram_util_percent": 78.17142857142856}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 0.5133307083804892, "episode_reward_min": -0.5625380891258005, "episode_reward_mean": -0.22143870714989553, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.1476792306586321, -0.5373728293289641, -0.2613171595491607, -0.30613352982958586, 0.5133307083804892, 0.17258996664196746, -0.11909455514837775, -0.5031227956101336, 0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504, -0.43496539425039366, -0.1280816020457124, -0.407126811127402, -0.3606734931133465, -0.2820342310144578, -0.21691316444653097, -0.5625380891258005, -0.28604645598581746], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16072669577157647, "mean_inference_ms": 1.0586685433714342, "mean_action_processing_ms": 0.045736861121873716, "mean_env_wait_ms": 1.0569357109842892, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 24000, "timers": {"sample_time_ms": 2540.602, "sample_throughput": 3148.86, "learn_time_ms": 2289.087, "learn_throughput": 3494.843, "update_time_ms": 1.526}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.004892261358835395, "policy_loss": -0.013052871864702966, "vf_loss": 0.0014942129297802846, "vf_explained_var": 0.509197473526001, "kl": 0.006666400041135531, "entropy": -3.3301871806856185, "entropy_coeff": 0.0}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 24, "training_iteration": 3, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-02", "timestamp": 1617996362, "time_this_iter_s": 4.188692092895508, "time_total_s": 14.506568193435669, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.506568193435669, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.45, "ram_util_percent": 79.28333333333335}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 0.5133307083804892, "episode_reward_min": -0.5625380891258005, "episode_reward_mean": -0.17050853954469558, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.09463151056917662, 0.4054968885493253, -0.47837238293012524, -0.5136364947140054, 0.3793332287462141, 0.164709037740991, -0.3888880451379023, 0.19498196334355944, 0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504, -0.43496539425039366, -0.1280816020457124, -0.407126811127402, -0.3606734931133465, -0.2820342310144578, -0.21691316444653097, -0.5625380891258005, -0.28604645598581746, -0.1476792306586321, -0.5373728293289641, -0.2613171595491607, -0.30613352982958586, 0.5133307083804892, 0.17258996664196746, -0.11909455514837775, -0.5031227956101336], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1597012716221443, "mean_inference_ms": 1.0512460228080807, "mean_action_processing_ms": 0.045268410736393705, "mean_env_wait_ms": 1.0404340238359615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 32000, "timers": {"sample_time_ms": 2515.316, "sample_throughput": 3180.516, "learn_time_ms": 2230.209, "learn_throughput": 3587.108, "update_time_ms": 1.524}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.006299058655424724, "policy_loss": -0.013905127798872334, "vf_loss": 0.0015774832683659735, "vf_explained_var": 0.6084604859352112, "kl": 0.006028585512900636, "entropy": -3.331669084609501, "entropy_coeff": 0.0}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 32, "training_iteration": 4, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-07", "timestamp": 1617996367, "time_this_iter_s": 4.499444246292114, "time_total_s": 19.006012439727783, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.006012439727783, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.32857142857142, "ram_util_percent": 79.39999999999999}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 0.5133307083804892, "episode_reward_min": -0.5625380891258005, "episode_reward_mean": -0.14386018303120368, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.27404882015477017, -0.25900900626305967, 0.149002424031897, 0.0635089456979252, 0.05615660815853363, -0.452540064620916, 0.15566852538912568, 0.263127331943376, 0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504, -0.43496539425039366, -0.1280816020457124, -0.407126811127402, -0.3606734931133465, -0.2820342310144578, -0.21691316444653097, -0.5625380891258005, -0.28604645598581746, -0.1476792306586321, -0.5373728293289641, -0.2613171595491607, -0.30613352982958586, 0.5133307083804892, 0.17258996664196746, -0.11909455514837775, -0.5031227956101336, 0.09463151056917662, 0.4054968885493253, -0.47837238293012524, -0.5136364947140054, 0.3793332287462141, 0.164709037740991, -0.3888880451379023, 0.19498196334355944], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16024158101659092, "mean_inference_ms": 1.0507181970393247, "mean_action_processing_ms": 0.04512956206223968, "mean_env_wait_ms": 1.0337588963432998, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 40000, "timers": {"sample_time_ms": 2563.273, "sample_throughput": 3121.009, "learn_time_ms": 2211.404, "learn_throughput": 3617.611, "update_time_ms": 1.544}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.004400397192627665, "policy_loss": -0.011612939130928781, "vf_loss": 0.0014705998446082784, "vf_explained_var": 0.7055383324623108, "kl": 0.0057419426960959325, "entropy": -3.350977239154634, "entropy_coeff": 0.0}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 40, "training_iteration": 5, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-12", "timestamp": 1617996372, "time_this_iter_s": 4.897641658782959, "time_total_s": 23.903654098510742, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.903654098510742, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.98571428571429, "ram_util_percent": 79.51428571428572}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 0.5133307083804892, "episode_reward_min": -0.5625380891258005, "episode_reward_mean": -0.1253410444213172, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.29955839422210695, -0.04217752321222845, -0.13574169267353964, -0.289683116068135, 0.043573168722025546, 0.06369063712057832, 0.3134965485578629, 0.08443756080046638, 0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504, -0.43496539425039366, -0.1280816020457124, -0.407126811127402, -0.3606734931133465, -0.2820342310144578, -0.21691316444653097, -0.5625380891258005, -0.28604645598581746, -0.1476792306586321, -0.5373728293289641, -0.2613171595491607, -0.30613352982958586, 0.5133307083804892, 0.17258996664196746, -0.11909455514837775, -0.5031227956101336, 0.09463151056917662, 0.4054968885493253, -0.47837238293012524, -0.5136364947140054, 0.3793332287462141, 0.164709037740991, -0.3888880451379023, 0.19498196334355944, -0.27404882015477017, -0.25900900626305967, 0.149002424031897, 0.0635089456979252, 0.05615660815853363, -0.452540064620916, 0.15566852538912568, 0.263127331943376], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16100124208347935, "mean_inference_ms": 1.0512517567637099, "mean_action_processing_ms": 0.045042137260513176, "mean_env_wait_ms": 1.0292166802855633, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 48000, "timers": {"sample_time_ms": 2565.23, "sample_throughput": 3118.628, "learn_time_ms": 2219.583, "learn_throughput": 3604.28, "update_time_ms": 1.573}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.003770947116353209, "policy_loss": -0.011488625957142739, "vf_loss": 0.0016849372676381515, "vf_explained_var": 0.8218271732330322, "kl": 0.0060327415768471025, "entropy": -3.3525012296343606, "entropy_coeff": 0.0}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 6, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-16", "timestamp": 1617996376, "time_this_iter_s": 4.841670274734497, "time_total_s": 28.74532437324524, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.74532437324524, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 48.65714285714285, "ram_util_percent": 79.47142857142856}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 0.8536877951214095, "episode_reward_min": -0.5625380891258005, "episode_reward_mean": -0.09857373914690394, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.29413430661892315, 0.6001353492117742, -0.16357699756948452, -0.10620941744004753, -0.3223017410811507, 0.8536877951214095, 0.32310684288227143, -0.39446678450924544, 0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504, -0.43496539425039366, -0.1280816020457124, -0.407126811127402, -0.3606734931133465, -0.2820342310144578, -0.21691316444653097, -0.5625380891258005, -0.28604645598581746, -0.1476792306586321, -0.5373728293289641, -0.2613171595491607, -0.30613352982958586, 0.5133307083804892, 0.17258996664196746, -0.11909455514837775, -0.5031227956101336, 0.09463151056917662, 0.4054968885493253, -0.47837238293012524, -0.5136364947140054, 0.3793332287462141, 0.164709037740991, -0.3888880451379023, 0.19498196334355944, -0.27404882015477017, -0.25900900626305967, 0.149002424031897, 0.0635089456979252, 0.05615660815853363, -0.452540064620916, 0.15566852538912568, 0.263127331943376, -0.29955839422210695, -0.04217752321222845, -0.13574169267353964, -0.289683116068135, 0.043573168722025546, 0.06369063712057832, 0.3134965485578629, 0.08443756080046638], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16165840928268857, "mean_inference_ms": 1.0491757679457243, "mean_action_processing_ms": 0.04487021660011414, "mean_env_wait_ms": 1.023140485251389, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 56000, "timers": {"sample_time_ms": 2520.401, "sample_throughput": 3174.098, "learn_time_ms": 2226.226, "learn_throughput": 3593.525, "update_time_ms": 1.576}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.006438989650517229, "policy_loss": -0.015356951644496313, "vf_loss": 0.0018294997871779496, "vf_explained_var": 0.8624435067176819, "kl": 0.0070884633321492444, "entropy": -3.3616939726329984, "entropy_coeff": 0.0}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 56, "training_iteration": 7, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-21", "timestamp": 1617996381, "time_this_iter_s": 4.523400068283081, "time_total_s": 33.26872444152832, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.26872444152832, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 49.96666666666667, "ram_util_percent": 79.38333333333334}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.10914029336853, "episode_reward_min": -0.5625380891258005, "episode_reward_mean": -0.027306511606600508, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3216573098438056, 0.07114269752846458, 1.10914029336853, 0.8002072740576214, 0.844979692455951, 1.0183181289925933, 0.1277252018492696, 0.12265667099556388, 0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504, -0.43496539425039366, -0.1280816020457124, -0.407126811127402, -0.3606734931133465, -0.2820342310144578, -0.21691316444653097, -0.5625380891258005, -0.28604645598581746, -0.1476792306586321, -0.5373728293289641, -0.2613171595491607, -0.30613352982958586, 0.5133307083804892, 0.17258996664196746, -0.11909455514837775, -0.5031227956101336, 0.09463151056917662, 0.4054968885493253, -0.47837238293012524, -0.5136364947140054, 0.3793332287462141, 0.164709037740991, -0.3888880451379023, 0.19498196334355944, -0.27404882015477017, -0.25900900626305967, 0.149002424031897, 0.0635089456979252, 0.05615660815853363, -0.452540064620916, 0.15566852538912568, 0.263127331943376, -0.29955839422210695, -0.04217752321222845, -0.13574169267353964, -0.289683116068135, 0.043573168722025546, 0.06369063712057832, 0.3134965485578629, 0.08443756080046638, -0.29413430661892315, 0.6001353492117742, -0.16357699756948452, -0.10620941744004753, -0.3223017410811507, 0.8536877951214095, 0.32310684288227143, -0.39446678450924544], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16152261187367606, "mean_inference_ms": 1.0440974056553842, "mean_action_processing_ms": 0.04459050896852592, "mean_env_wait_ms": 1.0146865441525916, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 64000, "timers": {"sample_time_ms": 2439.182, "sample_throughput": 3279.788, "learn_time_ms": 2261.737, "learn_throughput": 3537.104, "update_time_ms": 1.558}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0044483404813541304, "policy_loss": -0.012725566129481036, "vf_loss": 0.00259390796187319, "vf_explained_var": 0.8542769551277161, "kl": 0.005683318127892793, "entropy": -3.3709452833448137, "entropy_coeff": 0.0}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 64, "training_iteration": 8, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-25", "timestamp": 1617996385, "time_this_iter_s": 4.387083053588867, "time_total_s": 37.65580749511719, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.65580749511719, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 39.3, "ram_util_percent": 79.43333333333334}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.3557462501865793, "episode_reward_min": -0.5625380891258005, "episode_reward_mean": 0.025657258555609692, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.006976530866029895, 1.3557462501865793, 0.6371705407756132, 0.23876505284215166, 0.3920226865963403, 0.16355870915377646, 0.1239060930176481, 0.6767934953881907, 0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504, -0.43496539425039366, -0.1280816020457124, -0.407126811127402, -0.3606734931133465, -0.2820342310144578, -0.21691316444653097, -0.5625380891258005, -0.28604645598581746, -0.1476792306586321, -0.5373728293289641, -0.2613171595491607, -0.30613352982958586, 0.5133307083804892, 0.17258996664196746, -0.11909455514837775, -0.5031227956101336, 0.09463151056917662, 0.4054968885493253, -0.47837238293012524, -0.5136364947140054, 0.3793332287462141, 0.164709037740991, -0.3888880451379023, 0.19498196334355944, -0.27404882015477017, -0.25900900626305967, 0.149002424031897, 0.0635089456979252, 0.05615660815853363, -0.452540064620916, 0.15566852538912568, 0.263127331943376, -0.29955839422210695, -0.04217752321222845, -0.13574169267353964, -0.289683116068135, 0.043573168722025546, 0.06369063712057832, 0.3134965485578629, 0.08443756080046638, -0.29413430661892315, 0.6001353492117742, -0.16357699756948452, -0.10620941744004753, -0.3223017410811507, 0.8536877951214095, 0.32310684288227143, -0.39446678450924544, -0.3216573098438056, 0.07114269752846458, 1.10914029336853, 0.8002072740576214, 0.844979692455951, 1.0183181289925933, 0.1277252018492696, 0.12265667099556388], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1610418374682295, "mean_inference_ms": 1.0379126345679381, "mean_action_processing_ms": 0.044278500068510335, "mean_env_wait_ms": 1.0056284897122059, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 72000, "timers": {"sample_time_ms": 2376.706, "sample_throughput": 3366.003, "learn_time_ms": 2286.828, "learn_throughput": 3498.295, "update_time_ms": 1.555}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.004230456781529245, "policy_loss": -0.013041534860219275, "vf_loss": 0.00260492978388414, "vf_explained_var": 0.8977471590042114, "kl": 0.006206145458337333, "entropy": -3.3820003252180797, "entropy_coeff": 0.0}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 72, "training_iteration": 9, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-30", "timestamp": 1617996390, "time_this_iter_s": 4.370859146118164, "time_total_s": 42.02666664123535, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.02666664123535, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.028571428571425, "ram_util_percent": 79.5}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.471375776489563, "episode_reward_min": -0.5625380891258005, "episode_reward_mean": 0.09422938040718545, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.033103185259297785, 1.471375776489563, 0.6436458176061863, 0.3798614652020029, 0.9884532675094251, 1.0802736252701255, 0.21472024836921477, 0.9458008013837187, 0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504, -0.43496539425039366, -0.1280816020457124, -0.407126811127402, -0.3606734931133465, -0.2820342310144578, -0.21691316444653097, -0.5625380891258005, -0.28604645598581746, -0.1476792306586321, -0.5373728293289641, -0.2613171595491607, -0.30613352982958586, 0.5133307083804892, 0.17258996664196746, -0.11909455514837775, -0.5031227956101336, 0.09463151056917662, 0.4054968885493253, -0.47837238293012524, -0.5136364947140054, 0.3793332287462141, 0.164709037740991, -0.3888880451379023, 0.19498196334355944, -0.27404882015477017, -0.25900900626305967, 0.149002424031897, 0.0635089456979252, 0.05615660815853363, -0.452540064620916, 0.15566852538912568, 0.263127331943376, -0.29955839422210695, -0.04217752321222845, -0.13574169267353964, -0.289683116068135, 0.043573168722025546, 0.06369063712057832, 0.3134965485578629, 0.08443756080046638, -0.29413430661892315, 0.6001353492117742, -0.16357699756948452, -0.10620941744004753, -0.3223017410811507, 0.8536877951214095, 0.32310684288227143, -0.39446678450924544, -0.3216573098438056, 0.07114269752846458, 1.10914029336853, 0.8002072740576214, 0.844979692455951, 1.0183181289925933, 0.1277252018492696, 0.12265667099556388, 0.006976530866029895, 1.3557462501865793, 0.6371705407756132, 0.23876505284215166, 0.3920226865963403, 0.16355870915377646, 0.1239060930176481, 0.6767934953881907], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16046531748296924, "mean_inference_ms": 1.0328550175295224, "mean_action_processing_ms": 0.04402349400248876, "mean_env_wait_ms": 0.9981682067336994, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 80000, "timers": {"sample_time_ms": 2364.152, "sample_throughput": 3383.878, "learn_time_ms": 2280.61, "learn_throughput": 3507.833, "update_time_ms": 1.618}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.00028889735658017417, "policy_loss": -0.008078078369772623, "vf_loss": 0.0028358515858324983, "vf_explained_var": 0.9073460102081299, "kl": 0.004953327910265043, "entropy": -3.3978215550619457, "entropy_coeff": 0.0}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 80, "training_iteration": 10, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-34", "timestamp": 1617996394, "time_this_iter_s": 4.48468542098999, "time_total_s": 46.51135206222534, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.51135206222534, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.51666666666667, "ram_util_percent": 79.5}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.927281097032969, "episode_reward_min": -0.5625380891258005, "episode_reward_mean": 0.1617726219828084, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.927281097032969, 0.5705261153590104, 0.3483853749739605, 0.6798247507555844, 0.4346924689376219, 1.0980787260995641, 0.32174588941454396, 1.3171058793390489, 0.2427615734387445, -0.11275317605896662, -0.3353908874994609, -0.19265315739389466, 0.02291779856957854, -0.35979410289030844, -0.4079002919257212, -0.30453806162560504, -0.43496539425039366, -0.1280816020457124, -0.407126811127402, -0.3606734931133465, -0.2820342310144578, -0.21691316444653097, -0.5625380891258005, -0.28604645598581746, -0.1476792306586321, -0.5373728293289641, -0.2613171595491607, -0.30613352982958586, 0.5133307083804892, 0.17258996664196746, -0.11909455514837775, -0.5031227956101336, 0.09463151056917662, 0.4054968885493253, -0.47837238293012524, -0.5136364947140054, 0.3793332287462141, 0.164709037740991, -0.3888880451379023, 0.19498196334355944, -0.27404882015477017, -0.25900900626305967, 0.149002424031897, 0.0635089456979252, 0.05615660815853363, -0.452540064620916, 0.15566852538912568, 0.263127331943376, -0.29955839422210695, -0.04217752321222845, -0.13574169267353964, -0.289683116068135, 0.043573168722025546, 0.06369063712057832, 0.3134965485578629, 0.08443756080046638, -0.29413430661892315, 0.6001353492117742, -0.16357699756948452, -0.10620941744004753, -0.3223017410811507, 0.8536877951214095, 0.32310684288227143, -0.39446678450924544, -0.3216573098438056, 0.07114269752846458, 1.10914029336853, 0.8002072740576214, 0.844979692455951, 1.0183181289925933, 0.1277252018492696, 0.12265667099556388, 0.006976530866029895, 1.3557462501865793, 0.6371705407756132, 0.23876505284215166, 0.3920226865963403, 0.16355870915377646, 0.1239060930176481, 0.6767934953881907, -0.033103185259297785, 1.471375776489563, 0.6436458176061863, 0.3798614652020029, 0.9884532675094251, 1.0802736252701255, 0.21472024836921477, 0.9458008013837187], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1599286114867578, "mean_inference_ms": 1.0295809022846418, "mean_action_processing_ms": 0.04384888135105043, "mean_env_wait_ms": 0.9929131940786159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 88000, "timers": {"sample_time_ms": 2334.242, "sample_throughput": 3427.237, "learn_time_ms": 2265.955, "learn_throughput": 3530.52, "update_time_ms": 1.664}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.0012645869732417798, "total_loss": -0.007042799869345294, "policy_loss": -0.014500394611368103, "vf_loss": 0.003056845668378094, "vf_explained_var": 0.9219216704368591, "kl": 0.008801493350239028, "entropy": -3.4272583098638627, "entropy_coeff": 0.0}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 88, "training_iteration": 11, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-39", "timestamp": 1617996399, "time_this_iter_s": 4.611933469772339, "time_total_s": 51.12328553199768, "pid": 7272, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.12328553199768, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 46.00000000000001, "ram_util_percent": 79.39999999999999}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.3700058705777676, "episode_reward_min": 0.2252142619438411, "episode_reward_mean": 0.6675547844388443, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.342944189621913, 0.7190120677528202, 0.2252142619438411, 1.3700058705777676, 1.174939211986151, 0.4541420084713119, 0.7041726905424721, 0.3500079746144782], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.152375999387804, "mean_inference_ms": 1.142362793246945, "mean_action_processing_ms": 0.048973343589089134, "mean_env_wait_ms": 1.1691146797233527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 96000, "timers": {"sample_time_ms": 3040.55, "sample_throughput": 2631.103, "learn_time_ms": 2324.44, "learn_throughput": 3441.69, "update_time_ms": 1.355}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.004061044134672672, "policy_loss": -0.012996612848447902, "vf_loss": 0.002691806685770788, "vf_explained_var": 0.9352682828903198, "kl": 0.006243760283622477, "entropy": -3.421657471429734, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 12, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-51", "timestamp": 1617996411, "time_this_iter_s": 5.3694117069244385, "time_total_s": 56.49269723892212, "pid": 7933, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.3694117069244385, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 49.8625, "ram_util_percent": 79.35}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.3700058705777676, "episode_reward_min": 0.17541704105355116, "episode_reward_mean": 0.6571841133185627, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.17541704105355116, 1.0369301175762389, 0.5520589644159262, 0.3228252865442771, 0.6806371671525995, 0.9119175139392628, 1.0922366040044817, 0.40248484289991104, 0.342944189621913, 0.7190120677528202, 0.2252142619438411, 1.3700058705777676, 1.174939211986151, 0.4541420084713119, 0.7041726905424721, 0.3500079746144782], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1533295462893024, "mean_inference_ms": 1.1173757973679321, "mean_action_processing_ms": 0.048098228199912746, "mean_env_wait_ms": 1.120134927618949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 104000, "timers": {"sample_time_ms": 2739.204, "sample_throughput": 2920.556, "learn_time_ms": 2629.556, "learn_throughput": 3042.338, "update_time_ms": 1.403}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.004588510952002946, "policy_loss": -0.013634269739249869, "vf_loss": 0.0029588942120354327, "vf_explained_var": 0.9405527114868164, "kl": 0.006086864501297, "entropy": -3.4570552129594105, "entropy_coeff": 0.0}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 104, "training_iteration": 13, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-26-56", "timestamp": 1617996416, "time_this_iter_s": 5.378739356994629, "time_total_s": 61.87143659591675, "pid": 7933, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.748151063919067, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 51.162499999999994, "ram_util_percent": 75.82499999999999}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.3700058705777676, "episode_reward_min": 0.17541704105355116, "episode_reward_mean": 0.6659412953953389, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0491554298696752, 1.0151293842752875, 1.249977141320696, 0.23387312622032352, 0.6792221645178842, 0.3928125897946002, 0.4470504545656939, 0.4004249858269664, 0.342944189621913, 0.7190120677528202, 0.2252142619438411, 1.3700058705777676, 1.174939211986151, 0.4541420084713119, 0.7041726905424721, 0.3500079746144782, 0.17541704105355116, 1.0369301175762389, 0.5520589644159262, 0.3228252865442771, 0.6806371671525995, 0.9119175139392628, 1.0922366040044817, 0.40248484289991104], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1571287667732795, "mean_inference_ms": 1.1177517159645827, "mean_action_processing_ms": 0.04810233593815169, "mean_env_wait_ms": 1.1088961144368124, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 112000, "timers": {"sample_time_ms": 2758.687, "sample_throughput": 2899.931, "learn_time_ms": 2603.402, "learn_throughput": 3072.902, "update_time_ms": 1.453}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.00777019847125288, "policy_loss": -0.01820618300033467, "vf_loss": 0.003127485942391176, "vf_explained_var": 0.9467609524726868, "kl": 0.0073084971749238555, "entropy": -3.478586401258196, "entropy_coeff": 0.0}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 112, "training_iteration": 14, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-27-02", "timestamp": 1617996422, "time_this_iter_s": 5.354595422744751, "time_total_s": 67.2260320186615, "pid": 7933, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.10274648666382, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 52.9, "ram_util_percent": 79.1625}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.6112582082713063, "episode_reward_min": -0.08711625792597066, "episode_reward_mean": 0.6369747964740169, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.21099925373382256, 0.7291475161199665, 0.4322104474069355, 0.5480667354521964, 0.5209421344141807, -0.08711625792597066, 1.6112582082713063, 0.43509436020797376, 0.342944189621913, 0.7190120677528202, 0.2252142619438411, 1.3700058705777676, 1.174939211986151, 0.4541420084713119, 0.7041726905424721, 0.3500079746144782, 0.17541704105355116, 1.0369301175762389, 0.5520589644159262, 0.3228252865442771, 0.6806371671525995, 0.9119175139392628, 1.0922366040044817, 0.40248484289991104, 1.0491554298696752, 1.0151293842752875, 1.249977141320696, 0.23387312622032352, 0.6792221645178842, 0.3928125897946002, 0.4470504545656939, 0.4004249858269664], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15824811465368627, "mean_inference_ms": 1.1023711770244846, "mean_action_processing_ms": 0.047405152118210565, "mean_env_wait_ms": 1.0853884126511737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 120000, "timers": {"sample_time_ms": 2572.841, "sample_throughput": 3109.403, "learn_time_ms": 2622.991, "learn_throughput": 3049.953, "update_time_ms": 1.451}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.004079834203280154, "policy_loss": -0.014046434298275954, "vf_loss": 0.003260043841446676, "vf_explained_var": 0.9454934597015381, "kl": 0.006706557155305904, "entropy": -3.483351529590667, "entropy_coeff": 0.0}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 120, "training_iteration": 15, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-27-06", "timestamp": 1617996426, "time_this_iter_s": 4.703500032424927, "time_total_s": 71.92953205108643, "pid": 7933, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.806246519088745, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 46.73333333333334, "ram_util_percent": 79.39999999999999}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.6112582082713063, "episode_reward_min": -0.08711625792597066, "episode_reward_mean": 0.6119840820931539, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.23397592406350953, 0.09704179703004523, 0.6025837572887374, 1.1275260683645718, 1.344606783863954, 0.5358385221828728, 0.05626663409039523, 0.09833030967352707, 0.342944189621913, 0.7190120677528202, 0.2252142619438411, 1.3700058705777676, 1.174939211986151, 0.4541420084713119, 0.7041726905424721, 0.3500079746144782, 0.17541704105355116, 1.0369301175762389, 0.5520589644159262, 0.3228252865442771, 0.6806371671525995, 0.9119175139392628, 1.0922366040044817, 0.40248484289991104, 1.0491554298696752, 1.0151293842752875, 1.249977141320696, 0.23387312622032352, 0.6792221645178842, 0.3928125897946002, 0.4470504545656939, 0.4004249858269664, 0.21099925373382256, 0.7291475161199665, 0.4322104474069355, 0.5480667354521964, 0.5209421344141807, -0.08711625792597066, 1.6112582082713063, 0.43509436020797376], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15748169148489785, "mean_inference_ms": 1.0886428865799946, "mean_action_processing_ms": 0.04653276297290458, "mean_env_wait_ms": 1.0599544825929788, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 128000, "timers": {"sample_time_ms": 2469.582, "sample_throughput": 3239.415, "learn_time_ms": 2696.153, "learn_throughput": 2967.191, "update_time_ms": 1.495}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.004770442104292294, "policy_loss": -0.014438133797652665, "vf_loss": 0.003072592991566847, "vf_explained_var": 0.9418356418609619, "kl": 0.006595098864405401, "entropy": -3.4841247588869124, "entropy_coeff": 0.0}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 128, "training_iteration": 16, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-27-12", "timestamp": 1617996432, "time_this_iter_s": 5.050742864608765, "time_total_s": 76.98027491569519, "pid": 7933, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.85698938369751, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.01428571428571, "ram_util_percent": 79.34285714285714}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.721793771640519, "episode_reward_min": -0.08711625792597066, "episode_reward_mean": 0.6272744439124686, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.4265185829678386, 1.721793771640519, 0.3468273370693782, 0.10690336696803704, 0.23802792872624123, 1.2727751397532723, 0.28609278743818534, 1.2308711095088651, 0.342944189621913, 0.7190120677528202, 0.2252142619438411, 1.3700058705777676, 1.174939211986151, 0.4541420084713119, 0.7041726905424721, 0.3500079746144782, 0.17541704105355116, 1.0369301175762389, 0.5520589644159262, 0.3228252865442771, 0.6806371671525995, 0.9119175139392628, 1.0922366040044817, 0.40248484289991104, 1.0491554298696752, 1.0151293842752875, 1.249977141320696, 0.23387312622032352, 0.6792221645178842, 0.3928125897946002, 0.4470504545656939, 0.4004249858269664, 0.21099925373382256, 0.7291475161199665, 0.4322104474069355, 0.5480667354521964, 0.5209421344141807, -0.08711625792597066, 1.6112582082713063, 0.43509436020797376, 0.23397592406350953, 0.09704179703004523, 0.6025837572887374, 1.1275260683645718, 1.344606783863954, 0.5358385221828728, 0.05626663409039523, 0.09833030967352707], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15610291363562714, "mean_inference_ms": 1.0736892298493133, "mean_action_processing_ms": 0.04570395285013634, "mean_env_wait_ms": 1.036905408318508, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 136000, "timers": {"sample_time_ms": 2382.662, "sample_throughput": 3357.59, "learn_time_ms": 2729.234, "learn_throughput": 2931.226, "update_time_ms": 1.536}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0031657942408134065, "policy_loss": -0.013098594185615342, "vf_loss": 0.0036231332554644536, "vf_explained_var": 0.9402601718902588, "kl": 0.006309666648684513, "entropy": -3.4986783322833834, "entropy_coeff": 0.0}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 136, "training_iteration": 17, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-27-16", "timestamp": 1617996436, "time_this_iter_s": 4.850591421127319, "time_total_s": 81.83086633682251, "pid": 7933, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.70758080482483, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.72857142857142, "ram_util_percent": 79.39999999999999}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 1.721793771640519, "episode_reward_min": -0.08711625792597066, "episode_reward_mean": 0.6979765652462078, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5494293428089823, 0.9343449071199956, 1.5324498489804395, 1.5686173531903713, 0.8366749836113163, 1.2710031499962136, 1.6167459134767261, 0.6682488468051007, 0.342944189621913, 0.7190120677528202, 0.2252142619438411, 1.3700058705777676, 1.174939211986151, 0.4541420084713119, 0.7041726905424721, 0.3500079746144782, 0.17541704105355116, 1.0369301175762389, 0.5520589644159262, 0.3228252865442771, 0.6806371671525995, 0.9119175139392628, 1.0922366040044817, 0.40248484289991104, 1.0491554298696752, 1.0151293842752875, 1.249977141320696, 0.23387312622032352, 0.6792221645178842, 0.3928125897946002, 0.4470504545656939, 0.4004249858269664, 0.21099925373382256, 0.7291475161199665, 0.4322104474069355, 0.5480667354521964, 0.5209421344141807, -0.08711625792597066, 1.6112582082713063, 0.43509436020797376, 0.23397592406350953, 0.09704179703004523, 0.6025837572887374, 1.1275260683645718, 1.344606783863954, 0.5358385221828728, 0.05626663409039523, 0.09833030967352707, 0.4265185829678386, 1.721793771640519, 0.3468273370693782, 0.10690336696803704, 0.23802792872624123, 1.2727751397532723, 0.28609278743818534, 1.2308711095088651], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15480248461342455, "mean_inference_ms": 1.0610314994546182, "mean_action_processing_ms": 0.045047769760905694, "mean_env_wait_ms": 1.0186095427259907, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 144000, "timers": {"sample_time_ms": 2355.519, "sample_throughput": 3396.279, "learn_time_ms": 2720.765, "learn_throughput": 2940.349, "update_time_ms": 1.525}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.00425794328902922, "policy_loss": -0.015687628782221248, "vf_loss": 0.004186715047422146, "vf_explained_var": 0.9381661415100098, "kl": 0.00724296984336679, "entropy": -3.5447831683688693, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 18, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-27-21", "timestamp": 1617996441, "time_this_iter_s": 4.869221925735474, "time_total_s": 86.70008826255798, "pid": 7933, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.5768027305603, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 39.971428571428575, "ram_util_percent": 79.31428571428572}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 2.764306000198503, "episode_reward_min": -0.08711625792597066, "episode_reward_mean": 0.7758344081585444, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.4593746966667396, 0.961796184167897, 1.8666110436968504, 1.4258136534881074, 2.764306000198503, 0.3931658505314235, 2.446990499153188, 0.24865654045649532, 0.342944189621913, 0.7190120677528202, 0.2252142619438411, 1.3700058705777676, 1.174939211986151, 0.4541420084713119, 0.7041726905424721, 0.3500079746144782, 0.17541704105355116, 1.0369301175762389, 0.5520589644159262, 0.3228252865442771, 0.6806371671525995, 0.9119175139392628, 1.0922366040044817, 0.40248484289991104, 1.0491554298696752, 1.0151293842752875, 1.249977141320696, 0.23387312622032352, 0.6792221645178842, 0.3928125897946002, 0.4470504545656939, 0.4004249858269664, 0.21099925373382256, 0.7291475161199665, 0.4322104474069355, 0.5480667354521964, 0.5209421344141807, -0.08711625792597066, 1.6112582082713063, 0.43509436020797376, 0.23397592406350953, 0.09704179703004523, 0.6025837572887374, 1.1275260683645718, 1.344606783863954, 0.5358385221828728, 0.05626663409039523, 0.09833030967352707, 0.4265185829678386, 1.721793771640519, 0.3468273370693782, 0.10690336696803704, 0.23802792872624123, 1.2727751397532723, 0.28609278743818534, 1.2308711095088651, 0.5494293428089823, 0.9343449071199956, 1.5324498489804395, 1.5686173531903713, 0.8366749836113163, 1.2710031499962136, 1.6167459134767261, 0.6682488468051007], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15400993464003937, "mean_inference_ms": 1.0544827679673554, "mean_action_processing_ms": 0.04469339544752861, "mean_env_wait_ms": 1.0080006297477413, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 152000, "timers": {"sample_time_ms": 2402.816, "sample_throughput": 3329.427, "learn_time_ms": 2697.529, "learn_throughput": 2965.677, "update_time_ms": 1.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0031958529873499794, "policy_loss": -0.01581040085367267, "vf_loss": 0.005715881322791416, "vf_explained_var": 0.9290699362754822, "kl": 0.006898667264197554, "entropy": -3.5703415075937905, "entropy_coeff": 0.0}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 152, "training_iteration": 19, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-27-27", "timestamp": 1617996447, "time_this_iter_s": 5.275208234786987, "time_total_s": 91.97529649734497, "pid": 7933, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.85201096534729, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.012499999999996, "ram_util_percent": 79.6375}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 2.764306000198503, "episode_reward_min": -0.08711625792597066, "episode_reward_mean": 0.7948412447265468, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5015004741168543, 0.5888132502704797, 1.4148757051533378, 0.20465476472787048, 1.2659172054052488, 0.5812370967671592, 1.3985797365852997, 0.6195892651382773, 0.342944189621913, 0.7190120677528202, 0.2252142619438411, 1.3700058705777676, 1.174939211986151, 0.4541420084713119, 0.7041726905424721, 0.3500079746144782, 0.17541704105355116, 1.0369301175762389, 0.5520589644159262, 0.3228252865442771, 0.6806371671525995, 0.9119175139392628, 1.0922366040044817, 0.40248484289991104, 1.0491554298696752, 1.0151293842752875, 1.249977141320696, 0.23387312622032352, 0.6792221645178842, 0.3928125897946002, 0.4470504545656939, 0.4004249858269664, 0.21099925373382256, 0.7291475161199665, 0.4322104474069355, 0.5480667354521964, 0.5209421344141807, -0.08711625792597066, 1.6112582082713063, 0.43509436020797376, 0.23397592406350953, 0.09704179703004523, 0.6025837572887374, 1.1275260683645718, 1.344606783863954, 0.5358385221828728, 0.05626663409039523, 0.09833030967352707, 0.4265185829678386, 1.721793771640519, 0.3468273370693782, 0.10690336696803704, 0.23802792872624123, 1.2727751397532723, 0.28609278743818534, 1.2308711095088651, 0.5494293428089823, 0.9343449071199956, 1.5324498489804395, 1.5686173531903713, 0.8366749836113163, 1.2710031499962136, 1.6167459134767261, 0.6682488468051007, 0.4593746966667396, 0.961796184167897, 1.8666110436968504, 1.4258136534881074, 2.764306000198503, 0.3931658505314235, 2.446990499153188, 0.24865654045649532], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1535562819850657, "mean_inference_ms": 1.0510939281649623, "mean_action_processing_ms": 0.044497484552242846, "mean_env_wait_ms": 1.001680084254947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 160000, "timers": {"sample_time_ms": 2434.709, "sample_throughput": 3285.814, "learn_time_ms": 2673.691, "learn_throughput": 2992.118, "update_time_ms": 1.524}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0029466496337027777, "policy_loss": -0.014341677952971723, "vf_loss": 0.0041540466574212865, "vf_explained_var": 0.9509697556495667, "kl": 0.007240984019719892, "entropy": -3.603552129533556, "entropy_coeff": 0.0}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 160, "training_iteration": 20, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-27-32", "timestamp": 1617996452, "time_this_iter_s": 5.178724050521851, "time_total_s": 97.15402054786682, "pid": 7933, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.03073501586914, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 49.7, "ram_util_percent": 79.77142857142857}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 2.764306000198503, "episode_reward_min": -0.08711625792597066, "episode_reward_mean": 0.8592529662540904, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2943888524481069, 1.0766984281199785, 1.4478490729169726, 1.6688851705612477, 1.1541169179379906, 1.5575545352827427, 2.0162195887677212, 1.2959551139811079, 0.342944189621913, 0.7190120677528202, 0.2252142619438411, 1.3700058705777676, 1.174939211986151, 0.4541420084713119, 0.7041726905424721, 0.3500079746144782, 0.17541704105355116, 1.0369301175762389, 0.5520589644159262, 0.3228252865442771, 0.6806371671525995, 0.9119175139392628, 1.0922366040044817, 0.40248484289991104, 1.0491554298696752, 1.0151293842752875, 1.249977141320696, 0.23387312622032352, 0.6792221645178842, 0.3928125897946002, 0.4470504545656939, 0.4004249858269664, 0.21099925373382256, 0.7291475161199665, 0.4322104474069355, 0.5480667354521964, 0.5209421344141807, -0.08711625792597066, 1.6112582082713063, 0.43509436020797376, 0.23397592406350953, 0.09704179703004523, 0.6025837572887374, 1.1275260683645718, 1.344606783863954, 0.5358385221828728, 0.05626663409039523, 0.09833030967352707, 0.4265185829678386, 1.721793771640519, 0.3468273370693782, 0.10690336696803704, 0.23802792872624123, 1.2727751397532723, 0.28609278743818534, 1.2308711095088651, 0.5494293428089823, 0.9343449071199956, 1.5324498489804395, 1.5686173531903713, 0.8366749836113163, 1.2710031499962136, 1.6167459134767261, 0.6682488468051007, 0.4593746966667396, 0.961796184167897, 1.8666110436968504, 1.4258136534881074, 2.764306000198503, 0.3931658505314235, 2.446990499153188, 0.24865654045649532, 1.5015004741168543, 0.5888132502704797, 1.4148757051533378, 0.20465476472787048, 1.2659172054052488, 0.5812370967671592, 1.3985797365852997, 0.6195892651382773], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1536198541994532, "mean_inference_ms": 1.0500057064673427, "mean_action_processing_ms": 0.044419900091690105, "mean_env_wait_ms": 0.9983439249345233, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 168000, "timers": {"sample_time_ms": 2467.748, "sample_throughput": 3241.822, "learn_time_ms": 2652.689, "learn_throughput": 3015.808, "update_time_ms": 1.535}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0013056588728749562, "policy_loss": -0.012900304027079116, "vf_loss": 0.004825215587126357, "vf_explained_var": 0.9492767453193665, "kl": 0.0067694295966435995, "entropy": -3.6191367005544994, "entropy_coeff": 0.0}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 168, "training_iteration": 21, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-27-37", "timestamp": 1617996457, "time_this_iter_s": 5.2361226081848145, "time_total_s": 102.39014315605164, "pid": 7933, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.266857624053955, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 51.1875, "ram_util_percent": 79.86250000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 3.7167199305105445, "episode_reward_min": 0.6062951516842914, "episode_reward_mean": 1.3775232049241088, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.7167199305105445, 0.7806679421915736, 1.3357617059383573, 0.6432126431478646, 0.7844320225775303, 0.7914448597775874, 0.6062951516842914, 2.361651383565121], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12321893747274454, "mean_inference_ms": 0.8055275672680133, "mean_action_processing_ms": 0.03410118085878355, "mean_env_wait_ms": 0.8080963130954738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 176000, "timers": {"sample_time_ms": 2437.846, "sample_throughput": 3281.585, "learn_time_ms": 2690.532, "learn_throughput": 2973.39, "update_time_ms": 1.595}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.002657990562655623, "policy_loss": -0.014252437367325737, "vf_loss": 0.004804552421860751, "vf_explained_var": 0.9524708390235901, "kl": 0.006789894146282995, "entropy": -3.62768458563184, "entropy_coeff": 0.0}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 176, "training_iteration": 22, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-28-50", "timestamp": 1617996530, "time_this_iter_s": 5.1330626010894775, "time_total_s": 107.52320575714111, "pid": 8850, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.1330626010894775, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 38.2125, "ram_util_percent": 77.8375}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 3.7167199305105445, "episode_reward_min": 0.4697085392465592, "episode_reward_mean": 1.3898660176341204, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.344111371341596, 1.5352657622603103, 2.914846803173046, 0.4697085392465592, 0.8299946932483919, 2.132176767817622, 1.3433472619215587, 0.648219443743973, 3.7167199305105445, 0.7806679421915736, 1.3357617059383573, 0.6432126431478646, 0.7844320225775303, 0.7914448597775874, 0.6062951516842914, 2.361651383565121], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13988039824306592, "mean_inference_ms": 0.8981986559076286, "mean_action_processing_ms": 0.03734819858570562, "mean_env_wait_ms": 0.8790913221778659, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 184000, "timers": {"sample_time_ms": 2663.255, "sample_throughput": 3003.843, "learn_time_ms": 3061.15, "learn_throughput": 2613.397, "update_time_ms": 1.789}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0035411899406758564, "policy_loss": -0.016268850171140263, "vf_loss": 0.005089156410937745, "vf_explained_var": 0.9473623633384705, "kl": 0.007638502991684373, "entropy": -3.6334942598191518, "entropy_coeff": 0.0}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 184, "training_iteration": 23, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-28-56", "timestamp": 1617996536, "time_this_iter_s": 6.336993455886841, "time_total_s": 113.86019921302795, "pid": 8850, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.470056056976318, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 63.28888888888888, "ram_util_percent": 77.13333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 3.7167199305105445, "episode_reward_min": 0.4697085392465592, "episode_reward_mean": 1.3546414096744972, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.358472676856646, 1.611282261860905, 0.6368098982043275, 0.9872079503801445, 0.6464676183497391, 1.831398079011925, 1.4240964192632979, 0.7778026461150249, 3.7167199305105445, 0.7806679421915736, 1.3357617059383573, 0.6432126431478646, 0.7844320225775303, 0.7914448597775874, 0.6062951516842914, 2.361651383565121, 1.344111371341596, 1.5352657622603103, 2.914846803173046, 0.4697085392465592, 0.8299946932483919, 2.132176767817622, 1.3433472619215587, 0.648219443743973], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14946355616485335, "mean_inference_ms": 0.9620535702870758, "mean_action_processing_ms": 0.040456915588212544, "mean_env_wait_ms": 0.9336878447894777, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 192000, "timers": {"sample_time_ms": 2857.799, "sample_throughput": 2799.357, "learn_time_ms": 2970.436, "learn_throughput": 2693.207, "update_time_ms": 1.814}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0019225790534937192, "policy_loss": -0.013293855897490941, "vf_loss": 0.004167070656660057, "vf_explained_var": 0.9595065712928772, "kl": 0.007204210067847891, "entropy": -3.6474048258766296, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 192, "training_iteration": 24, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-29-03", "timestamp": 1617996543, "time_this_iter_s": 6.043187141418457, "time_total_s": 119.90338635444641, "pid": 8850, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.513243198394775, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 63.78888888888889, "ram_util_percent": 78.56666666666666}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 4.3055057171638955, "episode_reward_min": 0.4697085392465592, "episode_reward_mean": 1.6470184781396762, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.3762429857910479, 3.062803412388723, 2.454148585280096, 2.9118987251377764, 1.805122048084463, 2.3851982131809892, 4.3055057171638955, 1.8922777812547058, 3.7167199305105445, 0.7806679421915736, 1.3357617059383573, 0.6432126431478646, 0.7844320225775303, 0.7914448597775874, 0.6062951516842914, 2.361651383565121, 1.344111371341596, 1.5352657622603103, 2.914846803173046, 0.4697085392465592, 0.8299946932483919, 2.132176767817622, 1.3433472619215587, 0.648219443743973, 2.358472676856646, 1.611282261860905, 0.6368098982043275, 0.9872079503801445, 0.6464676183497391, 1.831398079011925, 1.4240964192632979, 0.7778026461150249], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1537313159703919, "mean_inference_ms": 0.9851457266449805, "mean_action_processing_ms": 0.04160644687733071, "mean_env_wait_ms": 0.9505179995599176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 200000, "timers": {"sample_time_ms": 2701.775, "sample_throughput": 2961.017, "learn_time_ms": 2891.173, "learn_throughput": 2767.043, "update_time_ms": 1.732}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.003458368385003673, "policy_loss": -0.016218902587535836, "vf_loss": 0.0063397521153092384, "vf_explained_var": 0.9417895078659058, "kl": 0.0064207799510941615, "entropy": -3.644971809689961, "entropy_coeff": 0.0}}, "num_steps_sampled": 200000, "num_steps_trained": 200000}, "done": false, "episodes_total": 200, "training_iteration": 25, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-29-07", "timestamp": 1617996547, "time_this_iter_s": 4.89391827583313, "time_total_s": 124.79730463027954, "pid": 8850, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.407161474227905, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 47.51428571428572, "ram_util_percent": 78.82857142857142}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 4.3055057171638955, "episode_reward_min": 0.4697085392465592, "episode_reward_mean": 1.8632506530827118, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9325362166714644, 2.3562532061563055, 1.7666730721435164, 3.5324840943668026, 4.194154095977461, 3.124407615091199, 3.297728102827784, 2.6211984196043003, 3.7167199305105445, 0.7806679421915736, 1.3357617059383573, 0.6432126431478646, 0.7844320225775303, 0.7914448597775874, 0.6062951516842914, 2.361651383565121, 1.344111371341596, 1.5352657622603103, 2.914846803173046, 0.4697085392465592, 0.8299946932483919, 2.132176767817622, 1.3433472619215587, 0.648219443743973, 2.358472676856646, 1.611282261860905, 0.6368098982043275, 0.9872079503801445, 0.6464676183497391, 1.831398079011925, 1.4240964192632979, 0.7778026461150249, 1.3762429857910479, 3.062803412388723, 2.454148585280096, 2.9118987251377764, 1.805122048084463, 2.3851982131809892, 4.3055057171638955, 1.8922777812547058], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15697471289787807, "mean_inference_ms": 1.0092585485344945, "mean_action_processing_ms": 0.04239690560398059, "mean_env_wait_ms": 0.9630660621083343, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 208000, "timers": {"sample_time_ms": 2736.122, "sample_throughput": 2923.847, "learn_time_ms": 2859.438, "learn_throughput": 2797.753, "update_time_ms": 1.683}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0030515691531555994, "policy_loss": -0.018070361872632352, "vf_loss": 0.007190844982803341, "vf_explained_var": 0.9405239224433899, "kl": 0.007827946073597386, "entropy": -3.6727617354620072, "entropy_coeff": 0.0}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 208, "training_iteration": 26, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-29-13", "timestamp": 1617996553, "time_this_iter_s": 5.6133105754852295, "time_total_s": 130.41061520576477, "pid": 8850, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.020472049713135, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.412499999999994, "ram_util_percent": 78.9}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 4.3055057171638955, "episode_reward_min": 0.4697085392465592, "episode_reward_mean": 1.9513123532904941, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.9530497416266388, 2.920408373210835, 1.1050700931033708, 1.9239439742302489, 3.736478385029857, 1.7065159851365723, 3.094319451751346, 2.693180830546373, 3.7167199305105445, 0.7806679421915736, 1.3357617059383573, 0.6432126431478646, 0.7844320225775303, 0.7914448597775874, 0.6062951516842914, 2.361651383565121, 1.344111371341596, 1.5352657622603103, 2.914846803173046, 0.4697085392465592, 0.8299946932483919, 2.132176767817622, 1.3433472619215587, 0.648219443743973, 2.358472676856646, 1.611282261860905, 0.6368098982043275, 0.9872079503801445, 0.6464676183497391, 1.831398079011925, 1.4240964192632979, 0.7778026461150249, 1.3762429857910479, 3.062803412388723, 2.454148585280096, 2.9118987251377764, 1.805122048084463, 2.3851982131809892, 4.3055057171638955, 1.8922777812547058, 0.9325362166714644, 2.3562532061563055, 1.7666730721435164, 3.5324840943668026, 4.194154095977461, 3.124407615091199, 3.297728102827784, 2.6211984196043003], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1584802672135268, "mean_inference_ms": 1.0250013020173852, "mean_action_processing_ms": 0.042957050276193016, "mean_env_wait_ms": 0.9718958942103377, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 216000, "timers": {"sample_time_ms": 2702.317, "sample_throughput": 2960.422, "learn_time_ms": 2836.797, "learn_throughput": 2820.081, "update_time_ms": 1.655}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -1.0321404607523055e-05, "policy_loss": -0.014048470021595084, "vf_loss": 0.006563118281995966, "vf_explained_var": 0.9466779828071594, "kl": 0.007475031525014885, "entropy": -3.669472331092471, "entropy_coeff": 0.0}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 216, "training_iteration": 27, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-29-18", "timestamp": 1617996558, "time_this_iter_s": 5.263313293457031, "time_total_s": 135.6739284992218, "pid": 8850, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.283785343170166, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 55.75714285714286, "ram_util_percent": 78.87142857142855}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 4.979989329603884, "episode_reward_min": 0.4697085392465592, "episode_reward_mean": 2.1238578416969736, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.9074886580598265, 3.2075848970532173, 3.859208491678687, 1.861703974746391, 2.3384408645663237, 2.666928713300819, 3.451701248077671, 4.979989329603884, 3.7167199305105445, 0.7806679421915736, 1.3357617059383573, 0.6432126431478646, 0.7844320225775303, 0.7914448597775874, 0.6062951516842914, 2.361651383565121, 1.344111371341596, 1.5352657622603103, 2.914846803173046, 0.4697085392465592, 0.8299946932483919, 2.132176767817622, 1.3433472619215587, 0.648219443743973, 2.358472676856646, 1.611282261860905, 0.6368098982043275, 0.9872079503801445, 0.6464676183497391, 1.831398079011925, 1.4240964192632979, 0.7778026461150249, 1.3762429857910479, 3.062803412388723, 2.454148585280096, 2.9118987251377764, 1.805122048084463, 2.3851982131809892, 4.3055057171638955, 1.8922777812547058, 0.9325362166714644, 2.3562532061563055, 1.7666730721435164, 3.5324840943668026, 4.194154095977461, 3.124407615091199, 3.297728102827784, 2.6211984196043003, 1.9530497416266388, 2.920408373210835, 1.1050700931033708, 1.9239439742302489, 3.736478385029857, 1.7065159851365723, 3.094319451751346, 2.693180830546373], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1595674045342354, "mean_inference_ms": 1.0340065548709219, "mean_action_processing_ms": 0.04327431188748542, "mean_env_wait_ms": 0.976414588246384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 224000, "timers": {"sample_time_ms": 2661.692, "sample_throughput": 3005.607, "learn_time_ms": 2826.002, "learn_throughput": 2830.854, "update_time_ms": 1.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0009174175442211212, "policy_loss": -0.015700111771741555, "vf_loss": 0.008206412380945587, "vf_explained_var": 0.9479598999023438, "kl": 0.006576282290061788, "entropy": -3.682047238425603, "entropy_coeff": 0.0}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 224, "training_iteration": 28, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-29-24", "timestamp": 1617996564, "time_this_iter_s": 5.185205459594727, "time_total_s": 140.85913395881653, "pid": 8850, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.46899080276489, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 48.349999999999994, "ram_util_percent": 78.9}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 4.979989329603884, "episode_reward_min": 0.4697085392465592, "episode_reward_mean": 2.1432381412139474, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1871290382554331, 3.647654675614505, 2.6014957043133697, 2.1893298317225027, 2.8796628771746438, 1.0453306167335557, 2.7534143684637855, 1.9271847903843047, 3.7167199305105445, 0.7806679421915736, 1.3357617059383573, 0.6432126431478646, 0.7844320225775303, 0.7914448597775874, 0.6062951516842914, 2.361651383565121, 1.344111371341596, 1.5352657622603103, 2.914846803173046, 0.4697085392465592, 0.8299946932483919, 2.132176767817622, 1.3433472619215587, 0.648219443743973, 2.358472676856646, 1.611282261860905, 0.6368098982043275, 0.9872079503801445, 0.6464676183497391, 1.831398079011925, 1.4240964192632979, 0.7778026461150249, 1.3762429857910479, 3.062803412388723, 2.454148585280096, 2.9118987251377764, 1.805122048084463, 2.3851982131809892, 4.3055057171638955, 1.8922777812547058, 0.9325362166714644, 2.3562532061563055, 1.7666730721435164, 3.5324840943668026, 4.194154095977461, 3.124407615091199, 3.297728102827784, 2.6211984196043003, 1.9530497416266388, 2.920408373210835, 1.1050700931033708, 1.9239439742302489, 3.736478385029857, 1.7065159851365723, 3.094319451751346, 2.693180830546373, 2.9074886580598265, 3.2075848970532173, 3.859208491678687, 1.861703974746391, 2.3384408645663237, 2.666928713300819, 3.451701248077671, 4.979989329603884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16067193648918704, "mean_inference_ms": 1.0413574104725596, "mean_action_processing_ms": 0.04355063489283252, "mean_env_wait_ms": 0.9806961693436433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 232000, "timers": {"sample_time_ms": 2664.668, "sample_throughput": 3002.25, "learn_time_ms": 2804.602, "learn_throughput": 2852.455, "update_time_ms": 1.633}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0025497356370564493, "policy_loss": -0.01670808389428116, "vf_loss": 0.006879123393446207, "vf_explained_var": 0.9610528945922852, "kl": 0.007279221559800799, "entropy": -3.716932149160476, "entropy_coeff": 0.0}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 232, "training_iteration": 29, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-29-29", "timestamp": 1617996569, "time_this_iter_s": 5.34751296043396, "time_total_s": 146.2066469192505, "pid": 8850, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.81650376319885, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 56.08571428571429, "ram_util_percent": 78.91428571428571}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 4.979989329603884, "episode_reward_min": 0.4697085392465592, "episode_reward_mean": 2.193043063312296, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1032643082615494, 2.801056290107037, 4.692178259673, 2.7962852348892815, 3.011841724019014, 1.6958109160860229, 3.1004292181895705, 1.5309935695672197, 3.7167199305105445, 0.7806679421915736, 1.3357617059383573, 0.6432126431478646, 0.7844320225775303, 0.7914448597775874, 0.6062951516842914, 2.361651383565121, 1.344111371341596, 1.5352657622603103, 2.914846803173046, 0.4697085392465592, 0.8299946932483919, 2.132176767817622, 1.3433472619215587, 0.648219443743973, 2.358472676856646, 1.611282261860905, 0.6368098982043275, 0.9872079503801445, 0.6464676183497391, 1.831398079011925, 1.4240964192632979, 0.7778026461150249, 1.3762429857910479, 3.062803412388723, 2.454148585280096, 2.9118987251377764, 1.805122048084463, 2.3851982131809892, 4.3055057171638955, 1.8922777812547058, 0.9325362166714644, 2.3562532061563055, 1.7666730721435164, 3.5324840943668026, 4.194154095977461, 3.124407615091199, 3.297728102827784, 2.6211984196043003, 1.9530497416266388, 2.920408373210835, 1.1050700931033708, 1.9239439742302489, 3.736478385029857, 1.7065159851365723, 3.094319451751346, 2.693180830546373, 2.9074886580598265, 3.2075848970532173, 3.859208491678687, 1.861703974746391, 2.3384408645663237, 2.666928713300819, 3.451701248077671, 4.979989329603884, 1.1871290382554331, 3.647654675614505, 2.6014957043133697, 2.1893298317225027, 2.8796628771746438, 1.0453306167335557, 2.7534143684637855, 1.9271847903843047], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16125997827474772, "mean_inference_ms": 1.0472753197865126, "mean_action_processing_ms": 0.043779646670695026, "mean_env_wait_ms": 0.9844358014114591, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 240000, "timers": {"sample_time_ms": 2659.964, "sample_throughput": 3007.56, "learn_time_ms": 2793.13, "learn_throughput": 2864.17, "update_time_ms": 1.617}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 3.4551816208968084e-05, "policy_loss": -0.01624013181953203, "vf_loss": 0.009113413392610493, "vf_explained_var": 0.9553982019424438, "kl": 0.007161268631794623, "entropy": -3.7343031754569402, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 240, "training_iteration": 30, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-29-34", "timestamp": 1617996574, "time_this_iter_s": 5.33021354675293, "time_total_s": 151.53686046600342, "pid": 8850, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.14671730995178, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 54.6375, "ram_util_percent": 78.91250000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 5.8755775133860615, "episode_reward_min": 0.4697085392465592, "episode_reward_mean": 2.2800786479056496, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.9616392067275608, 5.8755775133860615, 1.42150707644601, 3.5248717109454777, 2.076655720012144, 4.025030172962109, 1.693908815977942, 2.928001057509359, 3.7167199305105445, 0.7806679421915736, 1.3357617059383573, 0.6432126431478646, 0.7844320225775303, 0.7914448597775874, 0.6062951516842914, 2.361651383565121, 1.344111371341596, 1.5352657622603103, 2.914846803173046, 0.4697085392465592, 0.8299946932483919, 2.132176767817622, 1.3433472619215587, 0.648219443743973, 2.358472676856646, 1.611282261860905, 0.6368098982043275, 0.9872079503801445, 0.6464676183497391, 1.831398079011925, 1.4240964192632979, 0.7778026461150249, 1.3762429857910479, 3.062803412388723, 2.454148585280096, 2.9118987251377764, 1.805122048084463, 2.3851982131809892, 4.3055057171638955, 1.8922777812547058, 0.9325362166714644, 2.3562532061563055, 1.7666730721435164, 3.5324840943668026, 4.194154095977461, 3.124407615091199, 3.297728102827784, 2.6211984196043003, 1.9530497416266388, 2.920408373210835, 1.1050700931033708, 1.9239439742302489, 3.736478385029857, 1.7065159851365723, 3.094319451751346, 2.693180830546373, 2.9074886580598265, 3.2075848970532173, 3.859208491678687, 1.861703974746391, 2.3384408645663237, 2.666928713300819, 3.451701248077671, 4.979989329603884, 1.1871290382554331, 3.647654675614505, 2.6014957043133697, 2.1893298317225027, 2.8796628771746438, 1.0453306167335557, 2.7534143684637855, 1.9271847903843047, 1.1032643082615494, 2.801056290107037, 4.692178259673, 2.7962852348892815, 3.011841724019014, 1.6958109160860229, 3.1004292181895705, 1.5309935695672197], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.161792101038393, "mean_inference_ms": 1.0506180792756286, "mean_action_processing_ms": 0.043907334238771266, "mean_env_wait_ms": 0.9861758747871139, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 248000, "timers": {"sample_time_ms": 2619.917, "sample_throughput": 3053.532, "learn_time_ms": 2807.679, "learn_throughput": 2849.329, "update_time_ms": 1.608}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": -0.0018672697719127414, "policy_loss": -0.017179223228364238, "vf_loss": 0.008151337312209227, "vf_explained_var": 0.9589738845825195, "kl": 0.007160615752495471, "entropy": -3.753622096682352, "entropy_coeff": 0.0}}, "num_steps_sampled": 248000, "num_steps_trained": 248000}, "done": false, "episodes_total": 248, "training_iteration": 31, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-29-39", "timestamp": 1617996579, "time_this_iter_s": 5.20380163192749, "time_total_s": 156.7406620979309, "pid": 8850, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 54.35051894187927, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 52.1857142857143, "ram_util_percent": 78.91428571428571}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 4.907226502180403, "episode_reward_min": 1.725439299484369, "episode_reward_mean": 3.181389867004647, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.295643611261082, 3.3512047272720764, 2.2565458189744825, 4.375887646704492, 2.9792089124111247, 4.907226502180403, 1.725439299484369, 2.5599624177491447], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22904734154204864, "mean_inference_ms": 1.5689246244840214, "mean_action_processing_ms": 0.06345161548503986, "mean_env_wait_ms": 1.5684574038594157, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 256000, "timers": {"sample_time_ms": 48080.99, "sample_throughput": 166.386, "learn_time_ms": 2800.263, "learn_throughput": 2856.874, "update_time_ms": 1.25}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.0008504401951555222, "policy_loss": -0.014977605865588264, "vf_loss": 0.008043544470436044, "vf_explained_var": 0.9643344283103943, "kl": 0.007784501856399907, "entropy": -3.7822443227919322, "entropy_coeff": 0.0}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 256, "training_iteration": 32, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-31-47", "timestamp": 1617996707, "time_this_iter_s": 50.88656806945801, "time_total_s": 207.62723016738892, "pid": 10453, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.88656806945801, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.477777777777774, "ram_util_percent": 80.42500000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 5.737585948021153, "episode_reward_min": 2.1921546212212117, "episode_reward_mean": 3.970060001144, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1847038974056949, "mean_inference_ms": 1.1515644165900323, "mean_action_processing_ms": 0.04812110434998047, "mean_env_wait_ms": 1.1846278156791177, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 264000, "timers": {"sample_time_ms": 3164.857, "sample_throughput": 2527.76, "learn_time_ms": 2745.004, "learn_throughput": 2914.385, "update_time_ms": 1.5}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.004343488978015052, "policy_loss": -0.015046735781998862, "vf_loss": 0.011719989782524488, "vf_explained_var": 0.9511415958404541, "kl": 0.0076702360862067765, "entropy": -3.8230245453970775, "entropy_coeff": 0.0}}, "num_steps_sampled": 264000, "num_steps_trained": 264000}, "done": false, "episodes_total": 264, "training_iteration": 33, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-32-16", "timestamp": 1617996736, "time_this_iter_s": 5.915607690811157, "time_total_s": 213.54283785820007, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.915607690811157, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 62.733333333333334, "ram_util_percent": 78.94444444444444}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 7.003001784885555, "episode_reward_min": 1.8527730181589952, "episode_reward_mean": 3.9176910189830565, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18295645241403125, "mean_inference_ms": 1.1580368159331564, "mean_action_processing_ms": 0.048306014849956155, "mean_env_wait_ms": 1.1668585533987448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 272000, "timers": {"sample_time_ms": 2918.816, "sample_throughput": 2740.838, "learn_time_ms": 2790.045, "learn_throughput": 2867.337, "update_time_ms": 1.492}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.00314179525178458, "policy_loss": -0.012927814061561274, "vf_loss": 0.008870688437055501, "vf_explained_var": 0.9629787802696228, "kl": 0.007198921412170407, "entropy": -3.8697469234466553, "entropy_coeff": 0.0}}, "num_steps_sampled": 272000, "num_steps_trained": 272000}, "done": false, "episodes_total": 272, "training_iteration": 34, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-32-21", "timestamp": 1617996741, "time_this_iter_s": 5.514253377914429, "time_total_s": 219.0570912361145, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.429861068725586, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 60.53750000000001, "ram_util_percent": 79.1625}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 8.999616635898748, "episode_reward_min": 1.8527730181589952, "episode_reward_mean": 4.400254313366247, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18212991704828138, "mean_inference_ms": 1.159313452854023, "mean_action_processing_ms": 0.048325467453365245, "mean_env_wait_ms": 1.1552846156774441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 280000, "timers": {"sample_time_ms": 2844.406, "sample_throughput": 2812.538, "learn_time_ms": 2792.222, "learn_throughput": 2865.101, "update_time_ms": 1.489}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.006192225253298169, "policy_loss": -0.014681757250357242, "vf_loss": 0.013060101958376074, "vf_explained_var": 0.9518405199050903, "kl": 0.00781387917786127, "entropy": -3.8698888619740806, "entropy_coeff": 0.0}}, "num_steps_sampled": 280000, "num_steps_trained": 280000}, "done": false, "episodes_total": 280, "training_iteration": 35, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-32-27", "timestamp": 1617996747, "time_this_iter_s": 5.498748064041138, "time_total_s": 224.55583930015564, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.928609132766724, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 59.22500000000001, "ram_util_percent": 79.23750000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 8.999616635898748, "episode_reward_min": 1.8527730181589952, "episode_reward_mean": 4.375802866529906, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18101065039756986, "mean_inference_ms": 1.1578112124811404, "mean_action_processing_ms": 0.04824477180011867, "mean_env_wait_ms": 1.1452851744591137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 288000, "timers": {"sample_time_ms": 2800.452, "sample_throughput": 2856.682, "learn_time_ms": 2775.971, "learn_throughput": 2881.874, "update_time_ms": 1.589}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.0064723173540736, "policy_loss": -0.012595997546755132, "vf_loss": 0.011703576131295117, "vf_explained_var": 0.957253098487854, "kl": 0.007364739811727925, "entropy": -3.8809466399843733, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 288, "training_iteration": 36, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-32-32", "timestamp": 1617996752, "time_this_iter_s": 5.403608083724976, "time_total_s": 229.95944738388062, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.3322172164917, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 61.75714285714287, "ram_util_percent": 79.24285714285715}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 8.999616635898748, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 4.329595048652443, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18064196627878132, "mean_inference_ms": 1.1630652949504339, "mean_action_processing_ms": 0.04814404054693841, "mean_env_wait_ms": 1.136957297244514, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 296000, "timers": {"sample_time_ms": 2830.691, "sample_throughput": 2826.165, "learn_time_ms": 2723.167, "learn_throughput": 2937.756, "update_time_ms": 1.585}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.004244432925054479, "policy_loss": -0.012072932034257858, "vf_loss": 0.009973387500005109, "vf_explained_var": 0.9634412527084351, "kl": 0.006343976941905798, "entropy": -3.920030889056978, "entropy_coeff": 0.0}}, "num_steps_sampled": 296000, "num_steps_trained": 296000}, "done": false, "episodes_total": 296, "training_iteration": 37, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-32-38", "timestamp": 1617996758, "time_this_iter_s": 5.4694929122924805, "time_total_s": 235.4289402961731, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.80171012878418, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.0875, "ram_util_percent": 79.3875}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 8.999616635898748, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 4.397631338953938, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1788783089551449, "mean_inference_ms": 1.1566128627956351, "mean_action_processing_ms": 0.04768731242062899, "mean_env_wait_ms": 1.1213246847383906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 304000, "timers": {"sample_time_ms": 2688.834, "sample_throughput": 2975.268, "learn_time_ms": 2655.926, "learn_throughput": 3012.132, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.006786480013813291, "policy_loss": -0.014994739806131712, "vf_loss": 0.014873157307091687, "vf_explained_var": 0.9481481313705444, "kl": 0.006908062246761152, "entropy": -3.9437626089368547, "entropy_coeff": 0.0}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 304, "training_iteration": 38, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-32-42", "timestamp": 1617996762, "time_this_iter_s": 4.305411100387573, "time_total_s": 239.73435139656067, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.10712122917175, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.38333333333334, "ram_util_percent": 79.38333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 8.999616635898748, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 4.400673280163212, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1766930814793219, "mean_inference_ms": 1.145682325410734, "mean_action_processing_ms": 0.04711957419967431, "mean_env_wait_ms": 1.1039568630322176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 312000, "timers": {"sample_time_ms": 2574.446, "sample_throughput": 3107.465, "learn_time_ms": 2614.105, "learn_throughput": 3060.321, "update_time_ms": 1.602}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.0036281758091515964, "policy_loss": -0.014524818298273854, "vf_loss": 0.01033696076936192, "vf_explained_var": 0.96184903383255, "kl": 0.007816032927838109, "entropy": -3.9699703738802956, "entropy_coeff": 0.0}}, "num_steps_sampled": 312000, "num_steps_trained": 312000}, "done": false, "episodes_total": 312, "training_iteration": 39, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-32-46", "timestamp": 1617996766, "time_this_iter_s": 4.256800174713135, "time_total_s": 243.9911515712738, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 36.36392140388489, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.514285714285716, "ram_util_percent": 79.60000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 8.999616635898748, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 4.4165251385170095, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1743895215046654, "mean_inference_ms": 1.133037308613101, "mean_action_processing_ms": 0.046525003035152876, "mean_env_wait_ms": 1.0865809960197534, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 320000, "timers": {"sample_time_ms": 2488.35, "sample_throughput": 3214.982, "learn_time_ms": 2613.481, "learn_throughput": 3061.052, "update_time_ms": 1.615}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.004010784543222851, "policy_loss": -0.015496329685288763, "vf_loss": 0.012290636801885234, "vf_explained_var": 0.955685019493103, "kl": 0.007216477397060584, "entropy": -3.994873285293579, "entropy_coeff": 0.0}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 320, "training_iteration": 40, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-32-51", "timestamp": 1617996771, "time_this_iter_s": 4.501185417175293, "time_total_s": 248.4923369884491, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.86510682106018, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 34.483333333333334, "ram_util_percent": 76.31666666666666}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 9.620630289628364, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 4.594007337790502, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17216532159921547, "mean_inference_ms": 1.1199818737746439, "mean_action_processing_ms": 0.04593591573232551, "mean_env_wait_ms": 1.0699099012441735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 328000, "timers": {"sample_time_ms": 2411.112, "sample_throughput": 3317.972, "learn_time_ms": 2583.09, "learn_throughput": 3097.065, "update_time_ms": 1.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.010515966293742024, "policy_loss": -0.01158746839722707, "vf_loss": 0.015053062226682429, "vf_explained_var": 0.9534638524055481, "kl": 0.007050372009712552, "entropy": -4.011869600840977, "entropy_coeff": 0.0}}, "num_steps_sampled": 328000, "num_steps_trained": 328000}, "done": false, "episodes_total": 328, "training_iteration": 41, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-32-55", "timestamp": 1617996775, "time_this_iter_s": 4.139622688293457, "time_total_s": 252.63195967674255, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.00472950935364, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.649999999999995, "ram_util_percent": 70.03333333333335}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.382352469585232, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 4.788739444860887, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17004151928202466, "mean_inference_ms": 1.1071972238103753, "mean_action_processing_ms": 0.04537515827335228, "mean_env_wait_ms": 1.0542750410549917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 336000, "timers": {"sample_time_ms": 2346.269, "sample_throughput": 3409.669, "learn_time_ms": 2572.834, "learn_throughput": 3109.411, "update_time_ms": 1.654}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.010812894840325629, "policy_loss": -0.013474596546046318, "vf_loss": 0.01700516858152927, "vf_explained_var": 0.957466721534729, "kl": 0.007282323721382353, "entropy": -4.029572520937238, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 336, "training_iteration": 42, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-32-59", "timestamp": 1617996779, "time_this_iter_s": 4.249773263931274, "time_total_s": 256.8817329406738, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.25450277328491, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.583333333333332, "ram_util_percent": 70.03333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.382352469585232, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 4.826858695764544, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16802883389194695, "mean_inference_ms": 1.094843507214559, "mean_action_processing_ms": 0.0448404064709313, "mean_env_wait_ms": 1.039607181152547, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 344000, "timers": {"sample_time_ms": 2200.356, "sample_throughput": 3635.776, "learn_time_ms": 2526.365, "learn_throughput": 3166.605, "update_time_ms": 1.679}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.008345594260072897, "policy_loss": -0.012486395130436572, "vf_loss": 0.013086136149626875, "vf_explained_var": 0.9693227410316467, "kl": 0.007745853255665492, "entropy": -4.070430278778076, "entropy_coeff": 0.0}}, "num_steps_sampled": 344000, "num_steps_trained": 344000}, "done": false, "episodes_total": 344, "training_iteration": 43, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-03", "timestamp": 1617996783, "time_this_iter_s": 3.99281907081604, "time_total_s": 260.87455201148987, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.24732184410095, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 21.51666666666667, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.382352469585232, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 4.825450711484167, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 4.81711325317594, 5.721239135372037, 5.737585948021153, 2.707191913624774, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16615357677153506, "mean_inference_ms": 1.0831603660724907, "mean_action_processing_ms": 0.04433853516496535, "mean_env_wait_ms": 1.0259994128484038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 352000, "timers": {"sample_time_ms": 2104.782, "sample_throughput": 3800.869, "learn_time_ms": 2473.912, "learn_throughput": 3233.745, "update_time_ms": 1.692}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.0052129944697732016, "policy_loss": -0.01390821621235874, "vf_loss": 0.011155477710186488, "vf_explained_var": 0.9730703830718994, "kl": 0.007965731249737835, "entropy": -4.087781943972149, "entropy_coeff": 0.0}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 352, "training_iteration": 44, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-07", "timestamp": 1617996787, "time_this_iter_s": 4.033641338348389, "time_total_s": 264.90819334983826, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 57.28096318244934, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.74, "ram_util_percent": 70.2}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.382352469585232, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 4.8404145378611085, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 3.5664761396581373, 2.1921546212212117, 3.212267171563301, 3.8064518265154454, 4.367156778699253, 3.2323741613545627, 7.003001784885555, 5.330748764003044, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16374025586515703, "mean_inference_ms": 1.0696939315797696, "mean_action_processing_ms": 0.043739082175440105, "mean_env_wait_ms": 1.007364958601389, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 360000, "timers": {"sample_time_ms": 2006.625, "sample_throughput": 3986.793, "learn_time_ms": 2420.345, "learn_throughput": 3305.314, "update_time_ms": 1.716}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.009206235763572511, "policy_loss": -0.012136984453906142, "vf_loss": 0.01429809731919141, "vf_explained_var": 0.964486300945282, "kl": 0.007045120488674868, "entropy": -4.096696384369381, "entropy_coeff": 0.0}}, "num_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 360, "training_iteration": 45, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-11", "timestamp": 1617996791, "time_this_iter_s": 3.980909585952759, "time_total_s": 268.889102935791, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 61.2618727684021, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 21.5, "ram_util_percent": 70.03333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.382352469585232, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 5.071258871501147, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 3.694381924623765, 3.2428762195814747, 2.199263643270248, 1.8527730181589952, 3.933899215669249, 8.999616635898748, 5.919720461910014, 3.8233874357808926, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16041351003515433, "mean_inference_ms": 1.0509009094846922, "mean_action_processing_ms": 0.04288740735398479, "mean_env_wait_ms": 0.9816434418530429, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 368000, "timers": {"sample_time_ms": 1912.982, "sample_throughput": 4181.953, "learn_time_ms": 2379.106, "learn_throughput": 3362.608, "update_time_ms": 1.705}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.0060924579581571004, "policy_loss": -0.015781566678058533, "vf_loss": 0.014342996498776807, "vf_explained_var": 0.9662203788757324, "kl": 0.007531027065678721, "entropy": -4.1414453567020475, "entropy_coeff": 0.0}}, "num_steps_sampled": 368000, "num_steps_trained": 368000}, "done": false, "episodes_total": 368, "training_iteration": 46, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-15", "timestamp": 1617996795, "time_this_iter_s": 4.054077625274658, "time_total_s": 272.9431805610657, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 65.31595039367676, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 21.933333333333334, "ram_util_percent": 70.06666666666666}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.382352469585232, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 5.265757596248271, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 3.5107914157558033, 6.7384634212715, 3.568953446292344, 6.428215184482469, 3.007771536467992, 3.130058381323332, 7.5299215134457125, 6.923681298003609, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1571087011469245, "mean_inference_ms": 1.0312955137136541, "mean_action_processing_ms": 0.04199995385717772, "mean_env_wait_ms": 0.9575669801427484, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 376000, "timers": {"sample_time_ms": 1793.954, "sample_throughput": 4459.424, "learn_time_ms": 2357.069, "learn_throughput": 3394.045, "update_time_ms": 1.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.007499636468728857, "policy_loss": -0.016107480455603864, "vf_loss": 0.01566581963191903, "vf_explained_var": 0.9626159071922302, "kl": 0.007941296627183281, "entropy": -4.1732025600615, "entropy_coeff": 0.0}}, "num_steps_sampled": 376000, "num_steps_trained": 376000}, "done": false, "episodes_total": 376, "training_iteration": 47, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-20", "timestamp": 1617996800, "time_this_iter_s": 4.059635639190674, "time_total_s": 277.00281620025635, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 69.37558603286743, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 22.516666666666666, "ram_util_percent": 69.98333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.40242306974044, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 5.485655607650126, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.4441259231863808, 5.252663510045598, 3.0480383913811115, 3.0833276543133454, 4.004938332398064, 3.7025692574116347, 3.8844149904613605, 6.44817339343676, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15395091663905142, "mean_inference_ms": 1.0111716595737548, "mean_action_processing_ms": 0.04109494984032514, "mean_env_wait_ms": 0.9338789510673016, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 384000, "timers": {"sample_time_ms": 1764.181, "sample_throughput": 4534.682, "learn_time_ms": 2360.418, "learn_throughput": 3389.23, "update_time_ms": 1.726}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.015214489092902532, "policy_loss": -0.012202992691614088, "vf_loss": 0.019727638745236965, "vf_explained_var": 0.9552626609802246, "kl": 0.007689843619508403, "entropy": -4.199443635486421, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 384, "training_iteration": 48, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-24", "timestamp": 1617996804, "time_this_iter_s": 4.042267322540283, "time_total_s": 281.04508352279663, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 73.41785335540771, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 21.766666666666666, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.40242306974044, "episode_reward_min": 1.7168001785186338, "episode_reward_mean": 5.715304719793981, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 1.7168001785186338, 5.0696139573403, 4.457194550346192, 3.874405557227785, 6.724228148114486, 1.9971650314922007, 5.013388210741508, 2.4211170895082716, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15069303418766566, "mean_inference_ms": 0.9899778663292951, "mean_action_processing_ms": 0.04020183750893749, "mean_env_wait_ms": 0.9110053674392123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 392000, "timers": {"sample_time_ms": 1744.409, "sample_throughput": 4586.082, "learn_time_ms": 2359.417, "learn_throughput": 3390.669, "update_time_ms": 1.769}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.01473804320844393, "policy_loss": -0.012386793751151317, "vf_loss": 0.020142060985404348, "vf_explained_var": 0.9568979740142822, "kl": 0.006982774658512975, "entropy": -4.2382910743592275, "entropy_coeff": 0.0}}, "num_steps_sampled": 392000, "num_steps_trained": 392000}, "done": false, "episodes_total": 392, "training_iteration": 49, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-28", "timestamp": 1617996808, "time_this_iter_s": 4.050140857696533, "time_total_s": 285.09522438049316, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 77.46799421310425, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.18, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.474687646532121, "episode_reward_min": 2.0370094174991964, "episode_reward_mean": 6.012516521408146, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 6.807728323039096, 2.0370094174991964, 5.631464261322598, 7.270401841973985, 7.944786035883283, 2.897447867787734, 2.8408014726484216, 5.387640400821389, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14761099732476812, "mean_inference_ms": 0.968892601912605, "mean_action_processing_ms": 0.039381017009460395, "mean_env_wait_ms": 0.8902978622652262, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 400000, "timers": {"sample_time_ms": 1734.08, "sample_throughput": 4613.398, "learn_time_ms": 2333.59, "learn_throughput": 3428.195, "update_time_ms": 1.776}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.01336372173613026, "policy_loss": -0.012419747927832224, "vf_loss": 0.019194489182342612, "vf_explained_var": 0.958838164806366, "kl": 0.006588980097264525, "entropy": -4.224646825639028, "entropy_coeff": 0.0}}, "num_steps_sampled": 400000, "num_steps_trained": 400000}, "done": false, "episodes_total": 400, "training_iteration": 50, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-32", "timestamp": 1617996812, "time_this_iter_s": 4.13992166519165, "time_total_s": 289.2351460456848, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 81.6079158782959, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 20.966666666666665, "ram_util_percent": 69.98333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.474687646532121, "episode_reward_min": 2.3457208048093987, "episode_reward_mean": 6.143316228404191, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 3.476319457277154, 4.366605507417389, 5.201195004055061, 3.2366036734603414, 6.84404070331844, 2.9962641568072113, 3.834282715630744, 6.836404332995058, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14512599827296635, "mean_inference_ms": 0.951617811791584, "mean_action_processing_ms": 0.038703892750272334, "mean_env_wait_ms": 0.8733058851056879, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 408000, "timers": {"sample_time_ms": 1729.373, "sample_throughput": 4625.953, "learn_time_ms": 2335.002, "learn_throughput": 3426.122, "update_time_ms": 1.736}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.01483795243418879, "policy_loss": -0.012218578984694821, "vf_loss": 0.019880369231696168, "vf_explained_var": 0.958053708076477, "kl": 0.007176162357190772, "entropy": -4.249247452569386, "entropy_coeff": 0.0}}, "num_steps_sampled": 408000, "num_steps_trained": 408000}, "done": false, "episodes_total": 408, "training_iteration": 51, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-36", "timestamp": 1617996816, "time_this_iter_s": 4.106452703475952, "time_total_s": 293.34159874916077, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 85.71436858177185, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 20.783333333333335, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.474687646532121, "episode_reward_min": 2.3457208048093987, "episode_reward_mean": 6.3527369737532755, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 6.049078866404384, 2.657193408791663, 2.366631366504751, 4.636009625496519, 7.809459724880059, 4.430962169467749, 9.620630289628364, 5.3381579567657615, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14308460811585022, "mean_inference_ms": 0.9369731654461623, "mean_action_processing_ms": 0.03812635676990938, "mean_env_wait_ms": 0.8588844615706895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 416000, "timers": {"sample_time_ms": 1725.582, "sample_throughput": 4636.116, "learn_time_ms": 2317.62, "learn_throughput": 3451.817, "update_time_ms": 1.746}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.010368010088328331, "policy_loss": -0.013902152474555705, "vf_loss": 0.017518009147828535, "vf_explained_var": 0.9655631184577942, "kl": 0.006752154701167629, "entropy": -4.2779677254813055, "entropy_coeff": 0.0}}, "num_steps_sampled": 416000, "num_steps_trained": 416000}, "done": false, "episodes_total": 416, "training_iteration": 52, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-40", "timestamp": 1617996820, "time_this_iter_s": 4.038248777389526, "time_total_s": 297.3798475265503, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 89.75261735916138, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 22.083333333333332, "ram_util_percent": 70.05}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.474687646532121, "episode_reward_min": 2.3457208048093987, "episode_reward_mean": 6.698724515058778, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 6.214776141050548, 5.1313765279002235, 4.243145309521358, 5.322411336613442, 5.812137544224773, 12.382352469585232, 4.315882265908414, 4.992206975336175, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1413358399888226, "mean_inference_ms": 0.9244939142465698, "mean_action_processing_ms": 0.03763238268921245, "mean_env_wait_ms": 0.8465814306950666, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 424000, "timers": {"sample_time_ms": 1727.89, "sample_throughput": 4629.924, "learn_time_ms": 2325.369, "learn_throughput": 3440.315, "update_time_ms": 1.749}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.01840757546088998, "policy_loss": -0.01414607156304613, "vf_loss": 0.026081126449363574, "vf_explained_var": 0.9551995992660522, "kl": 0.00647252302853361, "entropy": -4.288828304835728, "entropy_coeff": 0.0}}, "num_steps_sampled": 424000, "num_steps_trained": 424000}, "done": false, "episodes_total": 424, "training_iteration": 53, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-44", "timestamp": 1617996824, "time_this_iter_s": 4.093350410461426, "time_total_s": 301.4731979370117, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 93.8459677696228, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.55, "ram_util_percent": 69.96666666666667}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 12.474687646532121, "episode_reward_min": 2.3457208048093987, "episode_reward_mean": 6.927179291964879, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 9.393309886341791, 6.991242612279507, 4.834321465877414, 3.6091740484015826, 2.942704999351882, 4.799065053450939, 5.0347523000628165, 8.46639452892866, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1398388363698437, "mean_inference_ms": 0.9137366341217167, "mean_action_processing_ms": 0.03720536771561163, "mean_env_wait_ms": 0.8359699383425654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 432000, "timers": {"sample_time_ms": 1726.256, "sample_throughput": 4634.306, "learn_time_ms": 2327.036, "learn_throughput": 3437.85, "update_time_ms": 1.747}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.019121549284410854, "policy_loss": -0.010941216027334569, "vf_loss": 0.023664204137665883, "vf_explained_var": 0.963590681552887, "kl": 0.006398560893204477, "entropy": -4.34836178734189, "entropy_coeff": 0.0}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 432, "training_iteration": 54, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-48", "timestamp": 1617996828, "time_this_iter_s": 4.034377098083496, "time_total_s": 305.5075750350952, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 97.8803448677063, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 21.183333333333334, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 16.826366796987095, "episode_reward_min": 2.3457208048093987, "episode_reward_mean": 7.229736850951367, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 4.948650066137983, 3.7947809776901034, 6.489686056472813, 5.188375656313701, 4.023689562378815, 3.6063495682246423, 4.556051097063945, 5.615832157019993, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13854285823549348, "mean_inference_ms": 0.9044394286247239, "mean_action_processing_ms": 0.036835184794591885, "mean_env_wait_ms": 0.8268001667648669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 440000, "timers": {"sample_time_ms": 1729.908, "sample_throughput": 4624.525, "learn_time_ms": 2332.569, "learn_throughput": 3429.696, "update_time_ms": 1.726}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.025785889905241745, "policy_loss": -0.009258363521583969, "vf_loss": 0.02857933994678278, "vf_explained_var": 0.9605529308319092, "kl": 0.006464914662674779, "entropy": -4.36043097480895, "entropy_coeff": 0.0}}, "num_steps_sampled": 440000, "num_steps_trained": 440000}, "done": false, "episodes_total": 440, "training_iteration": 55, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-52", "timestamp": 1617996832, "time_this_iter_s": 4.072749853134155, "time_total_s": 309.58032488822937, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 101.95309472084045, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.560000000000002, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 16.826366796987095, "episode_reward_min": 2.3457208048093987, "episode_reward_mean": 7.539277460594706, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 3.8157721178186046, 6.707209580747248, 6.8808491369344305, 3.2739498550123853, 3.97745100651022, 4.377987982437291, 8.89015159352721, 5.412983897879271, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13741780030774783, "mean_inference_ms": 0.8962847438098676, "mean_action_processing_ms": 0.03651171079215778, "mean_env_wait_ms": 0.8187627891172243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 448000, "timers": {"sample_time_ms": 1730.258, "sample_throughput": 4623.587, "learn_time_ms": 2327.023, "learn_throughput": 3437.869, "update_time_ms": 1.707}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.016417460353483283, "policy_loss": -0.013539815380696266, "vf_loss": 0.022214710638518372, "vf_explained_var": 0.9710119962692261, "kl": 0.0077425641939044, "entropy": -4.3899489887177, "entropy_coeff": 0.0}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 448, "training_iteration": 56, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-33-56", "timestamp": 1617996836, "time_this_iter_s": 4.000675201416016, "time_total_s": 313.5810000896454, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 105.95376992225647, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 22.299999999999997, "ram_util_percent": 70.21666666666668}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 16.826366796987095, "episode_reward_min": 2.3457208048093987, "episode_reward_mean": 7.921744674500229, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 4.936811370405263, 2.509994046709093, 4.990681467428938, 4.685254368927451, 6.033771310657401, 4.125467023467715, 6.110686077354438, 6.541333613448877, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13642339101462264, "mean_inference_ms": 0.8890425146927885, "mean_action_processing_ms": 0.03622486501232367, "mean_env_wait_ms": 0.811616991697152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 456000, "timers": {"sample_time_ms": 1723.308, "sample_throughput": 4642.234, "learn_time_ms": 2339.515, "learn_throughput": 3419.512, "update_time_ms": 1.695}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.02382573052235539, "policy_loss": -0.014293449103004403, "vf_loss": 0.03102771858019488, "vf_explained_var": 0.9635766744613647, "kl": 0.007091461651263729, "entropy": -4.4235472981891935, "entropy_coeff": 0.0}}, "num_steps_sampled": 456000, "num_steps_trained": 456000}, "done": false, "episodes_total": 456, "training_iteration": 57, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-00", "timestamp": 1617996840, "time_this_iter_s": 4.114692211151123, "time_total_s": 317.6956923007965, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 110.06846213340759, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 21.850000000000005, "ram_util_percent": 70.10000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 17.012945208080495, "episode_reward_min": 2.3457208048093987, "episode_reward_mean": 8.428565019283933, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 7.8433964532740745, 8.673629689424027, 9.38807404827908, 7.078706395998713, 7.142585528844668, 7.646280435242625, 4.768306982772288, 4.862666828946429, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13554070747517222, "mean_inference_ms": 0.8825584993932672, "mean_action_processing_ms": 0.035966980810286014, "mean_env_wait_ms": 0.8052062358352383, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 464000, "timers": {"sample_time_ms": 1726.122, "sample_throughput": 4634.666, "learn_time_ms": 2350.609, "learn_throughput": 3403.373, "update_time_ms": 1.703}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.03684269137207478, "policy_loss": -0.012180778497297848, "vf_loss": 0.040261397404330115, "vf_explained_var": 0.9589248299598694, "kl": 0.008762074220511649, "entropy": -4.463534165942479, "entropy_coeff": 0.0}}, "num_steps_sampled": 464000, "num_steps_trained": 464000}, "done": false, "episodes_total": 464, "training_iteration": 58, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-05", "timestamp": 1617996845, "time_this_iter_s": 4.180719614028931, "time_total_s": 321.87641191482544, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 114.24918174743652, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 21.3, "ram_util_percent": 70.10000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 20.050730177199053, "episode_reward_min": 2.3457208048093987, "episode_reward_mean": 8.736803931698404, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 11.086764877962413, 3.7919785661886065, 7.08382399119353, 6.733383818455417, 5.793252149233932, 6.994258236381525, 6.437295262257451, 12.40242306974044, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13474849219181162, "mean_inference_ms": 0.8766856639669705, "mean_action_processing_ms": 0.03573356780652413, "mean_env_wait_ms": 0.7994088935753674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 472000, "timers": {"sample_time_ms": 1733.288, "sample_throughput": 4615.505, "learn_time_ms": 2344.639, "learn_throughput": 3412.038, "update_time_ms": 1.663}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.03583260580512976, "policy_loss": -0.012250989291166503, "vf_loss": 0.041122784483290854, "vf_explained_var": 0.9584727883338928, "kl": 0.00696080966320421, "entropy": -4.492349897112165, "entropy_coeff": 0.0}}, "num_steps_sampled": 472000, "num_steps_trained": 472000}, "done": false, "episodes_total": 472, "training_iteration": 59, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-09", "timestamp": 1617996849, "time_this_iter_s": 4.061385154724121, "time_total_s": 325.93779706954956, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 118.31056690216064, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 21.349999999999998, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.345199638288946, "episode_reward_min": 2.3457208048093987, "episode_reward_mean": 9.185434622118862, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 7.118357991433873, 7.027788953594387, 5.866061181160296, 11.18822049342625, 2.3457208048093987, 6.825783155309827, 7.476847781090019, 5.106636468200402, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1340324417546912, "mean_inference_ms": 0.8713756263760447, "mean_action_processing_ms": 0.03552205397441365, "mean_env_wait_ms": 0.794161747272448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 480000, "timers": {"sample_time_ms": 1727.819, "sample_throughput": 4630.115, "learn_time_ms": 2335.86, "learn_throughput": 3424.863, "update_time_ms": 1.656}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.04600597292717014, "policy_loss": -0.011495216084378106, "vf_loss": 0.05139893704345302, "vf_explained_var": 0.9510738253593445, "kl": 0.0061022524115821675, "entropy": -4.52658410299392, "entropy_coeff": 0.0}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 480, "training_iteration": 60, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-13", "timestamp": 1617996853, "time_this_iter_s": 3.996680498123169, "time_total_s": 329.93447756767273, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 122.30724740028381, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 21.349999999999998, "ram_util_percent": 70.01666666666667}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.345199638288946, "episode_reward_min": 3.642230004255169, "episode_reward_mean": 9.436571949638651, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 8.681420840343367, 10.285374315499869, 7.228717846085969, 6.882661455680941, 8.00945773968242, 4.787408776213965, 4.058386084442703, 8.569396455944378, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13338665260374033, "mean_inference_ms": 0.8665817347698009, "mean_action_processing_ms": 0.035330371167330794, "mean_env_wait_ms": 0.7894172467368007, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 488000, "timers": {"sample_time_ms": 1722.348, "sample_throughput": 4644.822, "learn_time_ms": 2325.967, "learn_throughput": 3439.43, "update_time_ms": 1.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.02729674410961923, "policy_loss": -0.012702190790266271, "vf_loss": 0.03305576972308613, "vf_explained_var": 0.9692385196685791, "kl": 0.006943167187273502, "entropy": -4.563612521640838, "entropy_coeff": 0.0}}, "num_steps_sampled": 488000, "num_steps_trained": 488000}, "done": false, "episodes_total": 488, "training_iteration": 61, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-17", "timestamp": 1617996857, "time_this_iter_s": 3.9533872604370117, "time_total_s": 333.88786482810974, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 126.26063466072083, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.000000000000004, "ram_util_percent": 70.04}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.345199638288946, "episode_reward_min": 3.642230004255169, "episode_reward_mean": 10.032087957567015, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 8.1013572427951, 5.498400512649281, 12.474687646532121, 9.495998426446011, 5.399982406281108, 10.899721427638365, 3.947879519483969, 5.273785834376114, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13280574868818318, "mean_inference_ms": 0.8622098920406852, "mean_action_processing_ms": 0.0351554492295169, "mean_env_wait_ms": 0.7850841360179287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 496000, "timers": {"sample_time_ms": 1722.791, "sample_throughput": 4643.627, "learn_time_ms": 2323.177, "learn_throughput": 3443.56, "update_time_ms": 1.634}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.04946982881261243, "policy_loss": -0.01208902755013061, "vf_loss": 0.054777923971414566, "vf_explained_var": 0.9548872709274292, "kl": 0.006780932243499491, "entropy": -4.597502784123496, "entropy_coeff": 0.0}}, "num_steps_sampled": 496000, "num_steps_trained": 496000}, "done": false, "episodes_total": 496, "training_iteration": 62, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-21", "timestamp": 1617996861, "time_this_iter_s": 4.014237642288208, "time_total_s": 337.90210247039795, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 130.27487230300903, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 22.0, "ram_util_percent": 70.03333333333335}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.345199638288946, "episode_reward_min": 3.642230004255169, "episode_reward_mean": 10.54398478875429, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 5.4959656973758175, 5.901272832555794, 8.2889589586499, 8.689683644218979, 6.288078104101566, 4.916694300203022, 4.776946812634172, 10.331943728296928, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1322782780893447, "mean_inference_ms": 0.8581635300987692, "mean_action_processing_ms": 0.03499386568174791, "mean_env_wait_ms": 0.7810687781876208, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 504000, "timers": {"sample_time_ms": 1722.439, "sample_throughput": 4644.576, "learn_time_ms": 2316.094, "learn_throughput": 3454.091, "update_time_ms": 1.597}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.03648072733942952, "policy_loss": -0.01169803487284789, "vf_loss": 0.04071019187806144, "vf_explained_var": 0.9657143950462341, "kl": 0.007468568065041114, "entropy": -4.63506719801161, "entropy_coeff": 0.0}}, "num_steps_sampled": 504000, "num_steps_trained": 504000}, "done": false, "episodes_total": 504, "training_iteration": 63, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-25", "timestamp": 1617996865, "time_this_iter_s": 4.0184667110443115, "time_total_s": 341.92056918144226, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 134.29333901405334, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 21.450000000000003, "ram_util_percent": 70.06666666666666}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.345199638288946, "episode_reward_min": 3.642230004255169, "episode_reward_mean": 10.848487497587753, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 6.982577744551503, 9.72433578695051, 6.989879481947363, 7.723334127184714, 9.455346947783461, 11.930859648076114, 8.077321244208317, 7.5090482311794755, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1317459335791829, "mean_inference_ms": 0.8544661146407878, "mean_action_processing_ms": 0.03484563680737083, "mean_env_wait_ms": 0.7773983937677965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 512000, "timers": {"sample_time_ms": 1725.065, "sample_throughput": 4637.507, "learn_time_ms": 2320.85, "learn_throughput": 3447.013, "update_time_ms": 1.603}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.03335982652765418, "policy_loss": -0.009796989083822285, "vf_loss": 0.035422698136359926, "vf_explained_var": 0.9712695479393005, "kl": 0.007734117253373067, "entropy": -4.678666039118691, "entropy_coeff": 0.0}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 512, "training_iteration": 64, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-29", "timestamp": 1617996869, "time_this_iter_s": 4.108863592147827, "time_total_s": 346.0294327735901, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 138.40220260620117, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 21.283333333333335, "ram_util_percent": 70.18333333333334}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.345199638288946, "episode_reward_min": 3.642230004255169, "episode_reward_mean": 11.2358991887535, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 10.488420035016889, 10.642760901953764, 11.070075333881581, 8.333045196390108, 11.334981111664781, 12.472615632015804, 9.591427635831943, 10.413499147485933, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13124297903668616, "mean_inference_ms": 0.8510235479760315, "mean_action_processing_ms": 0.03470795396339324, "mean_env_wait_ms": 0.7739800995422709, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 520000, "timers": {"sample_time_ms": 1720.503, "sample_throughput": 4649.802, "learn_time_ms": 2325.299, "learn_throughput": 3440.418, "update_time_ms": 1.64}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.03718492863256307, "policy_loss": -0.012778404094870128, "vf_loss": 0.04299182991778094, "vf_explained_var": 0.9662150740623474, "kl": 0.006971505182307391, "entropy": -4.71662205741519, "entropy_coeff": 0.0}}, "num_steps_sampled": 520000, "num_steps_trained": 520000}, "done": false, "episodes_total": 520, "training_iteration": 65, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-33", "timestamp": 1617996873, "time_this_iter_s": 4.0724382400512695, "time_total_s": 350.10187101364136, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 142.47464084625244, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.66, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.345199638288946, "episode_reward_min": 3.642230004255169, "episode_reward_mean": 11.522467448999844, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 7.348219045257183, 8.15602294100131, 5.280307291069166, 6.662693456423825, 16.826366796987095, 10.171193111477356, 6.879717550923201, 10.187365563087576, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13077846191246117, "mean_inference_ms": 0.8478553468974523, "mean_action_processing_ms": 0.03458111933708087, "mean_env_wait_ms": 0.770830922259819, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 528000, "timers": {"sample_time_ms": 1718.578, "sample_throughput": 4655.012, "learn_time_ms": 2335.376, "learn_throughput": 3425.572, "update_time_ms": 1.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.04158096592725506, "policy_loss": -0.010057122224853152, "vf_loss": 0.04510866291821003, "vf_explained_var": 0.9663723111152649, "kl": 0.006529427576987516, "entropy": -4.730443031068832, "entropy_coeff": 0.0}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 528, "training_iteration": 66, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-37", "timestamp": 1617996877, "time_this_iter_s": 4.083512544631958, "time_total_s": 354.1853835582733, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 146.5581533908844, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 21.55, "ram_util_percent": 70.06666666666666}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.345199638288946, "episode_reward_min": 3.642230004255169, "episode_reward_mean": 12.173290324614781, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 11.922315390033631, 8.542119255785313, 4.448228176634708, 7.349414948414694, 9.513239728706987, 6.214656527829351, 7.114713058975095, 10.60760899945177, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13035042465406305, "mean_inference_ms": 0.844941360539111, "mean_action_processing_ms": 0.03446401982345786, "mean_env_wait_ms": 0.7679390983096185, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 536000, "timers": {"sample_time_ms": 1724.431, "sample_throughput": 4639.212, "learn_time_ms": 2332.879, "learn_throughput": 3429.238, "update_time_ms": 1.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.050723864216475734, "policy_loss": -0.011690492667849101, "vf_loss": 0.055844737128132864, "vf_explained_var": 0.9633674621582031, "kl": 0.0065696196601031315, "entropy": -4.762037602681962, "entropy_coeff": 0.0}}, "num_steps_sampled": 536000, "num_steps_trained": 536000}, "done": false, "episodes_total": 536, "training_iteration": 67, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-41", "timestamp": 1617996881, "time_this_iter_s": 4.14876127243042, "time_total_s": 358.33414483070374, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 150.70691466331482, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 22.116666666666664, "ram_util_percent": 70.08333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.345199638288946, "episode_reward_min": 3.642230004255169, "episode_reward_mean": 12.57708292827362, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 10.331345108976633, 12.596485446494297, 3.642230004255169, 9.157197230946446, 8.858756372935758, 11.840358846580953, 14.452782515979733, 6.422088717288621, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12995016554325656, "mean_inference_ms": 0.8422225593771994, "mean_action_processing_ms": 0.03435414164658519, "mean_env_wait_ms": 0.7652510692834384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 544000, "timers": {"sample_time_ms": 1727.817, "sample_throughput": 4630.121, "learn_time_ms": 2326.112, "learn_throughput": 3439.215, "update_time_ms": 1.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.03745154439220353, "policy_loss": -0.010397665513058504, "vf_loss": 0.04097566800931143, "vf_explained_var": 0.9722937345504761, "kl": 0.006873539900259366, "entropy": -4.778631164914086, "entropy_coeff": 0.0}}, "num_steps_sampled": 544000, "num_steps_trained": 544000}, "done": false, "episodes_total": 544, "training_iteration": 68, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-45", "timestamp": 1617996885, "time_this_iter_s": 4.146921396255493, "time_total_s": 362.48106622695923, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 154.8538360595703, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 21.400000000000002, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.68613436010849, "episode_reward_min": 4.2384339813306635, "episode_reward_mean": 13.308064827828462, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 10.358049385364874, 8.441152485161227, 9.748290668854535, 11.461597569253541, 13.843618243128901, 9.459594976427995, 17.012945208080495, 9.33692870763733, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12958018997546758, "mean_inference_ms": 0.8396889497815282, "mean_action_processing_ms": 0.03425133276079599, "mean_env_wait_ms": 0.762749001194511, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 552000, "timers": {"sample_time_ms": 1723.44, "sample_throughput": 4641.879, "learn_time_ms": 2329.766, "learn_throughput": 3433.821, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.07205035722267533, "policy_loss": -0.00781814388871666, "vf_loss": 0.07314451931724472, "vf_explained_var": 0.9572935104370117, "kl": 0.0067239813580517735, "entropy": -4.773294441283695, "entropy_coeff": 0.0}}, "num_steps_sampled": 552000, "num_steps_trained": 552000}, "done": false, "episodes_total": 552, "training_iteration": 69, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-49", "timestamp": 1617996889, "time_this_iter_s": 4.053795337677002, "time_total_s": 366.53486156463623, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 158.90763139724731, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 21.266666666666666, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.68613436010849, "episode_reward_min": 4.2384339813306635, "episode_reward_mean": 14.027879112859857, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 11.920868217472524, 4.2384339813306635, 13.854921872957668, 10.948722549733903, 5.894066814369547, 20.050730177199053, 16.213233395800295, 7.53794503812232, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12923880507051017, "mean_inference_ms": 0.8373406180407125, "mean_action_processing_ms": 0.03415628414463565, "mean_env_wait_ms": 0.7604258604300462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 560000, "timers": {"sample_time_ms": 1720.434, "sample_throughput": 4649.99, "learn_time_ms": 2339.256, "learn_throughput": 3419.891, "update_time_ms": 1.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.08328655728005938, "policy_loss": -0.00790246163627931, "vf_loss": 0.08550998420705871, "vf_explained_var": 0.956095814704895, "kl": 0.005679035762561456, "entropy": -4.801509312220982, "entropy_coeff": 0.0}}, "num_steps_sampled": 560000, "num_steps_trained": 560000}, "done": false, "episodes_total": 560, "training_iteration": 70, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-53", "timestamp": 1617996893, "time_this_iter_s": 4.062572240829468, "time_total_s": 370.5974338054657, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 162.97020363807678, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.683333333333334, "ram_util_percent": 70.06666666666666}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.68613436010849, "episode_reward_min": 4.3682655397769174, "episode_reward_mean": 14.443381323186204, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 7.922238689035487, 5.029888758896931, 14.406022837879652, 11.173411892925667, 31.345199638288946, 10.004951088261965, 8.031981035593565, 11.297579581907002, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12891668907920567, "mean_inference_ms": 0.835146458087437, "mean_action_processing_ms": 0.034066370330093465, "mean_env_wait_ms": 0.7582539240884411, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 568000, "timers": {"sample_time_ms": 1727.303, "sample_throughput": 4631.498, "learn_time_ms": 2350.145, "learn_throughput": 3404.046, "update_time_ms": 1.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.04443232172597495, "policy_loss": -0.009665099830026664, "vf_loss": 0.0470291298651506, "vf_explained_var": 0.9760804772377014, "kl": 0.0070682902347355605, "entropy": -4.828211640554761, "entropy_coeff": 0.0}}, "num_steps_sampled": 568000, "num_steps_trained": 568000}, "done": false, "episodes_total": 568, "training_iteration": 71, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-34-58", "timestamp": 1617996898, "time_this_iter_s": 4.1303606033325195, "time_total_s": 374.7277944087982, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 167.1005642414093, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 21.433333333333326, "ram_util_percent": 70.05000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.68613436010849, "episode_reward_min": 4.3682655397769174, "episode_reward_mean": 14.664717579565504, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 10.852926418603468, 11.136288460408426, 11.420533464529813, 11.096789325866009, 4.3682655397769174, 15.511362027943822, 7.2463931937541926, 14.855700638045645, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12861118297110136, "mean_inference_ms": 0.8330658575545021, "mean_action_processing_ms": 0.03398131997929879, "mean_env_wait_ms": 0.7561920478904166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 576000, "timers": {"sample_time_ms": 1725.301, "sample_throughput": 4636.872, "learn_time_ms": 2350.036, "learn_throughput": 3404.204, "update_time_ms": 1.656}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.03427072357208956, "policy_loss": -0.012448733628150962, "vf_loss": 0.04020215943455696, "vf_explained_var": 0.980525553226471, "kl": 0.006517298726571931, "entropy": -4.879733850085546, "entropy_coeff": 0.0}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 576, "training_iteration": 72, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-02", "timestamp": 1617996902, "time_this_iter_s": 3.9931704998016357, "time_total_s": 378.72096490859985, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 171.09373474121094, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 24.8, "ram_util_percent": 70.1}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.68613436010849, "episode_reward_min": 5.722014721156463, "episode_reward_mean": 15.174975146780527, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 12.846585826017373, 6.74205566454526, 9.322499305280646, 7.176287385639423, 15.810574271305256, 22.245648548464356, 15.598279174831493, 8.539376025683888, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12832586274145774, "mean_inference_ms": 0.831133205366469, "mean_action_processing_ms": 0.03390276950827841, "mean_env_wait_ms": 0.7542860865898439, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 584000, "timers": {"sample_time_ms": 1727.8, "sample_throughput": 4630.166, "learn_time_ms": 2356.294, "learn_throughput": 3395.162, "update_time_ms": 1.668}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.04738583092001222, "policy_loss": -0.010364655479197465, "vf_loss": 0.05092238611172116, "vf_explained_var": 0.9767614006996155, "kl": 0.00682810131489994, "entropy": -4.918432273561993, "entropy_coeff": 0.0}}, "num_steps_sampled": 584000, "num_steps_trained": 584000}, "done": false, "episodes_total": 584, "training_iteration": 73, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-06", "timestamp": 1617996906, "time_this_iter_s": 4.106155872344971, "time_total_s": 382.8271207809448, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 175.1998906135559, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 21.516666666666666, "ram_util_percent": 70.03333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.68613436010849, "episode_reward_min": 5.722014721156463, "episode_reward_mean": 15.645244359361836, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 6.579659532374957, 15.475380195407315, 14.590084342893544, 19.215422215769273, 15.545544425700946, 20.690984486560993, 15.722042147812292, 15.996451796133385, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1280548582808405, "mean_inference_ms": 0.829323572936827, "mean_action_processing_ms": 0.03382935231429549, "mean_env_wait_ms": 0.7525025659610663, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 592000, "timers": {"sample_time_ms": 1726.888, "sample_throughput": 4632.611, "learn_time_ms": 2357.785, "learn_throughput": 3393.015, "update_time_ms": 1.664}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.05920127600372311, "policy_loss": -0.007874675449870881, "vf_loss": 0.06038930633711436, "vf_explained_var": 0.9742358326911926, "kl": 0.006686646579986527, "entropy": -4.953734132978651, "entropy_coeff": 0.0}}, "num_steps_sampled": 592000, "num_steps_trained": 592000}, "done": false, "episodes_total": 592, "training_iteration": 74, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-10", "timestamp": 1617996910, "time_this_iter_s": 4.113796710968018, "time_total_s": 386.94091749191284, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 179.31368732452393, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 21.583333333333332, "ram_util_percent": 70.05000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.68613436010849, "episode_reward_min": 5.722014721156463, "episode_reward_mean": 15.709629138642804, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 13.890288642787024, 12.27063660826872, 10.086016628073772, 8.079531399592423, 10.843328251253604, 15.056692682009274, 12.319720028980589, 12.858113912697416, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12779651411020895, "mean_inference_ms": 0.8276449942027706, "mean_action_processing_ms": 0.0337612216018749, "mean_env_wait_ms": 0.7508581521269707, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 600000, "timers": {"sample_time_ms": 1735.59, "sample_throughput": 4609.385, "learn_time_ms": 2352.9, "learn_throughput": 3400.06, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.07481424123167045, "policy_loss": -0.008397575940877672, "vf_loss": 0.0772370183988223, "vf_explained_var": 0.9698700904846191, "kl": 0.005974799401998993, "entropy": -4.952086970919654, "entropy_coeff": 0.0}}, "num_steps_sampled": 600000, "num_steps_trained": 600000}, "done": false, "episodes_total": 600, "training_iteration": 75, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-14", "timestamp": 1617996914, "time_this_iter_s": 4.109904766082764, "time_total_s": 391.0508222579956, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 183.4235920906067, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 21.5, "ram_util_percent": 70.01666666666667}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 31.68613436010849, "episode_reward_min": 5.722014721156463, "episode_reward_mean": 16.209674789836004, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 5.722014721156463, 9.393898933815674, 9.941484130150824, 9.004562301318508, 9.213747815102368, 17.4138473303253, 15.235988820463291, 12.896382004170608, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1275638159340988, "mean_inference_ms": 0.8260861795790051, "mean_action_processing_ms": 0.033697948282987424, "mean_env_wait_ms": 0.7493342364774476, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 608000, "timers": {"sample_time_ms": 1741.728, "sample_throughput": 4593.14, "learn_time_ms": 2347.734, "learn_throughput": 3407.541, "update_time_ms": 1.613}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.06750472652770224, "policy_loss": -0.01135647026378484, "vf_loss": 0.07170971258292122, "vf_explained_var": 0.9736467599868774, "kl": 0.00715148087132663, "entropy": -4.9849169292147195, "entropy_coeff": 0.0}}, "num_steps_sampled": 608000, "num_steps_trained": 608000}, "done": false, "episodes_total": 608, "training_iteration": 76, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-18", "timestamp": 1617996918, "time_this_iter_s": 4.09274959564209, "time_total_s": 395.1435718536377, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 187.51634168624878, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 21.733333333333334, "ram_util_percent": 70.13333333333334}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 35.01709210889841, "episode_reward_min": 8.526088960285257, "episode_reward_mean": 16.980231487184952, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 16.28161303016756, 11.975925426552987, 11.806227003354898, 12.310140898319071, 20.02970401065123, 12.059386495493001, 12.394276399560255, 19.34105081491305, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1273517773896583, "mean_inference_ms": 0.8246698952729052, "mean_action_processing_ms": 0.0336395789459322, "mean_env_wait_ms": 0.7479509675696815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 616000, "timers": {"sample_time_ms": 1748.317, "sample_throughput": 4575.829, "learn_time_ms": 2334.939, "learn_throughput": 3426.213, "update_time_ms": 1.618}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.08124779107137806, "policy_loss": -0.008028961067634916, "vf_loss": 0.08361334359598538, "vf_explained_var": 0.9700227379798889, "kl": 0.005663411769395073, "entropy": -4.994405935681056, "entropy_coeff": 0.0}}, "num_steps_sampled": 616000, "num_steps_trained": 616000}, "done": false, "episodes_total": 616, "training_iteration": 77, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-22", "timestamp": 1617996922, "time_this_iter_s": 4.086087703704834, "time_total_s": 399.22965955734253, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 191.6024293899536, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 22.833333333333332, "ram_util_percent": 70.16666666666667}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 17.59530590279958, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 8.526088960285257, 9.664841424603463, 12.564947444823938, 18.423355468545008, 20.048397599198935, 15.970505132182538, 21.30348316570537, 13.807853818107453, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12715129372953515, "mean_inference_ms": 0.8233391770561508, "mean_action_processing_ms": 0.033584657514376545, "mean_env_wait_ms": 0.746653302998136, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 624000, "timers": {"sample_time_ms": 1749.092, "sample_throughput": 4573.802, "learn_time_ms": 2322.365, "learn_throughput": 3444.764, "update_time_ms": 1.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.13780945178771775, "policy_loss": -0.005505668058518379, "vf_loss": 0.13634960447985028, "vf_explained_var": 0.9569507241249084, "kl": 0.00696551093151645, "entropy": -5.011063174595908, "entropy_coeff": 0.0}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 624, "training_iteration": 78, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-26", "timestamp": 1617996926, "time_this_iter_s": 4.028963804244995, "time_total_s": 403.2586233615875, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 195.6313931941986, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 21.650000000000002, "ram_util_percent": 70.08333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 17.818253084639537, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 18.2351184013247, 22.897573442658796, 14.93422007825156, 9.397021680291289, 12.859494129797678, 13.667528131553384, 9.069128717120236, 23.42113160083152, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12696049326273173, "mean_inference_ms": 0.8220704300380115, "mean_action_processing_ms": 0.03353229778629044, "mean_env_wait_ms": 0.7454123773672598, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 632000, "timers": {"sample_time_ms": 1746.557, "sample_throughput": 4580.441, "learn_time_ms": 2325.48, "learn_throughput": 3440.15, "update_time_ms": 1.639}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.06698423802911763, "policy_loss": -0.006400034777701847, "vf_loss": 0.0669043567031622, "vf_explained_var": 0.9774177074432373, "kl": 0.006479913132294776, "entropy": -5.041730373624771, "entropy_coeff": 0.0}}, "num_steps_sampled": 632000, "num_steps_trained": 632000}, "done": false, "episodes_total": 632, "training_iteration": 79, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-30", "timestamp": 1617996930, "time_this_iter_s": 4.060770511627197, "time_total_s": 407.3193938732147, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 199.6921637058258, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 23.84, "ram_util_percent": 70.02000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 18.07783815050383, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 16.107890420364285, 9.022167488650698, 10.719735084557264, 11.224480878840389, 13.23715285918584, 31.68613436010849, 25.315503058192043, 17.621618547522964, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1267772836895406, "mean_inference_ms": 0.820843291291733, "mean_action_processing_ms": 0.03348190604477603, "mean_env_wait_ms": 0.7442035500654695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 640000, "timers": {"sample_time_ms": 1746.868, "sample_throughput": 4579.625, "learn_time_ms": 2316.284, "learn_throughput": 3453.808, "update_time_ms": 1.641}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.061025227057851024, "policy_loss": -0.011381293100024026, "vf_loss": 0.06561961279265464, "vf_explained_var": 0.9771144390106201, "kl": 0.006786907025213752, "entropy": -5.048491258469839, "entropy_coeff": 0.0}}, "num_steps_sampled": 640000, "num_steps_trained": 640000}, "done": false, "episodes_total": 640, "training_iteration": 80, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-34", "timestamp": 1617996934, "time_this_iter_s": 3.9730923175811768, "time_total_s": 411.2924861907959, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 203.66525602340698, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 21.116666666666667, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 18.219958759795713, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 15.89468272724205, 22.856459929980495, 12.212544883192697, 11.575337833516981, 30.401945934569884, 16.99436452818015, 20.520818736509735, 21.449228789850988, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1266026166233459, "mean_inference_ms": 0.8196496264874389, "mean_action_processing_ms": 0.03343348529383069, "mean_env_wait_ms": 0.7430272078618397, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 648000, "timers": {"sample_time_ms": 1744.167, "sample_throughput": 4586.718, "learn_time_ms": 2307.22, "learn_throughput": 3467.376, "update_time_ms": 1.67}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.05911678075790405, "policy_loss": -0.010128502408781695, "vf_loss": 0.06224007662090044, "vf_explained_var": 0.9781101942062378, "kl": 0.007005206501436612, "entropy": -5.067932461935376, "entropy_coeff": 0.0}}, "num_steps_sampled": 648000, "num_steps_trained": 648000}, "done": false, "episodes_total": 648, "training_iteration": 81, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-38", "timestamp": 1617996938, "time_this_iter_s": 4.012844085693359, "time_total_s": 415.30533027648926, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 207.67810010910034, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 21.66666666666666, "ram_util_percent": 70.05000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 18.238144060938698, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 23.072066533166232, 14.383780463948298, 18.11964148324035, 16.701759277583072, 20.968973404023995, 14.095647743181992, 11.930055475429677, 21.354961699774254, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12643512097558085, "mean_inference_ms": 0.8185323801028442, "mean_action_processing_ms": 0.03338807207446274, "mean_env_wait_ms": 0.7419279135187311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 656000, "timers": {"sample_time_ms": 1746.653, "sample_throughput": 4580.189, "learn_time_ms": 2319.509, "learn_throughput": 3449.006, "update_time_ms": 1.66}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.06902006611464516, "policy_loss": -0.007867045526851028, "vf_loss": 0.07064937729211081, "vf_explained_var": 0.9747388958930969, "kl": 0.006237734101771835, "entropy": -5.093019848778134, "entropy_coeff": 0.0}}, "num_steps_sampled": 656000, "num_steps_trained": 656000}, "done": false, "episodes_total": 656, "training_iteration": 82, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-42", "timestamp": 1617996942, "time_this_iter_s": 4.14143443107605, "time_total_s": 419.4467647075653, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 211.8195345401764, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 22.549999999999997, "ram_util_percent": 70.10000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 18.384363183308157, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 17.720323103911376, 13.671210000834293, 21.955180543692208, 10.512791108772504, 11.330003141414586, 15.246067879971147, 18.881827708933635, 17.398800315109263, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12627513012726252, "mean_inference_ms": 0.8174580883300415, "mean_action_processing_ms": 0.03334431601144753, "mean_env_wait_ms": 0.7408753026496445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 664000, "timers": {"sample_time_ms": 1739.459, "sample_throughput": 4599.13, "learn_time_ms": 2314.506, "learn_throughput": 3456.461, "update_time_ms": 1.682}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.06204636709853297, "policy_loss": -0.008398295380175114, "vf_loss": 0.06295994781549015, "vf_explained_var": 0.9786061644554138, "kl": 0.0074847133918887095, "entropy": -5.109884307498024, "entropy_coeff": 0.0}}, "num_steps_sampled": 664000, "num_steps_trained": 664000}, "done": false, "episodes_total": 664, "training_iteration": 83, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-46", "timestamp": 1617996946, "time_this_iter_s": 3.984510660171509, "time_total_s": 423.4312753677368, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 215.8040452003479, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.1, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 19.351999080460608, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 18.492693834954864, 11.618364978450556, 16.51842069624756, 11.858720605638018, 18.458719008353807, 16.12203578626253, 17.739117885858075, 20.91572600887192, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12612297716775278, "mean_inference_ms": 0.8164212243364681, "mean_action_processing_ms": 0.03330236520894423, "mean_env_wait_ms": 0.7398568181800214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 672000, "timers": {"sample_time_ms": 1739.104, "sample_throughput": 4600.069, "learn_time_ms": 2311.411, "learn_throughput": 3461.09, "update_time_ms": 1.692}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.12490392934590105, "policy_loss": -0.006069250345703155, "vf_loss": 0.12424754055719527, "vf_explained_var": 0.9627701044082642, "kl": 0.006725636998280173, "entropy": -5.1345510180034335, "entropy_coeff": 0.0}}, "num_steps_sampled": 672000, "num_steps_trained": 672000}, "done": false, "episodes_total": 672, "training_iteration": 84, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-51", "timestamp": 1617996951, "time_this_iter_s": 4.079547882080078, "time_total_s": 427.5108232498169, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 219.88359308242798, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 21.23333333333333, "ram_util_percent": 70.08333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 19.98619392617819, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 20.634284586817824, 18.485779358576043, 12.629029884696664, 12.529323270993581, 22.280453955539226, 19.506636031493215, 9.607340054890635, 22.906148190322547, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12598388018852524, "mean_inference_ms": 0.8154563299729292, "mean_action_processing_ms": 0.033263651287627406, "mean_env_wait_ms": 0.7389040399102267, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 680000, "timers": {"sample_time_ms": 1740.196, "sample_throughput": 4597.184, "learn_time_ms": 2308.09, "learn_throughput": 3466.069, "update_time_ms": 1.69}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.11977653560184297, "policy_loss": -0.00788044131227902, "vf_loss": 0.12163847270939085, "vf_explained_var": 0.966498613357544, "kl": 0.006018504430170333, "entropy": -5.15972758096362, "entropy_coeff": 0.0}}, "num_steps_sampled": 680000, "num_steps_trained": 680000}, "done": false, "episodes_total": 680, "training_iteration": 85, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-55", "timestamp": 1617996955, "time_this_iter_s": 4.0879223346710205, "time_total_s": 431.5987455844879, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 223.971515417099, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 22.55, "ram_util_percent": 70.3}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 20.549281477516175, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 23.98277134969009, 18.181204430600577, 16.016727625285125, 12.82694582207741, 21.640424934320563, 10.441226901720372, 11.335082247343724, 19.413778812946628, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258496836662966, "mean_inference_ms": 0.8145381183145912, "mean_action_processing_ms": 0.03322683944544589, "mean_env_wait_ms": 0.7380023681397632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 688000, "timers": {"sample_time_ms": 1738.659, "sample_throughput": 4601.248, "learn_time_ms": 2303.647, "learn_throughput": 3472.754, "update_time_ms": 1.675}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.08524870242746103, "policy_loss": -0.006579889812403255, "vf_loss": 0.08550561863988165, "vf_explained_var": 0.9769041538238525, "kl": 0.006322974006512335, "entropy": -5.148673640357123, "entropy_coeff": 0.0}}, "num_steps_sampled": 688000, "num_steps_trained": 688000}, "done": false, "episodes_total": 688, "training_iteration": 86, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-35-59", "timestamp": 1617996959, "time_this_iter_s": 4.03313684463501, "time_total_s": 435.6318824291229, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 228.004652261734, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 21.95, "ram_util_percent": 70.14999999999999}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 21.382783701098578, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 26.859358574487064, 13.984712386066848, 9.624687805597183, 16.95477540826722, 11.676402566097668, 16.35087448846904, 16.367438270066874, 10.13172899393378, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12572251559793096, "mean_inference_ms": 0.8136335566808409, "mean_action_processing_ms": 0.033190763250917986, "mean_env_wait_ms": 0.7371086788178093, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 696000, "timers": {"sample_time_ms": 1726.764, "sample_throughput": 4632.942, "learn_time_ms": 2309.157, "learn_throughput": 3464.468, "update_time_ms": 1.661}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.12047815565315503, "policy_loss": -0.009661383512947295, "vf_loss": 0.12324255870448218, "vf_explained_var": 0.9689940214157104, "kl": 0.006896977874612998, "entropy": -5.1852512208242265, "entropy_coeff": 0.0}}, "num_steps_sampled": 696000, "num_steps_trained": 696000}, "done": false, "episodes_total": 696, "training_iteration": 87, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-03", "timestamp": 1617996963, "time_this_iter_s": 4.0222344398498535, "time_total_s": 439.6541168689728, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 232.02688670158386, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 22.63333333333333, "ram_util_percent": 70.10000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 22.19760615870323, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 24.95242517692552, 21.510539757649234, 20.99138812429558, 23.428095895544942, 18.28306066795419, 13.436677553682404, 35.01709210889841, 16.03544399923768, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12560039735353307, "mean_inference_ms": 0.8127668153540736, "mean_action_processing_ms": 0.03315651597877438, "mean_env_wait_ms": 0.7362554853649159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 704000, "timers": {"sample_time_ms": 1723.654, "sample_throughput": 4641.302, "learn_time_ms": 2318.712, "learn_throughput": 3450.191, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.09490953260175293, "policy_loss": -0.008077701797620171, "vf_loss": 0.09562699059172282, "vf_explained_var": 0.9766905307769775, "kl": 0.007360243282857395, "entropy": -5.188891955784389, "entropy_coeff": 0.0}}, "num_steps_sampled": 704000, "num_steps_trained": 704000}, "done": false, "episodes_total": 704, "training_iteration": 88, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-07", "timestamp": 1617996967, "time_this_iter_s": 4.092803478240967, "time_total_s": 443.74692034721375, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 236.11969017982483, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 24.080000000000002, "ram_util_percent": 70.1}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 22.53120026593402, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 24.239664130464178, 15.147014364496442, 18.59917738934937, 25.119465577315154, 20.635882519826545, 19.043545025277098, 28.548022372060146, 24.297501248273, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12546624235232617, "mean_inference_ms": 0.8118886428082587, "mean_action_processing_ms": 0.03312167604992742, "mean_env_wait_ms": 0.7353877307031269, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 712000, "timers": {"sample_time_ms": 1728.639, "sample_throughput": 4627.917, "learn_time_ms": 2319.206, "learn_throughput": 3449.457, "update_time_ms": 1.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.15537581072440224, "policy_loss": -0.006750630769169047, "vf_loss": 0.1559151097067765, "vf_explained_var": 0.9673070311546326, "kl": 0.006211328150201884, "entropy": -5.212247182452489, "entropy_coeff": 0.0}}, "num_steps_sampled": 712000, "num_steps_trained": 712000}, "done": false, "episodes_total": 712, "training_iteration": 89, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-11", "timestamp": 1617996971, "time_this_iter_s": 4.115784645080566, "time_total_s": 447.8627049922943, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 240.2354748249054, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 21.599999999999998, "ram_util_percent": 70.05000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.089919761808105, "episode_reward_min": 5.847609777335195, "episode_reward_mean": 22.78767034823914, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542, 15.859505731787, 15.383779204107867, 5.847609777335195, 48.089919761808105, 26.78859140486628, 12.414422846738967, 12.837220854977163, 7.722763400396856, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12533573644953175, "mean_inference_ms": 0.8110185894079036, "mean_action_processing_ms": 0.033087197955874025, "mean_env_wait_ms": 0.734524565320278, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 720000, "timers": {"sample_time_ms": 1727.456, "sample_throughput": 4631.088, "learn_time_ms": 2327.705, "learn_throughput": 3436.862, "update_time_ms": 1.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.12259528605592629, "policy_loss": -0.008837011731451466, "vf_loss": 0.12434446563323338, "vf_explained_var": 0.9736050367355347, "kl": 0.007087830624114427, "entropy": -5.251270755888924, "entropy_coeff": 0.0}}, "num_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 720, "training_iteration": 90, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-15", "timestamp": 1617996975, "time_this_iter_s": 4.046190977096558, "time_total_s": 451.90889596939087, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 244.28166580200195, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 21.900000000000002, "ram_util_percent": 70.10000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 46.82644111106626, "episode_reward_min": 9.054401589253127, "episode_reward_mean": 23.30371398343303, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.044451314499376, 28.710007202040998, 22.42990858993327, 26.43594888354486, 16.408996537204477, 16.344239337289522, 25.01846783001187, 41.15615680688182, 26.489641893572845, 19.238117743525713, 25.970455786181024, 11.142977267188542, 22.96505601693451, 19.421656928073197, 21.825302339410612, 11.647942776903134, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12521189071985064, "mean_inference_ms": 0.8101809776372321, "mean_action_processing_ms": 0.033054350282545816, "mean_env_wait_ms": 0.7336971595066482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 728000, "timers": {"sample_time_ms": 1725.461, "sample_throughput": 4636.441, "learn_time_ms": 2336.561, "learn_throughput": 3423.836, "update_time_ms": 1.616}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.08712928816084824, "policy_loss": -0.007121691140272315, "vf_loss": 0.08834131109336066, "vf_explained_var": 0.9809956550598145, "kl": 0.00590967114216515, "entropy": -5.26425708286346, "entropy_coeff": 0.0}}, "num_steps_sampled": 728000, "num_steps_trained": 728000}, "done": false, "episodes_total": 728, "training_iteration": 91, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-19", "timestamp": 1617996979, "time_this_iter_s": 4.081947088241577, "time_total_s": 455.99084305763245, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 248.36361289024353, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 20.666666666666668, "ram_util_percent": 70.10000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 46.82644111106626, "episode_reward_min": 9.054401589253127, "episode_reward_mean": 23.448643807621973, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.542989488697035, 17.82013921403439, 17.771679695995285, 14.490885775439159, 16.181790257604895, 20.06277722152071, 33.800445464499134, 25.523426052893008, 12.902980483629284, 16.294323801268536, 30.606760357485957, 14.775700064553137, 11.518914625103529, 18.69473156659557, 19.663039390025784, 20.845602896158038, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542, 20.044451314499376, 28.710007202040998, 22.42990858993327, 26.43594888354486, 16.408996537204477, 16.344239337289522, 25.01846783001187, 41.15615680688182], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12510638853169337, "mean_inference_ms": 0.8094118318458444, "mean_action_processing_ms": 0.033024010194676226, "mean_env_wait_ms": 0.7329373182881033, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 736000, "timers": {"sample_time_ms": 1729.002, "sample_throughput": 4626.947, "learn_time_ms": 2332.884, "learn_throughput": 3429.232, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.08946211136404485, "policy_loss": -0.0045993451901253255, "vf_loss": 0.08760258756459706, "vf_explained_var": 0.9805850386619568, "kl": 0.0064588687678296414, "entropy": -5.290796219356476, "entropy_coeff": 0.0}}, "num_steps_sampled": 736000, "num_steps_trained": 736000}, "done": false, "episodes_total": 736, "training_iteration": 92, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-23", "timestamp": 1617996983, "time_this_iter_s": 4.139663934707642, "time_total_s": 460.1305069923401, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 252.50327682495117, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 22.599999999999998, "ram_util_percent": 70.08333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 47.577307229563885, "episode_reward_min": 9.054401589253127, "episode_reward_mean": 24.602406828249467, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.581223823692454, 38.47451435905476, 23.034672184130496, 22.588014197360113, 21.728546492193836, 33.48208178448622, 47.577307229563885, 28.211995177087218, 12.044175973813092, 26.351803533624967, 18.264395604604054, 21.764080036685332, 10.290437359863681, 26.504167377798638, 21.99470998774196, 19.630291650848246, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542, 20.044451314499376, 28.710007202040998, 22.42990858993327, 26.43594888354486, 16.408996537204477, 16.344239337289522, 25.01846783001187, 41.15615680688182, 27.542989488697035, 17.82013921403439, 17.771679695995285, 14.490885775439159, 16.181790257604895, 20.06277722152071, 33.800445464499134, 25.523426052893008], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12500403853912836, "mean_inference_ms": 0.8086720987900473, "mean_action_processing_ms": 0.0329948508893482, "mean_env_wait_ms": 0.7322089664339998, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 744000, "timers": {"sample_time_ms": 1735.945, "sample_throughput": 4608.441, "learn_time_ms": 2329.495, "learn_throughput": 3434.221, "update_time_ms": 1.612}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.16820689825902854, "policy_loss": -0.00654890930043563, "vf_loss": 0.16818379953740134, "vf_explained_var": 0.9650087356567383, "kl": 0.0065720093710022786, "entropy": -5.355577393183633, "entropy_coeff": 0.0}}, "num_steps_sampled": 744000, "num_steps_trained": 744000}, "done": false, "episodes_total": 744, "training_iteration": 93, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-27", "timestamp": 1617996987, "time_this_iter_s": 4.019695281982422, "time_total_s": 464.1502022743225, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 256.5229721069336, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 21.583333333333332, "ram_util_percent": 70.08333333333333}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 48.07157291763518, "episode_reward_min": 9.054401589253127, "episode_reward_mean": 25.421299674415177, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.340370470041336, 23.809106964355426, 48.07157291763518, 26.486277738057616, 21.61552714715197, 18.910738876745196, 27.746087610762135, 37.753664416802444, 18.763280872343316, 9.054401589253127, 22.816388090108333, 24.670236549384537, 17.448359111938124, 14.119605117978258, 22.818513904839595, 23.37228594700959, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542, 20.044451314499376, 28.710007202040998, 22.42990858993327, 26.43594888354486, 16.408996537204477, 16.344239337289522, 25.01846783001187, 41.15615680688182, 27.542989488697035, 17.82013921403439, 17.771679695995285, 14.490885775439159, 16.181790257604895, 20.06277722152071, 33.800445464499134, 25.523426052893008, 45.581223823692454, 38.47451435905476, 23.034672184130496, 22.588014197360113, 21.728546492193836, 33.48208178448622, 47.577307229563885, 28.211995177087218], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12490645606550381, "mean_inference_ms": 0.8079632065147132, "mean_action_processing_ms": 0.03296689369553051, "mean_env_wait_ms": 0.7315094818096266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 752000, "timers": {"sample_time_ms": 1740.31, "sample_throughput": 4596.881, "learn_time_ms": 2334.185, "learn_throughput": 3427.32, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.12448199328389906, "policy_loss": -0.005336279241693398, "vf_loss": 0.12365767637652064, "vf_explained_var": 0.9762271046638489, "kl": 0.0061605951179646784, "entropy": -5.375346274602981, "entropy_coeff": 0.0}}, "num_steps_sampled": 752000, "num_steps_trained": 752000}, "done": false, "episodes_total": 752, "training_iteration": 94, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-31", "timestamp": 1617996991, "time_this_iter_s": 4.1705522537231445, "time_total_s": 468.32075452804565, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 260.69352436065674, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 21.783333333333335, "ram_util_percent": 70.10000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 53.24340586213289, "episode_reward_min": 10.984725612634273, "episode_reward_mean": 26.116917921721676, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.77754450137109, 53.24340586213289, 15.792426967885255, 23.07344775787323, 36.291366119646604, 18.28671079315786, 17.581771640171027, 26.57822227126668, 14.800134286133263, 25.276982773912856, 14.417321420488545, 22.99559575499302, 16.42346431436625, 21.899753299462585, 30.649534895806298, 36.56617026710847, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542, 20.044451314499376, 28.710007202040998, 22.42990858993327, 26.43594888354486, 16.408996537204477, 16.344239337289522, 25.01846783001187, 41.15615680688182, 27.542989488697035, 17.82013921403439, 17.771679695995285, 14.490885775439159, 16.181790257604895, 20.06277722152071, 33.800445464499134, 25.523426052893008, 45.581223823692454, 38.47451435905476, 23.034672184130496, 22.588014197360113, 21.728546492193836, 33.48208178448622, 47.577307229563885, 28.211995177087218, 34.340370470041336, 23.809106964355426, 48.07157291763518, 26.486277738057616, 21.61552714715197, 18.910738876745196, 27.746087610762135, 37.753664416802444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12481389766631056, "mean_inference_ms": 0.8072903751766722, "mean_action_processing_ms": 0.03294027396535317, "mean_env_wait_ms": 0.73084613718266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 760000, "timers": {"sample_time_ms": 1733.144, "sample_throughput": 4615.89, "learn_time_ms": 2341.365, "learn_throughput": 3416.81, "update_time_ms": 1.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.1452387745883907, "policy_loss": -0.005833360588266736, "vf_loss": 0.14515089988708496, "vf_explained_var": 0.9731181263923645, "kl": 0.005921236897212645, "entropy": -5.362998803456624, "entropy_coeff": 0.0}}, "num_steps_sampled": 760000, "num_steps_trained": 760000}, "done": false, "episodes_total": 760, "training_iteration": 95, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-36", "timestamp": 1617996996, "time_this_iter_s": 4.0882182121276855, "time_total_s": 472.40897274017334, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 264.7817425727844, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 21.166666666666668, "ram_util_percent": 70.0}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 53.24340586213289, "episode_reward_min": 10.984725612634273, "episode_reward_mean": 26.180364313322542, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.7776837031274, 17.796387974148832, 25.74044131028593, 15.973711084335974, 32.42453849553418, 19.00987370191122, 21.153302278390843, 22.49765762462304, 34.10597427543074, 19.006122719149168, 33.0703277323784, 31.75844601418217, 29.41755524187025, 13.268322990184299, 18.091571041144356, 46.82644111106626, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542, 20.044451314499376, 28.710007202040998, 22.42990858993327, 26.43594888354486, 16.408996537204477, 16.344239337289522, 25.01846783001187, 41.15615680688182, 27.542989488697035, 17.82013921403439, 17.771679695995285, 14.490885775439159, 16.181790257604895, 20.06277722152071, 33.800445464499134, 25.523426052893008, 45.581223823692454, 38.47451435905476, 23.034672184130496, 22.588014197360113, 21.728546492193836, 33.48208178448622, 47.577307229563885, 28.211995177087218, 34.340370470041336, 23.809106964355426, 48.07157291763518, 26.486277738057616, 21.61552714715197, 18.910738876745196, 27.746087610762135, 37.753664416802444, 31.77754450137109, 53.24340586213289, 15.792426967885255, 23.07344775787323, 36.291366119646604, 18.28671079315786, 17.581771640171027, 26.57822227126668], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12472359700291612, "mean_inference_ms": 0.8066511917983931, "mean_action_processing_ms": 0.032914896727345606, "mean_env_wait_ms": 0.7302142017157851, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 768000, "timers": {"sample_time_ms": 1736.707, "sample_throughput": 4606.418, "learn_time_ms": 2353.125, "learn_throughput": 3399.735, "update_time_ms": 1.683}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.09079720058463632, "policy_loss": -0.008586412317873467, "vf_loss": 0.09260244980927497, "vf_explained_var": 0.9822964668273926, "kl": 0.006781162269088248, "entropy": -5.379777923462883, "entropy_coeff": 0.0}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 768, "training_iteration": 96, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-40", "timestamp": 1617997000, "time_this_iter_s": 4.185626983642578, "time_total_s": 476.5945997238159, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 268.967369556427, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 23.82, "ram_util_percent": 70.1}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 53.24340586213289, "episode_reward_min": 10.984725612634273, "episode_reward_mean": 26.13496005384617, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.080587420711343, 26.728398396593192, 32.75265187790583, 23.076425508101888, 21.45551810589372, 23.97402672292045, 43.268528155286184, 23.66819899035634, 29.001532253880168, 18.96924355496649, 12.373721704805165, 27.194895478478536, 26.090294699259008, 19.193039856424896, 17.583144705879523, 23.380678895978903, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542, 20.044451314499376, 28.710007202040998, 22.42990858993327, 26.43594888354486, 16.408996537204477, 16.344239337289522, 25.01846783001187, 41.15615680688182, 27.542989488697035, 17.82013921403439, 17.771679695995285, 14.490885775439159, 16.181790257604895, 20.06277722152071, 33.800445464499134, 25.523426052893008, 45.581223823692454, 38.47451435905476, 23.034672184130496, 22.588014197360113, 21.728546492193836, 33.48208178448622, 47.577307229563885, 28.211995177087218, 34.340370470041336, 23.809106964355426, 48.07157291763518, 26.486277738057616, 21.61552714715197, 18.910738876745196, 27.746087610762135, 37.753664416802444, 31.77754450137109, 53.24340586213289, 15.792426967885255, 23.07344775787323, 36.291366119646604, 18.28671079315786, 17.581771640171027, 26.57822227126668, 34.7776837031274, 17.796387974148832, 25.74044131028593, 15.973711084335974, 32.42453849553418, 19.00987370191122, 21.153302278390843, 22.49765762462304], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12463484048615485, "mean_inference_ms": 0.806045918906997, "mean_action_processing_ms": 0.03289104902823126, "mean_env_wait_ms": 0.7296207382489999, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 776000, "timers": {"sample_time_ms": 1744.245, "sample_throughput": 4586.512, "learn_time_ms": 2358.837, "learn_throughput": 3391.502, "update_time_ms": 1.692}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.11708838155581838, "policy_loss": -0.006931200061762143, "vf_loss": 0.1185362193556059, "vf_explained_var": 0.9782038927078247, "kl": 0.005483360964775322, "entropy": -5.364319559127566, "entropy_coeff": 0.0}}, "num_steps_sampled": 776000, "num_steps_trained": 776000}, "done": false, "episodes_total": 776, "training_iteration": 97, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-44", "timestamp": 1617997004, "time_this_iter_s": 4.155643701553345, "time_total_s": 480.75024342536926, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 273.12301325798035, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 22.733333333333334, "ram_util_percent": 70.10000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 53.24340586213289, "episode_reward_min": 10.984725612634273, "episode_reward_mean": 26.140011154555083, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.37043709343494, 17.867953624202983, 20.084663403501203, 17.582883647939298, 32.70804082146811, 25.00831743531987, 19.59390089657418, 23.075464298122935, 38.78341907166344, 27.644877641850975, 18.254296513920657, 23.957999082151282, 29.180443626708975, 20.504179680484487, 22.680000754196346, 18.633507588192167, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542, 20.044451314499376, 28.710007202040998, 22.42990858993327, 26.43594888354486, 16.408996537204477, 16.344239337289522, 25.01846783001187, 41.15615680688182, 27.542989488697035, 17.82013921403439, 17.771679695995285, 14.490885775439159, 16.181790257604895, 20.06277722152071, 33.800445464499134, 25.523426052893008, 45.581223823692454, 38.47451435905476, 23.034672184130496, 22.588014197360113, 21.728546492193836, 33.48208178448622, 47.577307229563885, 28.211995177087218, 34.340370470041336, 23.809106964355426, 48.07157291763518, 26.486277738057616, 21.61552714715197, 18.910738876745196, 27.746087610762135, 37.753664416802444, 31.77754450137109, 53.24340586213289, 15.792426967885255, 23.07344775787323, 36.291366119646604, 18.28671079315786, 17.581771640171027, 26.57822227126668, 34.7776837031274, 17.796387974148832, 25.74044131028593, 15.973711084335974, 32.42453849553418, 19.00987370191122, 21.153302278390843, 22.49765762462304, 26.080587420711343, 26.728398396593192, 32.75265187790583, 23.076425508101888, 21.45551810589372, 23.97402672292045, 43.268528155286184, 23.66819899035634], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12454654734800696, "mean_inference_ms": 0.8054386499453117, "mean_action_processing_ms": 0.032866854795947226, "mean_env_wait_ms": 0.7290221548858169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 784000, "timers": {"sample_time_ms": 1744.367, "sample_throughput": 4586.192, "learn_time_ms": 2357.956, "learn_throughput": 3392.769, "update_time_ms": 1.715}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.07720124458391515, "policy_loss": -0.008132454126127182, "vf_loss": 0.07923200413111657, "vf_explained_var": 0.9854228496551514, "kl": 0.006101696046128396, "entropy": -5.4163526050628175, "entropy_coeff": 0.0}}, "num_steps_sampled": 784000, "num_steps_trained": 784000}, "done": false, "episodes_total": 784, "training_iteration": 98, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-48", "timestamp": 1617997008, "time_this_iter_s": 4.0857908725738525, "time_total_s": 484.8360342979431, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 277.2088041305542, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 21.61666666666667, "ram_util_percent": 70.05000000000001}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 53.24340586213289, "episode_reward_min": 10.984725612634273, "episode_reward_mean": 26.909426686451596, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.458957972058215, 39.32865354985752, 34.51972572653424, 30.38269944810412, 19.020895407593198, 52.964147194748605, 29.549650044358618, 47.35554780556548, 20.153180770823038, 31.450891089173446, 31.55157677591393, 43.03460419673263, 27.107383140339675, 13.53462667914947, 26.823540400357945, 34.24718448658551, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542, 20.044451314499376, 28.710007202040998, 22.42990858993327, 26.43594888354486, 16.408996537204477, 16.344239337289522, 25.01846783001187, 41.15615680688182, 27.542989488697035, 17.82013921403439, 17.771679695995285, 14.490885775439159, 16.181790257604895, 20.06277722152071, 33.800445464499134, 25.523426052893008, 45.581223823692454, 38.47451435905476, 23.034672184130496, 22.588014197360113, 21.728546492193836, 33.48208178448622, 47.577307229563885, 28.211995177087218, 34.340370470041336, 23.809106964355426, 48.07157291763518, 26.486277738057616, 21.61552714715197, 18.910738876745196, 27.746087610762135, 37.753664416802444, 31.77754450137109, 53.24340586213289, 15.792426967885255, 23.07344775787323, 36.291366119646604, 18.28671079315786, 17.581771640171027, 26.57822227126668, 34.7776837031274, 17.796387974148832, 25.74044131028593, 15.973711084335974, 32.42453849553418, 19.00987370191122, 21.153302278390843, 22.49765762462304, 26.080587420711343, 26.728398396593192, 32.75265187790583, 23.076425508101888, 21.45551810589372, 23.97402672292045, 43.268528155286184, 23.66819899035634, 18.37043709343494, 17.867953624202983, 20.084663403501203, 17.582883647939298, 32.70804082146811, 25.00831743531987, 19.59390089657418, 23.075464298122935], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12446336877633753, "mean_inference_ms": 0.8048544037484769, "mean_action_processing_ms": 0.03284331629108383, "mean_env_wait_ms": 0.7284441270264611, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 792000, "timers": {"sample_time_ms": 1745.062, "sample_throughput": 4584.365, "learn_time_ms": 2363.302, "learn_throughput": 3385.094, "update_time_ms": 1.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.1746527243937765, "policy_loss": -0.007807778778471171, "vf_loss": 0.17673094535157793, "vf_explained_var": 0.9725359678268433, "kl": 0.005729557787408195, "entropy": -5.436607534923251, "entropy_coeff": 0.0}}, "num_steps_sampled": 792000, "num_steps_trained": 792000}, "done": false, "episodes_total": 792, "training_iteration": 99, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-52", "timestamp": 1617997012, "time_this_iter_s": 4.175179481506348, "time_total_s": 489.01121377944946, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 281.38398361206055, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 21.8, "ram_util_percent": 70.11666666666666}, "trial_id": "3d0f1_00002"}
{"episode_reward_max": 53.24340586213289, "episode_reward_min": 10.984725612634273, "episode_reward_mean": 27.37705289647829, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.938433975097716, 40.43334747570471, 32.609209830305666, 27.9063526328331, 28.784324974577835, 40.896013069656576, 39.40279976787119, 25.695126815698423, 33.473807719782094, 26.094951551296734, 18.269536997950315, 23.881193277988412, 41.19369999641773, 31.51811997158633, 16.289134536498114, 28.483423292763018, 35.190810795222795, 20.480542752230733, 10.984725612634273, 22.87367704991443, 33.43840170764179, 21.71913087327409, 18.777451478246668, 16.222056312812153, 38.77341156795533, 30.18749134386344, 27.598419881536266, 14.560917692244542, 20.044451314499376, 28.710007202040998, 22.42990858993327, 26.43594888354486, 16.408996537204477, 16.344239337289522, 25.01846783001187, 41.15615680688182, 27.542989488697035, 17.82013921403439, 17.771679695995285, 14.490885775439159, 16.181790257604895, 20.06277722152071, 33.800445464499134, 25.523426052893008, 45.581223823692454, 38.47451435905476, 23.034672184130496, 22.588014197360113, 21.728546492193836, 33.48208178448622, 47.577307229563885, 28.211995177087218, 34.340370470041336, 23.809106964355426, 48.07157291763518, 26.486277738057616, 21.61552714715197, 18.910738876745196, 27.746087610762135, 37.753664416802444, 31.77754450137109, 53.24340586213289, 15.792426967885255, 23.07344775787323, 36.291366119646604, 18.28671079315786, 17.581771640171027, 26.57822227126668, 34.7776837031274, 17.796387974148832, 25.74044131028593, 15.973711084335974, 32.42453849553418, 19.00987370191122, 21.153302278390843, 22.49765762462304, 26.080587420711343, 26.728398396593192, 32.75265187790583, 23.076425508101888, 21.45551810589372, 23.97402672292045, 43.268528155286184, 23.66819899035634, 18.37043709343494, 17.867953624202983, 20.084663403501203, 17.582883647939298, 32.70804082146811, 25.00831743531987, 19.59390089657418, 23.075464298122935, 23.458957972058215, 39.32865354985752, 34.51972572653424, 30.38269944810412, 19.020895407593198, 52.964147194748605, 29.549650044358618, 47.35554780556548], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12438322873013666, "mean_inference_ms": 0.8042881965821819, "mean_action_processing_ms": 0.03282028129048521, "mean_env_wait_ms": 0.727884865585267, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 800000, "timers": {"sample_time_ms": 1747.304, "sample_throughput": 4578.483, "learn_time_ms": 2365.603, "learn_throughput": 3381.802, "update_time_ms": 1.667}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0012645869732417798, "total_loss": 0.14489406517278108, "policy_loss": -0.010864441393918935, "vf_loss": 0.14921531684341885, "vf_explained_var": 0.9791874885559082, "kl": 0.006543189228054077, "entropy": -5.467779848310682, "entropy_coeff": 0.0}}, "num_steps_sampled": 800000, "num_steps_trained": 800000}, "done": true, "episodes_total": 800, "training_iteration": 100, "experiment_id": "1bb66fce4d4e4672a842bf7f18f0c0a7", "date": "2021-04-09_12-36-56", "timestamp": 1617997016, "time_this_iter_s": 4.091493606567383, "time_total_s": 493.10270738601685, "pid": 12588, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 6582, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 29, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0012645869732417802, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9067919500755929, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20289984247380316, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 285.47547721862793, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 21.133333333333336, "ram_util_percent": 70.18333333333334}, "trial_id": "3d0f1_00002"}
