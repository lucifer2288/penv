{"episode_reward_max": -0.22170871850805152, "episode_reward_min": -0.7832857050420357, "episode_reward_mean": -0.5128338072801268, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.37427625991348645, -0.7832857050420357, -0.22170871850805152, -0.6871796602070829, -0.6690525703394066, -0.4415797944651447, -0.6084502838612017, -0.3174917124007491, -0.5822070573791831, -0.625147322800875, -0.6181644979598432, -0.564337055264989, -0.38002938330111824, -0.4962907568454232, -0.5815898435614906, -0.25455029463194845], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13781346067295924, "mean_inference_ms": 1.0131519072158095, "mean_action_processing_ms": 0.043314392494192125, "mean_env_wait_ms": 0.9658775295827946, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 19200, "timers": {"sample_time_ms": 5785.044, "sample_throughput": 3318.903, "learn_time_ms": 4473.399, "learn_throughput": 4292.039, "update_time_ms": 1.323}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": 0.0059464673170198995, "policy_loss": -0.007695617709929744, "vf_loss": 0.0029524643851133684, "vf_explained_var": 0.8930409550666809, "kl": 0.010689620717118183, "entropy": -3.429769465128581, "entropy_coeff": 0.0}}, "num_steps_sampled": 19200, "num_steps_trained": 19200}, "done": false, "episodes_total": 16, "training_iteration": 1, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-18-17", "timestamp": 1617635897, "time_this_iter_s": 10.263550519943237, "time_total_s": 10.263550519943237, "pid": 9438, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.263550519943237, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.25333333333333, "ram_util_percent": 59.99333333333334}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.11376280869793098, "episode_reward_min": -0.7832857050420357, "episode_reward_mean": -0.5177972813480246, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6315896719175431, -0.6095979598961925, -0.6154427122079814, -0.6783496028794704, -0.5109660461362613, 0.11376280869793098, -0.6719726329432871, -0.4776404306067249, -0.6015577582380623, -0.4522007331284222, -0.5441659714429052, -0.41494825199423346, -0.615915108869068, -0.6068146938333723, -0.5026422797911719, -0.544131041467993, -0.37427625991348645, -0.7832857050420357, -0.22170871850805152, -0.6871796602070829, -0.6690525703394066, -0.4415797944651447, -0.6084502838612017, -0.3174917124007491, -0.5822070573791831, -0.625147322800875, -0.6181644979598432, -0.564337055264989, -0.38002938330111824, -0.4962907568454232, -0.5815898435614906, -0.25455029463194845], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13220919401318015, "mean_inference_ms": 0.9737388192279655, "mean_action_processing_ms": 0.04157633666396027, "mean_env_wait_ms": 0.9156716579054615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 38400, "timers": {"sample_time_ms": 5256.548, "sample_throughput": 3652.587, "learn_time_ms": 4581.851, "learn_throughput": 4190.446, "update_time_ms": 1.561}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": 0.003136433775847157, "policy_loss": -0.007593566160649061, "vf_loss": 0.002511336205837627, "vf_explained_var": 0.8833361864089966, "kl": 0.008218662763635318, "entropy": -3.389727142651876, "entropy_coeff": 0.0}}, "num_steps_sampled": 38400, "num_steps_trained": 38400}, "done": false, "episodes_total": 32, "training_iteration": 2, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-18-26", "timestamp": 1617635906, "time_this_iter_s": 9.426156282424927, "time_total_s": 19.689706802368164, "pid": 9438, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.689706802368164, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.76428571428572, "ram_util_percent": 60.15714285714288}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.18380146291258703, "episode_reward_min": -0.7832857050420357, "episode_reward_mean": -0.4844869296031476, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6653509586699428, -0.5502286454777644, -0.6262171543053853, -0.5362660568178692, -0.599348691089983, -0.2654391918747185, -0.4647889200829839, -0.5581385943175687, -0.6145103577693314, -0.42434877983511804, -0.6782122633902077, -0.07833462614647013, -0.5111417933107634, -0.5188079809844125, -0.3364509949540857, -0.11000073828834234, -0.6493675741981364, -0.7753968324345011, -0.5289256006284531, 0.08441505854321218, 0.18380146291258703, -0.4007704914288008, -0.6160472371198719, -0.3218780929705647, -0.37427625991348645, -0.7832857050420357, -0.22170871850805152, -0.6871796602070829, -0.6690525703394066, -0.4415797944651447, -0.6084502838612017, -0.3174917124007491, -0.5822070573791831, -0.625147322800875, -0.6181644979598432, -0.564337055264989, -0.38002938330111824, -0.4962907568454232, -0.5815898435614906, -0.25455029463194845, -0.6315896719175431, -0.6095979598961925, -0.6154427122079814, -0.6783496028794704, -0.5109660461362613, 0.11376280869793098, -0.6719726329432871, -0.4776404306067249, -0.6015577582380623, -0.4522007331284222, -0.5441659714429052, -0.41494825199423346, -0.615915108869068, -0.6068146938333723, -0.5026422797911719, -0.544131041467993], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1344578093751816, "mean_inference_ms": 0.9546034529137858, "mean_action_processing_ms": 0.04071075321802593, "mean_env_wait_ms": 0.8887041934594915, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 57600, "timers": {"sample_time_ms": 5265.941, "sample_throughput": 3646.072, "learn_time_ms": 4533.168, "learn_throughput": 4235.449, "update_time_ms": 1.528}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.00013331711292266846, "policy_loss": -0.009118728243435422, "vf_loss": 0.002057088314710806, "vf_explained_var": 0.8743541240692139, "kl": 0.006928323882942398, "entropy": -3.3959759140014647, "entropy_coeff": 0.0}}, "num_steps_sampled": 57600, "num_steps_trained": 57600}, "done": false, "episodes_total": 56, "training_iteration": 3, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-18-36", "timestamp": 1617635916, "time_this_iter_s": 9.728463649749756, "time_total_s": 29.41817045211792, "pid": 9438, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.41817045211792, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.27142857142856, "ram_util_percent": 60.200000000000024}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.18380146291258703, "episode_reward_min": -0.7832857050420357, "episode_reward_mean": -0.46635443378849406, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4386355142163744, -0.38445623669413564, -0.0442240270258647, -0.32463012948609266, -0.7149359934869082, -0.5972649884797154, -0.625315553826821, -0.1907615342316129, -0.7241906208313729, -0.5526714500419677, -0.3070692912800673, -0.04284296642461749, -0.23365938902930794, -0.3454227705228541, -0.29350024749194903, -0.6266704619256475, -0.37427625991348645, -0.7832857050420357, -0.22170871850805152, -0.6871796602070829, -0.6690525703394066, -0.4415797944651447, -0.6084502838612017, -0.3174917124007491, -0.5822070573791831, -0.625147322800875, -0.6181644979598432, -0.564337055264989, -0.38002938330111824, -0.4962907568454232, -0.5815898435614906, -0.25455029463194845, -0.6315896719175431, -0.6095979598961925, -0.6154427122079814, -0.6783496028794704, -0.5109660461362613, 0.11376280869793098, -0.6719726329432871, -0.4776404306067249, -0.6015577582380623, -0.4522007331284222, -0.5441659714429052, -0.41494825199423346, -0.615915108869068, -0.6068146938333723, -0.5026422797911719, -0.544131041467993, -0.6653509586699428, -0.5502286454777644, -0.6262171543053853, -0.5362660568178692, -0.599348691089983, -0.2654391918747185, -0.4647889200829839, -0.5581385943175687, -0.6145103577693314, -0.42434877983511804, -0.6782122633902077, -0.07833462614647013, -0.5111417933107634, -0.5188079809844125, -0.3364509949540857, -0.11000073828834234, -0.6493675741981364, -0.7753968324345011, -0.5289256006284531, 0.08441505854321218, 0.18380146291258703, -0.4007704914288008, -0.6160472371198719, -0.3218780929705647], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13660438040563583, "mean_inference_ms": 0.9560512879465644, "mean_action_processing_ms": 0.04079391610994739, "mean_env_wait_ms": 0.8872672389600578, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 76800, "timers": {"sample_time_ms": 5420.059, "sample_throughput": 3542.397, "learn_time_ms": 4583.195, "learn_throughput": 4189.217, "update_time_ms": 1.486}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": 0.0008872290048748255, "policy_loss": -0.008178795594722033, "vf_loss": 0.0022919164427245655, "vf_explained_var": 0.8686960935592651, "kl": 0.006774106842155258, "entropy": -3.371872345606486, "entropy_coeff": 0.0}}, "num_steps_sampled": 76800, "num_steps_trained": 76800}, "done": false, "episodes_total": 72, "training_iteration": 4, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-18-47", "timestamp": 1617635927, "time_this_iter_s": 10.623941659927368, "time_total_s": 40.04211211204529, "pid": 9438, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.04211211204529, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 53.00666666666666, "ram_util_percent": 60.37333333333333}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.25267161259227033, "episode_reward_min": -0.7832857050420357, "episode_reward_mean": -0.4456515186777617, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6362810922615836, -0.4964777816991585, -0.3657317055623024, -0.5416192225751231, -0.2626063961349313, -0.27339573484009116, -0.3420676090015075, -0.025416133182152523, -0.14602672963021268, -0.505272653026855, -0.5980312064709956, -0.5808342083516584, -0.1804181954797227, -0.6668297809908101, -0.15368122075675372, -0.41067441185884024, -0.6900122367381019, -0.28379635742237597, -0.3324392155130116, -0.5771148935350771, -0.4841534861076094, -0.5712474831050727, 0.25267161259227033, -0.33357041864187364, -0.37427625991348645, -0.7832857050420357, -0.22170871850805152, -0.6871796602070829, -0.6690525703394066, -0.4415797944651447, -0.6084502838612017, -0.3174917124007491, -0.5822070573791831, -0.625147322800875, -0.6181644979598432, -0.564337055264989, -0.38002938330111824, -0.4962907568454232, -0.5815898435614906, -0.25455029463194845, -0.6315896719175431, -0.6095979598961925, -0.6154427122079814, -0.6783496028794704, -0.5109660461362613, 0.11376280869793098, -0.6719726329432871, -0.4776404306067249, -0.6015577582380623, -0.4522007331284222, -0.5441659714429052, -0.41494825199423346, -0.615915108869068, -0.6068146938333723, -0.5026422797911719, -0.544131041467993, -0.6653509586699428, -0.5502286454777644, -0.6262171543053853, -0.5362660568178692, -0.599348691089983, -0.2654391918747185, -0.4647889200829839, -0.5581385943175687, -0.6145103577693314, -0.42434877983511804, -0.6782122633902077, -0.07833462614647013, -0.5111417933107634, -0.5188079809844125, -0.3364509949540857, -0.11000073828834234, -0.6493675741981364, -0.7753968324345011, -0.5289256006284531, 0.08441505854321218, 0.18380146291258703, -0.4007704914288008, -0.6160472371198719, -0.3218780929705647, -0.4386355142163744, -0.38445623669413564, -0.0442240270258647, -0.32463012948609266, -0.7149359934869082, -0.5972649884797154, -0.625315553826821, -0.1907615342316129, -0.7241906208313729, -0.5526714500419677, -0.3070692912800673, -0.04284296642461749, -0.23365938902930794, -0.3454227705228541, -0.29350024749194903, -0.6266704619256475], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13928893652968888, "mean_inference_ms": 0.952378180322042, "mean_action_processing_ms": 0.040646694334587515, "mean_env_wait_ms": 0.8806121671937684, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 96000, "timers": {"sample_time_ms": 5325.269, "sample_throughput": 3605.452, "learn_time_ms": 4639.56, "learn_throughput": 4138.324, "update_time_ms": 1.5}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.0009195167571306228, "policy_loss": -0.010470575839281081, "vf_loss": 0.0021954382909461856, "vf_explained_var": 0.8723861575126648, "kl": 0.007355619634812077, "entropy": -3.352099593480428, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 5, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-18-56", "timestamp": 1617635936, "time_this_iter_s": 9.818796873092651, "time_total_s": 49.86090898513794, "pid": 9438, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.86090898513794, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.42142857142857, "ram_util_percent": 60.314285714285695}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.25267161259227033, "episode_reward_min": -0.7753968324345011, "episode_reward_mean": -0.4191666167526953, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5166393618294816, -0.5184461795912081, 0.23418597943271702, 0.13649224743200716, -0.18872924763104904, -0.38345620539167347, -0.01675649153643377, -0.22257577252518979, -0.4044027965104451, -0.7152369526356462, -0.42510269538058526, -0.5906624487568046, -0.27152454634567513, -0.5996086937789701, -0.7444772064506184, -0.4000561488473967, -0.38002938330111824, -0.4962907568454232, -0.5815898435614906, -0.25455029463194845, -0.6315896719175431, -0.6095979598961925, -0.6154427122079814, -0.6783496028794704, -0.5109660461362613, 0.11376280869793098, -0.6719726329432871, -0.4776404306067249, -0.6015577582380623, -0.4522007331284222, -0.5441659714429052, -0.41494825199423346, -0.615915108869068, -0.6068146938333723, -0.5026422797911719, -0.544131041467993, -0.6653509586699428, -0.5502286454777644, -0.6262171543053853, -0.5362660568178692, -0.599348691089983, -0.2654391918747185, -0.4647889200829839, -0.5581385943175687, -0.6145103577693314, -0.42434877983511804, -0.6782122633902077, -0.07833462614647013, -0.5111417933107634, -0.5188079809844125, -0.3364509949540857, -0.11000073828834234, -0.6493675741981364, -0.7753968324345011, -0.5289256006284531, 0.08441505854321218, 0.18380146291258703, -0.4007704914288008, -0.6160472371198719, -0.3218780929705647, -0.4386355142163744, -0.38445623669413564, -0.0442240270258647, -0.32463012948609266, -0.7149359934869082, -0.5972649884797154, -0.625315553826821, -0.1907615342316129, -0.7241906208313729, -0.5526714500419677, -0.3070692912800673, -0.04284296642461749, -0.23365938902930794, -0.3454227705228541, -0.29350024749194903, -0.6266704619256475, -0.6362810922615836, -0.4964777816991585, -0.3657317055623024, -0.5416192225751231, -0.2626063961349313, -0.27339573484009116, -0.3420676090015075, -0.025416133182152523, -0.14602672963021268, -0.505272653026855, -0.5980312064709956, -0.5808342083516584, -0.1804181954797227, -0.6668297809908101, -0.15368122075675372, -0.41067441185884024, -0.6900122367381019, -0.28379635742237597, -0.3324392155130116, -0.5771148935350771, -0.4841534861076094, -0.5712474831050727, 0.25267161259227033, -0.33357041864187364], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14021980954287547, "mean_inference_ms": 0.9426611192533764, "mean_action_processing_ms": 0.04019563082997876, "mean_env_wait_ms": 0.8647335374650166, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 115200, "timers": {"sample_time_ms": 5265.865, "sample_throughput": 3646.124, "learn_time_ms": 4711.574, "learn_throughput": 4075.072, "update_time_ms": 1.539}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.0018152920637900631, "policy_loss": -0.011024795096988478, "vf_loss": 0.002170182690800478, "vf_explained_var": 0.8572845458984375, "kl": 0.007039321387807529, "entropy": -3.3562220176060995, "entropy_coeff": 0.0}}, "num_steps_sampled": 115200, "num_steps_trained": 115200}, "done": false, "episodes_total": 112, "training_iteration": 6, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-19-07", "timestamp": 1617635947, "time_this_iter_s": 10.048426389694214, "time_total_s": 59.90933537483215, "pid": 9438, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 59.90933537483215, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 48.44285714285716, "ram_util_percent": 58.14285714285715}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.18128827751134025, "episode_reward_min": -0.5092752069440141, "episode_reward_mean": -0.22916896220459101, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.14757459348882762, -0.18403827429519226, -0.39075581357072753, -0.17476385652667126, -0.08647921006728898, -0.43970878551009573, -0.27685634910606666, -0.09013312832463849, -0.4700544900557541, -0.24737671002466577, -0.2341520744503156, 0.18128827751134025, -0.29788449872959655, -0.5092752069440141, -0.14000535205770226, -0.15893332963323958], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14114657921971802, "mean_inference_ms": 0.9829532424890215, "mean_action_processing_ms": 0.04235085027012315, "mean_env_wait_ms": 0.9370316494906361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 134400, "timers": {"sample_time_ms": 5970.701, "sample_throughput": 3215.703, "learn_time_ms": 5425.459, "learn_throughput": 3538.871, "update_time_ms": 1.597}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.00039144485257565977, "policy_loss": -0.009267355327804884, "vf_loss": 0.0024403214563305177, "vf_explained_var": 0.8633579611778259, "kl": 0.006435588508223494, "entropy": -3.3816264502207436, "entropy_coeff": 0.0}}, "num_steps_sampled": 134400, "num_steps_trained": 134400}, "done": false, "episodes_total": 128, "training_iteration": 7, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-21-23", "timestamp": 1617636083, "time_this_iter_s": 11.400545835494995, "time_total_s": 71.30988121032715, "pid": 10735, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.400545835494995, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.370588235294115, "ram_util_percent": 60.329411764705874}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.30386540565582565, "episode_reward_min": -0.5975275822671529, "episode_reward_mean": -0.2183063997171022, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.06656988760546678, -0.43263048287068173, -0.1924761999600897, -0.5975275822671529, 0.019536048084110025, -0.31576681855653455, -0.2266632173252422, -0.209292442980763, -0.35197808357085403, -0.08674377381523501, -0.34946023394770764, -0.4121713479549843, -0.29890664384537013, 0.30386540565582565, -0.5030085562869209, 0.26755264636231946, -0.14757459348882762, -0.18403827429519226, -0.39075581357072753, -0.17476385652667126, -0.08647921006728898, -0.43970878551009573, -0.27685634910606666, -0.09013312832463849, -0.4700544900557541, -0.24737671002466577, -0.2341520744503156, 0.18128827751134025, -0.29788449872959655, -0.5092752069440141, -0.14000535205770226, -0.15893332963323958], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14218920764360427, "mean_inference_ms": 0.9784900993210109, "mean_action_processing_ms": 0.042109520544568506, "mean_env_wait_ms": 0.9228994656990781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 153600, "timers": {"sample_time_ms": 5720.948, "sample_throughput": 3356.087, "learn_time_ms": 5606.078, "learn_throughput": 3424.854, "update_time_ms": 1.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.00047887403207520643, "policy_loss": -0.009443943379446864, "vf_loss": 0.002258996025193483, "vf_explained_var": 0.8293046951293945, "kl": 0.006706072824696699, "entropy": -3.373428915341695, "entropy_coeff": 0.0}}, "num_steps_sampled": 153600, "num_steps_trained": 153600}, "done": false, "episodes_total": 144, "training_iteration": 8, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-21-35", "timestamp": 1617636095, "time_this_iter_s": 11.265538930892944, "time_total_s": 82.57542014122009, "pid": 10735, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.66608476638794, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.431250000000006, "ram_util_percent": 60.45}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.5635819510647746, "episode_reward_min": -0.5975275822671529, "episode_reward_mean": -0.21932403482338866, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3127432380071534, -0.028737577703045303, -0.3603952544590213, -0.31465508516121365, -0.39507989919352293, -0.44870306507328794, 0.3468213094559449, -0.22007130069147762, -0.037079414898783636, -0.38954257702620443, -0.5237812594586296, -0.22954886986582357, 0.0168874344941492, 0.5635819510647746, -0.44780104180907077, -0.08279719953106746, -0.5803391679563228, -0.3241185660881738, -0.003930059009763509, -0.0588861026173616, -0.462654720188787, -0.3454508336236446, -0.38607153138200684, -0.2712450904330018, -0.14757459348882762, -0.18403827429519226, -0.39075581357072753, -0.17476385652667126, -0.08647921006728898, -0.43970878551009573, -0.27685634910606666, -0.09013312832463849, -0.4700544900557541, -0.24737671002466577, -0.2341520744503156, 0.18128827751134025, -0.29788449872959655, -0.5092752069440141, -0.14000535205770226, -0.15893332963323958, 0.06656988760546678, -0.43263048287068173, -0.1924761999600897, -0.5975275822671529, 0.019536048084110025, -0.31576681855653455, -0.2266632173252422, -0.209292442980763, -0.35197808357085403, -0.08674377381523501, -0.34946023394770764, -0.4121713479549843, -0.29890664384537013, 0.30386540565582565, -0.5030085562869209, 0.26755264636231946], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14468800814402788, "mean_inference_ms": 0.9862443404107852, "mean_action_processing_ms": 0.041995218834785394, "mean_env_wait_ms": 0.9139917076951134, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 172800, "timers": {"sample_time_ms": 5740.973, "sample_throughput": 3344.381, "learn_time_ms": 5637.43, "learn_throughput": 3405.807, "update_time_ms": 1.59}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.0013642332268257937, "policy_loss": -0.00961376932449639, "vf_loss": 0.0018436703776630262, "vf_explained_var": 0.8482755422592163, "kl": 0.006405865630755822, "entropy": -3.4033526357014976, "entropy_coeff": 0.0}}, "num_steps_sampled": 172800, "num_steps_trained": 172800}, "done": false, "episodes_total": 168, "training_iteration": 9, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-21-46", "timestamp": 1617636106, "time_this_iter_s": 11.488651990890503, "time_total_s": 94.0640721321106, "pid": 10735, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.15473675727844, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.975, "ram_util_percent": 60.75}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.5635819510647746, "episode_reward_min": -0.6452837748007552, "episode_reward_mean": -0.2145692565394305, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.4561224549462919, -0.24342406773265002, -0.44276307126054976, -0.44274773164266557, -0.39911676463815027, -0.3274098673186374, -0.30106460971763405, -0.48549316749707816, -0.5598680375308753, -0.29717413462596076, -0.6452837748007552, 0.41005574293493674, -0.17576392503007954, 0.1973788468413824, -0.034498812144340585, 0.12421039848753734, -0.14757459348882762, -0.18403827429519226, -0.39075581357072753, -0.17476385652667126, -0.08647921006728898, -0.43970878551009573, -0.27685634910606666, -0.09013312832463849, -0.4700544900557541, -0.24737671002466577, -0.2341520744503156, 0.18128827751134025, -0.29788449872959655, -0.5092752069440141, -0.14000535205770226, -0.15893332963323958, 0.06656988760546678, -0.43263048287068173, -0.1924761999600897, -0.5975275822671529, 0.019536048084110025, -0.31576681855653455, -0.2266632173252422, -0.209292442980763, -0.35197808357085403, -0.08674377381523501, -0.34946023394770764, -0.4121713479549843, -0.29890664384537013, 0.30386540565582565, -0.5030085562869209, 0.26755264636231946, -0.3127432380071534, -0.028737577703045303, -0.3603952544590213, -0.31465508516121365, -0.39507989919352293, -0.44870306507328794, 0.3468213094559449, -0.22007130069147762, -0.037079414898783636, -0.38954257702620443, -0.5237812594586296, -0.22954886986582357, 0.0168874344941492, 0.5635819510647746, -0.44780104180907077, -0.08279719953106746, -0.5803391679563228, -0.3241185660881738, -0.003930059009763509, -0.0588861026173616, -0.462654720188787, -0.3454508336236446, -0.38607153138200684, -0.2712450904330018], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1450543863209636, "mean_inference_ms": 0.9901038627619366, "mean_action_processing_ms": 0.04208528422188697, "mean_env_wait_ms": 0.9133395169850524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 192000, "timers": {"sample_time_ms": 5734.59, "sample_throughput": 3348.104, "learn_time_ms": 5661.404, "learn_throughput": 3391.385, "update_time_ms": 1.654}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.0006953040727724632, "policy_loss": -0.010029374789446592, "vf_loss": 0.0022631216250980895, "vf_explained_var": 0.8243103623390198, "kl": 0.007070949925109744, "entropy": -3.3852052116394042, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 184, "training_iteration": 10, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-21-58", "timestamp": 1617636118, "time_this_iter_s": 11.461483240127563, "time_total_s": 105.52555537223816, "pid": 10735, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.616219997406006, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.39411764705882, "ram_util_percent": 59.38235294117647}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.5635819510647746, "episode_reward_min": -0.689446237164357, "episode_reward_mean": -0.2244593791368249, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.351846517979037, 0.1580537981810739, -0.20761294876838154, -0.08954401890988495, -0.31939733910870316, -0.689446237164357, -0.28467824842804923, -0.05430791555066161, -0.41204641244351436, -0.4027151779838963, -0.4281644412241927, -0.44178963735562754, -0.335714221787184, -0.09464766462997909, -0.4434741580553419, -0.3482957848380687, -0.33664171655675823, -0.3749472332478688, -0.3622498674448917, -0.2944388081653603, 0.022263593929776393, 0.18242285549877013, -0.1649912096559344, -0.024904614608124542, -0.14757459348882762, -0.18403827429519226, -0.39075581357072753, -0.17476385652667126, -0.08647921006728898, -0.43970878551009573, -0.27685634910606666, -0.09013312832463849, -0.4700544900557541, -0.24737671002466577, -0.2341520744503156, 0.18128827751134025, -0.29788449872959655, -0.5092752069440141, -0.14000535205770226, -0.15893332963323958, 0.06656988760546678, -0.43263048287068173, -0.1924761999600897, -0.5975275822671529, 0.019536048084110025, -0.31576681855653455, -0.2266632173252422, -0.209292442980763, -0.35197808357085403, -0.08674377381523501, -0.34946023394770764, -0.4121713479549843, -0.29890664384537013, 0.30386540565582565, -0.5030085562869209, 0.26755264636231946, -0.3127432380071534, -0.028737577703045303, -0.3603952544590213, -0.31465508516121365, -0.39507989919352293, -0.44870306507328794, 0.3468213094559449, -0.22007130069147762, -0.037079414898783636, -0.38954257702620443, -0.5237812594586296, -0.22954886986582357, 0.0168874344941492, 0.5635819510647746, -0.44780104180907077, -0.08279719953106746, -0.5803391679563228, -0.3241185660881738, -0.003930059009763509, -0.0588861026173616, -0.462654720188787, -0.3454508336236446, -0.38607153138200684, -0.2712450904330018, 0.4561224549462919, -0.24342406773265002, -0.44276307126054976, -0.44274773164266557, -0.39911676463815027, -0.3274098673186374, -0.30106460971763405, -0.48549316749707816, -0.5598680375308753, -0.29717413462596076, -0.6452837748007552, 0.41005574293493674, -0.17576392503007954, 0.1973788468413824, -0.034498812144340585, 0.12421039848753734], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14735908928412236, "mean_inference_ms": 0.9980881186164678, "mean_action_processing_ms": 0.0424460244110022, "mean_env_wait_ms": 0.917900203446218, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 211200, "timers": {"sample_time_ms": 5821.826, "sample_throughput": 3297.934, "learn_time_ms": 5692.109, "learn_throughput": 3373.091, "update_time_ms": 1.61}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.0014319160301238297, "policy_loss": -0.009889087276533245, "vf_loss": 0.0019304684433154762, "vf_explained_var": 0.8474107384681702, "kl": 0.006526701726640264, "entropy": -3.3908038266499836, "entropy_coeff": 0.0}}, "num_steps_sampled": 211200, "num_steps_trained": 211200}, "done": false, "episodes_total": 208, "training_iteration": 11, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-22-10", "timestamp": 1617636130, "time_this_iter_s": 11.994881391525269, "time_total_s": 117.52043676376343, "pid": 10735, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 57.611101388931274, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 52.435294117647054, "ram_util_percent": 59.8764705882353}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.23215843634902167, "episode_reward_min": -0.5380072482656992, "episode_reward_mean": -0.29335060060942963, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4947808167941237, -0.5027966832610464, -0.14867651020050032, -0.37516488535241105, -0.09634111053206573, -0.37569169663512797, -0.16475564401224152, -0.2689683338717962, -0.32859939294188945, 0.23215843634902167, -0.31462049903972245, -0.13566297774850233, -0.5380072482656992, -0.24352976449015207, -0.4291784134033784, -0.5089940695512385], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1132558753519245, "mean_inference_ms": 0.8054875374237531, "mean_action_processing_ms": 0.03450909091849369, "mean_env_wait_ms": 0.7374350203419169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 230400, "timers": {"sample_time_ms": 4926.883, "sample_throughput": 3896.987, "learn_time_ms": 5864.551, "learn_throughput": 3273.908, "update_time_ms": 1.406}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.001990677872672677, "policy_loss": -0.01131422134116292, "vf_loss": 0.002165610259398818, "vf_explained_var": 0.8546717166900635, "kl": 0.007157933140794436, "entropy": -3.3983198547363282, "entropy_coeff": 0.0}}, "num_steps_sampled": 230400, "num_steps_trained": 230400}, "done": false, "episodes_total": 224, "training_iteration": 12, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-24-08", "timestamp": 1617636248, "time_this_iter_s": 10.796462059020996, "time_total_s": 128.31689882278442, "pid": 12326, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.796462059020996, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.099999999999994, "ram_util_percent": 61.25}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.27735703800611944, "episode_reward_min": -0.5380072482656992, "episode_reward_mean": -0.1803671983440276, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.11188730157637383, -0.1808188598682029, -0.06879069972906804, -0.19473675014306513, 0.17472647430565935, -0.24290129544771577, -0.3644588443524478, -0.4272610677014087, 0.27735703800611944, -0.04473575307524047, -0.2954874486878427, -0.06558604537167878, 0.261387182832302, 0.23033962483889536, 0.15019370830449685, -0.17548069959243884, -0.4947808167941237, -0.5027966832610464, -0.14867651020050032, -0.37516488535241105, -0.09634111053206573, -0.37569169663512797, -0.16475564401224152, -0.2689683338717962, -0.32859939294188945, 0.23215843634902167, -0.31462049903972245, -0.13566297774850233, -0.5380072482656992, -0.24352976449015207, -0.4291784134033784, -0.5089940695512385], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12547175554078532, "mean_inference_ms": 0.887097915602928, "mean_action_processing_ms": 0.0380864370910091, "mean_env_wait_ms": 0.8128459894899089, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 249600, "timers": {"sample_time_ms": 5592.816, "sample_throughput": 3432.976, "learn_time_ms": 6314.127, "learn_throughput": 3040.8, "update_time_ms": 1.538}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.001333343219012022, "policy_loss": -0.011013448542604843, "vf_loss": 0.0023265748874594767, "vf_explained_var": 0.8107967972755432, "kl": 0.007353529787311951, "entropy": -3.3868496513366697, "entropy_coeff": 0.0}}, "num_steps_sampled": 249600, "num_steps_trained": 249600}, "done": false, "episodes_total": 240, "training_iteration": 13, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-24-21", "timestamp": 1617636261, "time_this_iter_s": 13.032326698303223, "time_total_s": 141.34922552108765, "pid": 12326, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.82878875732422, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 60.378947368421066, "ram_util_percent": 61.56315789473683}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 0.8932255455329827, "episode_reward_min": -0.5650802840253147, "episode_reward_mean": -0.07051360243053158, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.005447107357717806, -0.06301470493134742, 0.5904914393627965, 0.2780226345462957, 0.6747531521399888, 0.13961104140620972, 0.007369354243162096, 0.06044045337297366, -0.059251426310020894, 0.352143116673852, 0.10924255339982913, 0.8932255455329827, -0.26586302217040436, -0.1858560925122419, -0.21170177085169162, -0.5650802840253147, 0.45272034154534313, -0.06988340829910289, -0.1460012581830875, -0.48124552728861975, 0.0008145413802638224, 0.1323969807310177, 0.15114196912594902, 0.023065874652564933, -0.4947808167941237, -0.5027966832610464, -0.14867651020050032, -0.37516488535241105, -0.09634111053206573, -0.37569169663512797, -0.16475564401224152, -0.2689683338717962, -0.32859939294188945, 0.23215843634902167, -0.31462049903972245, -0.13566297774850233, -0.5380072482656992, -0.24352976449015207, -0.4291784134033784, -0.5089940695512385, -0.11188730157637383, -0.1808188598682029, -0.06879069972906804, -0.19473675014306513, 0.17472647430565935, -0.24290129544771577, -0.3644588443524478, -0.4272610677014087, 0.27735703800611944, -0.04473575307524047, -0.2954874486878427, -0.06558604537167878, 0.261387182832302, 0.23033962483889536, 0.15019370830449685, -0.17548069959243884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13916135642111055, "mean_inference_ms": 0.9534423191206696, "mean_action_processing_ms": 0.040502230715547316, "mean_env_wait_ms": 0.8635523011408482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 268800, "timers": {"sample_time_ms": 5918.371, "sample_throughput": 3244.136, "learn_time_ms": 6161.808, "learn_throughput": 3115.968, "update_time_ms": 1.609}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.0017273365830381712, "policy_loss": -0.012262235286956032, "vf_loss": 0.002724102644715458, "vf_explained_var": 0.8036326169967651, "kl": 0.007810796098783612, "entropy": -3.394728684425354, "entropy_coeff": 0.0}}, "num_steps_sampled": 268800, "num_steps_trained": 268800}, "done": false, "episodes_total": 264, "training_iteration": 14, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-24-33", "timestamp": 1617636273, "time_this_iter_s": 12.435230493545532, "time_total_s": 153.78445601463318, "pid": 12326, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 36.26401925086975, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 55.79411764705883, "ram_util_percent": 61.52352941176471}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 1.162744088335844, "episode_reward_min": -0.5650802840253147, "episode_reward_mean": -0.04285981080268429, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0036054538010603654, -0.2054319806231657, 1.162744088335844, -0.07758799640926073, 0.18924077856710642, 0.21898529251495424, -0.47349752129669687, -0.28342776942607606, 0.04446132903135713, -0.057383700890404676, 0.13307914182925007, -0.29099127690006565, 0.03659948317076811, 0.06068371291026797, 0.4952156647687205, -0.09343934106715979, -0.4947808167941237, -0.5027966832610464, -0.14867651020050032, -0.37516488535241105, -0.09634111053206573, -0.37569169663512797, -0.16475564401224152, -0.2689683338717962, -0.32859939294188945, 0.23215843634902167, -0.31462049903972245, -0.13566297774850233, -0.5380072482656992, -0.24352976449015207, -0.4291784134033784, -0.5089940695512385, -0.11188730157637383, -0.1808188598682029, -0.06879069972906804, -0.19473675014306513, 0.17472647430565935, -0.24290129544771577, -0.3644588443524478, -0.4272610677014087, 0.27735703800611944, -0.04473575307524047, -0.2954874486878427, -0.06558604537167878, 0.261387182832302, 0.23033962483889536, 0.15019370830449685, -0.17548069959243884, 0.005447107357717806, -0.06301470493134742, 0.5904914393627965, 0.2780226345462957, 0.6747531521399888, 0.13961104140620972, 0.007369354243162096, 0.06044045337297366, -0.059251426310020894, 0.352143116673852, 0.10924255339982913, 0.8932255455329827, -0.26586302217040436, -0.1858560925122419, -0.21170177085169162, -0.5650802840253147, 0.45272034154534313, -0.06988340829910289, -0.1460012581830875, -0.48124552728861975, 0.0008145413802638224, 0.1323969807310177, 0.15114196912594902, 0.023065874652564933], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14074699829259169, "mean_inference_ms": 0.9593402641077924, "mean_action_processing_ms": 0.040669089952112734, "mean_env_wait_ms": 0.8654345571136501, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 288000, "timers": {"sample_time_ms": 5531.375, "sample_throughput": 3471.108, "learn_time_ms": 5962.817, "learn_throughput": 3219.955, "update_time_ms": 1.612}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.00035478369643290837, "policy_loss": -0.010583444734414419, "vf_loss": 0.0028393403518324097, "vf_explained_var": 0.8454273343086243, "kl": 0.007389320265501737, "entropy": -3.4138321908315024, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 280, "training_iteration": 15, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-24-43", "timestamp": 1617636283, "time_this_iter_s": 9.744826793670654, "time_total_s": 163.52928280830383, "pid": 12326, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.008846044540405, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.992857142857144, "ram_util_percent": 61.671428571428564}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 1.162744088335844, "episode_reward_min": -0.5650802840253147, "episode_reward_mean": -0.010245229737826655, "episode_len_mean": 1000.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.360166914974809, -0.09990032580166774, -0.35176505217656906, 0.061377974896724696, -0.06909955450924532, 0.3411539191427433, -0.098484421557679, -0.18121675653987757, -0.04790539278735617, -0.007391556598004723, -0.052907790752776185, 0.11505366780053827, 0.04027087585248057, -0.3372976804984018, -0.23620034572324344, 0.3268003465744085, 0.22809162738173727, 0.3794643549903385, 1.0773095158958124, -0.20907724566754737, 0.2645573088790698, -0.15688209024437694, 0.5831313374473011, 0.17311469198269203, -0.4947808167941237, -0.5027966832610464, -0.14867651020050032, -0.37516488535241105, -0.09634111053206573, -0.37569169663512797, -0.16475564401224152, -0.2689683338717962, -0.32859939294188945, 0.23215843634902167, -0.31462049903972245, -0.13566297774850233, -0.5380072482656992, -0.24352976449015207, -0.4291784134033784, -0.5089940695512385, -0.11188730157637383, -0.1808188598682029, -0.06879069972906804, -0.19473675014306513, 0.17472647430565935, -0.24290129544771577, -0.3644588443524478, -0.4272610677014087, 0.27735703800611944, -0.04473575307524047, -0.2954874486878427, -0.06558604537167878, 0.261387182832302, 0.23033962483889536, 0.15019370830449685, -0.17548069959243884, 0.005447107357717806, -0.06301470493134742, 0.5904914393627965, 0.2780226345462957, 0.6747531521399888, 0.13961104140620972, 0.007369354243162096, 0.06044045337297366, -0.059251426310020894, 0.352143116673852, 0.10924255339982913, 0.8932255455329827, -0.26586302217040436, -0.1858560925122419, -0.21170177085169162, -0.5650802840253147, 0.45272034154534313, -0.06988340829910289, -0.1460012581830875, -0.48124552728861975, 0.0008145413802638224, 0.1323969807310177, 0.15114196912594902, 0.023065874652564933, 0.0036054538010603654, -0.2054319806231657, 1.162744088335844, -0.07758799640926073, 0.18924077856710642, 0.21898529251495424, -0.47349752129669687, -0.28342776942607606, 0.04446132903135713, -0.057383700890404676, 0.13307914182925007, -0.29099127690006565, 0.03659948317076811, 0.06068371291026797, 0.4952156647687205, -0.09343934106715979], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14169346434670002, "mean_inference_ms": 0.9551505650464712, "mean_action_processing_ms": 0.04044091122611033, "mean_env_wait_ms": 0.8582044964865078, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 307200, "timers": {"sample_time_ms": 5310.655, "sample_throughput": 3615.373, "learn_time_ms": 5935.558, "learn_throughput": 3234.742, "update_time_ms": 1.624}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.002000309551773071, "total_loss": -0.0005430207587778568, "policy_loss": -0.010564123624935745, "vf_loss": 0.003059373254266878, "vf_explained_var": 0.8198091387748718, "kl": 0.006961730690672994, "entropy": -3.4176141007741294, "entropy_coeff": 0.0}}, "num_steps_sampled": 307200, "num_steps_trained": 307200}, "done": false, "episodes_total": 304, "training_iteration": 16, "experiment_id": "bb8bca7272f54999a01a8dd6f8cb5393", "date": "2021-04-05_08-24-53", "timestamp": 1617636293, "time_this_iter_s": 10.263898849487305, "time_total_s": 173.79318165779114, "pid": 12326, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 19131, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 6, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0020003095517730704, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9514409094692471, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2661360372709266, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 56.27274489402771, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 34.49999999999999, "ram_util_percent": 59.93333333333333}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 35.32938449059671, "episode_reward_min": 8.208545523491486, "episode_reward_mean": 15.047259642820189, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.629028499260098, 11.993263045673762, 8.208545523491486, 8.5719106221142, 8.771050367230744, 35.32938449059671, 23.8808807126706, 13.994013881523916], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2261806584238485, "mean_inference_ms": 1.3163788180139793, "mean_action_processing_ms": 0.054537412302707, "mean_env_wait_ms": 1.3519832858586593, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 272000, "timers": {"sample_time_ms": 46761.731, "sample_throughput": 273.728, "learn_time_ms": 4272.256, "learn_throughput": 2996.075, "update_time_ms": 1.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 7.450277616020607e+17, "policy_loss": 0.04023672091231371, "vf_loss": 7.450277616020607e+17, "vf_explained_var": -1.4191582353717536e-09, "kl": 0.6309362983419782, "entropy": -4.313404980159941, "entropy_coeff": 0.0}}, "num_steps_sampled": 272000, "num_steps_trained": 272000}, "done": false, "episodes_total": 256, "training_iteration": 28, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-25-52", "timestamp": 1617636352, "time_this_iter_s": 51.03890585899353, "time_total_s": 212.35164189338684, "pid": 12930, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12714, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.03890585899353, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.34520547945205, "ram_util_percent": 61.71506849315068}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 8.647275044820372, "episode_reward_min": 2.856291333002372, "episode_reward_mean": 6.279370916438015, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.210442006331913, 6.117483082377043, 5.892424529142168, 8.079606353675835, 5.2389680984683595, 2.856291333002372, 6.192476883686067, 8.647275044820372], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16258477345620892, "mean_inference_ms": 0.9632870080246171, "mean_action_processing_ms": 0.0413004716138107, "mean_env_wait_ms": 0.9454683092964358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 284800, "timers": {"sample_time_ms": 8368.293, "sample_throughput": 1529.583, "learn_time_ms": 4412.037, "learn_throughput": 2901.154, "update_time_ms": 1.42}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 4.9860088148718315e+20, "policy_loss": 0.049357461336989046, "vf_loss": 4.9860088148718315e+20, "vf_explained_var": 2.9092742437342167e-08, "kl": 1.2849902255194527, "entropy": -5.329878273464384, "entropy_coeff": 0.0}}, "num_steps_sampled": 284800, "num_steps_trained": 284800}, "done": false, "episodes_total": 264, "training_iteration": 29, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-50", "timestamp": 1617636470, "time_this_iter_s": 12.784785032272339, "time_total_s": 225.13642692565918, "pid": 15109, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12714, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.784785032272339, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 55.12105263157895, "ram_util_percent": 59.17894736842104}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 8.647275044820372, "episode_reward_min": -0.6144416089764173, "episode_reward_mean": 2.775184086160891, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7832769600427132, -0.2539042517769119, 1.2781456026653757, -0.40767756039238384, 1.5507925728311336, -0.25485759320000034, 1.1479050492553013, -0.6144416089764173, 4.076831343158801, 0.09494126175542417, 1.6151788156642035, -0.09094821653418583, 2.521051477252277, 0.9721749145898275, 4.534836021427408, -0.5838540514053112, 7.210442006331913, 6.117483082377043, 5.892424529142168, 8.079606353675835, 5.2389680984683595, 2.856291333002372, 6.192476883686067, 8.647275044820372], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18462729133850939, "mean_inference_ms": 0.9901313594402078, "mean_action_processing_ms": 0.04218434843725325, "mean_env_wait_ms": 0.9552760115389908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 297600, "timers": {"sample_time_ms": 6187.585, "sample_throughput": 2068.659, "learn_time_ms": 4189.222, "learn_throughput": 3055.46, "update_time_ms": 1.39}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 3.169634189789006e+23, "policy_loss": 0.07128033650085508, "vf_loss": 3.169634189789006e+23, "vf_explained_var": 0.0, "kl": 0.20705735186735788, "entropy": -5.4050739379156205, "entropy_coeff": 0.0}}, "num_steps_sampled": 297600, "num_steps_trained": 297600}, "done": false, "episodes_total": 280, "training_iteration": 30, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-27-58", "timestamp": 1617636478, "time_this_iter_s": 7.980090618133545, "time_total_s": 233.11651754379272, "pid": 15109, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12714, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.764875650405884, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.21818181818182, "ram_util_percent": 61.36363636363637}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 8.647275044820372, "episode_reward_min": -0.7170344113404734, "episode_reward_mean": 1.9840075919698932, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.20133940315050936, -0.40096994417177245, 0.2623410119591325, -0.29053736799999474, -0.5109083499645538, -0.7170344113404734, -0.5955048921978363, -0.6622217679587938, 7.210442006331913, 6.117483082377043, 5.892424529142168, 8.079606353675835, 5.2389680984683595, 2.856291333002372, 6.192476883686067, 8.647275044820372, 0.7832769600427132, -0.2539042517769119, 1.2781456026653757, -0.40767756039238384, 1.5507925728311336, -0.25485759320000034, 1.1479050492553013, -0.6144416089764173, 4.076831343158801, 0.09494126175542417, 1.6151788156642035, -0.09094821653418583, 2.521051477252277, 0.9721749145898275, 4.534836021427408, -0.5838540514053112], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18802126940491637, "mean_inference_ms": 1.016041070704453, "mean_action_processing_ms": 0.04281543735523196, "mean_env_wait_ms": 0.967718181930145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 310400, "timers": {"sample_time_ms": 5654.482, "sample_throughput": 2263.691, "learn_time_ms": 4090.015, "learn_throughput": 3129.573, "update_time_ms": 1.48}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 8.542095463436745e+23, "policy_loss": -0.00038813664078978557, "vf_loss": 8.542095463436745e+23, "vf_explained_var": 0.0, "kl": 0.00013353295660289448, "entropy": -5.3901001044682095, "entropy_coeff": 0.0}}, "num_steps_sampled": 310400, "num_steps_trained": 310400}, "done": false, "episodes_total": 288, "training_iteration": 31, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-06", "timestamp": 1617636486, "time_this_iter_s": 8.48630428314209, "time_total_s": 241.60282182693481, "pid": 15109, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12714, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.251179933547974, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 49.34166666666666, "ram_util_percent": 61.73333333333334}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 8.647275044820372, "episode_reward_min": -0.7526621033036857, "episode_reward_mean": 1.1442899198115015, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6615727049822195, -0.5735640043970145, -0.6777041572917831, -0.6443000151867426, -0.660231510756561, -0.13460476625707585, -0.4386684245308802, -0.5513411822026493, -0.5262849812052521, -0.6372722216347317, -0.6031285499189418, -0.5554212615727712, -0.7526621033036857, -0.2530688620175705, -0.4500680523426591, -0.44243399448397097, 7.210442006331913, 6.117483082377043, 5.892424529142168, 8.079606353675835, 5.2389680984683595, 2.856291333002372, 6.192476883686067, 8.647275044820372, 0.7832769600427132, -0.2539042517769119, 1.2781456026653757, -0.40767756039238384, 1.5507925728311336, -0.25485759320000034, 1.1479050492553013, -0.6144416089764173, 4.076831343158801, 0.09494126175542417, 1.6151788156642035, -0.09094821653418583, 2.521051477252277, 0.9721749145898275, 4.534836021427408, -0.5838540514053112, -0.20133940315050936, -0.40096994417177245, 0.2623410119591325, -0.29053736799999474, -0.5109083499645538, -0.7170344113404734, -0.5955048921978363, -0.6622217679587938], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19562608225927058, "mean_inference_ms": 1.04499936614242, "mean_action_processing_ms": 0.04369670364014746, "mean_env_wait_ms": 0.9847666353080665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 323200, "timers": {"sample_time_ms": 5373.292, "sample_throughput": 2382.152, "learn_time_ms": 4104.753, "learn_throughput": 3118.336, "update_time_ms": 1.497}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.125, "cur_lr": 0.01, "total_loss": 1.3111963989631878e+24, "policy_loss": 9.744094443574016e-06, "vf_loss": 1.3111963989631878e+24, "vf_explained_var": 0.0, "kl": 0.00010528945321788168, "entropy": -5.400741531735375, "entropy_coeff": 0.0}}, "num_steps_sampled": 323200, "num_steps_trained": 323200}, "done": false, "episodes_total": 304, "training_iteration": 32, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-15", "timestamp": 1617636495, "time_this_iter_s": 8.686432600021362, "time_total_s": 250.28925442695618, "pid": 15109, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12714, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.937612533569336, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 46.47692307692308, "ram_util_percent": 61.99230769230769}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 8.647275044820372, "episode_reward_min": -0.7653519034864747, "episode_reward_mean": 0.7639745341708958, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.15094347372817718, -0.7473965000175482, -0.23573320621896054, -0.5919064130189821, 0.28779239823759917, -0.7462715420136151, -0.38165016642757904, -0.26654579627422614, -0.5876660213931916, -0.23566230669024857, -0.6010384345862159, 0.09328213416913078, -0.5629385353111634, -0.4127334167177805, -0.42866972799366365, -0.7653519034864747, 7.210442006331913, 6.117483082377043, 5.892424529142168, 8.079606353675835, 5.2389680984683595, 2.856291333002372, 6.192476883686067, 8.647275044820372, 0.7832769600427132, -0.2539042517769119, 1.2781456026653757, -0.40767756039238384, 1.5507925728311336, -0.25485759320000034, 1.1479050492553013, -0.6144416089764173, 4.076831343158801, 0.09494126175542417, 1.6151788156642035, -0.09094821653418583, 2.521051477252277, 0.9721749145898275, 4.534836021427408, -0.5838540514053112, -0.20133940315050936, -0.40096994417177245, 0.2623410119591325, -0.29053736799999474, -0.5109083499645538, -0.7170344113404734, -0.5955048921978363, -0.6622217679587938, -0.6615727049822195, -0.5735640043970145, -0.6777041572917831, -0.6443000151867426, -0.660231510756561, -0.13460476625707585, -0.4386684245308802, -0.5513411822026493, -0.5262849812052521, -0.6372722216347317, -0.6031285499189418, -0.5554212615727712, -0.7526621033036857, -0.2530688620175705, -0.4500680523426591, -0.44243399448397097], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20010429957141607, "mean_inference_ms": 1.0535798818738726, "mean_action_processing_ms": 0.043960307821253625, "mean_env_wait_ms": 0.9879810201888752, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 336000, "timers": {"sample_time_ms": 5063.421, "sample_throughput": 2527.935, "learn_time_ms": 4172.669, "learn_throughput": 3067.581, "update_time_ms": 1.572}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5625, "cur_lr": 0.01, "total_loss": 2.738008860686554e+25, "policy_loss": 0.0004929665679117621, "vf_loss": 2.738008860686554e+25, "vf_explained_var": 0.0, "kl": 2.113091894292059e-05, "entropy": -5.408651346252078, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 320, "training_iteration": 33, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-23", "timestamp": 1617636503, "time_this_iter_s": 8.275521993637085, "time_total_s": 258.56477642059326, "pid": 15109, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12714, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.21313452720642, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 47.03333333333333, "ram_util_percent": 61.725000000000016}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 8.647275044820372, "episode_reward_min": -0.7653519034864747, "episode_reward_mean": 0.6498757583372506, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4831151968565833, 0.5357949187882127, -0.42288465693964006, -0.5103937623724273, -0.3094832664005189, -0.543629406867821, -0.19092984921967482, -0.17867436678682747, 7.210442006331913, 6.117483082377043, 5.892424529142168, 8.079606353675835, 5.2389680984683595, 2.856291333002372, 6.192476883686067, 8.647275044820372, 0.7832769600427132, -0.2539042517769119, 1.2781456026653757, -0.40767756039238384, 1.5507925728311336, -0.25485759320000034, 1.1479050492553013, -0.6144416089764173, 4.076831343158801, 0.09494126175542417, 1.6151788156642035, -0.09094821653418583, 2.521051477252277, 0.9721749145898275, 4.534836021427408, -0.5838540514053112, -0.20133940315050936, -0.40096994417177245, 0.2623410119591325, -0.29053736799999474, -0.5109083499645538, -0.7170344113404734, -0.5955048921978363, -0.6622217679587938, -0.6615727049822195, -0.5735640043970145, -0.6777041572917831, -0.6443000151867426, -0.660231510756561, -0.13460476625707585, -0.4386684245308802, -0.5513411822026493, -0.5262849812052521, -0.6372722216347317, -0.6031285499189418, -0.5554212615727712, -0.7526621033036857, -0.2530688620175705, -0.4500680523426591, -0.44243399448397097, 0.15094347372817718, -0.7473965000175482, -0.23573320621896054, -0.5919064130189821, 0.28779239823759917, -0.7462715420136151, -0.38165016642757904, -0.26654579627422614, -0.5876660213931916, -0.23566230669024857, -0.6010384345862159, 0.09328213416913078, -0.5629385353111634, -0.4127334167177805, -0.42866972799366365, -0.7653519034864747], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20028389329688462, "mean_inference_ms": 1.0515728239866111, "mean_action_processing_ms": 0.04386157639095645, "mean_env_wait_ms": 0.9842798141599789, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 348800, "timers": {"sample_time_ms": 4719.961, "sample_throughput": 2711.887, "learn_time_ms": 4206.397, "learn_throughput": 3042.984, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.28125, "cur_lr": 0.01, "total_loss": 1.8378052246568796e+25, "policy_loss": -0.0004145189942348571, "vf_loss": 1.8378052246568796e+25, "vf_explained_var": 0.0, "kl": 0.0, "entropy": -5.408651346252078, "entropy_coeff": 0.0}}, "num_steps_sampled": 348800, "num_steps_trained": 348800}, "done": false, "episodes_total": 328, "training_iteration": 34, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-31", "timestamp": 1617636511, "time_this_iter_s": 7.38802170753479, "time_total_s": 265.95279812812805, "pid": 15109, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12714, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 12, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.60115623474121, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.269999999999996, "ram_util_percent": 61.61}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": 19.14001197120022, "episode_reward_mean": 42.984125707841606, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2510399966092257, "mean_inference_ms": 1.2133687466650933, "mean_action_processing_ms": 0.05200415939003319, "mean_env_wait_ms": 1.2211356903765944, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 430400, "timers": {"sample_time_ms": 7594.613, "sample_throughput": 1053.378, "learn_time_ms": 1909.757, "learn_throughput": 4189.015, "update_time_ms": 1.417}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.00010000000000000003, "total_loss": 5.017861060050981e+18, "policy_loss": 0.04289255870225014, "vf_loss": 5.017861060050981e+18, "vf_explained_var": 0.0, "kl": 0.672650508160861, "entropy": -4.836722436940895, "entropy_coeff": 0.0}}, "num_steps_sampled": 430400, "num_steps_trained": 430400}, "done": false, "episodes_total": 408, "training_iteration": 45, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-47", "timestamp": 1617636527, "time_this_iter_s": 9.508668184280396, "time_total_s": 278.678115606308, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.508668184280396, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 65.82000000000001, "ram_util_percent": 58.766666666666666}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": 7.892557783057265, "episode_reward_mean": 28.68834830243113, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.173034222553188, 14.282460698375175, 16.433735761717042, 11.770124952932248, 25.72032966959456, 13.321195074834847, 7.892557783057265, 8.547129013100893, 36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24684246017348235, "mean_inference_ms": 1.2002066269338154, "mean_action_processing_ms": 0.05130609822274766, "mean_env_wait_ms": 1.1894712181635412, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 438400, "timers": {"sample_time_ms": 5212.628, "sample_throughput": 1534.734, "learn_time_ms": 1847.629, "learn_throughput": 4329.873, "update_time_ms": 1.499}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.00010000000000000003, "total_loss": 3.0245162960662254e+19, "policy_loss": 0.13498495461173216, "vf_loss": 3.0245162960662254e+19, "vf_explained_var": 0.0, "kl": 1.0375772748353347, "entropy": -5.516686178603262, "entropy_coeff": 0.0}}, "num_steps_sampled": 438400, "num_steps_trained": 438400}, "done": false, "episodes_total": 416, "training_iteration": 46, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-52", "timestamp": 1617636532, "time_this_iter_s": 4.6220481395721436, "time_total_s": 283.3001637458801, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.130716323852539, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 61.149999999999984, "ram_util_percent": 60.95000000000001}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": 1.9189894388411912, "episode_reward_mean": 20.533967485320893, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.268134838837754, 2.493721825806608, 5.433850666435474, 3.252462135687222, 1.9189894388411912, 7.2225789937543325, 2.607277781974854, 4.6046311274659635, 36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082, 17.173034222553188, 14.282460698375175, 16.433735761717042, 11.770124952932248, 25.72032966959456, 13.321195074834847, 7.892557783057265, 8.547129013100893], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23695869757466315, "mean_inference_ms": 1.1534271095367192, "mean_action_processing_ms": 0.049272120343103666, "mean_env_wait_ms": 1.1311837368999187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 446400, "timers": {"sample_time_ms": 4088.349, "sample_throughput": 1956.78, "learn_time_ms": 1761.106, "learn_throughput": 4542.6, "update_time_ms": 1.526}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.00010000000000000003, "total_loss": 7.779603300425387e+20, "policy_loss": 0.05152138098986503, "vf_loss": 7.779603300425387e+20, "vf_explained_var": 0.0, "kl": 0.3519581235804648, "entropy": -5.454708351279205, "entropy_coeff": 0.0}}, "num_steps_sampled": 446400, "num_steps_trained": 446400}, "done": false, "episodes_total": 424, "training_iteration": 47, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-28-55", "timestamp": 1617636535, "time_this_iter_s": 3.4339776039123535, "time_total_s": 286.7341413497925, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.564693927764893, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.72, "ram_util_percent": 61.239999999999995}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": 0.8219578701217614, "episode_reward_mean": 16.081658778697687, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.387781784402962, 2.374630607052322, 0.8219578701217614, 7.901512373877383, 2.8476054059452385, 1.0064233730142274, 1.6240955270232313, 3.8338543291874325, 36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082, 17.173034222553188, 14.282460698375175, 16.433735761717042, 11.770124952932248, 25.72032966959456, 13.321195074834847, 7.892557783057265, 8.547129013100893, 6.268134838837754, 2.493721825806608, 5.433850666435474, 3.252462135687222, 1.9189894388411912, 7.2225789937543325, 2.607277781974854, 4.6046311274659635], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23266759883975507, "mean_inference_ms": 1.1320450034608323, "mean_action_processing_ms": 0.048329288857560965, "mean_env_wait_ms": 1.1027620934181017, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 454400, "timers": {"sample_time_ms": 3729.484, "sample_throughput": 2145.069, "learn_time_ms": 1793.448, "learn_throughput": 4460.681, "update_time_ms": 1.499}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.00010000000000000003, "total_loss": 3.701153986149866e+21, "policy_loss": 0.0061547858552690946, "vf_loss": 3.701153986149866e+21, "vf_explained_var": 0.0, "kl": 0.10242695305145012, "entropy": -5.393193919703646, "entropy_coeff": 0.0}}, "num_steps_sampled": 454400, "num_steps_trained": 454400}, "done": false, "episodes_total": 432, "training_iteration": 48, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-00", "timestamp": 1617636540, "time_this_iter_s": 4.549909353256226, "time_total_s": 291.2840507030487, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.114603281021118, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 57.0, "ram_util_percent": 61.34285714285714}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": 0.17458245256781701, "episode_reward_mean": 13.108970862708087, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.148787792705459, 1.5805518291071836, 0.6689957083163129, 0.31916303452698225, 1.6757299216257038, 0.17458245256781701, 1.992987722337363, 2.18495512881065, 36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082, 17.173034222553188, 14.282460698375175, 16.433735761717042, 11.770124952932248, 25.72032966959456, 13.321195074834847, 7.892557783057265, 8.547129013100893, 6.268134838837754, 2.493721825806608, 5.433850666435474, 3.252462135687222, 1.9189894388411912, 7.2225789937543325, 2.607277781974854, 4.6046311274659635, 1.387781784402962, 2.374630607052322, 0.8219578701217614, 7.901512373877383, 2.8476054059452385, 1.0064233730142274, 1.6240955270232313, 3.8338543291874325], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22826341670449116, "mean_inference_ms": 1.1187662905008686, "mean_action_processing_ms": 0.04745296489300198, "mean_env_wait_ms": 1.0774308548408063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 462400, "timers": {"sample_time_ms": 3450.921, "sample_throughput": 2318.222, "learn_time_ms": 1750.134, "learn_throughput": 4571.078, "update_time_ms": 1.524}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.0625, "cur_lr": 0.00010000000000000003, "total_loss": 1.384698687550652e+22, "policy_loss": -0.0010862890499169534, "vf_loss": 1.384698687550652e+22, "vf_explained_var": 0.0, "kl": 0.025905147757170337, "entropy": -5.423354661689614, "entropy_coeff": 0.0}}, "num_steps_sampled": 462400, "num_steps_trained": 462400}, "done": false, "episodes_total": 440, "training_iteration": 49, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-04", "timestamp": 1617636544, "time_this_iter_s": 3.9189205169677734, "time_total_s": 295.2029712200165, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.03352379798889, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.2, "ram_util_percent": 61.339999999999996}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": -0.2858552836531892, "episode_reward_mean": 11.057728311245219, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2858552836531892, 0.6141770965144135, 0.45879624666086016, 1.4500712760528325, 1.4989687730066126, 0.9507855938016796, 1.1403497928995137, 0.5848309361642745, 36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082, 17.173034222553188, 14.282460698375175, 16.433735761717042, 11.770124952932248, 25.72032966959456, 13.321195074834847, 7.892557783057265, 8.547129013100893, 6.268134838837754, 2.493721825806608, 5.433850666435474, 3.252462135687222, 1.9189894388411912, 7.2225789937543325, 2.607277781974854, 4.6046311274659635, 1.387781784402962, 2.374630607052322, 0.8219578701217614, 7.901512373877383, 2.8476054059452385, 1.0064233730142274, 1.6240955270232313, 3.8338543291874325, 1.148787792705459, 1.5805518291071836, 0.6689957083163129, 0.31916303452698225, 1.6757299216257038, 0.17458245256781701, 1.992987722337363, 2.18495512881065], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22512651988897622, "mean_inference_ms": 1.1051772674085354, "mean_action_processing_ms": 0.04670021087190893, "mean_env_wait_ms": 1.0563230080689265, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 470400, "timers": {"sample_time_ms": 3267.565, "sample_throughput": 2448.307, "learn_time_ms": 1775.011, "learn_throughput": 4507.015, "update_time_ms": 1.533}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.59375, "cur_lr": 0.00010000000000000003, "total_loss": 3.478332551038231e+22, "policy_loss": 0.003718305677878407, "vf_loss": 3.478332551038231e+22, "vf_explained_var": 0.0, "kl": 0.008745719248182932, "entropy": -5.437795387124115, "entropy_coeff": 0.0}}, "num_steps_sampled": 470400, "num_steps_trained": 470400}, "done": false, "episodes_total": 448, "training_iteration": 50, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-08", "timestamp": 1617636548, "time_this_iter_s": 4.257404565811157, "time_total_s": 299.46037578582764, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.29092836380005, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.833333333333336, "ram_util_percent": 61.4}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": -0.2858552836531892, "episode_reward_mean": 9.568128313029506, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5027915232427471, 0.06194394441577633, -0.1858721439742863, 0.26241996835249837, 0.11481347456058599, 0.9801550646500432, 1.345923274068292, 0.9620514845661534, 36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082, 17.173034222553188, 14.282460698375175, 16.433735761717042, 11.770124952932248, 25.72032966959456, 13.321195074834847, 7.892557783057265, 8.547129013100893, 6.268134838837754, 2.493721825806608, 5.433850666435474, 3.252462135687222, 1.9189894388411912, 7.2225789937543325, 2.607277781974854, 4.6046311274659635, 1.387781784402962, 2.374630607052322, 0.8219578701217614, 7.901512373877383, 2.8476054059452385, 1.0064233730142274, 1.6240955270232313, 3.8338543291874325, 1.148787792705459, 1.5805518291071836, 0.6689957083163129, 0.31916303452698225, 1.6757299216257038, 0.17458245256781701, 1.992987722337363, 2.18495512881065, -0.2858552836531892, 0.6141770965144135, 0.45879624666086016, 1.4500712760528325, 1.4989687730066126, 0.9507855938016796, 1.1403497928995137, 0.5848309361642745], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2229483016632643, "mean_inference_ms": 1.0976445865332847, "mean_action_processing_ms": 0.04627377844920782, "mean_env_wait_ms": 1.0438395967640586, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 478400, "timers": {"sample_time_ms": 3197.131, "sample_throughput": 2502.243, "learn_time_ms": 1751.956, "learn_throughput": 4566.324, "update_time_ms": 1.555}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.59375, "cur_lr": 0.00010000000000000003, "total_loss": 7.128235757694322e+22, "policy_loss": 0.0031415354372617207, "vf_loss": 7.128235757694322e+22, "vf_explained_var": 0.0, "kl": 0.008038249253383223, "entropy": -5.4293719687551825, "entropy_coeff": 0.0}}, "num_steps_sampled": 478400, "num_steps_trained": 478400}, "done": false, "episodes_total": 456, "training_iteration": 51, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-12", "timestamp": 1617636552, "time_this_iter_s": 4.3946099281311035, "time_total_s": 303.85498571395874, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.68553829193115, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 50.057142857142864, "ram_util_percent": 61.32857142857142}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": -0.2858552836531892, "episode_reward_mean": 8.50004210189424, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.503983476140969, 2.4208277117261683, 0.9685950887186583, 1.6805562933775748, 0.5692549268346332, 0.6323174212627221, 0.4609418296168346, 0.9510322439013916, 36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082, 17.173034222553188, 14.282460698375175, 16.433735761717042, 11.770124952932248, 25.72032966959456, 13.321195074834847, 7.892557783057265, 8.547129013100893, 6.268134838837754, 2.493721825806608, 5.433850666435474, 3.252462135687222, 1.9189894388411912, 7.2225789937543325, 2.607277781974854, 4.6046311274659635, 1.387781784402962, 2.374630607052322, 0.8219578701217614, 7.901512373877383, 2.8476054059452385, 1.0064233730142274, 1.6240955270232313, 3.8338543291874325, 1.148787792705459, 1.5805518291071836, 0.6689957083163129, 0.31916303452698225, 1.6757299216257038, 0.17458245256781701, 1.992987722337363, 2.18495512881065, -0.2858552836531892, 0.6141770965144135, 0.45879624666086016, 1.4500712760528325, 1.4989687730066126, 0.9507855938016796, 1.1403497928995137, 0.5848309361642745, 1.5027915232427471, 0.06194394441577633, -0.1858721439742863, 0.26241996835249837, 0.11481347456058599, 0.9801550646500432, 1.345923274068292, 0.9620514845661534], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2206369464732167, "mean_inference_ms": 1.0884652910715342, "mean_action_processing_ms": 0.045818633036132275, "mean_env_wait_ms": 1.0311321838353429, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 486400, "timers": {"sample_time_ms": 3046.541, "sample_throughput": 2625.929, "learn_time_ms": 1748.91, "learn_throughput": 4574.277, "update_time_ms": 1.557}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.59375, "cur_lr": 0.00010000000000000003, "total_loss": 1.2676884819503975e+23, "policy_loss": -0.0006282335533848349, "vf_loss": 1.2676884819503975e+23, "vf_explained_var": 0.0, "kl": 0.008612440573930178, "entropy": -5.424984554074845, "entropy_coeff": 0.0}}, "num_steps_sampled": 486400, "num_steps_trained": 486400}, "done": false, "episodes_total": 464, "training_iteration": 52, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-16", "timestamp": 1617636556, "time_this_iter_s": 3.7263479232788086, "time_total_s": 307.58133363723755, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.41188621520996, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.540000000000006, "ram_util_percent": 61.5}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": -0.2858552836531892, "episode_reward_mean": 7.620176669041317, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7900380305581005, 0.9400147229271956, 0.9147930686839669, -0.0314042602002611, 0.11865053367540712, 0.3554993398538331, 1.240459981783339, 0.32197423246192547, 36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082, 17.173034222553188, 14.282460698375175, 16.433735761717042, 11.770124952932248, 25.72032966959456, 13.321195074834847, 7.892557783057265, 8.547129013100893, 6.268134838837754, 2.493721825806608, 5.433850666435474, 3.252462135687222, 1.9189894388411912, 7.2225789937543325, 2.607277781974854, 4.6046311274659635, 1.387781784402962, 2.374630607052322, 0.8219578701217614, 7.901512373877383, 2.8476054059452385, 1.0064233730142274, 1.6240955270232313, 3.8338543291874325, 1.148787792705459, 1.5805518291071836, 0.6689957083163129, 0.31916303452698225, 1.6757299216257038, 0.17458245256781701, 1.992987722337363, 2.18495512881065, -0.2858552836531892, 0.6141770965144135, 0.45879624666086016, 1.4500712760528325, 1.4989687730066126, 0.9507855938016796, 1.1403497928995137, 0.5848309361642745, 1.5027915232427471, 0.06194394441577633, -0.1858721439742863, 0.26241996835249837, 0.11481347456058599, 0.9801550646500432, 1.345923274068292, 0.9620514845661534, 0.503983476140969, 2.4208277117261683, 0.9685950887186583, 1.6805562933775748, 0.5692549268346332, 0.6323174212627221, 0.4609418296168346, 0.9510322439013916], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.219207008132365, "mean_inference_ms": 1.0826122766134283, "mean_action_processing_ms": 0.04553226958521259, "mean_env_wait_ms": 1.0227607700944672, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 494400, "timers": {"sample_time_ms": 3013.611, "sample_throughput": 2654.623, "learn_time_ms": 1761.572, "learn_throughput": 4541.398, "update_time_ms": 1.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.59375, "cur_lr": 0.00010000000000000003, "total_loss": 2.0637838163235066e+23, "policy_loss": -9.630819264237048e-05, "vf_loss": 2.0637838163235066e+23, "vf_explained_var": 0.0, "kl": 0.011598949048246415, "entropy": -5.444432492526072, "entropy_coeff": 0.0}}, "num_steps_sampled": 494400, "num_steps_trained": 494400}, "done": false, "episodes_total": 472, "training_iteration": 53, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-21", "timestamp": 1617636561, "time_this_iter_s": 4.619396924972534, "time_total_s": 312.2007305622101, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.031283140182495, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 58.628571428571426, "ram_util_percent": 61.42857142857142}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": -0.2858552836531892, "episode_reward_mean": 6.980654971276263, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.7768974776747224, 3.0341455675261297, 1.270616400063016, 0.9032270762314116, 1.1491597011065715, 0.39609136198148454, 1.0178923096745618, 0.2516476368682823, 36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082, 17.173034222553188, 14.282460698375175, 16.433735761717042, 11.770124952932248, 25.72032966959456, 13.321195074834847, 7.892557783057265, 8.547129013100893, 6.268134838837754, 2.493721825806608, 5.433850666435474, 3.252462135687222, 1.9189894388411912, 7.2225789937543325, 2.607277781974854, 4.6046311274659635, 1.387781784402962, 2.374630607052322, 0.8219578701217614, 7.901512373877383, 2.8476054059452385, 1.0064233730142274, 1.6240955270232313, 3.8338543291874325, 1.148787792705459, 1.5805518291071836, 0.6689957083163129, 0.31916303452698225, 1.6757299216257038, 0.17458245256781701, 1.992987722337363, 2.18495512881065, -0.2858552836531892, 0.6141770965144135, 0.45879624666086016, 1.4500712760528325, 1.4989687730066126, 0.9507855938016796, 1.1403497928995137, 0.5848309361642745, 1.5027915232427471, 0.06194394441577633, -0.1858721439742863, 0.26241996835249837, 0.11481347456058599, 0.9801550646500432, 1.345923274068292, 0.9620514845661534, 0.503983476140969, 2.4208277117261683, 0.9685950887186583, 1.6805562933775748, 0.5692549268346332, 0.6323174212627221, 0.4609418296168346, 0.9510322439013916, 0.7900380305581005, 0.9400147229271956, 0.9147930686839669, -0.0314042602002611, 0.11865053367540712, 0.3554993398538331, 1.240459981783339, 0.32197423246192547], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21766087555183083, "mean_inference_ms": 1.0759101784318985, "mean_action_processing_ms": 0.045224857409360254, "mean_env_wait_ms": 1.014083829658504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 502400, "timers": {"sample_time_ms": 2914.476, "sample_throughput": 2744.919, "learn_time_ms": 1748.645, "learn_throughput": 4574.972, "update_time_ms": 1.639}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.59375, "cur_lr": 0.00010000000000000003, "total_loss": 3.5727932042605386e+23, "policy_loss": 0.005272895163628009, "vf_loss": 3.5727932042605386e+23, "vf_explained_var": 0.0, "kl": 0.011845571252534975, "entropy": -5.413998945704046, "entropy_coeff": 0.0}}, "num_steps_sampled": 502400, "num_steps_trained": 502400}, "done": false, "episodes_total": 480, "training_iteration": 54, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-25", "timestamp": 1617636565, "time_this_iter_s": 3.661370277404785, "time_total_s": 315.86210083961487, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.69265341758728, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.080000000000002, "ram_util_percent": 61.5}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 57.881019610953906, "episode_reward_min": -0.2858552836531892, "episode_reward_mean": 6.4841609375483324, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1532104616110859, 1.1386539034335375, 3.8959111887750906, 0.819938400661999, 2.090359335311136, 0.36080594919451525, 1.387561410928535, 1.3073241522363315, 36.994722581437735, 55.2765485175183, 45.04004411239119, 43.17106138628572, 53.409970974164956, 57.881019610953906, 19.14001197120022, 32.95962650878082, 17.173034222553188, 14.282460698375175, 16.433735761717042, 11.770124952932248, 25.72032966959456, 13.321195074834847, 7.892557783057265, 8.547129013100893, 6.268134838837754, 2.493721825806608, 5.433850666435474, 3.252462135687222, 1.9189894388411912, 7.2225789937543325, 2.607277781974854, 4.6046311274659635, 1.387781784402962, 2.374630607052322, 0.8219578701217614, 7.901512373877383, 2.8476054059452385, 1.0064233730142274, 1.6240955270232313, 3.8338543291874325, 1.148787792705459, 1.5805518291071836, 0.6689957083163129, 0.31916303452698225, 1.6757299216257038, 0.17458245256781701, 1.992987722337363, 2.18495512881065, -0.2858552836531892, 0.6141770965144135, 0.45879624666086016, 1.4500712760528325, 1.4989687730066126, 0.9507855938016796, 1.1403497928995137, 0.5848309361642745, 1.5027915232427471, 0.06194394441577633, -0.1858721439742863, 0.26241996835249837, 0.11481347456058599, 0.9801550646500432, 1.345923274068292, 0.9620514845661534, 0.503983476140969, 2.4208277117261683, 0.9685950887186583, 1.6805562933775748, 0.5692549268346332, 0.6323174212627221, 0.4609418296168346, 0.9510322439013916, 0.7900380305581005, 0.9400147229271956, 0.9147930686839669, -0.0314042602002611, 0.11865053367540712, 0.3554993398538331, 1.240459981783339, 0.32197423246192547, 1.7768974776747224, 3.0341455675261297, 1.270616400063016, 0.9032270762314116, 1.1491597011065715, 0.39609136198148454, 1.0178923096745618, 0.2516476368682823], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21649185691253053, "mean_inference_ms": 1.07063023499682, "mean_action_processing_ms": 0.04498553303934619, "mean_env_wait_ms": 1.007296784502006, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 510400, "timers": {"sample_time_ms": 2405.867, "sample_throughput": 3325.205, "learn_time_ms": 1748.866, "learn_throughput": 4574.393, "update_time_ms": 1.701}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.59375, "cur_lr": 0.00010000000000000003, "total_loss": 4.951856138653152e+23, "policy_loss": -0.001053451984365172, "vf_loss": 4.951856138653152e+23, "vf_explained_var": 0.0, "kl": 0.009727568084479502, "entropy": -5.457297622032885, "entropy_coeff": 0.0}}, "num_steps_sampled": 510400, "num_steps_trained": 510400}, "done": false, "episodes_total": 488, "training_iteration": 55, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-29", "timestamp": 1617636569, "time_this_iter_s": 4.428641080856323, "time_total_s": 320.2907419204712, "pid": 16151, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.32257532953523005, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.1212944984436, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 54.88333333333333, "ram_util_percent": 61.383333333333326}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": 17.914377753135614, "episode_reward_mean": 38.41245734387793, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2577864266299344, "mean_inference_ms": 1.2265021627123183, "mean_action_processing_ms": 0.05229986035502279, "mean_env_wait_ms": 1.26583134377753, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 430400, "timers": {"sample_time_ms": 8311.806, "sample_throughput": 962.486, "learn_time_ms": 1899.047, "learn_throughput": 4212.64, "update_time_ms": 1.462}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001, "total_loss": 1.4865127194444892e+19, "policy_loss": 0.041387240705519635, "vf_loss": 1.4865127194444892e+19, "vf_explained_var": 0.0, "kl": 0.8243602075666752, "entropy": -4.916331813020526, "entropy_coeff": 0.0}}, "num_steps_sampled": 430400, "num_steps_trained": 430400}, "done": false, "episodes_total": 408, "training_iteration": 45, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-46", "timestamp": 1617636586, "time_this_iter_s": 10.216026067733765, "time_total_s": 279.38547348976135, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.216026067733765, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 65.58, "ram_util_percent": 58.80666666666666}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": 11.601010860891869, "episode_reward_mean": 28.535689213180476, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24244609356639268, "mean_inference_ms": 1.1828771969053715, "mean_action_processing_ms": 0.05030366246587771, "mean_env_wait_ms": 1.1971763715293315, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 438400, "timers": {"sample_time_ms": 5437.694, "sample_throughput": 1471.212, "learn_time_ms": 1747.101, "learn_throughput": 4579.015, "update_time_ms": 1.59}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001, "total_loss": 1.0526366450407623e+21, "policy_loss": 0.01723633586516371, "vf_loss": 1.0526366450407623e+21, "vf_explained_var": 0.0, "kl": 0.5344804013675114, "entropy": -4.871125311221716, "entropy_coeff": 0.0}}, "num_steps_sampled": 438400, "num_steps_trained": 438400}, "done": false, "episodes_total": 416, "training_iteration": 46, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-50", "timestamp": 1617636590, "time_this_iter_s": 4.16492772102356, "time_total_s": 283.5504012107849, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.380953788757324, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.81666666666667, "ram_util_percent": 61.00000000000001}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": 4.543329752924632, "episode_reward_mean": 21.28372224927422, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23457747598970916, "mean_inference_ms": 1.1579229500947283, "mean_action_processing_ms": 0.04928976986250334, "mean_env_wait_ms": 1.158626724826867, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 446400, "timers": {"sample_time_ms": 4451.48, "sample_throughput": 1797.155, "learn_time_ms": 1739.763, "learn_throughput": 4598.328, "update_time_ms": 1.544}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001, "total_loss": 5.421615906033064e+21, "policy_loss": 0.019877498120757012, "vf_loss": 5.421615906033064e+21, "vf_explained_var": 0.0, "kl": 0.399337186003631, "entropy": -5.261861801147461, "entropy_coeff": 0.0}}, "num_steps_sampled": 446400, "num_steps_trained": 446400}, "done": false, "episodes_total": 424, "training_iteration": 47, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-54", "timestamp": 1617636594, "time_this_iter_s": 4.210202932357788, "time_total_s": 287.7606041431427, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18.591156721115112, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.800000000000004, "ram_util_percent": 57.03333333333333}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": 1.3695992967621926, "episode_reward_mean": 17.086472359119036, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2324779728027448, "mean_inference_ms": 1.1532100342070462, "mean_action_processing_ms": 0.049108451641449224, "mean_env_wait_ms": 1.1457941888108976, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 454400, "timers": {"sample_time_ms": 4088.64, "sample_throughput": 1956.641, "learn_time_ms": 1768.366, "learn_throughput": 4523.95, "update_time_ms": 1.547}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.001, "total_loss": 1.8072752095965107e+23, "policy_loss": -0.00016816347433289266, "vf_loss": 1.8072752095965107e+23, "vf_explained_var": 0.0, "kl": 0.1853279375805045, "entropy": -5.4040486227791265, "entropy_coeff": 0.0}}, "num_steps_sampled": 454400, "num_steps_trained": 454400}, "done": false, "episodes_total": 432, "training_iteration": 48, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-29-59", "timestamp": 1617636599, "time_this_iter_s": 4.861039638519287, "time_total_s": 292.621643781662, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.4521963596344, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 66.45714285714286, "ram_util_percent": 59.01428571428571}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": 1.3695992967621926, "episode_reward_mean": 14.285307894522806, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23188774699602072, "mean_inference_ms": 1.1580864728117557, "mean_action_processing_ms": 0.049014553990097624, "mean_env_wait_ms": 1.1380256876397556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 462400, "timers": {"sample_time_ms": 3885.713, "sample_throughput": 2058.824, "learn_time_ms": 1747.793, "learn_throughput": 4577.2, "update_time_ms": 1.534}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.0625, "cur_lr": 0.001, "total_loss": 1.0202995103851758e+24, "policy_loss": 0.02924874569684759, "vf_loss": 1.0202995103851758e+24, "vf_explained_var": 0.0, "kl": 0.3987107676155162, "entropy": -5.619529697130311, "entropy_coeff": 0.0}}, "num_steps_sampled": 462400, "num_steps_trained": 462400}, "done": false, "episodes_total": 440, "training_iteration": 49, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-04", "timestamp": 1617636604, "time_this_iter_s": 4.7448570728302, "time_total_s": 297.3665008544922, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.1970534324646, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 57.01428571428572, "ram_util_percent": 60.97142857142858}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": 0.009913369456378218, "episode_reward_mean": 12.048713665640477, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2301773483831195, "mean_inference_ms": 1.1540264955080624, "mean_action_processing_ms": 0.048664886345472703, "mean_env_wait_ms": 1.125218903062729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 470400, "timers": {"sample_time_ms": 3624.753, "sample_throughput": 2207.047, "learn_time_ms": 1739.491, "learn_throughput": 4599.047, "update_time_ms": 1.525}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.59375, "cur_lr": 0.001, "total_loss": 2.907069559782588e+24, "policy_loss": 0.01445284179622694, "vf_loss": 2.907069559782588e+24, "vf_explained_var": 0.0, "kl": 0.16781324232524297, "entropy": -5.768857847969487, "entropy_coeff": 0.0}}, "num_steps_sampled": 470400, "num_steps_trained": 470400}, "done": false, "episodes_total": 448, "training_iteration": 50, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-08", "timestamp": 1617636608, "time_this_iter_s": 4.0246264934539795, "time_total_s": 301.39112734794617, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.22167992591858, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.63333333333333, "ram_util_percent": 61.43333333333334}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": 0.009913369456378218, "episode_reward_mean": 10.46882912777856, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22936917390972664, "mean_inference_ms": 1.1523800485863736, "mean_action_processing_ms": 0.04848570433796865, "mean_env_wait_ms": 1.1177198426814692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 478400, "timers": {"sample_time_ms": 3521.394, "sample_throughput": 2271.828, "learn_time_ms": 1774.714, "learn_throughput": 4507.768, "update_time_ms": 1.529}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 11.390625, "cur_lr": 0.001, "total_loss": 8.674530819013786e+24, "policy_loss": 0.009030545585050757, "vf_loss": 8.674530819013786e+24, "vf_explained_var": 0.0, "kl": 0.10511921810091666, "entropy": -5.675821601219897, "entropy_coeff": 0.0}}, "num_steps_sampled": 478400, "num_steps_trained": 478400}, "done": false, "episodes_total": 456, "training_iteration": 51, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-13", "timestamp": 1617636613, "time_this_iter_s": 4.892636060714722, "time_total_s": 306.2837634086609, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.1143159866333, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 64.98571428571428, "ram_util_percent": 61.5}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": -0.5587959893279479, "episode_reward_mean": 9.176869613725248, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22803625324108828, "mean_inference_ms": 1.1463486698321184, "mean_action_processing_ms": 0.04816345854943272, "mean_env_wait_ms": 1.1072648379917416, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 486400, "timers": {"sample_time_ms": 3336.818, "sample_throughput": 2397.494, "learn_time_ms": 1761.779, "learn_throughput": 4540.865, "update_time_ms": 1.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 17.0859375, "cur_lr": 0.001, "total_loss": 2.182554807363706e+25, "policy_loss": 0.0025413268276507843, "vf_loss": 2.182554807363706e+25, "vf_explained_var": 0.0, "kl": 0.038398795936889246, "entropy": -5.76334849843439, "entropy_coeff": 0.0}}, "num_steps_sampled": 486400, "num_steps_trained": 486400}, "done": false, "episodes_total": 464, "training_iteration": 52, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-17", "timestamp": 1617636617, "time_this_iter_s": 3.7225751876831055, "time_total_s": 310.006338596344, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.836891174316406, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.239999999999995, "ram_util_percent": 61.6}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": -0.5861333500399946, "episode_reward_mean": 8.131968955353504, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22689607713856363, "mean_inference_ms": 1.1391250074229544, "mean_action_processing_ms": 0.04781406493839265, "mean_env_wait_ms": 1.0966194387762331, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 494400, "timers": {"sample_time_ms": 3202.09, "sample_throughput": 2498.368, "learn_time_ms": 1787.067, "learn_throughput": 4476.608, "update_time_ms": 1.554}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 25.62890625, "cur_lr": 0.001, "total_loss": 4.963423503309283e+25, "policy_loss": 0.0008643816866613222, "vf_loss": 4.963423503309283e+25, "vf_explained_var": 0.0, "kl": 0.01948658853136706, "entropy": -5.758899256868182, "entropy_coeff": 0.0}}, "num_steps_sampled": 494400, "num_steps_trained": 494400}, "done": false, "episodes_total": 472, "training_iteration": 53, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-21", "timestamp": 1617636621, "time_this_iter_s": 4.1199729442596436, "time_total_s": 314.12631154060364, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.95686411857605, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 47.03333333333333, "ram_util_percent": 61.51666666666667}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": -0.6920233444272674, "episode_reward_mean": 7.317303262339711, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22590899737690626, "mean_inference_ms": 1.134035489309688, "mean_action_processing_ms": 0.04756953919861665, "mean_env_wait_ms": 1.0889216999521036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 502400, "timers": {"sample_time_ms": 3156.969, "sample_throughput": 2534.076, "learn_time_ms": 1773.873, "learn_throughput": 4509.906, "update_time_ms": 1.544}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 25.62890625, "cur_lr": 0.001, "total_loss": 7.19523009547454e+25, "policy_loss": -0.0012524151825346053, "vf_loss": 7.19523009547454e+25, "vf_explained_var": 0.0, "kl": 0.006689031098811132, "entropy": -5.7640019272858245, "entropy_coeff": 0.0}}, "num_steps_sampled": 502400, "num_steps_trained": 502400}, "done": false, "episodes_total": 480, "training_iteration": 54, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-25", "timestamp": 1617636625, "time_this_iter_s": 4.412008285522461, "time_total_s": 318.5383198261261, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.36887240409851, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 54.48333333333333, "ram_util_percent": 61.650000000000006}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": -0.6920233444272674, "episode_reward_mean": 6.664879520207055, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2247229172933352, "mean_inference_ms": 1.1279782879618323, "mean_action_processing_ms": 0.04729549562007913, "mean_env_wait_ms": 1.0807120772414862, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 510400, "timers": {"sample_time_ms": 2528.868, "sample_throughput": 3163.471, "learn_time_ms": 1760.904, "learn_throughput": 4543.122, "update_time_ms": 1.561}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 25.62890625, "cur_lr": 0.001, "total_loss": 1.5158400387592827e+26, "policy_loss": 0.004330526018198931, "vf_loss": 1.5158400387592827e+26, "vf_explained_var": 0.0, "kl": 0.022411555223131797, "entropy": -5.7716730675607355, "entropy_coeff": 0.0}}, "num_steps_sampled": 510400, "num_steps_trained": 510400}, "done": false, "episodes_total": 488, "training_iteration": 55, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-29", "timestamp": 1617636629, "time_this_iter_s": 3.807938814163208, "time_total_s": 322.3462586402893, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.17681121826172, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 34.93333333333333, "ram_util_percent": 61.833333333333336}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": -0.6920233444272674, "episode_reward_mean": 6.090148500211982, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, 17.914377753135614, 44.4491561600262, 26.563297215921764, 45.1097741293126, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22394214524074907, "mean_inference_ms": 1.1235870780840485, "mean_action_processing_ms": 0.047097057897018346, "mean_env_wait_ms": 1.0745999927206809, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 518400, "timers": {"sample_time_ms": 2554.91, "sample_throughput": 3131.225, "learn_time_ms": 1786.5, "learn_throughput": 4478.029, "update_time_ms": 1.532}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 38.443359375, "cur_lr": 0.001, "total_loss": 2.6998068919044146e+26, "policy_loss": 0.021096138973316213, "vf_loss": 2.6998068919044146e+26, "vf_explained_var": 0.0, "kl": 0.27725230579106314, "entropy": -5.370175847467387, "entropy_coeff": 0.0}}, "num_steps_sampled": 518400, "num_steps_trained": 518400}, "done": false, "episodes_total": 496, "training_iteration": 56, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-34", "timestamp": 1617636634, "time_this_iter_s": 4.6813154220581055, "time_total_s": 327.0275740623474, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 57.858126640319824, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 66.49999999999999, "ram_util_percent": 61.85}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 67.60389504168481, "episode_reward_min": -0.722736250417501, "episode_reward_mean": 4.4838394997646605, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893, 40.44967551944047, 19.494300188534663, 67.60389504168481, 45.71518274296734, 18.42874571014095, 19.35141306444563, 19.507127097149635, 11.601010860891869, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22173053259902095, "mean_inference_ms": 1.114521114655119, "mean_action_processing_ms": 0.04668615078147979, "mean_env_wait_ms": 1.0606022247373545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 526400, "timers": {"sample_time_ms": 2525.606, "sample_throughput": 3167.557, "learn_time_ms": 1787.395, "learn_throughput": 4475.788, "update_time_ms": 1.536}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 57.6650390625, "cur_lr": 0.001, "total_loss": 3.8564548538176966e+26, "policy_loss": -0.0005993535884937166, "vf_loss": 3.8564548538176966e+26, "vf_explained_var": 0.0, "kl": 0.0009797325951952207, "entropy": -5.369894729470307, "entropy_coeff": 0.0}}, "num_steps_sampled": 526400, "num_steps_trained": 526400}, "done": false, "episodes_total": 504, "training_iteration": 57, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-38", "timestamp": 1617636638, "time_this_iter_s": 3.926375389099121, "time_total_s": 330.95394945144653, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 61.784502029418945, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 32.36666666666667, "ram_util_percent": 62.0}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 25.2153144834283, "episode_reward_min": -0.8880250602906581, "episode_reward_mean": 2.0666815824988856, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.41843476420829995, 1.8395926890562175, -0.16968601096452496, 1.286247275427137, -0.22722688139349928, -0.32065562045634305, -0.8880250602906581, -0.6662531284921591, 16.778983508732058, 25.2153144834283, 14.501756196479883, 23.88701773859586, 6.065130308096127, 6.064729782115931, 4.543329752924632, 10.63194329234726, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, -0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21953901694516703, "mean_inference_ms": 1.1052529758569118, "mean_action_processing_ms": 0.04622823473313115, "mean_env_wait_ms": 1.0446650040395529, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 534400, "timers": {"sample_time_ms": 2500.526, "sample_throughput": 3199.327, "learn_time_ms": 1829.485, "learn_throughput": 4372.815, "update_time_ms": 1.542}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 28.83251953125, "cur_lr": 0.001, "total_loss": 5.818064464503559e+26, "policy_loss": 0.0021155557841203124, "vf_loss": 5.818064464503559e+26, "vf_explained_var": 0.0, "kl": 0.00018381975362745097, "entropy": -5.36924934387207, "entropy_coeff": 0.0}}, "num_steps_sampled": 534400, "num_steps_trained": 534400}, "done": false, "episodes_total": 512, "training_iteration": 58, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-43", "timestamp": 1617636643, "time_this_iter_s": 5.0325140953063965, "time_total_s": 335.98646354675293, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 66.81701612472534, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 62.028571428571425}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 8.404586367041194, "episode_reward_min": -0.8880250602906581, "episode_reward_mean": 0.9661764934819845, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5118053112216043, -0.6691051347629748, 0.24044772510078305, -0.7258506025623663, -0.01641482859278809, -0.4594133487439616, 0.0928101055298185, -0.31297244371695104, 6.853060183698752, 8.404586367041194, 5.389200639276824, 6.28632624619296, 4.553648599608338, 3.049174194506783, 6.179514102662737, 3.331851100654683, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, -0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893, -0.41843476420829995, 1.8395926890562175, -0.16968601096452496, 1.286247275427137, -0.22722688139349928, -0.32065562045634305, -0.8880250602906581, -0.6662531284921591], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21876404594255822, "mean_inference_ms": 1.1002356445751011, "mean_action_processing_ms": 0.04596059551642643, "mean_env_wait_ms": 1.0357757079434546, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 542400, "timers": {"sample_time_ms": 2445.913, "sample_throughput": 3270.762, "learn_time_ms": 1831.272, "learn_throughput": 4368.547, "update_time_ms": 1.516}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 14.416259765625, "cur_lr": 0.001, "total_loss": 9.206519777566096e+26, "policy_loss": -0.002041688316308384, "vf_loss": 9.206519777566096e+26, "vf_explained_var": 0.0, "kl": 0.0005429193240487157, "entropy": -5.363612013043098, "entropy_coeff": 0.0}}, "num_steps_sampled": 542400, "num_steps_trained": 542400}, "done": false, "episodes_total": 520, "training_iteration": 59, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-47", "timestamp": 1617636647, "time_this_iter_s": 4.216763019561768, "time_total_s": 340.2032265663147, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 71.03377914428711, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 43.96666666666666, "ram_util_percent": 61.99999999999999}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 7.151363837255698, "episode_reward_min": -0.8880250602906581, "episode_reward_mean": 0.4828778591758687, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.38247915025541634, -0.8307439282585758, -0.503251975797555, -0.7908165297891191, -0.3812284909623985, -0.8007677141898386, -0.7164100101397871, 0.12319580242334127, 3.583329081561282, 1.3695992967621926, 7.151363837255698, 6.739301296216024, 1.4903357902118972, 2.7371864193119593, 3.1315042100111308, 4.394432266286056, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, -0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893, -0.41843476420829995, 1.8395926890562175, -0.16968601096452496, 1.286247275427137, -0.22722688139349928, -0.32065562045634305, -0.8880250602906581, -0.6662531284921591, -0.5118053112216043, -0.6691051347629748, 0.24044772510078305, -0.7258506025623663, -0.01641482859278809, -0.4594133487439616, 0.0928101055298185, -0.31297244371695104], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2178510997416138, "mean_inference_ms": 1.0943709797970553, "mean_action_processing_ms": 0.045646933728317685, "mean_env_wait_ms": 1.0267099323031577, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 550400, "timers": {"sample_time_ms": 2457.355, "sample_throughput": 3255.532, "learn_time_ms": 1877.207, "learn_throughput": 4261.649, "update_time_ms": 1.532}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.2081298828125, "cur_lr": 0.001, "total_loss": 1.4254612642165776e+27, "policy_loss": -0.0015818425498129625, "vf_loss": 1.4254612642165776e+27, "vf_explained_var": 0.0, "kl": 0.0002554643664175188, "entropy": -5.35903433133971, "entropy_coeff": 0.0}}, "num_steps_sampled": 550400, "num_steps_trained": 550400}, "done": false, "episodes_total": 528, "training_iteration": 60, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-52", "timestamp": 1617636652, "time_this_iter_s": 4.599806070327759, "time_total_s": 344.80303263664246, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 75.63358521461487, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 44.642857142857146, "ram_util_percent": 61.842857142857135}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 5.0019587359478574, "episode_reward_min": -0.8880250602906581, "episode_reward_mean": 0.14914108604550827, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.30020934855868164, 0.8286343477369524, -0.3451570907018966, -0.722905963330583, -0.6627430989350591, -0.6483986683543925, -0.3390225593341504, -0.5868227339419883, 2.6596087544500975, 5.0019587359478574, 2.989357786398435, 2.2408163264855894, 0.42184716307624215, 1.859165768502435, 0.4611809757193668, 1.1566732807327393, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, -0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893, -0.41843476420829995, 1.8395926890562175, -0.16968601096452496, 1.286247275427137, -0.22722688139349928, -0.32065562045634305, -0.8880250602906581, -0.6662531284921591, -0.5118053112216043, -0.6691051347629748, 0.24044772510078305, -0.7258506025623663, -0.01641482859278809, -0.4594133487439616, 0.0928101055298185, -0.31297244371695104, -0.38247915025541634, -0.8307439282585758, -0.503251975797555, -0.7908165297891191, -0.3812284909623985, -0.8007677141898386, -0.7164100101397871, 0.12319580242334127], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21682728580398464, "mean_inference_ms": 1.0868727501285889, "mean_action_processing_ms": 0.04533245969379514, "mean_env_wait_ms": 1.0180557157876982, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 558400, "timers": {"sample_time_ms": 2466.093, "sample_throughput": 3243.998, "learn_time_ms": 1853.454, "learn_throughput": 4316.266, "update_time_ms": 1.523}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.60406494140625, "cur_lr": 0.001, "total_loss": 2.0532903644821446e+27, "policy_loss": 0.0006530345769001628, "vf_loss": 2.0532903644821446e+27, "vf_explained_var": 0.0, "kl": 0.0011310771559057582, "entropy": -5.355428326804683, "entropy_coeff": 0.0}}, "num_steps_sampled": 558400, "num_steps_trained": 558400}, "done": false, "episodes_total": 536, "training_iteration": 61, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-30-56", "timestamp": 1617636656, "time_this_iter_s": 4.743544340133667, "time_total_s": 349.5465769767761, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 80.37712955474854, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.75714285714286, "ram_util_percent": 61.942857142857136}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 2.0072663710161045, "episode_reward_min": -0.8880250602906581, "episode_reward_mean": -0.05573274040727068, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.35862716097988445, -0.5484330527643224, -0.627932792648435, -0.6987335662262414, -0.610740785695328, -0.3160872800432063, -0.3844304123421505, -0.15178880326556354, 0.009913369456378218, 1.415492739157309, 0.97285751673771, 0.6288093564485919, 2.0072663710161045, 0.7962952680267683, 1.1956827335990874, 1.1514433650849325, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, -0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893, -0.41843476420829995, 1.8395926890562175, -0.16968601096452496, 1.286247275427137, -0.22722688139349928, -0.32065562045634305, -0.8880250602906581, -0.6662531284921591, -0.5118053112216043, -0.6691051347629748, 0.24044772510078305, -0.7258506025623663, -0.01641482859278809, -0.4594133487439616, 0.0928101055298185, -0.31297244371695104, -0.38247915025541634, -0.8307439282585758, -0.503251975797555, -0.7908165297891191, -0.3812284909623985, -0.8007677141898386, -0.7164100101397871, 0.12319580242334127, -0.30020934855868164, 0.8286343477369524, -0.3451570907018966, -0.722905963330583, -0.6627430989350591, -0.6483986683543925, -0.3390225593341504, -0.5868227339419883], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21575465653343165, "mean_inference_ms": 1.0791119225185033, "mean_action_processing_ms": 0.045058397686765624, "mean_env_wait_ms": 1.010524663595446, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 566400, "timers": {"sample_time_ms": 2495.558, "sample_throughput": 3205.696, "learn_time_ms": 1873.357, "learn_throughput": 4270.408, "update_time_ms": 1.507}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.802032470703125, "cur_lr": 0.001, "total_loss": 2.741488430849362e+27, "policy_loss": -0.0016759474957273957, "vf_loss": 2.741488430849362e+27, "vf_explained_var": 0.0, "kl": 0.0005562888893006668, "entropy": -5.349710536452959, "entropy_coeff": 0.0}}, "num_steps_sampled": 566400, "num_steps_trained": 566400}, "done": false, "episodes_total": 544, "training_iteration": 62, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-01", "timestamp": 1617636661, "time_this_iter_s": 4.217634916305542, "time_total_s": 353.76421189308167, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 84.59476447105408, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.766666666666666, "ram_util_percent": 62.050000000000004}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 1.8395926890562175, "episode_reward_min": -0.8880250602906581, "episode_reward_mean": -0.17316956310054576, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.10758356128249347, -0.5611325774898271, -0.325085560915067, -0.744380496504962, -0.20383882783858387, -0.5512352621051928, -0.6419886104385819, -0.4306766532259149, 1.0108314924935864, 0.2312236062045787, 0.42376125253465036, 1.0996711158967956, 0.0935947519900131, -0.5587959893279479, -0.11887215266216711, -0.08117224526869415, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, -0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893, -0.41843476420829995, 1.8395926890562175, -0.16968601096452496, 1.286247275427137, -0.22722688139349928, -0.32065562045634305, -0.8880250602906581, -0.6662531284921591, -0.5118053112216043, -0.6691051347629748, 0.24044772510078305, -0.7258506025623663, -0.01641482859278809, -0.4594133487439616, 0.0928101055298185, -0.31297244371695104, -0.38247915025541634, -0.8307439282585758, -0.503251975797555, -0.7908165297891191, -0.3812284909623985, -0.8007677141898386, -0.7164100101397871, 0.12319580242334127, -0.30020934855868164, 0.8286343477369524, -0.3451570907018966, -0.722905963330583, -0.6627430989350591, -0.6483986683543925, -0.3390225593341504, -0.5868227339419883, -0.35862716097988445, -0.5484330527643224, -0.627932792648435, -0.6987335662262414, -0.610740785695328, -0.3160872800432063, -0.3844304123421505, -0.15178880326556354], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21508772909848656, "mean_inference_ms": 1.0733570388180291, "mean_action_processing_ms": 0.04486322803486246, "mean_env_wait_ms": 1.0050517070454068, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 574400, "timers": {"sample_time_ms": 2575.131, "sample_throughput": 3106.638, "learn_time_ms": 1878.707, "learn_throughput": 4258.248, "update_time_ms": 1.514}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.9010162353515625, "cur_lr": 0.001, "total_loss": 3.892955939399045e+27, "policy_loss": -0.0005941004228760612, "vf_loss": 3.892955939399045e+27, "vf_explained_var": 0.0, "kl": 0.00042746531334211433, "entropy": -5.343744008046277, "entropy_coeff": 0.0}}, "num_steps_sampled": 574400, "num_steps_trained": 574400}, "done": false, "episodes_total": 552, "training_iteration": 63, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-06", "timestamp": 1617636666, "time_this_iter_s": 4.969317674636841, "time_total_s": 358.7335295677185, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 89.56408214569092, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 66.65714285714286, "ram_util_percent": 62.028571428571425}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 1.8395926890562175, "episode_reward_min": -0.8880250602906581, "episode_reward_mean": -0.239533820574485, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4813399933546767, -0.7502007148664671, -0.6797511522206108, -0.41327840226966694, -0.6621129637259517, -0.5647655307609857, -0.28391927963159147, -0.7008158787031634, 0.4198417339418159, 0.16035779610304468, 0.5085201805650941, 0.6417500474754365, -0.2873422097514724, 0.08132473475493618, -0.4375849073914016, -0.2685618512514507, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, -0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893, -0.41843476420829995, 1.8395926890562175, -0.16968601096452496, 1.286247275427137, -0.22722688139349928, -0.32065562045634305, -0.8880250602906581, -0.6662531284921591, -0.5118053112216043, -0.6691051347629748, 0.24044772510078305, -0.7258506025623663, -0.01641482859278809, -0.4594133487439616, 0.0928101055298185, -0.31297244371695104, -0.38247915025541634, -0.8307439282585758, -0.503251975797555, -0.7908165297891191, -0.3812284909623985, -0.8007677141898386, -0.7164100101397871, 0.12319580242334127, -0.30020934855868164, 0.8286343477369524, -0.3451570907018966, -0.722905963330583, -0.6627430989350591, -0.6483986683543925, -0.3390225593341504, -0.5868227339419883, -0.35862716097988445, -0.5484330527643224, -0.627932792648435, -0.6987335662262414, -0.610740785695328, -0.3160872800432063, -0.3844304123421505, -0.15178880326556354, -0.10758356128249347, -0.5611325774898271, -0.325085560915067, -0.744380496504962, -0.20383882783858387, -0.5512352621051928, -0.6419886104385819, -0.4306766532259149], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2143769279220019, "mean_inference_ms": 1.068240967551645, "mean_action_processing_ms": 0.04468911210910878, "mean_env_wait_ms": 1.0001472271329825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 582400, "timers": {"sample_time_ms": 2531.152, "sample_throughput": 3160.616, "learn_time_ms": 1883.87, "learn_throughput": 4246.578, "update_time_ms": 1.54}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45050811767578125, "cur_lr": 0.001, "total_loss": 5.374722315039087e+27, "policy_loss": 0.003122883936706579, "vf_loss": 5.374722315039087e+27, "vf_explained_var": 0.0, "kl": 0.0002842018748883417, "entropy": -5.343795191566899, "entropy_coeff": 0.0}}, "num_steps_sampled": 582400, "num_steps_trained": 582400}, "done": false, "episodes_total": 560, "training_iteration": 64, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-10", "timestamp": 1617636670, "time_this_iter_s": 4.024456024169922, "time_total_s": 362.7579855918884, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 93.58853816986084, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 34.1, "ram_util_percent": 61.833333333333336}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 1.8395926890562175, "episode_reward_min": -0.8880250602906581, "episode_reward_mean": -0.28016663551475746, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.77491598374316, -0.7267430891287836, 0.2082239322230981, -0.7730035384070232, -0.5006385259974603, -0.1314403334755206, -0.54781419977402, 0.0013557687216259051, -0.3134849456033213, -0.46773642167739377, -0.5861333500399946, 0.4616284579963421, 0.3259953184234434, 0.38085826889995356, 0.07325700923811951, -0.32893180456470894, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, -0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893, -0.41843476420829995, 1.8395926890562175, -0.16968601096452496, 1.286247275427137, -0.22722688139349928, -0.32065562045634305, -0.8880250602906581, -0.6662531284921591, -0.5118053112216043, -0.6691051347629748, 0.24044772510078305, -0.7258506025623663, -0.01641482859278809, -0.4594133487439616, 0.0928101055298185, -0.31297244371695104, -0.38247915025541634, -0.8307439282585758, -0.503251975797555, -0.7908165297891191, -0.3812284909623985, -0.8007677141898386, -0.7164100101397871, 0.12319580242334127, -0.30020934855868164, 0.8286343477369524, -0.3451570907018966, -0.722905963330583, -0.6627430989350591, -0.6483986683543925, -0.3390225593341504, -0.5868227339419883, -0.35862716097988445, -0.5484330527643224, -0.627932792648435, -0.6987335662262414, -0.610740785695328, -0.3160872800432063, -0.3844304123421505, -0.15178880326556354, -0.10758356128249347, -0.5611325774898271, -0.325085560915067, -0.744380496504962, -0.20383882783858387, -0.5512352621051928, -0.6419886104385819, -0.4306766532259149, -0.4813399933546767, -0.7502007148664671, -0.6797511522206108, -0.41327840226966694, -0.6621129637259517, -0.5647655307609857, -0.28391927963159147, -0.7008158787031634], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2138940675937442, "mean_inference_ms": 1.0653231143790285, "mean_action_processing_ms": 0.044601469546825576, "mean_env_wait_ms": 0.9974364490440614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 590400, "timers": {"sample_time_ms": 2577.407, "sample_throughput": 3103.895, "learn_time_ms": 1913.404, "learn_throughput": 4181.029, "update_time_ms": 1.529}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22525405883789062, "cur_lr": 0.001, "total_loss": 6.927085095495613e+27, "policy_loss": 0.00044167547855737075, "vf_loss": 6.927085095495613e+27, "vf_explained_var": 0.0, "kl": 0.00021350765657086223, "entropy": -5.3428704693632305, "entropy_coeff": 0.0}}, "num_steps_sampled": 590400, "num_steps_trained": 590400}, "done": false, "episodes_total": 568, "training_iteration": 65, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-14", "timestamp": 1617636674, "time_this_iter_s": 4.567665100097656, "time_total_s": 367.3256506919861, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 98.1562032699585, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 52.78333333333333, "ram_util_percent": 61.9}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 1.8395926890562175, "episode_reward_min": -0.8880250602906581, "episode_reward_mean": -0.30478151051613106, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.056928607906483464, -0.7807239051410372, -0.25387426677209457, -0.20504276646585462, -0.5656911252370018, -0.6640266333097548, -0.05892663899818873, -0.3308210236345026, -0.6920233444272674, 0.33051081826297435, -0.22610853190010444, 0.018938467792257274, 0.02210625302313113, 1.158947323779985, -0.012813748462037644, -0.12548918331855302, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, -0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893, -0.41843476420829995, 1.8395926890562175, -0.16968601096452496, 1.286247275427137, -0.22722688139349928, -0.32065562045634305, -0.8880250602906581, -0.6662531284921591, -0.5118053112216043, -0.6691051347629748, 0.24044772510078305, -0.7258506025623663, -0.01641482859278809, -0.4594133487439616, 0.0928101055298185, -0.31297244371695104, -0.38247915025541634, -0.8307439282585758, -0.503251975797555, -0.7908165297891191, -0.3812284909623985, -0.8007677141898386, -0.7164100101397871, 0.12319580242334127, -0.30020934855868164, 0.8286343477369524, -0.3451570907018966, -0.722905963330583, -0.6627430989350591, -0.6483986683543925, -0.3390225593341504, -0.5868227339419883, -0.35862716097988445, -0.5484330527643224, -0.627932792648435, -0.6987335662262414, -0.610740785695328, -0.3160872800432063, -0.3844304123421505, -0.15178880326556354, -0.10758356128249347, -0.5611325774898271, -0.325085560915067, -0.744380496504962, -0.20383882783858387, -0.5512352621051928, -0.6419886104385819, -0.4306766532259149, -0.4813399933546767, -0.7502007148664671, -0.6797511522206108, -0.41327840226966694, -0.6621129637259517, -0.5647655307609857, -0.28391927963159147, -0.7008158787031634, -0.77491598374316, -0.7267430891287836, 0.2082239322230981, -0.7730035384070232, -0.5006385259974603, -0.1314403334755206, -0.54781419977402, 0.0013557687216259051], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21354459096751843, "mean_inference_ms": 1.0636066359304255, "mean_action_processing_ms": 0.04455985866187163, "mean_env_wait_ms": 0.9958770177857111, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 598400, "timers": {"sample_time_ms": 2579.226, "sample_throughput": 3101.706, "learn_time_ms": 1893.259, "learn_throughput": 4225.517, "update_time_ms": 1.533}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.11262702941894531, "cur_lr": 0.001, "total_loss": 8.889188529990619e+27, "policy_loss": 2.6794168043811367e-05, "vf_loss": 8.889188529990619e+27, "vf_explained_var": 0.0, "kl": 0.00029552857810109725, "entropy": -5.34425514149216, "entropy_coeff": 0.0}}, "num_steps_sampled": 598400, "num_steps_trained": 598400}, "done": false, "episodes_total": 576, "training_iteration": 66, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-19", "timestamp": 1617636679, "time_this_iter_s": 4.498254060745239, "time_total_s": 371.8239047527313, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 102.65445733070374, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 54.44285714285714, "ram_util_percent": 61.842857142857135}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 1.8395926890562175, "episode_reward_min": -0.8880250602906581, "episode_reward_mean": -0.34770877073024226, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5886393674422539, 0.186001110458746, -0.7732275984226724, -0.4146363562877263, -0.6558714086438696, -0.48162824729846976, -0.5769955882632273, -0.5136605107612573, 0.1552739906565488, -0.15298067952641925, 0.6587789047829058, -0.5786860698915481, -0.027262913326218774, -0.3835911718826439, -0.2666371738578253, 0.253744582178421, -0.6512461263107251, -0.1729688096604245, 0.0646950563476838, -0.671875201358813, -0.4693554091851173, -0.3371622672037093, -0.722736250417501, 1.2056119994731636, -0.577641702248046, -0.6784635729315454, -0.24414253100383437, -0.4098110519714893, -0.41843476420829995, 1.8395926890562175, -0.16968601096452496, 1.286247275427137, -0.22722688139349928, -0.32065562045634305, -0.8880250602906581, -0.6662531284921591, -0.5118053112216043, -0.6691051347629748, 0.24044772510078305, -0.7258506025623663, -0.01641482859278809, -0.4594133487439616, 0.0928101055298185, -0.31297244371695104, -0.38247915025541634, -0.8307439282585758, -0.503251975797555, -0.7908165297891191, -0.3812284909623985, -0.8007677141898386, -0.7164100101397871, 0.12319580242334127, -0.30020934855868164, 0.8286343477369524, -0.3451570907018966, -0.722905963330583, -0.6627430989350591, -0.6483986683543925, -0.3390225593341504, -0.5868227339419883, -0.35862716097988445, -0.5484330527643224, -0.627932792648435, -0.6987335662262414, -0.610740785695328, -0.3160872800432063, -0.3844304123421505, -0.15178880326556354, -0.10758356128249347, -0.5611325774898271, -0.325085560915067, -0.744380496504962, -0.20383882783858387, -0.5512352621051928, -0.6419886104385819, -0.4306766532259149, -0.4813399933546767, -0.7502007148664671, -0.6797511522206108, -0.41327840226966694, -0.6621129637259517, -0.5647655307609857, -0.28391927963159147, -0.7008158787031634, -0.77491598374316, -0.7267430891287836, 0.2082239322230981, -0.7730035384070232, -0.5006385259974603, -0.1314403334755206, -0.54781419977402, 0.0013557687216259051, -0.056928607906483464, -0.7807239051410372, -0.25387426677209457, -0.20504276646585462, -0.5656911252370018, -0.6640266333097548, -0.05892663899818873, -0.3308210236345026], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21328795815434268, "mean_inference_ms": 1.0619068491062047, "mean_action_processing_ms": 0.044516428180555796, "mean_env_wait_ms": 0.9942893515279512, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 606400, "timers": {"sample_time_ms": 2584.136, "sample_throughput": 3095.812, "learn_time_ms": 1905.811, "learn_throughput": 4197.687, "update_time_ms": 1.542}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.056313514709472656, "cur_lr": 0.001, "total_loss": 9.87618685116481e+27, "policy_loss": 0.0024121349451202406, "vf_loss": 9.87618685116481e+27, "vf_explained_var": 0.0, "kl": 0.000465597600027049, "entropy": -5.342109572212651, "entropy_coeff": 0.0}}, "num_steps_sampled": 606400, "num_steps_trained": 606400}, "done": false, "episodes_total": 584, "training_iteration": 67, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-23", "timestamp": 1617636683, "time_this_iter_s": 4.102097034454346, "time_total_s": 375.92600178718567, "pid": 16719, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7360, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.140449776995055, "kl_coeff": 1.0, "sgd_minibatch_size": 153, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.4466676362925586, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 106.75655436515808, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 36.2, "ram_util_percent": 61.879999999999995}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 2.767893847373757, "episode_reward_min": 0.5674237052259492, "episode_reward_mean": 1.7219206069912834, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0363546458943635, 0.5674237052259492, 2.767893847373757, 2.1981253095146047, 1.1831096058618193, 0.7374140619822902, 2.707399132953033, 1.5776445471244496], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16960873967182033, "mean_inference_ms": 0.9603250927660035, "mean_action_processing_ms": 0.04093286620312225, "mean_env_wait_ms": 0.9413751715946614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 524800, "timers": {"sample_time_ms": 4123.92, "sample_throughput": 3103.843, "learn_time_ms": 4870.462, "learn_throughput": 2628.087, "update_time_ms": 1.577}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.009999999999999998, "total_loss": 0.030479267570295964, "policy_loss": -0.014097853942737194, "vf_loss": 0.016089691769924353, "vf_explained_var": 0.9847261309623718, "kl": 0.02848742745647376, "entropy": -4.200032245029103, "entropy_coeff": 0.0}}, "num_steps_sampled": 524800, "num_steps_trained": 524800}, "done": false, "episodes_total": 504, "training_iteration": 44, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-39", "timestamp": 1617636699, "time_this_iter_s": 8.999106884002686, "time_total_s": 373.3542175292969, "pid": 18103, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12204, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9473029481033767, "kl_coeff": 1.0, "sgd_minibatch_size": 146, "shuffle_sequences": true, "num_sgd_iter": 11, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20644821090254728, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.999106884002686, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 50.88461538461539, "ram_util_percent": 62.1153846153846}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 3.1384771452677365, "episode_reward_min": 0.5243189595285216, "episode_reward_mean": 1.6641397222566265, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.1384771452677365, 0.5243189595285216, 1.5675241708986065, 1.6286329615178667, 2.3990858385431486, 1.53444014317135, 1.7799437717644482, 0.8673812038970494, 2.129860693044001, 0.9264443910195967, 2.737023374680533, 0.7619531055868818, 0.9460074322758207, 2.077997027111056, 2.381294776906329, 0.7636034830158243, 2.0363546458943635, 0.5674237052259492, 2.767893847373757, 2.1981253095146047, 1.1831096058618193, 0.7374140619822902, 2.707399132953033, 1.5776445471244496], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18220189906464504, "mean_inference_ms": 0.9580286484074026, "mean_action_processing_ms": 0.040807806801638376, "mean_env_wait_ms": 0.9236834188098095, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 537600, "timers": {"sample_time_ms": 4110.562, "sample_throughput": 3113.929, "learn_time_ms": 4760.577, "learn_throughput": 2688.75, "update_time_ms": 1.532}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.009999999999999998, "total_loss": 0.03259842654436149, "policy_loss": -0.01595288355019875, "vf_loss": 0.015538460458628833, "vf_explained_var": 0.9792110919952393, "kl": 0.022008566005917437, "entropy": -4.104744802821767, "entropy_coeff": 0.0}}, "num_steps_sampled": 537600, "num_steps_trained": 537600}, "done": false, "episodes_total": 520, "training_iteration": 45, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-48", "timestamp": 1617636708, "time_this_iter_s": 8.755806684494019, "time_total_s": 382.1100242137909, "pid": 18103, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12204, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9473029481033767, "kl_coeff": 1.0, "sgd_minibatch_size": 146, "shuffle_sequences": true, "num_sgd_iter": 11, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20644821090254728, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.754913568496704, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.80769230769231, "ram_util_percent": 62.16923076923077}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 3.1384771452677365, "episode_reward_min": 0.260628976379198, "episode_reward_mean": 1.598440455406409, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.4258287250345645, 1.6359216818815132, 0.4789972680592238, 1.4690210093194285, 2.1994237288933487, 1.2422946170298745, 0.260628976379198, 1.4986252322489078, 2.0363546458943635, 0.5674237052259492, 2.767893847373757, 2.1981253095146047, 1.1831096058618193, 0.7374140619822902, 2.707399132953033, 1.5776445471244496, 3.1384771452677365, 0.5243189595285216, 1.5675241708986065, 1.6286329615178667, 2.3990858385431486, 1.53444014317135, 1.7799437717644482, 0.8673812038970494, 2.129860693044001, 0.9264443910195967, 2.737023374680533, 0.7619531055868818, 0.9460074322758207, 2.077997027111056, 2.381294776906329, 0.7636034830158243], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1842367493126256, "mean_inference_ms": 0.9803737599963047, "mean_action_processing_ms": 0.04142818423058907, "mean_env_wait_ms": 0.9350116432785894, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 550400, "timers": {"sample_time_ms": 4251.983, "sample_throughput": 3010.36, "learn_time_ms": 4581.596, "learn_throughput": 2793.786, "update_time_ms": 1.534}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.009999999999999998, "total_loss": 0.03791384912619833, "policy_loss": -0.01298560425956649, "vf_loss": 0.012740762724371796, "vf_explained_var": 0.9777833819389343, "kl": 0.016959418341602115, "entropy": -4.0702970894900234, "entropy_coeff": 0.0}}, "num_steps_sampled": 550400, "num_steps_trained": 550400}, "done": false, "episodes_total": 528, "training_iteration": 46, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-31-57", "timestamp": 1617636717, "time_this_iter_s": 8.766099452972412, "time_total_s": 390.8761236667633, "pid": 18103, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12204, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9473029481033767, "kl_coeff": 1.0, "sgd_minibatch_size": 146, "shuffle_sequences": true, "num_sgd_iter": 11, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20644821090254728, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.521013021469116, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.716666666666676, "ram_util_percent": 62.29999999999999}, "trial_id": "1bd20_00000"}
{"episode_reward_max": 3.1384771452677365, "episode_reward_min": -0.05454748977519752, "episode_reward_mean": 1.4503773105474396, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6933065396150613, 1.0334109834614664, -0.05454748977519752, 1.0339385523235385, 1.6694592606713603, 1.009715772551178, 0.44457018681049076, 0.4667935300225523, 0.2955531603888313, 2.8165072480451316, 1.6880872951456394, 2.17367278281449, 0.8183649824450445, 1.2065823565737017, 1.3220819829190504, 1.8505191892596606, 2.0363546458943635, 0.5674237052259492, 2.767893847373757, 2.1981253095146047, 1.1831096058618193, 0.7374140619822902, 2.707399132953033, 1.5776445471244496, 3.1384771452677365, 0.5243189595285216, 1.5675241708986065, 1.6286329615178667, 2.3990858385431486, 1.53444014317135, 1.7799437717644482, 0.8673812038970494, 2.129860693044001, 0.9264443910195967, 2.737023374680533, 0.7619531055868818, 0.9460074322758207, 2.077997027111056, 2.381294776906329, 0.7636034830158243, 2.4258287250345645, 1.6359216818815132, 0.4789972680592238, 1.4690210093194285, 2.1994237288933487, 1.2422946170298745, 0.260628976379198, 1.4986252322489078], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19403438251524519, "mean_inference_ms": 1.021193974840818, "mean_action_processing_ms": 0.04286277748990144, "mean_env_wait_ms": 0.9649153006274892, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 563200, "timers": {"sample_time_ms": 4441.957, "sample_throughput": 2881.613, "learn_time_ms": 4429.107, "learn_throughput": 2889.973, "update_time_ms": 1.598}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.009999999999999998, "total_loss": 0.03034625574417243, "policy_loss": -0.0147389745490562, "vf_loss": 0.011919793508819897, "vf_explained_var": 0.9691914916038513, "kl": 0.014740194331600585, "entropy": -4.084913150830702, "entropy_coeff": 0.0}}, "num_steps_sampled": 563200, "num_steps_trained": 563200}, "done": false, "episodes_total": 544, "training_iteration": 47, "experiment_id": "96751bcb3e3240518e37e60a1301dade", "date": "2021-04-05_08-32-06", "timestamp": 1617636726, "time_this_iter_s": 8.991826295852661, "time_total_s": 399.86794996261597, "pid": 18103, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12204, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 34, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9473029481033767, "kl_coeff": 1.0, "sgd_minibatch_size": 146, "shuffle_sequences": true, "num_sgd_iter": 11, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.20644821090254728, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.51283931732178, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 55.9076923076923, "ram_util_percent": 62.115384615384635}, "trial_id": "1bd20_00000"}
