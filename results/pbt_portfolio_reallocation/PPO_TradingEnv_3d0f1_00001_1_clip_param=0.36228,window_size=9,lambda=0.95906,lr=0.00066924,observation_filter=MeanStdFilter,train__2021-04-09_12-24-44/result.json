{"episode_reward_max": 0.24606163873606346, "episode_reward_min": -0.47244849709001113, "episode_reward_mean": -0.23216416361161013, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.054457652313613214, -0.214492834043855, -0.3182154033290873, -0.2198416593250443, 0.24606163873606346, -0.47244849709001113, -0.4024496248665412, -0.42146927666079215], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21596663599705118, "mean_inference_ms": 1.1513732454361865, "mean_action_processing_ms": 0.04887672685564408, "mean_env_wait_ms": 1.1464497082239384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 9600, "timers": {"sample_time_ms": 3619.484, "sample_throughput": 2652.312, "learn_time_ms": 2383.482, "learn_throughput": 4027.721, "update_time_ms": 1.68}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": -0.03563895309343934, "policy_loss": -0.05187452357262373, "vf_loss": 0.0026392351960142454, "vf_explained_var": 0.6918480396270752, "kl": 0.013596334904432296, "entropy": -3.350230541229248, "entropy_coeff": 0.0}}, "num_steps_sampled": 9600, "num_steps_trained": 9600}, "done": false, "episodes_total": 8, "training_iteration": 1, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-24-56", "timestamp": 1617996296, "time_this_iter_s": 6.0354859828948975, "time_total_s": 6.0354859828948975, "pid": 7286, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.0354859828948975, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 61.55555555555556, "ram_util_percent": 79.0111111111111}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 0.910144950435761, "episode_reward_min": -0.47244849709001113, "episode_reward_mean": -0.1550706271882709, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.07353598151296681, -0.3569769959891841, -0.04275286401875755, 0.10709091932867665, -0.37673360121483795, 0.910144950435761, -0.35561653498140305, -0.4354366181667416, -0.054457652313613214, -0.214492834043855, -0.3182154033290873, -0.2198416593250443, 0.24606163873606346, -0.47244849709001113, -0.4024496248665412, -0.42146927666079215], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2001020792807986, "mean_inference_ms": 1.0665785238868528, "mean_action_processing_ms": 0.04514944454815538, "mean_env_wait_ms": 1.0403791744677733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 19200, "timers": {"sample_time_ms": 2933.525, "sample_throughput": 3272.514, "learn_time_ms": 2332.244, "learn_throughput": 4116.208, "update_time_ms": 1.501}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": -0.03783048880596956, "policy_loss": -0.05756990570574999, "vf_loss": 0.0029603314058234296, "vf_explained_var": 0.7492677569389343, "kl": 0.01677908698717753, "entropy": -3.3399264144897463, "entropy_coeff": 0.0}}, "num_steps_sampled": 19200, "num_steps_trained": 19200}, "done": false, "episodes_total": 16, "training_iteration": 2, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-25-00", "timestamp": 1617996300, "time_this_iter_s": 4.534918308258057, "time_total_s": 10.570404291152954, "pid": 7286, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.570404291152954, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 32.357142857142854, "ram_util_percent": 79.10000000000001}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 0.910144950435761, "episode_reward_min": -0.6244504225437504, "episode_reward_mean": -0.1302894034402271, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.04947566807095727, 0.20416932979761016, 0.035297151108348634, -0.42750801163328844, -0.6244504225437504, 0.008452637880121072, 0.2200933977385111, -0.012394061829711034, -0.054457652313613214, -0.214492834043855, -0.3182154033290873, -0.2198416593250443, 0.24606163873606346, -0.47244849709001113, -0.4024496248665412, -0.42146927666079215, -0.07353598151296681, -0.3569769959891841, -0.04275286401875755, 0.10709091932867665, -0.37673360121483795, 0.910144950435761, -0.35561653498140305, -0.4354366181667416], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19817077922566406, "mean_inference_ms": 1.052653465235634, "mean_action_processing_ms": 0.044534892011584754, "mean_env_wait_ms": 1.0152333512053187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 28800, "timers": {"sample_time_ms": 3027.086, "sample_throughput": 3171.367, "learn_time_ms": 2324.701, "learn_throughput": 4129.563, "update_time_ms": 1.569}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": -0.036856926133235296, "policy_loss": -0.05590463579942783, "vf_loss": 0.0025663575142001113, "vf_explained_var": 0.8284304141998291, "kl": 0.016481352634727955, "entropy": -3.3797308095296223, "entropy_coeff": 0.0}}, "num_steps_sampled": 28800, "num_steps_trained": 28800}, "done": false, "episodes_total": 24, "training_iteration": 3, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-25-06", "timestamp": 1617996306, "time_this_iter_s": 5.530423164367676, "time_total_s": 16.10082745552063, "pid": 7286, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.10082745552063, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 53.8375, "ram_util_percent": 79.3}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 0.910144950435761, "episode_reward_min": -0.6244504225437504, "episode_reward_mean": -0.036766380382179796, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7753155784437731, -0.26462810669403, 0.6282440292362397, 0.5090114248359743, 0.3189728596010106, -0.33326042668400757, 0.3032143079233267, 0.013551843673409891, -0.054457652313613214, -0.214492834043855, -0.3182154033290873, -0.2198416593250443, 0.24606163873606346, -0.47244849709001113, -0.4024496248665412, -0.42146927666079215, -0.07353598151296681, -0.3569769959891841, -0.04275286401875755, 0.10709091932867665, -0.37673360121483795, 0.910144950435761, -0.35561653498140305, -0.4354366181667416, -0.04947566807095727, 0.20416932979761016, 0.035297151108348634, -0.42750801163328844, -0.6244504225437504, 0.008452637880121072, 0.2200933977385111, -0.012394061829711034], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19436789705020557, "mean_inference_ms": 1.032507197788667, "mean_action_processing_ms": 0.04364459221574652, "mean_env_wait_ms": 0.9875455409529191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 38400, "timers": {"sample_time_ms": 2852.914, "sample_throughput": 3364.98, "learn_time_ms": 2345.657, "learn_throughput": 4092.67, "update_time_ms": 1.653}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": -0.03953332049151262, "policy_loss": -0.0609449452534318, "vf_loss": 0.003411128024260203, "vf_explained_var": 0.8222954869270325, "kl": 0.01800049694875876, "entropy": -3.3817806148529055, "entropy_coeff": 0.0}}, "num_steps_sampled": 38400, "num_steps_trained": 38400}, "done": false, "episodes_total": 32, "training_iteration": 4, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-25-11", "timestamp": 1617996311, "time_this_iter_s": 4.7471184730529785, "time_total_s": 20.84794592857361, "pid": 7286, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.84794592857361, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.53333333333333, "ram_util_percent": 79.31666666666666}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 1.13913258736304, "episode_reward_min": -0.6244504225437504, "episode_reward_mean": 0.08910160724045975, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.31208193797118444, 1.13913258736304, 0.2257519628881961, 1.0589856405136389, -0.12764432032416517, -0.14104921976038698, 0.3278774239580813, 0.9020100366119432, 0.019416229910470317, 0.07698804157229788, 0.3522110930344047, 0.5225589725101931, 0.3691933921596371, 0.7102659002304963, 0.3379185113218033, -0.008132994246643377, -0.054457652313613214, -0.214492834043855, -0.3182154033290873, -0.2198416593250443, 0.24606163873606346, -0.47244849709001113, -0.4024496248665412, -0.42146927666079215, -0.07353598151296681, -0.3569769959891841, -0.04275286401875755, 0.10709091932867665, -0.37673360121483795, 0.910144950435761, -0.35561653498140305, -0.4354366181667416, -0.04947566807095727, 0.20416932979761016, 0.035297151108348634, -0.42750801163328844, -0.6244504225437504, 0.008452637880121072, 0.2200933977385111, -0.012394061829711034, 0.7753155784437731, -0.26462810669403, 0.6282440292362397, 0.5090114248359743, 0.3189728596010106, -0.33326042668400757, 0.3032143079233267, 0.013551843673409891], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1972213974719368, "mean_inference_ms": 1.0201581411836995, "mean_action_processing_ms": 0.043089236574834495, "mean_env_wait_ms": 0.9666175735628779, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 48000, "timers": {"sample_time_ms": 2967.631, "sample_throughput": 3234.904, "learn_time_ms": 2307.221, "learn_throughput": 4160.849, "update_time_ms": 1.636}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": -0.03882498030240337, "policy_loss": -0.06155500363558531, "vf_loss": 0.004268924503897627, "vf_explained_var": 0.8472880721092224, "kl": 0.01846109941601753, "entropy": -3.3949833075205484, "entropy_coeff": 0.0}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 5, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-25-16", "timestamp": 1617996316, "time_this_iter_s": 5.586206674575806, "time_total_s": 26.434152603149414, "pid": 7286, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.434152603149414, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 52.9875, "ram_util_percent": 79.23750000000001}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 3.406714048568264, "episode_reward_min": -0.6244504225437504, "episode_reward_mean": 0.19145733319402816, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3820093829758391, 0.07258829822044954, 3.406714048568264, -0.2823477369667349, 0.7326023655148737, 0.783819027842009, 0.8138989529104215, 0.5354491722583865, -0.054457652313613214, -0.214492834043855, -0.3182154033290873, -0.2198416593250443, 0.24606163873606346, -0.47244849709001113, -0.4024496248665412, -0.42146927666079215, -0.07353598151296681, -0.3569769959891841, -0.04275286401875755, 0.10709091932867665, -0.37673360121483795, 0.910144950435761, -0.35561653498140305, -0.4354366181667416, -0.04947566807095727, 0.20416932979761016, 0.035297151108348634, -0.42750801163328844, -0.6244504225437504, 0.008452637880121072, 0.2200933977385111, -0.012394061829711034, 0.7753155784437731, -0.26462810669403, 0.6282440292362397, 0.5090114248359743, 0.3189728596010106, -0.33326042668400757, 0.3032143079233267, 0.013551843673409891, -0.31208193797118444, 1.13913258736304, 0.2257519628881961, 1.0589856405136389, -0.12764432032416517, -0.14104921976038698, 0.3278774239580813, 0.9020100366119432, 0.019416229910470317, 0.07698804157229788, 0.3522110930344047, 0.5225589725101931, 0.3691933921596371, 0.7102659002304963, 0.3379185113218033, -0.008132994246643377], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1968013318613219, "mean_inference_ms": 1.0123420077813858, "mean_action_processing_ms": 0.04273320573709082, "mean_env_wait_ms": 0.9556204329263246, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 57600, "timers": {"sample_time_ms": 2859.44, "sample_throughput": 3357.3, "learn_time_ms": 2324.93, "learn_throughput": 4129.156, "update_time_ms": 1.595}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": -0.04040004331618548, "policy_loss": -0.06286604388306538, "vf_loss": 0.005192501979569594, "vf_explained_var": 0.843166172504425, "kl": 0.01727349972973267, "entropy": -3.4329565207163495, "entropy_coeff": 0.0}}, "num_steps_sampled": 57600, "num_steps_trained": 57600}, "done": false, "episodes_total": 56, "training_iteration": 6, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-25-21", "timestamp": 1617996321, "time_this_iter_s": 4.737787961959839, "time_total_s": 31.171940565109253, "pid": 7286, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.171940565109253, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.38571428571429, "ram_util_percent": 79.24285714285715}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 3.406714048568264, "episode_reward_min": -0.6244504225437504, "episode_reward_mean": 0.25838512270675296, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.769030005458311, 0.23761067287415405, 1.042488372979797, 2.7175075651770633, -0.015497975189611823, 1.2249895323359583, -0.065037739438222, -0.09605323983083863, -0.054457652313613214, -0.214492834043855, -0.3182154033290873, -0.2198416593250443, 0.24606163873606346, -0.47244849709001113, -0.4024496248665412, -0.42146927666079215, -0.07353598151296681, -0.3569769959891841, -0.04275286401875755, 0.10709091932867665, -0.37673360121483795, 0.910144950435761, -0.35561653498140305, -0.4354366181667416, -0.04947566807095727, 0.20416932979761016, 0.035297151108348634, -0.42750801163328844, -0.6244504225437504, 0.008452637880121072, 0.2200933977385111, -0.012394061829711034, 0.7753155784437731, -0.26462810669403, 0.6282440292362397, 0.5090114248359743, 0.3189728596010106, -0.33326042668400757, 0.3032143079233267, 0.013551843673409891, -0.31208193797118444, 1.13913258736304, 0.2257519628881961, 1.0589856405136389, -0.12764432032416517, -0.14104921976038698, 0.3278774239580813, 0.9020100366119432, 0.019416229910470317, 0.07698804157229788, 0.3522110930344047, 0.5225589725101931, 0.3691933921596371, 0.7102659002304963, 0.3379185113218033, -0.008132994246643377, 0.3820093829758391, 0.07258829822044954, 3.406714048568264, -0.2823477369667349, 0.7326023655148737, 0.783819027842009, 0.8138989529104215, 0.5354491722583865], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1967004082088707, "mean_inference_ms": 1.0083682429382237, "mean_action_processing_ms": 0.04254652003278374, "mean_env_wait_ms": 0.9491084147158808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 67200, "timers": {"sample_time_ms": 2898.384, "sample_throughput": 3312.191, "learn_time_ms": 2302.577, "learn_throughput": 4169.242, "update_time_ms": 1.591}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": -0.041156648993492126, "policy_loss": -0.06407821328689654, "vf_loss": 0.004702408770099282, "vf_explained_var": 0.8823134303092957, "kl": 0.018219154501954715, "entropy": -3.47615229288737, "entropy_coeff": 0.0}}, "num_steps_sampled": 67200, "num_steps_trained": 67200}, "done": false, "episodes_total": 64, "training_iteration": 7, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-25-26", "timestamp": 1617996326, "time_this_iter_s": 5.307594537734985, "time_total_s": 36.47953510284424, "pid": 7286, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 36.47953510284424, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 47.475, "ram_util_percent": 79.25}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 3.406714048568264, "episode_reward_min": -0.6244504225437504, "episode_reward_mean": 0.29491534220780413, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.009542179612183954, 0.590347511485984, 0.8438734224814308, 0.5360309122907418, 1.0083210501526603, 0.5775428519079611, 0.45219489761301923, 0.6794039601857247, -0.054457652313613214, -0.214492834043855, -0.3182154033290873, -0.2198416593250443, 0.24606163873606346, -0.47244849709001113, -0.4024496248665412, -0.42146927666079215, -0.07353598151296681, -0.3569769959891841, -0.04275286401875755, 0.10709091932867665, -0.37673360121483795, 0.910144950435761, -0.35561653498140305, -0.4354366181667416, -0.04947566807095727, 0.20416932979761016, 0.035297151108348634, -0.42750801163328844, -0.6244504225437504, 0.008452637880121072, 0.2200933977385111, -0.012394061829711034, 0.7753155784437731, -0.26462810669403, 0.6282440292362397, 0.5090114248359743, 0.3189728596010106, -0.33326042668400757, 0.3032143079233267, 0.013551843673409891, -0.31208193797118444, 1.13913258736304, 0.2257519628881961, 1.0589856405136389, -0.12764432032416517, -0.14104921976038698, 0.3278774239580813, 0.9020100366119432, 0.019416229910470317, 0.07698804157229788, 0.3522110930344047, 0.5225589725101931, 0.3691933921596371, 0.7102659002304963, 0.3379185113218033, -0.008132994246643377, 0.3820093829758391, 0.07258829822044954, 3.406714048568264, -0.2823477369667349, 0.7326023655148737, 0.783819027842009, 0.8138989529104215, 0.5354491722583865, 0.769030005458311, 0.23761067287415405, 1.042488372979797, 2.7175075651770633, -0.015497975189611823, 1.2249895323359583, -0.065037739438222, -0.09605323983083863], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19596773520854865, "mean_inference_ms": 1.0028069206569503, "mean_action_processing_ms": 0.04229378747098898, "mean_env_wait_ms": 0.9413921282470061, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 76800, "timers": {"sample_time_ms": 2818.015, "sample_throughput": 3406.654, "learn_time_ms": 2329.717, "learn_throughput": 4120.672, "update_time_ms": 1.571}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": -0.04560863476867477, "policy_loss": -0.07028798631081978, "vf_loss": 0.004030205719172955, "vf_explained_var": 0.8891076445579529, "kl": 0.020649145742257437, "entropy": -3.488132807413737, "entropy_coeff": 0.0}}, "num_steps_sampled": 76800, "num_steps_trained": 76800}, "done": false, "episodes_total": 72, "training_iteration": 8, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-25-31", "timestamp": 1617996331, "time_this_iter_s": 4.781737804412842, "time_total_s": 41.26127290725708, "pid": 7286, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.26127290725708, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.56666666666667, "ram_util_percent": 79.26666666666667}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 3.406714048568264, "episode_reward_min": -0.6244504225437504, "episode_reward_mean": 0.33488324257852675, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.47749843039313866, 0.22867846674879977, 0.5042612575454406, 0.972363511419543, 1.0218801666007669, 1.1801440665222445, 0.5806701636209999, 0.5912587044693145, -0.054457652313613214, -0.214492834043855, -0.3182154033290873, -0.2198416593250443, 0.24606163873606346, -0.47244849709001113, -0.4024496248665412, -0.42146927666079215, -0.07353598151296681, -0.3569769959891841, -0.04275286401875755, 0.10709091932867665, -0.37673360121483795, 0.910144950435761, -0.35561653498140305, -0.4354366181667416, -0.04947566807095727, 0.20416932979761016, 0.035297151108348634, -0.42750801163328844, -0.6244504225437504, 0.008452637880121072, 0.2200933977385111, -0.012394061829711034, 0.7753155784437731, -0.26462810669403, 0.6282440292362397, 0.5090114248359743, 0.3189728596010106, -0.33326042668400757, 0.3032143079233267, 0.013551843673409891, -0.31208193797118444, 1.13913258736304, 0.2257519628881961, 1.0589856405136389, -0.12764432032416517, -0.14104921976038698, 0.3278774239580813, 0.9020100366119432, 0.019416229910470317, 0.07698804157229788, 0.3522110930344047, 0.5225589725101931, 0.3691933921596371, 0.7102659002304963, 0.3379185113218033, -0.008132994246643377, 0.3820093829758391, 0.07258829822044954, 3.406714048568264, -0.2823477369667349, 0.7326023655148737, 0.783819027842009, 0.8138989529104215, 0.5354491722583865, 0.769030005458311, 0.23761067287415405, 1.042488372979797, 2.7175075651770633, -0.015497975189611823, 1.2249895323359583, -0.065037739438222, -0.09605323983083863, 0.009542179612183954, 0.590347511485984, 0.8438734224814308, 0.5360309122907418, 1.0083210501526603, 0.5775428519079611, 0.45219489761301923, 0.6794039601857247], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.195462667137634, "mean_inference_ms": 0.999220473917334, "mean_action_processing_ms": 0.04212822481916932, "mean_env_wait_ms": 0.9360256485492805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 86400, "timers": {"sample_time_ms": 2831.723, "sample_throughput": 3390.162, "learn_time_ms": 2304.655, "learn_throughput": 4165.483, "update_time_ms": 1.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": -0.041022364602734646, "policy_loss": -0.07062123081336419, "vf_loss": 0.004672436040515701, "vf_explained_var": 0.8787517547607422, "kl": 0.016617620574931304, "entropy": -3.5088074270884198, "entropy_coeff": 0.0}}, "num_steps_sampled": 86400, "num_steps_trained": 86400}, "done": false, "episodes_total": 80, "training_iteration": 9, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-25-36", "timestamp": 1617996336, "time_this_iter_s": 5.05134391784668, "time_total_s": 46.31261682510376, "pid": 7286, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.31261682510376, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 47.150000000000006, "ram_util_percent": 79.25}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 4.109226901940404, "episode_reward_min": -0.6244504225437504, "episode_reward_mean": 0.5041659469886696, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.400361522761265, 0.7592109716897419, 4.109226901940404, 1.092742111198151, 0.7353917897221534, 2.4372987809259263, 1.3303044651788865, 0.8269085395039619, 1.278726134174672, 0.3941449293345811, 1.0220793428037704, 0.044511813341774564, -0.09357695664567467, 2.4995307197857426, 1.8546579663709188, 0.9177524725438637, -0.054457652313613214, -0.214492834043855, -0.3182154033290873, -0.2198416593250443, 0.24606163873606346, -0.47244849709001113, -0.4024496248665412, -0.42146927666079215, -0.07353598151296681, -0.3569769959891841, -0.04275286401875755, 0.10709091932867665, -0.37673360121483795, 0.910144950435761, -0.35561653498140305, -0.4354366181667416, -0.04947566807095727, 0.20416932979761016, 0.035297151108348634, -0.42750801163328844, -0.6244504225437504, 0.008452637880121072, 0.2200933977385111, -0.012394061829711034, 0.7753155784437731, -0.26462810669403, 0.6282440292362397, 0.5090114248359743, 0.3189728596010106, -0.33326042668400757, 0.3032143079233267, 0.013551843673409891, -0.31208193797118444, 1.13913258736304, 0.2257519628881961, 1.0589856405136389, -0.12764432032416517, -0.14104921976038698, 0.3278774239580813, 0.9020100366119432, 0.019416229910470317, 0.07698804157229788, 0.3522110930344047, 0.5225589725101931, 0.3691933921596371, 0.7102659002304963, 0.3379185113218033, -0.008132994246643377, 0.3820093829758391, 0.07258829822044954, 3.406714048568264, -0.2823477369667349, 0.7326023655148737, 0.783819027842009, 0.8138989529104215, 0.5354491722583865, 0.769030005458311, 0.23761067287415405, 1.042488372979797, 2.7175075651770633, -0.015497975189611823, 1.2249895323359583, -0.065037739438222, -0.09605323983083863, 0.009542179612183954, 0.590347511485984, 0.8438734224814308, 0.5360309122907418, 1.0083210501526603, 0.5775428519079611, 0.45219489761301923, 0.6794039601857247, 0.47749843039313866, 0.22867846674879977, 0.5042612575454406, 0.972363511419543, 1.0218801666007669, 1.1801440665222445, 0.5806701636209999, 0.5912587044693145], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19529359944146232, "mean_inference_ms": 0.9911106982752947, "mean_action_processing_ms": 0.0417627217435859, "mean_env_wait_ms": 0.9250405270433527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 96000, "timers": {"sample_time_ms": 2784.252, "sample_throughput": 3447.963, "learn_time_ms": 2326.37, "learn_throughput": 4126.601, "update_time_ms": 1.542}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": -0.03144132489959399, "policy_loss": -0.06218375604599714, "vf_loss": 0.009601446936527888, "vf_explained_var": 0.8313378691673279, "kl": 0.014093990474939345, "entropy": -3.562887290318807, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 10, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-25-41", "timestamp": 1617996341, "time_this_iter_s": 4.887197494506836, "time_total_s": 51.199814319610596, "pid": 7286, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.199814319610596, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.84285714285715, "ram_util_percent": 79.28571428571429}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 3.64709869913787, "episode_reward_min": 0.8475601726744275, "episode_reward_mean": 2.0697003181985827, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2867068356892037, 2.145248937348942, 0.8475601726744275, 2.1829755184084023, 2.28490735151927, 1.2249400039365406, 3.64709869913787, 2.9381650268740067], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16396542969194677, "mean_inference_ms": 0.9237132550874022, "mean_action_processing_ms": 0.03970505593718339, "mean_env_wait_ms": 0.9147052363888806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 105600, "timers": {"sample_time_ms": 3110.948, "sample_throughput": 3085.876, "learn_time_ms": 2799.395, "learn_throughput": 3429.312, "update_time_ms": 1.55}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": -0.04287383576855063, "policy_loss": -0.07048992149531841, "vf_loss": 0.006220085782309373, "vf_explained_var": 0.8817968964576721, "kl": 0.021395999441544213, "entropy": -3.5974721050262453, "entropy_coeff": 0.0}}, "num_steps_sampled": 105600, "num_steps_trained": 105600}, "done": false, "episodes_total": 104, "training_iteration": 11, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-27-03", "timestamp": 1617996423, "time_this_iter_s": 5.916934490203857, "time_total_s": 57.11674880981445, "pid": 8171, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.916934490203857, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.56666666666666, "ram_util_percent": 79.3}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 4.80287917426557, "episode_reward_min": 0.8475601726744275, "episode_reward_mean": 2.6636976259825333, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.253105322013047, 1.7814393257298642, 4.631174603486263, 4.558677779230923, 3.1985191996763733, 4.80287917426557, 3.986197187769056, 1.8495668779607728, 1.2867068356892037, 2.145248937348942, 0.8475601726744275, 2.1829755184084023, 2.28490735151927, 1.2249400039365406, 3.64709869913787, 2.9381650268740067], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1633439796928355, "mean_inference_ms": 0.9092197916101254, "mean_action_processing_ms": 0.03900103521987839, "mean_env_wait_ms": 0.8814679599795423, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 115200, "timers": {"sample_time_ms": 2812.588, "sample_throughput": 3413.227, "learn_time_ms": 2878.321, "learn_throughput": 3335.277, "update_time_ms": 1.475}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": -0.03092150970051686, "policy_loss": -0.0674473279590408, "vf_loss": 0.012970635903378328, "vf_explained_var": 0.8474207520484924, "kl": 0.015703452738622826, "entropy": -3.6179854424794513, "entropy_coeff": 0.0}}, "num_steps_sampled": 115200, "num_steps_trained": 115200}, "done": false, "episodes_total": 112, "training_iteration": 12, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-27-09", "timestamp": 1617996429, "time_this_iter_s": 5.476853132247925, "time_total_s": 62.59360194206238, "pid": 8171, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.393787622451782, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.875, "ram_util_percent": 79.3625}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 7.847940962770743, "episode_reward_min": 0.8450152405318361, "episode_reward_mean": 3.1033008147000505, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.105850364473001, 1.6049007691510808, 6.804564354590787, 0.8450152405318361, 5.274012485324715, 2.8273476499052266, 5.550425710333294, 7.847940962770743, 1.2867068356892037, 2.145248937348942, 0.8475601726744275, 2.1829755184084023, 2.28490735151927, 1.2249400039365406, 3.64709869913787, 2.9381650268740067, 1.253105322013047, 1.7814393257298642, 4.631174603486263, 4.558677779230923, 3.1985191996763733, 4.80287917426557, 3.986197187769056, 1.8495668779607728], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1619669072399638, "mean_inference_ms": 0.8977934312213557, "mean_action_processing_ms": 0.03847461039385854, "mean_env_wait_ms": 0.859525874295144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 124800, "timers": {"sample_time_ms": 2679.211, "sample_throughput": 3583.144, "learn_time_ms": 2890.109, "learn_throughput": 3321.674, "update_time_ms": 1.566}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": -0.022482729678352673, "policy_loss": -0.06524723590662082, "vf_loss": 0.019288272534807523, "vf_explained_var": 0.8210971355438232, "kl": 0.01565082147717476, "entropy": -3.650956179300944, "entropy_coeff": 0.0}}, "num_steps_sampled": 124800, "num_steps_trained": 124800}, "done": false, "episodes_total": 120, "training_iteration": 13, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-27-14", "timestamp": 1617996434, "time_this_iter_s": 5.332002878189087, "time_total_s": 67.92560482025146, "pid": 8171, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.72579050064087, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.371428571428574, "ram_util_percent": 79.39999999999999}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 16.749801425392935, "episode_reward_min": 0.8450152405318361, "episode_reward_mean": 3.9350895116635862, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.749801425392935, 4.827542116768909, 4.298409325372278, 2.5596953052378235, 5.356560049111152, 11.400494359629015, 2.874300256214852, 3.3768419827065905, 1.2867068356892037, 2.145248937348942, 0.8475601726744275, 2.1829755184084023, 2.28490735151927, 1.2249400039365406, 3.64709869913787, 2.9381650268740067, 1.253105322013047, 1.7814393257298642, 4.631174603486263, 4.558677779230923, 3.1985191996763733, 4.80287917426557, 3.986197187769056, 1.8495668779607728, 1.105850364473001, 1.6049007691510808, 6.804564354590787, 0.8450152405318361, 5.274012485324715, 2.8273476499052266, 5.550425710333294, 7.847940962770743], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16083397970030397, "mean_inference_ms": 0.8891478830077332, "mean_action_processing_ms": 0.03808042215687432, "mean_env_wait_ms": 0.8440672170708228, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 134400, "timers": {"sample_time_ms": 2615.456, "sample_throughput": 3670.488, "learn_time_ms": 2958.847, "learn_throughput": 3244.507, "update_time_ms": 1.563}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.003599557944883903, "policy_loss": -0.061926158045729, "vf_loss": 0.042454610566298165, "vf_explained_var": 0.7768838405609131, "kl": 0.0153807366391023, "entropy": -3.663605098724365, "entropy_coeff": 0.0}}, "num_steps_sampled": 134400, "num_steps_trained": 134400}, "done": false, "episodes_total": 128, "training_iteration": 14, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-27-20", "timestamp": 1617996440, "time_this_iter_s": 5.595253229141235, "time_total_s": 73.5208580493927, "pid": 8171, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.321043729782104, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.3875, "ram_util_percent": 79.375}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 16.749801425392935, "episode_reward_min": 0.8450152405318361, "episode_reward_mean": 4.724273996237408, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.885824570623282, 8.433905337891026, 3.854154028070811, 5.498587669155025, 7.397346467472875, 3.8723116365223884, 12.700876168739297, 4.016590171776563, 2.899625163536479, 5.213947294890281, 7.774267920110319, 6.343557302946729, 6.5366209694356785, 8.062211966725414, 5.534481214256323, 6.817979564008339, 1.2867068356892037, 2.145248937348942, 0.8475601726744275, 2.1829755184084023, 2.28490735151927, 1.2249400039365406, 3.64709869913787, 2.9381650268740067, 1.253105322013047, 1.7814393257298642, 4.631174603486263, 4.558677779230923, 3.1985191996763733, 4.80287917426557, 3.986197187769056, 1.8495668779607728, 1.105850364473001, 1.6049007691510808, 6.804564354590787, 0.8450152405318361, 5.274012485324715, 2.8273476499052266, 5.550425710333294, 7.847940962770743, 16.749801425392935, 4.827542116768909, 4.298409325372278, 2.5596953052378235, 5.356560049111152, 11.400494359629015, 2.874300256214852, 3.3768419827065905], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1674080914211431, "mean_inference_ms": 0.8998502558331047, "mean_action_processing_ms": 0.03813188818072976, "mean_env_wait_ms": 0.8372132251874623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 144000, "timers": {"sample_time_ms": 2734.906, "sample_throughput": 3510.175, "learn_time_ms": 2965.877, "learn_throughput": 3236.817, "update_time_ms": 1.545}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": -0.009826414790004491, "policy_loss": -0.06187479357545574, "vf_loss": 0.02856811247766018, "vf_explained_var": 0.8953730463981628, "kl": 0.015653510491053263, "entropy": -3.7577262433369953, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 15, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-27-26", "timestamp": 1617996446, "time_this_iter_s": 6.212901592254639, "time_total_s": 79.73375964164734, "pid": 8171, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.533945322036743, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 48.15555555555555, "ram_util_percent": 79.57777777777778}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 16.749801425392935, "episode_reward_min": 0.8450152405318361, "episode_reward_mean": 4.942909118164126, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.767773320283045, 3.992304772241571, 3.830417190315445, 8.186490152338449, 4.727300385425889, 9.38359822527393, 5.187032470686168, 5.962842281230987, 1.2867068356892037, 2.145248937348942, 0.8475601726744275, 2.1829755184084023, 2.28490735151927, 1.2249400039365406, 3.64709869913787, 2.9381650268740067, 1.253105322013047, 1.7814393257298642, 4.631174603486263, 4.558677779230923, 3.1985191996763733, 4.80287917426557, 3.986197187769056, 1.8495668779607728, 1.105850364473001, 1.6049007691510808, 6.804564354590787, 0.8450152405318361, 5.274012485324715, 2.8273476499052266, 5.550425710333294, 7.847940962770743, 16.749801425392935, 4.827542116768909, 4.298409325372278, 2.5596953052378235, 5.356560049111152, 11.400494359629015, 2.874300256214852, 3.3768419827065905, 5.885824570623282, 8.433905337891026, 3.854154028070811, 5.498587669155025, 7.397346467472875, 3.8723116365223884, 12.700876168739297, 4.016590171776563, 2.899625163536479, 5.213947294890281, 7.774267920110319, 6.343557302946729, 6.5366209694356785, 8.062211966725414, 5.534481214256323, 6.817979564008339], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16983135368342048, "mean_inference_ms": 0.9058888250485008, "mean_action_processing_ms": 0.038303138930084295, "mean_env_wait_ms": 0.8386556555220525, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 153600, "timers": {"sample_time_ms": 2785.104, "sample_throughput": 3446.909, "learn_time_ms": 2938.526, "learn_throughput": 3266.944, "update_time_ms": 1.514}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": -0.022346754297614096, "policy_loss": -0.06690999132891497, "vf_loss": 0.019781918053825696, "vf_explained_var": 0.9091556668281555, "kl": 0.016520878473917644, "entropy": -3.7489885679880777, "entropy_coeff": 0.0}}, "num_steps_sampled": 153600, "num_steps_trained": 153600}, "done": false, "episodes_total": 152, "training_iteration": 16, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-27-32", "timestamp": 1617996452, "time_this_iter_s": 5.844452381134033, "time_total_s": 85.57821202278137, "pid": 8171, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.378397703170776, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 44.03333333333333, "ram_util_percent": 79.74444444444445}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 16.749801425392935, "episode_reward_min": 0.8450152405318361, "episode_reward_mean": 5.191603059593894, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.010912441334108, 6.873057658420868, 6.035271871264071, 15.546079164858146, 7.038975415805927, 6.337041096159061, 5.702088824116498, 4.916258724859466, 1.2867068356892037, 2.145248937348942, 0.8475601726744275, 2.1829755184084023, 2.28490735151927, 1.2249400039365406, 3.64709869913787, 2.9381650268740067, 1.253105322013047, 1.7814393257298642, 4.631174603486263, 4.558677779230923, 3.1985191996763733, 4.80287917426557, 3.986197187769056, 1.8495668779607728, 1.105850364473001, 1.6049007691510808, 6.804564354590787, 0.8450152405318361, 5.274012485324715, 2.8273476499052266, 5.550425710333294, 7.847940962770743, 16.749801425392935, 4.827542116768909, 4.298409325372278, 2.5596953052378235, 5.356560049111152, 11.400494359629015, 2.874300256214852, 3.3768419827065905, 5.885824570623282, 8.433905337891026, 3.854154028070811, 5.498587669155025, 7.397346467472875, 3.8723116365223884, 12.700876168739297, 4.016590171776563, 2.899625163536479, 5.213947294890281, 7.774267920110319, 6.343557302946729, 6.5366209694356785, 8.062211966725414, 5.534481214256323, 6.817979564008339, 8.767773320283045, 3.992304772241571, 3.830417190315445, 8.186490152338449, 4.727300385425889, 9.38359822527393, 5.187032470686168, 5.962842281230987], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17227969406082017, "mean_inference_ms": 0.9137174867306708, "mean_action_processing_ms": 0.03859983990726902, "mean_env_wait_ms": 0.8432743824468565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 163200, "timers": {"sample_time_ms": 2840.605, "sample_throughput": 3379.562, "learn_time_ms": 2945.505, "learn_throughput": 3259.204, "update_time_ms": 1.607}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.0038524695734182992, "policy_loss": -0.05662434322138627, "vf_loss": 0.03848082815607389, "vf_explained_var": 0.8793262839317322, "kl": 0.01466399093468984, "entropy": -3.742218313217163, "entropy_coeff": 0.0}}, "num_steps_sampled": 163200, "num_steps_trained": 163200}, "done": false, "episodes_total": 160, "training_iteration": 17, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-27-38", "timestamp": 1617996458, "time_this_iter_s": 6.175322771072388, "time_total_s": 91.75353479385376, "pid": 8171, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.553720474243164, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 50.74444444444444, "ram_util_percent": 79.56666666666666}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 16.749801425392935, "episode_reward_min": 0.8450152405318361, "episode_reward_mean": 5.558240616851582, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.599036305364, 6.316548666718959, 13.158672192296475, 6.220440610475468, 5.690396994088802, 10.145280391251758, 6.007619685018926, 9.792733754090234, 1.2867068356892037, 2.145248937348942, 0.8475601726744275, 2.1829755184084023, 2.28490735151927, 1.2249400039365406, 3.64709869913787, 2.9381650268740067, 1.253105322013047, 1.7814393257298642, 4.631174603486263, 4.558677779230923, 3.1985191996763733, 4.80287917426557, 3.986197187769056, 1.8495668779607728, 1.105850364473001, 1.6049007691510808, 6.804564354590787, 0.8450152405318361, 5.274012485324715, 2.8273476499052266, 5.550425710333294, 7.847940962770743, 16.749801425392935, 4.827542116768909, 4.298409325372278, 2.5596953052378235, 5.356560049111152, 11.400494359629015, 2.874300256214852, 3.3768419827065905, 5.885824570623282, 8.433905337891026, 3.854154028070811, 5.498587669155025, 7.397346467472875, 3.8723116365223884, 12.700876168739297, 4.016590171776563, 2.899625163536479, 5.213947294890281, 7.774267920110319, 6.343557302946729, 6.5366209694356785, 8.062211966725414, 5.534481214256323, 6.817979564008339, 8.767773320283045, 3.992304772241571, 3.830417190315445, 8.186490152338449, 4.727300385425889, 9.38359822527393, 5.187032470686168, 5.962842281230987, 3.010912441334108, 6.873057658420868, 6.035271871264071, 15.546079164858146, 7.038975415805927, 6.337041096159061, 5.702088824116498, 4.916258724859466], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17402742110140768, "mean_inference_ms": 0.920099090206655, "mean_action_processing_ms": 0.03887737446195591, "mean_env_wait_ms": 0.847356215337749, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 172800, "timers": {"sample_time_ms": 2839.378, "sample_throughput": 3381.022, "learn_time_ms": 3044.149, "learn_throughput": 3153.59, "update_time_ms": 1.661}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": -0.01358711330840985, "policy_loss": -0.0666240489234527, "vf_loss": 0.030226950297753016, "vf_explained_var": 0.9171866774559021, "kl": 0.01520665687819322, "entropy": -3.7804405593872072, "entropy_coeff": 0.0}}, "num_steps_sampled": 172800, "num_steps_trained": 172800}, "done": false, "episodes_total": 168, "training_iteration": 18, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-27-45", "timestamp": 1617996465, "time_this_iter_s": 6.574235677719116, "time_total_s": 98.32777047157288, "pid": 8171, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.12795615196228, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 57.400000000000006, "ram_util_percent": 74.42222222222222}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 18.057507810481443, "episode_reward_min": 0.8450152405318361, "episode_reward_mean": 5.982956295043403, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.02090233247901, 5.032849698866352, 8.89171776280309, 13.175217834737898, 3.046971103354215, 7.039106263641333, 11.178906383795033, 18.057507810481443, 1.2867068356892037, 2.145248937348942, 0.8475601726744275, 2.1829755184084023, 2.28490735151927, 1.2249400039365406, 3.64709869913787, 2.9381650268740067, 1.253105322013047, 1.7814393257298642, 4.631174603486263, 4.558677779230923, 3.1985191996763733, 4.80287917426557, 3.986197187769056, 1.8495668779607728, 1.105850364473001, 1.6049007691510808, 6.804564354590787, 0.8450152405318361, 5.274012485324715, 2.8273476499052266, 5.550425710333294, 7.847940962770743, 16.749801425392935, 4.827542116768909, 4.298409325372278, 2.5596953052378235, 5.356560049111152, 11.400494359629015, 2.874300256214852, 3.3768419827065905, 5.885824570623282, 8.433905337891026, 3.854154028070811, 5.498587669155025, 7.397346467472875, 3.8723116365223884, 12.700876168739297, 4.016590171776563, 2.899625163536479, 5.213947294890281, 7.774267920110319, 6.343557302946729, 6.5366209694356785, 8.062211966725414, 5.534481214256323, 6.817979564008339, 8.767773320283045, 3.992304772241571, 3.830417190315445, 8.186490152338449, 4.727300385425889, 9.38359822527393, 5.187032470686168, 5.962842281230987, 3.010912441334108, 6.873057658420868, 6.035271871264071, 15.546079164858146, 7.038975415805927, 6.337041096159061, 5.702088824116498, 4.916258724859466, 10.599036305364, 6.316548666718959, 13.158672192296475, 6.220440610475468, 5.690396994088802, 10.145280391251758, 6.007619685018926, 9.792733754090234], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17576399531365078, "mean_inference_ms": 0.927520112715418, "mean_action_processing_ms": 0.03920605032782414, "mean_env_wait_ms": 0.8531120600564496, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 182400, "timers": {"sample_time_ms": 2893.086, "sample_throughput": 3318.256, "learn_time_ms": 3009.224, "learn_throughput": 3190.192, "update_time_ms": 1.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.01345408145338297, "policy_loss": -0.06298298127949238, "vf_loss": 0.05237983639041583, "vf_explained_var": 0.9122428297996521, "kl": 0.01603815075010061, "entropy": -3.7923363081614174, "entropy_coeff": 0.0}}, "num_steps_sampled": 182400, "num_steps_trained": 182400}, "done": false, "episodes_total": 176, "training_iteration": 19, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-27-51", "timestamp": 1617996471, "time_this_iter_s": 6.059898853302002, "time_total_s": 104.38766932487488, "pid": 8171, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.18785500526428, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 50.96666666666667, "ram_util_percent": 78.88888888888889}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 19.716796241022237, "episode_reward_min": 6.044288117402092, "episode_reward_mean": 10.48992230652718, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.545592178292365, 8.992224955214455, 6.283564886405576, 16.446698889311087, 19.716796241022237, 7.625110716771863, 10.265102467797767, 6.044288117402092], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16601370038041263, "mean_inference_ms": 0.9026539067642376, "mean_action_processing_ms": 0.0386250505439447, "mean_env_wait_ms": 0.9002957266633655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 192000, "timers": {"sample_time_ms": 2894.661, "sample_throughput": 3316.451, "learn_time_ms": 2943.748, "learn_throughput": 3261.149, "update_time_ms": 1.553}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": 0.010126240644603967, "policy_loss": -0.06130476544300715, "vf_loss": 0.05177615190545718, "vf_explained_var": 0.9098094701766968, "kl": 0.01965485433737437, "entropy": -3.8667123126983642, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 184, "training_iteration": 20, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-29-52", "timestamp": 1617996592, "time_this_iter_s": 5.8462488651275635, "time_total_s": 110.23391819000244, "pid": 9767, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.8462488651275635, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.94444444444444, "ram_util_percent": 75.98888888888888}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 19.716796241022237, "episode_reward_min": 4.23718087494883, "episode_reward_mean": 10.846231681551858, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.569338337184684, 17.215509593184777, 15.974019384123515, 9.20802092330573, 18.911019019988153, 4.23718087494883, 4.301721488945603, 9.203518830931001, 8.545592178292365, 8.992224955214455, 6.283564886405576, 16.446698889311087, 19.716796241022237, 7.625110716771863, 10.265102467797767, 6.044288117402092], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18280431451088683, "mean_inference_ms": 0.9787471986575726, "mean_action_processing_ms": 0.042119655485800794, "mean_env_wait_ms": 0.9601621869618508, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 201600, "timers": {"sample_time_ms": 3198.895, "sample_throughput": 3001.036, "learn_time_ms": 3047.511, "learn_throughput": 3150.112, "update_time_ms": 1.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": 0.018269505811234314, "policy_loss": -0.06303837198764085, "vf_loss": 0.06143701131145159, "vf_explained_var": 0.9205644726753235, "kl": 0.019870868027210234, "entropy": -3.8809526697794596, "entropy_coeff": 0.0}}, "num_steps_sampled": 201600, "num_steps_trained": 201600}, "done": false, "episodes_total": 192, "training_iteration": 21, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-29-59", "timestamp": 1617996599, "time_this_iter_s": 6.660111904144287, "time_total_s": 116.89403009414673, "pid": 9767, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.50636076927185, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 64.4, "ram_util_percent": 77.45555555555556}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 23.228556003685316, "episode_reward_min": 4.23718087494883, "episode_reward_mean": 11.345729416663183, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.735724380585653, 12.227259724148182, 8.642081017797969, 9.065659146275314, 13.220587807116614, 12.197924654043813, 23.228556003685316, 11.440006361433756, 8.545592178292365, 8.992224955214455, 6.283564886405576, 16.446698889311087, 19.716796241022237, 7.625110716771863, 10.265102467797767, 6.044288117402092, 10.569338337184684, 17.215509593184777, 15.974019384123515, 9.20802092330573, 18.911019019988153, 4.23718087494883, 4.301721488945603, 9.203518830931001], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18253917044892967, "mean_inference_ms": 0.975108159178156, "mean_action_processing_ms": 0.041968764315852135, "mean_env_wait_ms": 0.9455811428833344, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 211200, "timers": {"sample_time_ms": 2863.535, "sample_throughput": 3352.5, "learn_time_ms": 3079.538, "learn_throughput": 3117.351, "update_time_ms": 1.483}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": 0.023674857914447785, "policy_loss": -0.06415419607112804, "vf_loss": 0.06805691517889499, "vf_explained_var": 0.9240924119949341, "kl": 0.01977213880668084, "entropy": -3.920466823577881, "entropy_coeff": 0.0}}, "num_steps_sampled": 211200, "num_steps_trained": 211200}, "done": false, "episodes_total": 200, "training_iteration": 22, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-30-04", "timestamp": 1617996604, "time_this_iter_s": 5.34235954284668, "time_total_s": 122.23638963699341, "pid": 9767, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.84872031211853, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.8125, "ram_util_percent": 79.0125}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 32.29062047229868, "episode_reward_min": 4.23718087494883, "episode_reward_mean": 12.003204305037293, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.013714025734329, 10.489963943758937, 8.073801265066416, 11.382184346973775, 32.29062047229868, 9.09553436266389, 16.548622607365456, 11.910590737415506, 8.545592178292365, 8.992224955214455, 6.283564886405576, 16.446698889311087, 19.716796241022237, 7.625110716771863, 10.265102467797767, 6.044288117402092, 10.569338337184684, 17.215509593184777, 15.974019384123515, 9.20802092330573, 18.911019019988153, 4.23718087494883, 4.301721488945603, 9.203518830931001, 8.735724380585653, 12.227259724148182, 8.642081017797969, 9.065659146275314, 13.220587807116614, 12.197924654043813, 23.228556003685316, 11.440006361433756], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1802821174287586, "mean_inference_ms": 0.9625518603288256, "mean_action_processing_ms": 0.04141426968287303, "mean_env_wait_ms": 0.9255567964149771, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 220800, "timers": {"sample_time_ms": 2712.152, "sample_throughput": 3539.625, "learn_time_ms": 3080.326, "learn_throughput": 3116.553, "update_time_ms": 1.466}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": 0.08211240963389477, "policy_loss": -0.05974759085724751, "vf_loss": 0.12128746877113979, "vf_explained_var": 0.9079661965370178, "kl": 0.02057253209253152, "entropy": -3.952453997929891, "entropy_coeff": 0.0}}, "num_steps_sampled": 220800, "num_steps_trained": 220800}, "done": false, "episodes_total": 208, "training_iteration": 23, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-30-10", "timestamp": 1617996610, "time_this_iter_s": 5.346055030822754, "time_total_s": 127.58244466781616, "pid": 9767, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.194775342941284, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.7625, "ram_util_percent": 79.1}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 56.467967759645425, "episode_reward_min": 4.23718087494883, "episode_reward_mean": 14.718981290440558, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.796370011857697, 14.705955222406999, 11.446510483848066, 56.467967759645425, 10.218388489971517, 20.111519744461813, 18.50838820506743, 8.948090257581969, 32.79923510200911, 16.960885511562275, 15.642976275452341, 21.497262158068747, 10.511359801179484, 21.698541415723064, 22.969262107492963, 15.125851633624606, 8.545592178292365, 8.992224955214455, 6.283564886405576, 16.446698889311087, 19.716796241022237, 7.625110716771863, 10.265102467797767, 6.044288117402092, 10.569338337184684, 17.215509593184777, 15.974019384123515, 9.20802092330573, 18.911019019988153, 4.23718087494883, 4.301721488945603, 9.203518830931001, 8.735724380585653, 12.227259724148182, 8.642081017797969, 9.065659146275314, 13.220587807116614, 12.197924654043813, 23.228556003685316, 11.440006361433756, 12.013714025734329, 10.489963943758937, 8.073801265066416, 11.382184346973775, 32.29062047229868, 9.09553436266389, 16.548622607365456, 11.910590737415506], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18019796048339368, "mean_inference_ms": 0.9519865926442036, "mean_action_processing_ms": 0.04055549264926766, "mean_env_wait_ms": 0.8973086113270122, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 230400, "timers": {"sample_time_ms": 2700.254, "sample_throughput": 3555.221, "learn_time_ms": 3078.87, "learn_throughput": 3118.027, "update_time_ms": 1.491}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.3785243793328603, "policy_loss": -0.04665174496670564, "vf_loss": 0.402084502975146, "vf_explained_var": 0.825206458568573, "kl": 0.015394412515064081, "entropy": -4.0644393634796145, "entropy_coeff": 0.0}}, "num_steps_sampled": 230400, "num_steps_trained": 230400}, "done": false, "episodes_total": 224, "training_iteration": 24, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-30-15", "timestamp": 1617996615, "time_this_iter_s": 5.732066869735718, "time_total_s": 133.31451153755188, "pid": 9767, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.926842212677002, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.9625, "ram_util_percent": 79.1125}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 56.467967759645425, "episode_reward_min": 4.23718087494883, "episode_reward_mean": 14.742147374069557, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.861368452850835, 20.437621984929923, 17.00584821889353, 15.993904688723948, 7.430807479038608, 15.319079346850785, 14.433872528465582, 15.566648306995017, 8.545592178292365, 8.992224955214455, 6.283564886405576, 16.446698889311087, 19.716796241022237, 7.625110716771863, 10.265102467797767, 6.044288117402092, 10.569338337184684, 17.215509593184777, 15.974019384123515, 9.20802092330573, 18.911019019988153, 4.23718087494883, 4.301721488945603, 9.203518830931001, 8.735724380585653, 12.227259724148182, 8.642081017797969, 9.065659146275314, 13.220587807116614, 12.197924654043813, 23.228556003685316, 11.440006361433756, 12.013714025734329, 10.489963943758937, 8.073801265066416, 11.382184346973775, 32.29062047229868, 9.09553436266389, 16.548622607365456, 11.910590737415506, 24.796370011857697, 14.705955222406999, 11.446510483848066, 56.467967759645425, 10.218388489971517, 20.111519744461813, 18.50838820506743, 8.948090257581969, 32.79923510200911, 16.960885511562275, 15.642976275452341, 21.497262158068747, 10.511359801179484, 21.698541415723064, 22.969262107492963, 15.125851633624606], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1794325657760587, "mean_inference_ms": 0.9457837235120223, "mean_action_processing_ms": 0.04019400889394105, "mean_env_wait_ms": 0.8861782611128699, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 240000, "timers": {"sample_time_ms": 2616.797, "sample_throughput": 3668.607, "learn_time_ms": 3057.99, "learn_throughput": 3139.317, "update_time_ms": 1.507}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.034450369713207085, "policy_loss": -0.05951672105739514, "vf_loss": 0.06881952588756879, "vf_explained_var": 0.9517737627029419, "kl": 0.01676504498968522, "entropy": -4.0133416525522865, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 232, "training_iteration": 25, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-30-21", "timestamp": 1617996621, "time_this_iter_s": 5.162009954452515, "time_total_s": 138.4765214920044, "pid": 9767, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.08885216712952, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 36.58571428571429, "ram_util_percent": 79.05714285714285}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 56.467967759645425, "episode_reward_min": 4.23718087494883, "episode_reward_mean": 15.043106022674705, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.076538163107042, 22.283342135599096, 21.66921729394155, 16.207739318428292, 7.758120727779476, 15.86364229773881, 18.35076860218808, 12.989163964503637, 8.545592178292365, 8.992224955214455, 6.283564886405576, 16.446698889311087, 19.716796241022237, 7.625110716771863, 10.265102467797767, 6.044288117402092, 10.569338337184684, 17.215509593184777, 15.974019384123515, 9.20802092330573, 18.911019019988153, 4.23718087494883, 4.301721488945603, 9.203518830931001, 8.735724380585653, 12.227259724148182, 8.642081017797969, 9.065659146275314, 13.220587807116614, 12.197924654043813, 23.228556003685316, 11.440006361433756, 12.013714025734329, 10.489963943758937, 8.073801265066416, 11.382184346973775, 32.29062047229868, 9.09553436266389, 16.548622607365456, 11.910590737415506, 24.796370011857697, 14.705955222406999, 11.446510483848066, 56.467967759645425, 10.218388489971517, 20.111519744461813, 18.50838820506743, 8.948090257581969, 32.79923510200911, 16.960885511562275, 15.642976275452341, 21.497262158068747, 10.511359801179484, 21.698541415723064, 22.969262107492963, 15.125851633624606, 12.861368452850835, 20.437621984929923, 17.00584821889353, 15.993904688723948, 7.430807479038608, 15.319079346850785, 14.433872528465582, 15.566648306995017], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17855584790270712, "mean_inference_ms": 0.9405234785454822, "mean_action_processing_ms": 0.03990940192622282, "mean_env_wait_ms": 0.8773735057388989, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 249600, "timers": {"sample_time_ms": 2597.701, "sample_throughput": 3695.576, "learn_time_ms": 3026.151, "learn_throughput": 3172.346, "update_time_ms": 1.488}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.06006304675713182, "policy_loss": -0.05588394783437252, "vf_loss": 0.09022183453043302, "vf_explained_var": 0.9519028663635254, "kl": 0.0171501058836778, "entropy": -4.032617692947388, "entropy_coeff": 0.0}}, "num_steps_sampled": 249600, "num_steps_trained": 249600}, "done": false, "episodes_total": 240, "training_iteration": 26, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-30-26", "timestamp": 1617996626, "time_this_iter_s": 5.324777603149414, "time_total_s": 143.8012990951538, "pid": 9767, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.41362977027893, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.6875, "ram_util_percent": 79.08749999999999}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 56.467967759645425, "episode_reward_min": 4.23718087494883, "episode_reward_mean": 15.131606966185716, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.827648078400662, 25.13570711574815, 22.418108010319283, 18.13252580287214, 9.844278818661302, 11.129004824436542, 11.898833356291417, 13.330810107460978, 8.545592178292365, 8.992224955214455, 6.283564886405576, 16.446698889311087, 19.716796241022237, 7.625110716771863, 10.265102467797767, 6.044288117402092, 10.569338337184684, 17.215509593184777, 15.974019384123515, 9.20802092330573, 18.911019019988153, 4.23718087494883, 4.301721488945603, 9.203518830931001, 8.735724380585653, 12.227259724148182, 8.642081017797969, 9.065659146275314, 13.220587807116614, 12.197924654043813, 23.228556003685316, 11.440006361433756, 12.013714025734329, 10.489963943758937, 8.073801265066416, 11.382184346973775, 32.29062047229868, 9.09553436266389, 16.548622607365456, 11.910590737415506, 24.796370011857697, 14.705955222406999, 11.446510483848066, 56.467967759645425, 10.218388489971517, 20.111519744461813, 18.50838820506743, 8.948090257581969, 32.79923510200911, 16.960885511562275, 15.642976275452341, 21.497262158068747, 10.511359801179484, 21.698541415723064, 22.969262107492963, 15.125851633624606, 12.861368452850835, 20.437621984929923, 17.00584821889353, 15.993904688723948, 7.430807479038608, 15.319079346850785, 14.433872528465582, 15.566648306995017, 22.076538163107042, 22.283342135599096, 21.66921729394155, 16.207739318428292, 7.758120727779476, 15.86364229773881, 18.35076860218808, 12.989163964503637], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17774206922971816, "mean_inference_ms": 0.9366700890844305, "mean_action_processing_ms": 0.039706865074594505, "mean_env_wait_ms": 0.8708744061517435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 259200, "timers": {"sample_time_ms": 2602.228, "sample_throughput": 3689.146, "learn_time_ms": 3014.142, "learn_throughput": 3184.986, "update_time_ms": 1.543}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.06432528616239627, "policy_loss": -0.05745656772206227, "vf_loss": 0.09726972838242849, "vf_explained_var": 0.9480578899383545, "kl": 0.016341418425242105, "entropy": -4.050460217793782, "entropy_coeff": 0.0}}, "num_steps_sampled": 259200, "num_steps_trained": 259200}, "done": false, "episodes_total": 248, "training_iteration": 27, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-30-32", "timestamp": 1617996632, "time_this_iter_s": 5.573108911514282, "time_total_s": 149.3744080066681, "pid": 9767, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.98673868179321, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.45, "ram_util_percent": 79.1}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 56.467967759645425, "episode_reward_min": 4.23718087494883, "episode_reward_mean": 16.84717441352317, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.25258926863402, 24.645113776540455, 19.050169573590473, 51.51990135573001, 18.349452398518853, 25.417243596028825, 37.37245163602748, 52.69132991141207, 8.545592178292365, 8.992224955214455, 6.283564886405576, 16.446698889311087, 19.716796241022237, 7.625110716771863, 10.265102467797767, 6.044288117402092, 10.569338337184684, 17.215509593184777, 15.974019384123515, 9.20802092330573, 18.911019019988153, 4.23718087494883, 4.301721488945603, 9.203518830931001, 8.735724380585653, 12.227259724148182, 8.642081017797969, 9.065659146275314, 13.220587807116614, 12.197924654043813, 23.228556003685316, 11.440006361433756, 12.013714025734329, 10.489963943758937, 8.073801265066416, 11.382184346973775, 32.29062047229868, 9.09553436266389, 16.548622607365456, 11.910590737415506, 24.796370011857697, 14.705955222406999, 11.446510483848066, 56.467967759645425, 10.218388489971517, 20.111519744461813, 18.50838820506743, 8.948090257581969, 32.79923510200911, 16.960885511562275, 15.642976275452341, 21.497262158068747, 10.511359801179484, 21.698541415723064, 22.969262107492963, 15.125851633624606, 12.861368452850835, 20.437621984929923, 17.00584821889353, 15.993904688723948, 7.430807479038608, 15.319079346850785, 14.433872528465582, 15.566648306995017, 22.076538163107042, 22.283342135599096, 21.66921729394155, 16.207739318428292, 7.758120727779476, 15.86364229773881, 18.35076860218808, 12.989163964503637, 14.827648078400662, 25.13570711574815, 22.418108010319283, 18.13252580287214, 9.844278818661302, 11.129004824436542, 11.898833356291417, 13.330810107460978], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17728767055496128, "mean_inference_ms": 0.9344871353873835, "mean_action_processing_ms": 0.03959365393345463, "mean_env_wait_ms": 0.8666429553876895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 268800, "timers": {"sample_time_ms": 2623.807, "sample_throughput": 3658.806, "learn_time_ms": 2977.771, "learn_throughput": 3223.888, "update_time_ms": 1.554}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.4038505508502324, "policy_loss": -0.04677845097457369, "vf_loss": 0.42305994033813477, "vf_explained_var": 0.889689028263092, "kl": 0.018379375971853733, "entropy": -4.044232641855876, "entropy_coeff": 0.0}}, "num_steps_sampled": 268800, "num_steps_trained": 268800}, "done": false, "episodes_total": 256, "training_iteration": 28, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-30-37", "timestamp": 1617996637, "time_this_iter_s": 5.490315675735474, "time_total_s": 154.86472368240356, "pid": 9767, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.47705435752869, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 43.2375, "ram_util_percent": 79.1}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 37.550877957322015, "episode_reward_min": 15.154998994517339, "episode_reward_mean": 24.219154725471853, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.55782588935984, 27.947578544952307, 17.172000236904932, 15.154998994517339, 37.550877957322015, 17.185627801208653, 22.02444340190167, 34.159884977608066], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.177536553685413, "mean_inference_ms": 1.0194734520558808, "mean_action_processing_ms": 0.043430470308594454, "mean_env_wait_ms": 1.0078422582516762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 278400, "timers": {"sample_time_ms": 3444.6, "sample_throughput": 2786.971, "learn_time_ms": 2598.978, "learn_throughput": 3693.759, "update_time_ms": 1.717}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": 0.13489596509064236, "policy_loss": -0.057013710799316566, "vf_loss": 0.1714338388045629, "vf_explained_var": 0.9531207084655762, "kl": 0.020475835526982945, "entropy": -4.083147328694661, "entropy_coeff": 0.0}}, "num_steps_sampled": 278400, "num_steps_trained": 278400}, "done": false, "episodes_total": 264, "training_iteration": 29, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-30-50", "timestamp": 1617996650, "time_this_iter_s": 6.048303842544556, "time_total_s": 160.91302752494812, "pid": 10232, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.048303842544556, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.599999999999994, "ram_util_percent": 78.96666666666665}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 49.715519330366064, "episode_reward_min": 13.101257512483834, "episode_reward_mean": 23.8787025912697, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.101257512483834, 20.22834490801215, 17.321201530440817, 17.83194491699394, 49.715519330366064, 27.681126154715603, 22.873920399564952, 19.552688903963006, 22.55782588935984, 27.947578544952307, 17.172000236904932, 15.154998994517339, 37.550877957322015, 17.185627801208653, 22.02444340190167, 34.159884977608066], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18231563187413746, "mean_inference_ms": 1.021057318589636, "mean_action_processing_ms": 0.04373164806524165, "mean_env_wait_ms": 0.9941400700231556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 288000, "timers": {"sample_time_ms": 3254.666, "sample_throughput": 2949.612, "learn_time_ms": 3142.721, "learn_throughput": 3054.678, "update_time_ms": 1.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.18358196320633094, "policy_loss": -0.05025016285479069, "vf_loss": 0.2106093176205953, "vf_explained_var": 0.9469770193099976, "kl": 0.015481869205832482, "entropy": -4.110232130686442, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 272, "training_iteration": 30, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-30-56", "timestamp": 1617996656, "time_this_iter_s": 6.757331371307373, "time_total_s": 167.6703588962555, "pid": 10232, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.805635213851929, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 61.000000000000014, "ram_util_percent": 76.44}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 53.847723702721076, "episode_reward_min": 13.101257512483834, "episode_reward_mean": 26.811503889880345, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.602095035387414, 53.847723702721076, 28.83948649491899, 19.038527082712307, 41.34589342679255, 35.777760451824854, 28.315442017787355, 31.649923684668593, 22.55782588935984, 27.947578544952307, 17.172000236904932, 15.154998994517339, 37.550877957322015, 17.185627801208653, 22.02444340190167, 34.159884977608066, 13.101257512483834, 20.22834490801215, 17.321201530440817, 17.83194491699394, 49.715519330366064, 27.681126154715603, 22.873920399564952, 19.552688903963006], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17901969475513682, "mean_inference_ms": 0.9944762895548802, "mean_action_processing_ms": 0.042566594394692216, "mean_env_wait_ms": 0.9570318608133705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 297600, "timers": {"sample_time_ms": 2879.236, "sample_throughput": 3334.217, "learn_time_ms": 2952.095, "learn_throughput": 3251.928, "update_time_ms": 1.608}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.34952957153320313, "policy_loss": -0.04605577439690629, "vf_loss": 0.3707226879398028, "vf_explained_var": 0.9244166016578674, "kl": 0.016575105525553226, "entropy": -4.138582782745361, "entropy_coeff": 0.0}}, "num_steps_sampled": 297600, "num_steps_trained": 297600}, "done": false, "episodes_total": 280, "training_iteration": 31, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-31-01", "timestamp": 1617996661, "time_this_iter_s": 4.706339120864868, "time_total_s": 172.37669801712036, "pid": 10232, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.511974334716797, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.514285714285712, "ram_util_percent": 80.71428571428571}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 65.85038892714518, "episode_reward_min": 13.101257512483834, "episode_reward_mean": 28.26796804180112, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.90404525303251, 19.55613359265462, 27.76117993620552, 17.717621724832036, 18.30104045520478, 34.90943990841384, 65.85038892714518, 41.09903418301903, 22.55782588935984, 27.947578544952307, 17.172000236904932, 15.154998994517339, 37.550877957322015, 17.185627801208653, 22.02444340190167, 34.159884977608066, 13.101257512483834, 20.22834490801215, 17.321201530440817, 17.83194491699394, 49.715519330366064, 27.681126154715603, 22.873920399564952, 19.552688903963006, 22.602095035387414, 53.847723702721076, 28.83948649491899, 19.038527082712307, 41.34589342679255, 35.777760451824854, 28.315442017787355, 31.649923684668593], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1755615499963286, "mean_inference_ms": 0.9708231250896666, "mean_action_processing_ms": 0.04150723201127473, "mean_env_wait_ms": 0.9260351998980565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 307200, "timers": {"sample_time_ms": 2693.611, "sample_throughput": 3563.989, "learn_time_ms": 2889.027, "learn_throughput": 3322.918, "update_time_ms": 1.709}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.4295581154028575, "policy_loss": -0.046767819228892525, "vf_loss": 0.4468615198135376, "vf_explained_var": 0.9360812306404114, "kl": 0.019642944720884164, "entropy": -4.149751084645589, "entropy_coeff": 0.0}}, "num_steps_sampled": 307200, "num_steps_trained": 307200}, "done": false, "episodes_total": 288, "training_iteration": 32, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-31-06", "timestamp": 1617996666, "time_this_iter_s": 4.843463897705078, "time_total_s": 177.22016191482544, "pid": 10232, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.355438232421875, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.78333333333333, "ram_util_percent": 80.73333333333333}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 65.85038892714518, "episode_reward_min": 13.101257512483834, "episode_reward_mean": 29.052080970497485, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.3597295937456, 17.674597287599273, 15.28567357305814, 18.121304488357048, 39.51648082541164, 38.77019089191051, 19.717672422875605, 16.650354984224794, 31.600798287484686, 23.99416806499855, 33.47233484174442, 55.08078126341552, 29.376904517530456, 42.80251977420742, 27.306056691962546, 45.19534173771728, 22.55782588935984, 27.947578544952307, 17.172000236904932, 15.154998994517339, 37.550877957322015, 17.185627801208653, 22.02444340190167, 34.159884977608066, 13.101257512483834, 20.22834490801215, 17.321201530440817, 17.83194491699394, 49.715519330366064, 27.681126154715603, 22.873920399564952, 19.552688903963006, 22.602095035387414, 53.847723702721076, 28.83948649491899, 19.038527082712307, 41.34589342679255, 35.777760451824854, 28.315442017787355, 31.649923684668593, 35.90404525303251, 19.55613359265462, 27.76117993620552, 17.717621724832036, 18.30104045520478, 34.90943990841384, 65.85038892714518, 41.09903418301903], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17424674593477807, "mean_inference_ms": 0.9478039065832163, "mean_action_processing_ms": 0.04007035827838439, "mean_env_wait_ms": 0.885451691712905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 316800, "timers": {"sample_time_ms": 2632.693, "sample_throughput": 3646.457, "learn_time_ms": 2832.848, "learn_throughput": 3388.816, "update_time_ms": 1.633}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.6780326481660207, "policy_loss": -0.04439399582644304, "vf_loss": 0.6980235330263773, "vf_explained_var": 0.9270148873329163, "kl": 0.01626873624821504, "entropy": -4.24541233698527, "entropy_coeff": 0.0}}, "num_steps_sampled": 316800, "num_steps_trained": 316800}, "done": false, "episodes_total": 304, "training_iteration": 33, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-31-11", "timestamp": 1617996671, "time_this_iter_s": 5.003700256347656, "time_total_s": 182.2238621711731, "pid": 10232, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.35913848876953, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.1625, "ram_util_percent": 80.75}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 65.85038892714518, "episode_reward_min": 13.101257512483834, "episode_reward_mean": 29.99684919663506, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.35359178860035, 47.19979097594741, 28.8033760737122, 25.491705238619094, 20.40153311406894, 29.57511380537997, 30.857962103506843, 44.64059532784944, 22.55782588935984, 27.947578544952307, 17.172000236904932, 15.154998994517339, 37.550877957322015, 17.185627801208653, 22.02444340190167, 34.159884977608066, 13.101257512483834, 20.22834490801215, 17.321201530440817, 17.83194491699394, 49.715519330366064, 27.681126154715603, 22.873920399564952, 19.552688903963006, 22.602095035387414, 53.847723702721076, 28.83948649491899, 19.038527082712307, 41.34589342679255, 35.777760451824854, 28.315442017787355, 31.649923684668593, 35.90404525303251, 19.55613359265462, 27.76117993620552, 17.717621724832036, 18.30104045520478, 34.90943990841384, 65.85038892714518, 41.09903418301903, 35.3597295937456, 17.674597287599273, 15.28567357305814, 18.121304488357048, 39.51648082541164, 38.77019089191051, 19.717672422875605, 16.650354984224794, 31.600798287484686, 23.99416806499855, 33.47233484174442, 55.08078126341552, 29.376904517530456, 42.80251977420742, 27.306056691962546, 45.19534173771728], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.174268905979677, "mean_inference_ms": 0.9382337637360093, "mean_action_processing_ms": 0.03955023751709964, "mean_env_wait_ms": 0.8709754930618615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 326400, "timers": {"sample_time_ms": 2624.554, "sample_throughput": 3657.764, "learn_time_ms": 2795.264, "learn_throughput": 3434.38, "update_time_ms": 1.633}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.35943239281574885, "policy_loss": -0.045819850464661915, "vf_loss": 0.38322453379631044, "vf_explained_var": 0.9515909552574158, "kl": 0.014685135843853156, "entropy": -4.1815021642049155, "entropy_coeff": 0.0}}, "num_steps_sampled": 326400, "num_steps_trained": 326400}, "done": false, "episodes_total": 312, "training_iteration": 34, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-31-16", "timestamp": 1617996676, "time_this_iter_s": 5.197144985198975, "time_total_s": 187.42100715637207, "pid": 10232, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.556283473968506, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.942857142857143, "ram_util_percent": 80.7}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 65.85038892714518, "episode_reward_min": 13.101257512483834, "episode_reward_mean": 30.563709474956532, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.571749989572652, 39.346831397623475, 51.63540313057348, 15.408510086813045, 32.74079200251595, 42.941069498824994, 36.08980605433677, 29.5196892253942, 22.55782588935984, 27.947578544952307, 17.172000236904932, 15.154998994517339, 37.550877957322015, 17.185627801208653, 22.02444340190167, 34.159884977608066, 13.101257512483834, 20.22834490801215, 17.321201530440817, 17.83194491699394, 49.715519330366064, 27.681126154715603, 22.873920399564952, 19.552688903963006, 22.602095035387414, 53.847723702721076, 28.83948649491899, 19.038527082712307, 41.34589342679255, 35.777760451824854, 28.315442017787355, 31.649923684668593, 35.90404525303251, 19.55613359265462, 27.76117993620552, 17.717621724832036, 18.30104045520478, 34.90943990841384, 65.85038892714518, 41.09903418301903, 35.3597295937456, 17.674597287599273, 15.28567357305814, 18.121304488357048, 39.51648082541164, 38.77019089191051, 19.717672422875605, 16.650354984224794, 31.600798287484686, 23.99416806499855, 33.47233484174442, 55.08078126341552, 29.376904517530456, 42.80251977420742, 27.306056691962546, 45.19534173771728, 58.35359178860035, 47.19979097594741, 28.8033760737122, 25.491705238619094, 20.40153311406894, 29.57511380537997, 30.857962103506843, 44.64059532784944], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17372845402448134, "mean_inference_ms": 0.9292212517441204, "mean_action_processing_ms": 0.03909458878192036, "mean_env_wait_ms": 0.8583833937435084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 336000, "timers": {"sample_time_ms": 2564.417, "sample_throughput": 3743.541, "learn_time_ms": 2760.98, "learn_throughput": 3477.026, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.29120805154244106, "policy_loss": -0.05038902445385853, "vf_loss": 0.3173609411716461, "vf_explained_var": 0.964474081993103, "kl": 0.01615741889923811, "entropy": -4.209232648213704, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 320, "training_iteration": 35, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-31-21", "timestamp": 1617996681, "time_this_iter_s": 4.765386581420898, "time_total_s": 192.18639373779297, "pid": 10232, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.321670055389404, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.37142857142857, "ram_util_percent": 80.7}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 65.85038892714518, "episode_reward_min": 13.101257512483834, "episode_reward_mean": 31.58805005070316, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.52482674082671, 24.344502785575685, 42.286134687178226, 60.77709127253147, 38.07864631888983, 39.42709026921958, 27.551198762226992, 34.27270641696073, 22.55782588935984, 27.947578544952307, 17.172000236904932, 15.154998994517339, 37.550877957322015, 17.185627801208653, 22.02444340190167, 34.159884977608066, 13.101257512483834, 20.22834490801215, 17.321201530440817, 17.83194491699394, 49.715519330366064, 27.681126154715603, 22.873920399564952, 19.552688903963006, 22.602095035387414, 53.847723702721076, 28.83948649491899, 19.038527082712307, 41.34589342679255, 35.777760451824854, 28.315442017787355, 31.649923684668593, 35.90404525303251, 19.55613359265462, 27.76117993620552, 17.717621724832036, 18.30104045520478, 34.90943990841384, 65.85038892714518, 41.09903418301903, 35.3597295937456, 17.674597287599273, 15.28567357305814, 18.121304488357048, 39.51648082541164, 38.77019089191051, 19.717672422875605, 16.650354984224794, 31.600798287484686, 23.99416806499855, 33.47233484174442, 55.08078126341552, 29.376904517530456, 42.80251977420742, 27.306056691962546, 45.19534173771728, 58.35359178860035, 47.19979097594741, 28.8033760737122, 25.491705238619094, 20.40153311406894, 29.57511380537997, 30.857962103506843, 44.64059532784944, 28.571749989572652, 39.346831397623475, 51.63540313057348, 15.408510086813045, 32.74079200251595, 42.941069498824994, 36.08980605433677, 29.5196892253942], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17293463475507836, "mean_inference_ms": 0.9249520484490623, "mean_action_processing_ms": 0.03869331460631431, "mean_env_wait_ms": 0.8479019167755614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 345600, "timers": {"sample_time_ms": 2556.574, "sample_throughput": 3755.026, "learn_time_ms": 2734.262, "learn_throughput": 3511.002, "update_time_ms": 1.641}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.49457512140274046, "policy_loss": -0.04641281568755706, "vf_loss": 0.5165868818759918, "vf_explained_var": 0.9474561810493469, "kl": 0.01626737249394258, "entropy": -4.253221124013265, "entropy_coeff": 0.0}}, "num_steps_sampled": 345600, "num_steps_trained": 345600}, "done": false, "episodes_total": 328, "training_iteration": 36, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-31-26", "timestamp": 1617996686, "time_this_iter_s": 5.0555689334869385, "time_total_s": 197.2419626712799, "pid": 10232, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.37723898887634, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.8, "ram_util_percent": 80.64285714285714}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 65.85038892714518, "episode_reward_min": 13.101257512483834, "episode_reward_mean": 31.721196577390582, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.075932016889904, 26.164372459413162, 65.0839611587816, 18.681186166020588, 29.061833008261097, 20.652439732474882, 31.284290567713377, 44.35210743106478, 22.55782588935984, 27.947578544952307, 17.172000236904932, 15.154998994517339, 37.550877957322015, 17.185627801208653, 22.02444340190167, 34.159884977608066, 13.101257512483834, 20.22834490801215, 17.321201530440817, 17.83194491699394, 49.715519330366064, 27.681126154715603, 22.873920399564952, 19.552688903963006, 22.602095035387414, 53.847723702721076, 28.83948649491899, 19.038527082712307, 41.34589342679255, 35.777760451824854, 28.315442017787355, 31.649923684668593, 35.90404525303251, 19.55613359265462, 27.76117993620552, 17.717621724832036, 18.30104045520478, 34.90943990841384, 65.85038892714518, 41.09903418301903, 35.3597295937456, 17.674597287599273, 15.28567357305814, 18.121304488357048, 39.51648082541164, 38.77019089191051, 19.717672422875605, 16.650354984224794, 31.600798287484686, 23.99416806499855, 33.47233484174442, 55.08078126341552, 29.376904517530456, 42.80251977420742, 27.306056691962546, 45.19534173771728, 58.35359178860035, 47.19979097594741, 28.8033760737122, 25.491705238619094, 20.40153311406894, 29.57511380537997, 30.857962103506843, 44.64059532784944, 28.571749989572652, 39.346831397623475, 51.63540313057348, 15.408510086813045, 32.74079200251595, 42.941069498824994, 36.08980605433677, 29.5196892253942, 51.52482674082671, 24.344502785575685, 42.286134687178226, 60.77709127253147, 38.07864631888983, 39.42709026921958, 27.551198762226992, 34.27270641696073], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17203151542500075, "mean_inference_ms": 0.9202076514818802, "mean_action_processing_ms": 0.03833555318447261, "mean_env_wait_ms": 0.8385644560585138, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 355200, "timers": {"sample_time_ms": 2505.459, "sample_throughput": 3831.633, "learn_time_ms": 2723.354, "learn_throughput": 3525.065, "update_time_ms": 1.636}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.4379326113065084, "policy_loss": -0.04403818010662993, "vf_loss": 0.45693613489468893, "vf_explained_var": 0.9626523852348328, "kl": 0.01668976876884699, "entropy": -4.250372015635173, "entropy_coeff": 0.0}}, "num_steps_sampled": 355200, "num_steps_trained": 355200}, "done": false, "episodes_total": 336, "training_iteration": 37, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-31-31", "timestamp": 1617996691, "time_this_iter_s": 4.738572835922241, "time_total_s": 201.98053550720215, "pid": 10232, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.115811824798584, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.250000000000004, "ram_util_percent": 80.7}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 71.18746476283428, "episode_reward_min": 13.101257512483834, "episode_reward_mean": 32.89073578777987, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.770836356112724, 32.82795742121068, 44.36633433192205, 34.2442540110629, 24.63707937284611, 50.196488481057514, 26.589513738384476, 53.348635684962616, 71.18746476283428, 39.1631098946718, 38.40825726751524, 38.605050785485915, 29.654599982225623, 32.98553971122974, 35.925590743884094, 29.904196890214664, 22.55782588935984, 27.947578544952307, 17.172000236904932, 15.154998994517339, 37.550877957322015, 17.185627801208653, 22.02444340190167, 34.159884977608066, 13.101257512483834, 20.22834490801215, 17.321201530440817, 17.83194491699394, 49.715519330366064, 27.681126154715603, 22.873920399564952, 19.552688903963006, 22.602095035387414, 53.847723702721076, 28.83948649491899, 19.038527082712307, 41.34589342679255, 35.777760451824854, 28.315442017787355, 31.649923684668593, 35.90404525303251, 19.55613359265462, 27.76117993620552, 17.717621724832036, 18.30104045520478, 34.90943990841384, 65.85038892714518, 41.09903418301903, 35.3597295937456, 17.674597287599273, 15.28567357305814, 18.121304488357048, 39.51648082541164, 38.77019089191051, 19.717672422875605, 16.650354984224794, 31.600798287484686, 23.99416806499855, 33.47233484174442, 55.08078126341552, 29.376904517530456, 42.80251977420742, 27.306056691962546, 45.19534173771728, 58.35359178860035, 47.19979097594741, 28.8033760737122, 25.491705238619094, 20.40153311406894, 29.57511380537997, 30.857962103506843, 44.64059532784944, 28.571749989572652, 39.346831397623475, 51.63540313057348, 15.408510086813045, 32.74079200251595, 42.941069498824994, 36.08980605433677, 29.5196892253942, 51.52482674082671, 24.344502785575685, 42.286134687178226, 60.77709127253147, 38.07864631888983, 39.42709026921958, 27.551198762226992, 34.27270641696073, 28.075932016889904, 26.164372459413162, 65.0839611587816, 18.681186166020588, 29.061833008261097, 20.652439732474882, 31.284290567713377, 44.35210743106478], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17124955818889356, "mean_inference_ms": 0.9164369173164578, "mean_action_processing_ms": 0.03775657133401122, "mean_env_wait_ms": 0.8240293036172085, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 364800, "timers": {"sample_time_ms": 2516.02, "sample_throughput": 3815.55, "learn_time_ms": 2719.389, "learn_throughput": 3530.204, "update_time_ms": 1.666}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0006692369891822996, "total_loss": 0.774965652624766, "policy_loss": -0.04045844053228696, "vf_loss": 0.7905452807744344, "vf_explained_var": 0.9519717693328857, "kl": 0.01658587299287319, "entropy": -4.330939172108968, "entropy_coeff": 0.0}}, "num_steps_sampled": 364800, "num_steps_trained": 364800}, "done": false, "episodes_total": 352, "training_iteration": 38, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-31-36", "timestamp": 1617996696, "time_this_iter_s": 5.302100658416748, "time_total_s": 207.2826361656189, "pid": 10232, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.41791248321533, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.700000000000003, "ram_util_percent": 80.7}, "trial_id": "3d0f1_00001"}
{"episode_reward_max": 61.19553053524003, "episode_reward_min": 43.3009849111472, "episode_reward_mean": 52.43454412638023, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.43213613840046, 43.3009849111472, 61.19553053524003, 48.20447840125313, 60.0560651081505, 58.469624250117086, 46.071719514495335, 51.74581415223808], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21270508075336134, "mean_inference_ms": 1.1282934932089368, "mean_action_processing_ms": 0.048055239859270515, "mean_env_wait_ms": 1.1230728260980458, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 374400, "timers": {"sample_time_ms": 3534.515, "sample_throughput": 2716.073, "learn_time_ms": 2925.059, "learn_throughput": 3281.985, "update_time_ms": 1.425}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0006692369891822996, "total_loss": 0.3970460299650828, "policy_loss": -0.04977800713231166, "vf_loss": 0.42308082461357116, "vf_explained_var": 0.9701149463653564, "kl": 0.023743206188082695, "entropy": -4.263584677378336, "entropy_coeff": 0.0}}, "num_steps_sampled": 374400, "num_steps_trained": 374400}, "done": true, "episodes_total": 360, "training_iteration": 39, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-32-03", "timestamp": 1617996723, "time_this_iter_s": 6.464345693588257, "time_total_s": 213.74698185920715, "pid": 12092, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8297, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0006692369891822994, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9590554347994169, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.36228320294870875, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.464345693588257, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 62.57000000000001, "ram_util_percent": 78.62}, "trial_id": "3d0f1_00001"}
