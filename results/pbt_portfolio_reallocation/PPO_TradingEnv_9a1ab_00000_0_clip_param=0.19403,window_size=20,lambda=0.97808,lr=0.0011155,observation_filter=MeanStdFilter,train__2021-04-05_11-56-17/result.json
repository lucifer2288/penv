{"episode_reward_max": 0.4350745699749239, "episode_reward_min": -0.4663665670769531, "episode_reward_mean": -0.08400636144257201, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.41176759236149063, 0.37144822879398487, -0.35744401758158895, -0.23762663726602817, 0.4350745699749239, 0.19506735410686882, -0.4663665670769531, -0.20043623013029277], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1616129310781847, "mean_inference_ms": 0.9920891562824617, "mean_action_processing_ms": 0.04177909579446805, "mean_env_wait_ms": 0.9754265121636281, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 12800, "timers": {"sample_time_ms": 3904.797, "sample_throughput": 3278.02, "learn_time_ms": 3334.715, "learn_throughput": 3838.409, "update_time_ms": 1.535}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.020650586178526283, "policy_loss": -0.0368225809186697, "vf_loss": 0.004646020471118391, "vf_explained_var": 0.6950873732566833, "kl": 0.011525972951203585, "entropy": -3.2368997955322265, "entropy_coeff": 0.0}}, "num_steps_sampled": 12800, "num_steps_trained": 12800}, "done": false, "episodes_total": 8, "training_iteration": 1, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-56-30", "timestamp": 1617648990, "time_this_iter_s": 7.243836402893066, "time_total_s": 7.243836402893066, "pid": 18562, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.243836402893066, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 49.472727272727276, "ram_util_percent": 61.40909090909091}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 0.8640604942851569, "episode_reward_min": -0.6883057762601865, "episode_reward_mean": -0.12631680427941414, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6314096812489098, -0.3433023227042298, -0.13352290683838342, 0.8640604942851569, -0.02612163514527166, -0.674584768616645, -0.276876527683629, -0.18532007105652804, -0.19092010431623785, -0.6883057762601865, -0.27607194098043364, 0.647933249324981, -0.38439239342440557, -0.03348194046360509, 0.3412225221298191, -0.3684586081668546, -0.41176759236149063, 0.37144822879398487, -0.35744401758158895, -0.23762663726602817, 0.4350745699749239, 0.19506735410686882, -0.4663665670769531, -0.20043623013029277], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17372329908738438, "mean_inference_ms": 0.9784061319685137, "mean_action_processing_ms": 0.04111397843059974, "mean_env_wait_ms": 0.940980333634875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 25600, "timers": {"sample_time_ms": 3754.837, "sample_throughput": 3408.936, "learn_time_ms": 3199.189, "learn_throughput": 4001.014, "update_time_ms": 1.527}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.022806630262639373, "policy_loss": -0.03739527984987944, "vf_loss": 0.004195014883298427, "vf_explained_var": 0.7225989699363708, "kl": 0.01039363426156342, "entropy": -3.256473524570465, "entropy_coeff": 0.0}}, "num_steps_sampled": 25600, "num_steps_trained": 25600}, "done": false, "episodes_total": 24, "training_iteration": 2, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-56-37", "timestamp": 1617648997, "time_this_iter_s": 6.67485499382019, "time_total_s": 13.918691396713257, "pid": 18562, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.918691396713257, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.455555555555556, "ram_util_percent": 61.67777777777778}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 0.8640604942851569, "episode_reward_min": -0.7717445403054594, "episode_reward_mean": -0.13012214182102388, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.17372744572036058, -0.013360645336467303, 0.08599920923068027, -0.2848485902099921, 0.28273468117207257, -0.7717445403054594, -0.12542549022659677, -0.1319324141707019, -0.41176759236149063, 0.37144822879398487, -0.35744401758158895, -0.23762663726602817, 0.4350745699749239, 0.19506735410686882, -0.4663665670769531, -0.20043623013029277, -0.6314096812489098, -0.3433023227042298, -0.13352290683838342, 0.8640604942851569, -0.02612163514527166, -0.674584768616645, -0.276876527683629, -0.18532007105652804, -0.19092010431623785, -0.6883057762601865, -0.27607194098043364, 0.647933249324981, -0.38439239342440557, -0.03348194046360509, 0.3412225221298191, -0.3684586081668546], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17374108210454586, "mean_inference_ms": 0.9779829734812844, "mean_action_processing_ms": 0.04109020627544126, "mean_env_wait_ms": 0.9354375889173121, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 38400, "timers": {"sample_time_ms": 3772.799, "sample_throughput": 3392.707, "learn_time_ms": 3230.744, "learn_throughput": 3961.936, "update_time_ms": 1.569}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.02583076517097652, "policy_loss": -0.03995933067984879, "vf_loss": 0.003590760703664273, "vf_explained_var": 0.8208203911781311, "kl": 0.01053780603222549, "entropy": -3.253194525241852, "entropy_coeff": 0.0}}, "num_steps_sampled": 38400, "num_steps_trained": 38400}, "done": false, "episodes_total": 32, "training_iteration": 3, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-56-44", "timestamp": 1617649004, "time_this_iter_s": 7.109240770339966, "time_total_s": 21.027932167053223, "pid": 18562, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21.027932167053223, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.0, "ram_util_percent": 61.709090909090925}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 0.8640604942851569, "episode_reward_min": -0.7717445403054594, "episode_reward_mean": -0.17263146648432257, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.22526137899274812, -0.11391778374862938, -0.46909401920113875, 0.5773172192737761, -0.3791074487245582, -0.4378435707894709, -0.043528923069596215, -0.03601281144453028, -0.4309836838229428, -0.3778440560951107, -0.6012456103973788, -0.16902811935032758, -0.341971752684195, -0.39986311136629793, -0.44427755193214397, -0.22973925062942674, -0.41176759236149063, 0.37144822879398487, -0.35744401758158895, -0.23762663726602817, 0.4350745699749239, 0.19506735410686882, -0.4663665670769531, -0.20043623013029277, -0.6314096812489098, -0.3433023227042298, -0.13352290683838342, 0.8640604942851569, -0.02612163514527166, -0.674584768616645, -0.276876527683629, -0.18532007105652804, -0.19092010431623785, -0.6883057762601865, -0.27607194098043364, 0.647933249324981, -0.38439239342440557, -0.03348194046360509, 0.3412225221298191, -0.3684586081668546, -0.17372744572036058, -0.013360645336467303, 0.08599920923068027, -0.2848485902099921, 0.28273468117207257, -0.7717445403054594, -0.12542549022659677, -0.1319324141707019], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17665929629883922, "mean_inference_ms": 0.9741364113041842, "mean_action_processing_ms": 0.040886819562775296, "mean_env_wait_ms": 0.9241106009108848, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 51200, "timers": {"sample_time_ms": 3758.301, "sample_throughput": 3405.795, "learn_time_ms": 3202.802, "learn_throughput": 3996.5, "update_time_ms": 1.53}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.028507445440627634, "policy_loss": -0.04288223776966334, "vf_loss": 0.0033901868388056754, "vf_explained_var": 0.838962197303772, "kl": 0.010984604405239224, "entropy": -3.2634024000167847, "entropy_coeff": 0.0}}, "num_steps_sampled": 51200, "num_steps_trained": 51200}, "done": false, "episodes_total": 48, "training_iteration": 4, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-56-51", "timestamp": 1617649011, "time_this_iter_s": 6.840655565261841, "time_total_s": 27.868587732315063, "pid": 18562, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.868587732315063, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.1, "ram_util_percent": 61.666666666666664}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 0.8640604942851569, "episode_reward_min": -0.7717445403054594, "episode_reward_mean": -0.174416372913272, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.003577389378185636, -0.11999282499144226, -0.5154599454921021, -0.2037406512171579, -0.19992697321904807, -0.3265130186345615, -0.29161583748545095, 0.08677958483604598, -0.3618749110089474, -0.4640683527256597, 0.7260392804474349, -0.41581197703325273, -0.34517786302436104, -0.4238296794565884, -0.2646697092967112, 0.23994801372169206, -0.41176759236149063, 0.37144822879398487, -0.35744401758158895, -0.23762663726602817, 0.4350745699749239, 0.19506735410686882, -0.4663665670769531, -0.20043623013029277, -0.6314096812489098, -0.3433023227042298, -0.13352290683838342, 0.8640604942851569, -0.02612163514527166, -0.674584768616645, -0.276876527683629, -0.18532007105652804, -0.19092010431623785, -0.6883057762601865, -0.27607194098043364, 0.647933249324981, -0.38439239342440557, -0.03348194046360509, 0.3412225221298191, -0.3684586081668546, -0.17372744572036058, -0.013360645336467303, 0.08599920923068027, -0.2848485902099921, 0.28273468117207257, -0.7717445403054594, -0.12542549022659677, -0.1319324141707019, -0.22526137899274812, -0.11391778374862938, -0.46909401920113875, 0.5773172192737761, -0.3791074487245582, -0.4378435707894709, -0.043528923069596215, -0.03601281144453028, -0.4309836838229428, -0.3778440560951107, -0.6012456103973788, -0.16902811935032758, -0.341971752684195, -0.39986311136629793, -0.44427755193214397, -0.22973925062942674], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18065845297257094, "mean_inference_ms": 0.9725715795141854, "mean_action_processing_ms": 0.040800849689025746, "mean_env_wait_ms": 0.918189692622406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 64000, "timers": {"sample_time_ms": 3785.708, "sample_throughput": 3381.138, "learn_time_ms": 3213.529, "learn_throughput": 3983.16, "update_time_ms": 1.482}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.030288507025688888, "policy_loss": -0.04449361869134009, "vf_loss": 0.0037238858244381845, "vf_explained_var": 0.8180494904518127, "kl": 0.010481224982067943, "entropy": -3.2756007599830625, "entropy_coeff": 0.0}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 64, "training_iteration": 5, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-56-58", "timestamp": 1617649018, "time_this_iter_s": 7.15806770324707, "time_total_s": 35.026655435562134, "pid": 18562, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.026655435562134, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 45.41818181818182, "ram_util_percent": 61.75454545454546}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 0.8640604942851569, "episode_reward_min": -0.7717445403054594, "episode_reward_mean": -0.15155385080077732, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.09352362487183696, 0.0696247176310032, 0.13626240221224384, -0.1201788333613838, 0.47959740996532974, -0.025293345018303715, 0.2523760495328313, -0.4480941672964414, -0.41176759236149063, 0.37144822879398487, -0.35744401758158895, -0.23762663726602817, 0.4350745699749239, 0.19506735410686882, -0.4663665670769531, -0.20043623013029277, -0.6314096812489098, -0.3433023227042298, -0.13352290683838342, 0.8640604942851569, -0.02612163514527166, -0.674584768616645, -0.276876527683629, -0.18532007105652804, -0.19092010431623785, -0.6883057762601865, -0.27607194098043364, 0.647933249324981, -0.38439239342440557, -0.03348194046360509, 0.3412225221298191, -0.3684586081668546, -0.17372744572036058, -0.013360645336467303, 0.08599920923068027, -0.2848485902099921, 0.28273468117207257, -0.7717445403054594, -0.12542549022659677, -0.1319324141707019, -0.22526137899274812, -0.11391778374862938, -0.46909401920113875, 0.5773172192737761, -0.3791074487245582, -0.4378435707894709, -0.043528923069596215, -0.03601281144453028, -0.4309836838229428, -0.3778440560951107, -0.6012456103973788, -0.16902811935032758, -0.341971752684195, -0.39986311136629793, -0.44427755193214397, -0.22973925062942674, 0.003577389378185636, -0.11999282499144226, -0.5154599454921021, -0.2037406512171579, -0.19992697321904807, -0.3265130186345615, -0.29161583748545095, 0.08677958483604598, -0.3618749110089474, -0.4640683527256597, 0.7260392804474349, -0.41581197703325273, -0.34517786302436104, -0.4238296794565884, -0.2646697092967112, 0.23994801372169206], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18170951522608736, "mean_inference_ms": 0.9715472570405215, "mean_action_processing_ms": 0.04074929749694229, "mean_env_wait_ms": 0.9155039339363837, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 76800, "timers": {"sample_time_ms": 3744.746, "sample_throughput": 3418.122, "learn_time_ms": 3196.514, "learn_throughput": 4004.362, "update_time_ms": 1.524}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.03040062009356916, "policy_loss": -0.04683957856148482, "vf_loss": 0.0044447789946571, "vf_explained_var": 0.8242781758308411, "kl": 0.011994179273024201, "entropy": -3.2745173001289367, "entropy_coeff": 0.0}}, "num_steps_sampled": 76800, "num_steps_trained": 76800}, "done": false, "episodes_total": 72, "training_iteration": 6, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-57-05", "timestamp": 1617649025, "time_this_iter_s": 6.658986806869507, "time_total_s": 41.68564224243164, "pid": 18562, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.68564224243164, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 45.455555555555556, "ram_util_percent": 61.733333333333334}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 0.8640604942851569, "episode_reward_min": -0.7717445403054594, "episode_reward_mean": -0.10145618632199473, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3120886702107336, -0.30416605968634036, 0.32938920603406086, -0.441488065145559, 0.03702242826906721, 0.7671524883774972, -0.04385786238834255, -0.05137315146523003, 0.33706286825650555, -0.6651814519417883, 0.6512365029330185, 0.17022321546220298, 0.5525612267736477, 0.3441260074084067, 0.40081741376451063, 0.21229676487950644, -0.41176759236149063, 0.37144822879398487, -0.35744401758158895, -0.23762663726602817, 0.4350745699749239, 0.19506735410686882, -0.4663665670769531, -0.20043623013029277, -0.6314096812489098, -0.3433023227042298, -0.13352290683838342, 0.8640604942851569, -0.02612163514527166, -0.674584768616645, -0.276876527683629, -0.18532007105652804, -0.19092010431623785, -0.6883057762601865, -0.27607194098043364, 0.647933249324981, -0.38439239342440557, -0.03348194046360509, 0.3412225221298191, -0.3684586081668546, -0.17372744572036058, -0.013360645336467303, 0.08599920923068027, -0.2848485902099921, 0.28273468117207257, -0.7717445403054594, -0.12542549022659677, -0.1319324141707019, -0.22526137899274812, -0.11391778374862938, -0.46909401920113875, 0.5773172192737761, -0.3791074487245582, -0.4378435707894709, -0.043528923069596215, -0.03601281144453028, -0.4309836838229428, -0.3778440560951107, -0.6012456103973788, -0.16902811935032758, -0.341971752684195, -0.39986311136629793, -0.44427755193214397, -0.22973925062942674, 0.003577389378185636, -0.11999282499144226, -0.5154599454921021, -0.2037406512171579, -0.19992697321904807, -0.3265130186345615, -0.29161583748545095, 0.08677958483604598, -0.3618749110089474, -0.4640683527256597, 0.7260392804474349, -0.41581197703325273, -0.34517786302436104, -0.4238296794565884, -0.2646697092967112, 0.23994801372169206, -0.09352362487183696, 0.0696247176310032, 0.13626240221224384, -0.1201788333613838, 0.47959740996532974, -0.025293345018303715, 0.2523760495328313, -0.4480941672964414], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18386927987582283, "mean_inference_ms": 0.9692119097635186, "mean_action_processing_ms": 0.040639260273851806, "mean_env_wait_ms": 0.9104886583308175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 89600, "timers": {"sample_time_ms": 3732.092, "sample_throughput": 3429.711, "learn_time_ms": 3197.373, "learn_throughput": 4003.286, "update_time_ms": 1.585}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.02756089437752962, "policy_loss": -0.04571998743340373, "vf_loss": 0.00554266817169264, "vf_explained_var": 0.8250579237937927, "kl": 0.012616427196189762, "entropy": -3.2831752610206606, "entropy_coeff": 0.0}}, "num_steps_sampled": 89600, "num_steps_trained": 89600}, "done": false, "episodes_total": 88, "training_iteration": 7, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-57-12", "timestamp": 1617649032, "time_this_iter_s": 6.866786479949951, "time_total_s": 48.55242872238159, "pid": 18562, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.55242872238159, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.08, "ram_util_percent": 61.739999999999995}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 0.8640604942851569, "episode_reward_min": -0.7717445403054594, "episode_reward_mean": -0.0826969504237247, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2955133940304291, 0.17816678609916603, 0.22874242313939686, -0.1934970770732083, 0.14958908937966364, 0.6423660227967307, -0.12748309491773524, -0.1841603877964788, -0.41176759236149063, 0.37144822879398487, -0.35744401758158895, -0.23762663726602817, 0.4350745699749239, 0.19506735410686882, -0.4663665670769531, -0.20043623013029277, -0.6314096812489098, -0.3433023227042298, -0.13352290683838342, 0.8640604942851569, -0.02612163514527166, -0.674584768616645, -0.276876527683629, -0.18532007105652804, -0.19092010431623785, -0.6883057762601865, -0.27607194098043364, 0.647933249324981, -0.38439239342440557, -0.03348194046360509, 0.3412225221298191, -0.3684586081668546, -0.17372744572036058, -0.013360645336467303, 0.08599920923068027, -0.2848485902099921, 0.28273468117207257, -0.7717445403054594, -0.12542549022659677, -0.1319324141707019, -0.22526137899274812, -0.11391778374862938, -0.46909401920113875, 0.5773172192737761, -0.3791074487245582, -0.4378435707894709, -0.043528923069596215, -0.03601281144453028, -0.4309836838229428, -0.3778440560951107, -0.6012456103973788, -0.16902811935032758, -0.341971752684195, -0.39986311136629793, -0.44427755193214397, -0.22973925062942674, 0.003577389378185636, -0.11999282499144226, -0.5154599454921021, -0.2037406512171579, -0.19992697321904807, -0.3265130186345615, -0.29161583748545095, 0.08677958483604598, -0.3618749110089474, -0.4640683527256597, 0.7260392804474349, -0.41581197703325273, -0.34517786302436104, -0.4238296794565884, -0.2646697092967112, 0.23994801372169206, -0.09352362487183696, 0.0696247176310032, 0.13626240221224384, -0.1201788333613838, 0.47959740996532974, -0.025293345018303715, 0.2523760495328313, -0.4480941672964414, -0.3120886702107336, -0.30416605968634036, 0.32938920603406086, -0.441488065145559, 0.03702242826906721, 0.7671524883774972, -0.04385786238834255, -0.05137315146523003, 0.33706286825650555, -0.6651814519417883, 0.6512365029330185, 0.17022321546220298, 0.5525612267736477, 0.3441260074084067, 0.40081741376451063, 0.21229676487950644], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1844400609320039, "mean_inference_ms": 0.9698503775725066, "mean_action_processing_ms": 0.040626571799428066, "mean_env_wait_ms": 0.9091170383148032, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 102400, "timers": {"sample_time_ms": 3761.273, "sample_throughput": 3403.103, "learn_time_ms": 3225.436, "learn_throughput": 3968.456, "update_time_ms": 1.566}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.029256190219894052, "policy_loss": -0.0465698806848377, "vf_loss": 0.005332564252894372, "vf_explained_var": 0.8402301669120789, "kl": 0.011981127504259347, "entropy": -3.28837571144104, "entropy_coeff": 0.0}}, "num_steps_sampled": 102400, "num_steps_trained": 102400}, "done": false, "episodes_total": 96, "training_iteration": 8, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-57-19", "timestamp": 1617649039, "time_this_iter_s": 7.39727783203125, "time_total_s": 55.94970655441284, "pid": 18562, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 55.94970655441284, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.554545454545455, "ram_util_percent": 58.800000000000004}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 0.6921274450479438, "episode_reward_min": -0.2369587570197188, "episode_reward_mean": 0.27172975354608486, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.24117652437008297, 0.20588208527671958, 0.3385050906689113, 0.6921274450479438, -0.2369587570197188, -0.04213169963569996, 0.3493541708542012, 0.6258831688062387], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14118934928589058, "mean_inference_ms": 0.8144788374236642, "mean_action_processing_ms": 0.03398706360506609, "mean_env_wait_ms": 0.7811360884874333, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 115200, "timers": {"sample_time_ms": 3645.043, "sample_throughput": 3511.619, "learn_time_ms": 3998.983, "learn_throughput": 3200.814, "update_time_ms": 1.482}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.031982906432822346, "policy_loss": -0.04962924898602068, "vf_loss": 0.0051675541186705235, "vf_explained_var": 0.8614355325698853, "kl": 0.012478788690641522, "entropy": -3.304011969566345, "entropy_coeff": 0.0}}, "num_steps_sampled": 115200, "num_steps_trained": 115200}, "done": false, "episodes_total": 104, "training_iteration": 9, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-59-40", "timestamp": 1617649180, "time_this_iter_s": 7.6486029624938965, "time_total_s": 63.59830951690674, "pid": 19744, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.6486029624938965, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.21818181818182, "ram_util_percent": 61.4909090909091}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 1.4702999941487636, "episode_reward_min": -0.4964863873990942, "episode_reward_mean": 0.30918430396426905, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3495495257558081, 0.1285745031810559, 1.0709509647400965, 0.6057083325057959, 1.4702999941487636, -0.4964863873990942, 0.04409750406551116, 0.49997552295271364, -0.046926940284754415, 0.8579091765816691, 0.0919388231821554, 0.046084243638114364, 0.05872769221590124, 0.04284583157929389, 0.27725814992526954, 0.24607832998547785, 0.24117652437008297, 0.20588208527671958, 0.3385050906689113, 0.6921274450479438, -0.2369587570197188, -0.04213169963569996, 0.3493541708542012, 0.6258831688062387], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15406592341738376, "mean_inference_ms": 0.8139865660872067, "mean_action_processing_ms": 0.033905209890275755, "mean_env_wait_ms": 0.7631631099563162, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 128000, "timers": {"sample_time_ms": 3424.975, "sample_throughput": 3737.254, "learn_time_ms": 4001.566, "learn_throughput": 3198.748, "update_time_ms": 1.548}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.02940099031664431, "policy_loss": -0.04896695687435568, "vf_loss": 0.005814954799134285, "vf_explained_var": 0.8577495813369751, "kl": 0.013751014051958919, "entropy": -3.329784195423126, "entropy_coeff": 0.0}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 120, "training_iteration": 10, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-59-47", "timestamp": 1617649187, "time_this_iter_s": 7.216730117797852, "time_total_s": 70.81503963470459, "pid": 19744, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.865333080291748, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.47272727272727, "ram_util_percent": 61.65454545454547}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 2.751167366610278, "episode_reward_min": -0.4964863873990942, "episode_reward_mean": 0.3634931085037556, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.20841576731312994, 0.060787402648820654, -0.11815509185285422, -0.28707777152136144, 2.751167366610278, 0.3522867654988302, 0.8385495656257491, 0.40538217265513143, 0.24117652437008297, 0.20588208527671958, 0.3385050906689113, 0.6921274450479438, -0.2369587570197188, -0.04213169963569996, 0.3493541708542012, 0.6258831688062387, 0.3495495257558081, 0.1285745031810559, 1.0709509647400965, 0.6057083325057959, 1.4702999941487636, -0.4964863873990942, 0.04409750406551116, 0.49997552295271364, -0.046926940284754415, 0.8579091765816691, 0.0919388231821554, 0.046084243638114364, 0.05872769221590124, 0.04284583157929389, 0.27725814992526954, 0.24607832998547785], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15419137369172345, "mean_inference_ms": 0.8231502325871801, "mean_action_processing_ms": 0.03397005375250214, "mean_env_wait_ms": 0.7604881312188911, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 140800, "timers": {"sample_time_ms": 3429.773, "sample_throughput": 3732.025, "learn_time_ms": 4075.235, "learn_throughput": 3140.923, "update_time_ms": 1.613}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.029680704777128995, "policy_loss": -0.0484158255206421, "vf_loss": 0.005910769673064351, "vf_explained_var": 0.8605899214744568, "kl": 0.012824351731687784, "entropy": -3.3292552971839906, "entropy_coeff": 0.0}}, "num_steps_sampled": 140800, "num_steps_trained": 140800}, "done": false, "episodes_total": 128, "training_iteration": 11, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_11-59-55", "timestamp": 1617649195, "time_this_iter_s": 7.668519973754883, "time_total_s": 78.48355960845947, "pid": 19744, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.53385305404663, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.16363636363637, "ram_util_percent": 61.83636363636364}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 2.751167366610278, "episode_reward_min": -0.4964863873990942, "episode_reward_mean": 0.3978755564318009, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5169304750693358, 0.7331752355578531, 1.5368470825720033, 2.0154905005565458, -0.017847883005981724, -0.2476160396693604, 0.18745237380679236, -0.002291112632528125, 0.13057790632286914, 0.9727986380370086, 0.12321224733324043, 0.8064712953042794, 0.36175060149781113, 0.04590834514954523, -0.2654480967232699, 0.5688356674301218, 0.24117652437008297, 0.20588208527671958, 0.3385050906689113, 0.6921274450479438, -0.2369587570197188, -0.04213169963569996, 0.3493541708542012, 0.6258831688062387, 0.3495495257558081, 0.1285745031810559, 1.0709509647400965, 0.6057083325057959, 1.4702999941487636, -0.4964863873990942, 0.04409750406551116, 0.49997552295271364, -0.046926940284754415, 0.8579091765816691, 0.0919388231821554, 0.046084243638114364, 0.05872769221590124, 0.04284583157929389, 0.27725814992526954, 0.24607832998547785, 0.20841576731312994, 0.060787402648820654, -0.11815509185285422, -0.28707777152136144, 2.751167366610278, 0.3522867654988302, 0.8385495656257491, 0.40538217265513143], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1564259842440171, "mean_inference_ms": 0.8294353538598633, "mean_action_processing_ms": 0.033999961078488565, "mean_env_wait_ms": 0.7552393461745949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 153600, "timers": {"sample_time_ms": 3351.98, "sample_throughput": 3818.639, "learn_time_ms": 4071.575, "learn_throughput": 3143.747, "update_time_ms": 1.553}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.029049847405403853, "policy_loss": -0.048974411874078215, "vf_loss": 0.006829625628888607, "vf_explained_var": 0.8644910454750061, "kl": 0.013094941535964608, "entropy": -3.33771374464035, "entropy_coeff": 0.0}}, "num_steps_sampled": 153600, "num_steps_trained": 153600}, "done": false, "episodes_total": 144, "training_iteration": 12, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-00-02", "timestamp": 1617649202, "time_this_iter_s": 7.185730934143066, "time_total_s": 85.66929054260254, "pid": 19744, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.719583988189697, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.309999999999995, "ram_util_percent": 61.81999999999999}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 2.751167366610278, "episode_reward_min": -0.4964863873990942, "episode_reward_mean": 0.3978427863487267, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0649534466545627, 0.44220587912346265, 0.5699649611893041, 0.29446261066311474, 0.11815448674987494, 1.135676394305829, 0.3900920937899779, 0.5469018808696646, 0.7291727385172777, 0.7817884246490283, 0.15453437552089144, 0.42649690463904033, 0.20159612183001485, -0.04945025187388663, -0.28676913207725296, -0.15586931695884276, 0.24117652437008297, 0.20588208527671958, 0.3385050906689113, 0.6921274450479438, -0.2369587570197188, -0.04213169963569996, 0.3493541708542012, 0.6258831688062387, 0.3495495257558081, 0.1285745031810559, 1.0709509647400965, 0.6057083325057959, 1.4702999941487636, -0.4964863873990942, 0.04409750406551116, 0.49997552295271364, -0.046926940284754415, 0.8579091765816691, 0.0919388231821554, 0.046084243638114364, 0.05872769221590124, 0.04284583157929389, 0.27725814992526954, 0.24607832998547785, 0.20841576731312994, 0.060787402648820654, -0.11815509185285422, -0.28707777152136144, 2.751167366610278, 0.3522867654988302, 0.8385495656257491, 0.40538217265513143, 0.5169304750693358, 0.7331752355578531, 1.5368470825720033, 2.0154905005565458, -0.017847883005981724, -0.2476160396693604, 0.18745237380679236, -0.002291112632528125, 0.13057790632286914, 0.9727986380370086, 0.12321224733324043, 0.8064712953042794, 0.36175060149781113, 0.04590834514954523, -0.2654480967232699, 0.5688356674301218], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1585859828975159, "mean_inference_ms": 0.831006331576446, "mean_action_processing_ms": 0.03399981124232304, "mean_env_wait_ms": 0.751654877616557, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 166400, "timers": {"sample_time_ms": 3307.967, "sample_throughput": 3869.446, "learn_time_ms": 4065.014, "learn_throughput": 3148.821, "update_time_ms": 1.568}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.02864516628906131, "policy_loss": -0.048235840313136574, "vf_loss": 0.00624366250820458, "vf_explained_var": 0.8762122392654419, "kl": 0.013347011730074883, "entropy": -3.3549709701538086, "entropy_coeff": 0.0}}, "num_steps_sampled": 166400, "num_steps_trained": 166400}, "done": false, "episodes_total": 160, "training_iteration": 13, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-00-09", "timestamp": 1617649209, "time_this_iter_s": 7.178647994995117, "time_total_s": 92.84793853759766, "pid": 19744, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 36.898231983184814, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.120000000000005, "ram_util_percent": 61.919999999999995}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 2.7726358206907675, "episode_reward_min": -0.4964863873990942, "episode_reward_mean": 0.45168188306131896, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7942561421577516, 0.5873140233551195, 2.7726358206907675, 0.7005369436603326, 1.4092037571063734, -0.19837369856916742, -0.07032514770341258, 1.063909413398695, 0.24117652437008297, 0.20588208527671958, 0.3385050906689113, 0.6921274450479438, -0.2369587570197188, -0.04213169963569996, 0.3493541708542012, 0.6258831688062387, 0.3495495257558081, 0.1285745031810559, 1.0709509647400965, 0.6057083325057959, 1.4702999941487636, -0.4964863873990942, 0.04409750406551116, 0.49997552295271364, -0.046926940284754415, 0.8579091765816691, 0.0919388231821554, 0.046084243638114364, 0.05872769221590124, 0.04284583157929389, 0.27725814992526954, 0.24607832998547785, 0.20841576731312994, 0.060787402648820654, -0.11815509185285422, -0.28707777152136144, 2.751167366610278, 0.3522867654988302, 0.8385495656257491, 0.40538217265513143, 0.5169304750693358, 0.7331752355578531, 1.5368470825720033, 2.0154905005565458, -0.017847883005981724, -0.2476160396693604, 0.18745237380679236, -0.002291112632528125, 0.13057790632286914, 0.9727986380370086, 0.12321224733324043, 0.8064712953042794, 0.36175060149781113, 0.04590834514954523, -0.2654480967232699, 0.5688356674301218, 1.0649534466545627, 0.44220587912346265, 0.5699649611893041, 0.29446261066311474, 0.11815448674987494, 1.135676394305829, 0.3900920937899779, 0.5469018808696646, 0.7291727385172777, 0.7817884246490283, 0.15453437552089144, 0.42649690463904033, 0.20159612183001485, -0.04945025187388663, -0.28676913207725296, -0.15586931695884276], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15882569690666873, "mean_inference_ms": 0.8309857593507886, "mean_action_processing_ms": 0.03399317379546174, "mean_env_wait_ms": 0.7500550954950153, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 179200, "timers": {"sample_time_ms": 3252.336, "sample_throughput": 3935.633, "learn_time_ms": 4040.422, "learn_throughput": 3167.986, "update_time_ms": 1.575}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.028614366920664908, "policy_loss": -0.04945792653597891, "vf_loss": 0.007421198622323572, "vf_explained_var": 0.8272480964660645, "kl": 0.013422363214194774, "entropy": -3.3480132603645325, "entropy_coeff": 0.0}}, "num_steps_sampled": 179200, "num_steps_trained": 179200}, "done": false, "episodes_total": 168, "training_iteration": 14, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-00-16", "timestamp": 1617649216, "time_this_iter_s": 6.902421712875366, "time_total_s": 99.75036025047302, "pid": 19744, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.80065369606018, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.9, "ram_util_percent": 60.129999999999995}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 2.7726358206907675, "episode_reward_min": -0.4964863873990942, "episode_reward_mean": 0.48397263959053816, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7854120031861158, 0.7634757280345579, 0.4664340936226443, 0.1184326804000495, 0.7811259099532846, 0.6921704511551385, -0.16167063445367402, 0.3277927743320206, 0.031945969960167186, 1.6775546933811594, 1.082528473638516, 0.8475358626870537, 0.23551954557236265, 0.4441067797346363, 0.9581451404101786, 1.0179872319381769, 0.24117652437008297, 0.20588208527671958, 0.3385050906689113, 0.6921274450479438, -0.2369587570197188, -0.04213169963569996, 0.3493541708542012, 0.6258831688062387, 0.3495495257558081, 0.1285745031810559, 1.0709509647400965, 0.6057083325057959, 1.4702999941487636, -0.4964863873990942, 0.04409750406551116, 0.49997552295271364, -0.046926940284754415, 0.8579091765816691, 0.0919388231821554, 0.046084243638114364, 0.05872769221590124, 0.04284583157929389, 0.27725814992526954, 0.24607832998547785, 0.20841576731312994, 0.060787402648820654, -0.11815509185285422, -0.28707777152136144, 2.751167366610278, 0.3522867654988302, 0.8385495656257491, 0.40538217265513143, 0.5169304750693358, 0.7331752355578531, 1.5368470825720033, 2.0154905005565458, -0.017847883005981724, -0.2476160396693604, 0.18745237380679236, -0.002291112632528125, 0.13057790632286914, 0.9727986380370086, 0.12321224733324043, 0.8064712953042794, 0.36175060149781113, 0.04590834514954523, -0.2654480967232699, 0.5688356674301218, 1.0649534466545627, 0.44220587912346265, 0.5699649611893041, 0.29446261066311474, 0.11815448674987494, 1.135676394305829, 0.3900920937899779, 0.5469018808696646, 0.7291727385172777, 0.7817884246490283, 0.15453437552089144, 0.42649690463904033, 0.20159612183001485, -0.04945025187388663, -0.28676913207725296, -0.15586931695884276, 0.7942561421577516, 0.5873140233551195, 2.7726358206907675, 0.7005369436603326, 1.4092037571063734, -0.19837369856916742, -0.07032514770341258, 1.063909413398695], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16191675871730588, "mean_inference_ms": 0.840547221724956, "mean_action_processing_ms": 0.03441809134472045, "mean_env_wait_ms": 0.7575261392241704, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 192000, "timers": {"sample_time_ms": 3455.87, "sample_throughput": 3703.843, "learn_time_ms": 4031.055, "learn_throughput": 3175.348, "update_time_ms": 1.592}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.031214275863021612, "policy_loss": -0.0520312091615051, "vf_loss": 0.006281226575374603, "vf_explained_var": 0.8797523975372314, "kl": 0.014535706983879208, "entropy": -3.3704381346702577, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 184, "training_iteration": 15, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-00-25", "timestamp": 1617649225, "time_this_iter_s": 8.659104108810425, "time_total_s": 108.40946435928345, "pid": 19744, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.459757804870605, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 54.43846153846154, "ram_util_percent": 60.423076923076906}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 2.1168333536165598, "episode_reward_min": -0.1977635357582609, "episode_reward_mean": 1.0393197304429962, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4851763303977052, 1.575228976591648, 1.000530443891071, 2.1168333536165598, 1.0977254104606784, 0.3994084823589663, -0.1977635357582609, 0.8374183819856027], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18483147183334284, "mean_inference_ms": 1.0577559955115619, "mean_action_processing_ms": 0.04460534626509829, "mean_env_wait_ms": 1.0259560798571155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 204800, "timers": {"sample_time_ms": 4254.042, "sample_throughput": 3008.903, "learn_time_ms": 3602.865, "learn_throughput": 3552.728, "update_time_ms": 1.394}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.026317186206579208, "policy_loss": -0.04769570819102228, "vf_loss": 0.007391689922660589, "vf_explained_var": 0.8536641597747803, "kl": 0.013986831568181514, "entropy": -3.3973585319519044, "entropy_coeff": 0.0}}, "num_steps_sampled": 204800, "num_steps_trained": 204800}, "done": false, "episodes_total": 192, "training_iteration": 16, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-01-40", "timestamp": 1617649300, "time_this_iter_s": 7.8613975048065186, "time_total_s": 116.27086186408997, "pid": 21096, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.8613975048065186, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.725000000000016, "ram_util_percent": 61.60833333333335}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 2.1168333536165598, "episode_reward_min": -0.1977635357582609, "episode_reward_mean": 0.9084778713990346, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.47739866051726376, 2.0804459984080914, 0.7548405274806413, 2.101302174688765, -0.1936730353884254, 0.22995188319622284, 0.28077619846570756, 1.1207529504539298, 1.91986030780413, 0.17785428255394686, 0.29053378509599037, 0.031709789950499, 0.7161188059751049, 0.6410458660981306, 0.9819256596608847, 1.8780672150719764, 1.4851763303977052, 1.575228976591648, 1.000530443891071, 2.1168333536165598, 1.0977254104606784, 0.3994084823589663, -0.1977635357582609, 0.8374183819856027], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19881789392618002, "mean_inference_ms": 1.0298194381701602, "mean_action_processing_ms": 0.04343560872414451, "mean_env_wait_ms": 0.982661721168637, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 217600, "timers": {"sample_time_ms": 4016.144, "sample_throughput": 3187.137, "learn_time_ms": 3890.42, "learn_throughput": 3290.133, "update_time_ms": 1.479}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.027523892214521766, "policy_loss": -0.04974315259605646, "vf_loss": 0.00790100360289216, "vf_explained_var": 0.8801324367523193, "kl": 0.014318256191909313, "entropy": -3.3982956767082215, "entropy_coeff": 0.0}}, "num_steps_sampled": 217600, "num_steps_trained": 217600}, "done": false, "episodes_total": 208, "training_iteration": 17, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-01-48", "timestamp": 1617649308, "time_this_iter_s": 7.96247935295105, "time_total_s": 124.23334121704102, "pid": 21096, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.823876857757568, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 49.054545454545455, "ram_util_percent": 61.95454545454545}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 2.1168333536165598, "episode_reward_min": -0.1977635357582609, "episode_reward_mean": 0.859842259923879, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.14345705733285352, 1.0955880359766894, 1.0679240569459902, 1.2778849798430736, 0.5485854653672746, 0.8360130512806045, 0.7070680391511943, 0.034962718089617484, 1.4851763303977052, 1.575228976591648, 1.000530443891071, 2.1168333536165598, 1.0977254104606784, 0.3994084823589663, -0.1977635357582609, 0.8374183819856027, 0.47739866051726376, 2.0804459984080914, 0.7548405274806413, 2.101302174688765, -0.1936730353884254, 0.22995188319622284, 0.28077619846570756, 1.1207529504539298, 1.91986030780413, 0.17785428255394686, 0.29053378509599037, 0.031709789950499, 0.7161188059751049, 0.6410458660981306, 0.9819256596608847, 1.8780672150719764], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1955669214131049, "mean_inference_ms": 1.0219827475735046, "mean_action_processing_ms": 0.04277007227719522, "mean_env_wait_ms": 0.9630980034203762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 230400, "timers": {"sample_time_ms": 3863.104, "sample_throughput": 3313.398, "learn_time_ms": 3874.989, "learn_throughput": 3303.235, "update_time_ms": 1.545}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.02830126932822168, "policy_loss": -0.05186007713433355, "vf_loss": 0.008931852737441659, "vf_explained_var": 0.8606480956077576, "kl": 0.01462695681490004, "entropy": -3.4179733395576477, "entropy_coeff": 0.0}}, "num_steps_sampled": 230400, "num_steps_trained": 230400}, "done": false, "episodes_total": 216, "training_iteration": 18, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-01-56", "timestamp": 1617649316, "time_this_iter_s": 7.4076988697052, "time_total_s": 131.64104008674622, "pid": 21096, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.23157572746277, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.31818181818182, "ram_util_percent": 61.945454545454545}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 3.803341503921656, "episode_reward_min": -0.1977635357582609, "episode_reward_mean": 1.1436750083073834, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.803341503921656, 0.8807949020938768, 0.802404993334799, 1.1566508618086568, 1.1983882066788074, 2.630369442497544, 2.7712709871463774, 3.013603266660132, 1.893031905427513, 1.0029699994611132, 0.7284805429939172, 0.5823532574095043, 1.5289988001301982, 1.3334147405197565, 0.6503660310472184, 3.405008640059206, 1.4851763303977052, 1.575228976591648, 1.000530443891071, 2.1168333536165598, 1.0977254104606784, 0.3994084823589663, -0.1977635357582609, 0.8374183819856027, 0.47739866051726376, 2.0804459984080914, 0.7548405274806413, 2.101302174688765, -0.1936730353884254, 0.22995188319622284, 0.28077619846570756, 1.1207529504539298, 1.91986030780413, 0.17785428255394686, 0.29053378509599037, 0.031709789950499, 0.7161188059751049, 0.6410458660981306, 0.9819256596608847, 1.8780672150719764, 0.14345705733285352, 1.0955880359766894, 1.0679240569459902, 1.2778849798430736, 0.5485854653672746, 0.8360130512806045, 0.7070680391511943, 0.034962718089617484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19620812417678404, "mean_inference_ms": 1.0197246696262974, "mean_action_processing_ms": 0.0424119381440359, "mean_env_wait_ms": 0.9494066715884099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 243200, "timers": {"sample_time_ms": 3965.192, "sample_throughput": 3228.091, "learn_time_ms": 3883.262, "learn_throughput": 3296.198, "update_time_ms": 1.588}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.019022563942708074, "policy_loss": -0.04706581118982285, "vf_loss": 0.013478883374482394, "vf_explained_var": 0.8571321368217468, "kl": 0.01456436388194561, "entropy": -3.4432068943977354, "entropy_coeff": 0.0}}, "num_steps_sampled": 243200, "num_steps_trained": 243200}, "done": false, "episodes_total": 232, "training_iteration": 19, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-02-04", "timestamp": 1617649324, "time_this_iter_s": 8.187627792358398, "time_total_s": 139.82866787910461, "pid": 21096, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.419203519821167, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 47.5, "ram_util_percent": 61.91818181818181}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 3.803341503921656, "episode_reward_min": -0.1977635357582609, "episode_reward_mean": 1.3741349950070392, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5702493662539536, 2.0661602721575663, 2.7863411098906496, 0.5219260154627097, 3.071487201794387, 1.0098597889882162, 3.4359907642053704, 1.03912777635757, 1.9276464270750862, 1.9691099658943703, 0.5097665644572302, 2.9153134078844998, 0.6463010784553866, 3.354313454493788, 3.544280286069605, 3.6803658022557135, 1.4851763303977052, 1.575228976591648, 1.000530443891071, 2.1168333536165598, 1.0977254104606784, 0.3994084823589663, -0.1977635357582609, 0.8374183819856027, 0.47739866051726376, 2.0804459984080914, 0.7548405274806413, 2.101302174688765, -0.1936730353884254, 0.22995188319622284, 0.28077619846570756, 1.1207529504539298, 1.91986030780413, 0.17785428255394686, 0.29053378509599037, 0.031709789950499, 0.7161188059751049, 0.6410458660981306, 0.9819256596608847, 1.8780672150719764, 0.14345705733285352, 1.0955880359766894, 1.0679240569459902, 1.2778849798430736, 0.5485854653672746, 0.8360130512806045, 0.7070680391511943, 0.034962718089617484, 3.803341503921656, 0.8807949020938768, 0.802404993334799, 1.1566508618086568, 1.1983882066788074, 2.630369442497544, 2.7712709871463774, 3.013603266660132, 1.893031905427513, 1.0029699994611132, 0.7284805429939172, 0.5823532574095043, 1.5289988001301982, 1.3334147405197565, 0.6503660310472184, 3.405008640059206], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19642119910782696, "mean_inference_ms": 1.0141774456114248, "mean_action_processing_ms": 0.04210992929810742, "mean_env_wait_ms": 0.9388637204665458, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 256000, "timers": {"sample_time_ms": 3900.244, "sample_throughput": 3281.846, "learn_time_ms": 3933.061, "learn_throughput": 3254.463, "update_time_ms": 1.554}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.013738189558498561, "policy_loss": -0.04887325468473137, "vf_loss": 0.021041002040728927, "vf_explained_var": 0.8355637192726135, "kl": 0.014094062056392432, "entropy": -3.469308788776398, "entropy_coeff": 0.0}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 248, "training_iteration": 20, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-02-12", "timestamp": 1617649332, "time_this_iter_s": 7.780052185058594, "time_total_s": 147.6087200641632, "pid": 21096, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.19925570487976, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.58181818181818, "ram_util_percent": 60.027272727272724}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 3.803341503921656, "episode_reward_min": -0.1977635357582609, "episode_reward_mean": 1.4629638058049659, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.748256391560148, 3.122010638019491, 1.5153957542716858, 3.123773375929548, 2.1274709671916274, 0.6314021242811438, 1.4862887344267892, 2.6341563518266145, 1.4851763303977052, 1.575228976591648, 1.000530443891071, 2.1168333536165598, 1.0977254104606784, 0.3994084823589663, -0.1977635357582609, 0.8374183819856027, 0.47739866051726376, 2.0804459984080914, 0.7548405274806413, 2.101302174688765, -0.1936730353884254, 0.22995188319622284, 0.28077619846570756, 1.1207529504539298, 1.91986030780413, 0.17785428255394686, 0.29053378509599037, 0.031709789950499, 0.7161188059751049, 0.6410458660981306, 0.9819256596608847, 1.8780672150719764, 0.14345705733285352, 1.0955880359766894, 1.0679240569459902, 1.2778849798430736, 0.5485854653672746, 0.8360130512806045, 0.7070680391511943, 0.034962718089617484, 3.803341503921656, 0.8807949020938768, 0.802404993334799, 1.1566508618086568, 1.1983882066788074, 2.630369442497544, 2.7712709871463774, 3.013603266660132, 1.893031905427513, 1.0029699994611132, 0.7284805429939172, 0.5823532574095043, 1.5289988001301982, 1.3334147405197565, 0.6503660310472184, 3.405008640059206, 0.5702493662539536, 2.0661602721575663, 2.7863411098906496, 0.5219260154627097, 3.071487201794387, 1.0098597889882162, 3.4359907642053704, 1.03912777635757, 1.9276464270750862, 1.9691099658943703, 0.5097665644572302, 2.9153134078844998, 0.6463010784553866, 3.354313454493788, 3.544280286069605, 3.6803658022557135], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19661532143088997, "mean_inference_ms": 1.0153141725797854, "mean_action_processing_ms": 0.042160294232160896, "mean_env_wait_ms": 0.9386498503216494, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 268800, "timers": {"sample_time_ms": 3995.889, "sample_throughput": 3203.292, "learn_time_ms": 4010.963, "learn_throughput": 3191.254, "update_time_ms": 1.574}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.020098144193179904, "policy_loss": -0.050039555868133904, "vf_loss": 0.01397753657773137, "vf_explained_var": 0.8718473315238953, "kl": 0.015963875530287622, "entropy": -3.476249990463257, "entropy_coeff": 0.0}}, "num_steps_sampled": 268800, "num_steps_trained": 268800}, "done": false, "episodes_total": 256, "training_iteration": 21, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-02-21", "timestamp": 1617649341, "time_this_iter_s": 8.882112741470337, "time_total_s": 156.49083280563354, "pid": 21096, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.0813684463501, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 62.43846153846154, "ram_util_percent": 60.8076923076923}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 4.533011367088852, "episode_reward_min": -0.1977635357582609, "episode_reward_mean": 1.5243889679479585, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.010806350712179, 1.2283942179052767, 1.2817606560264467, 4.054608558431854, 1.3928332043699272, 1.690100656351944, 0.951988536459764, 1.9950038073552099, 0.7041075495655813, 1.162669516250737, 2.235488709256729, 2.3034568893891683, 4.533011367088852, 1.3484309846130702, 1.2590337170281032, 0.6611404406579695, 1.4851763303977052, 1.575228976591648, 1.000530443891071, 2.1168333536165598, 1.0977254104606784, 0.3994084823589663, -0.1977635357582609, 0.8374183819856027, 0.47739866051726376, 2.0804459984080914, 0.7548405274806413, 2.101302174688765, -0.1936730353884254, 0.22995188319622284, 0.28077619846570756, 1.1207529504539298, 1.91986030780413, 0.17785428255394686, 0.29053378509599037, 0.031709789950499, 0.7161188059751049, 0.6410458660981306, 0.9819256596608847, 1.8780672150719764, 0.14345705733285352, 1.0955880359766894, 1.0679240569459902, 1.2778849798430736, 0.5485854653672746, 0.8360130512806045, 0.7070680391511943, 0.034962718089617484, 3.803341503921656, 0.8807949020938768, 0.802404993334799, 1.1566508618086568, 1.1983882066788074, 2.630369442497544, 2.7712709871463774, 3.013603266660132, 1.893031905427513, 1.0029699994611132, 0.7284805429939172, 0.5823532574095043, 1.5289988001301982, 1.3334147405197565, 0.6503660310472184, 3.405008640059206, 0.5702493662539536, 2.0661602721575663, 2.7863411098906496, 0.5219260154627097, 3.071487201794387, 1.0098597889882162, 3.4359907642053704, 1.03912777635757, 1.9276464270750862, 1.9691099658943703, 0.5097665644572302, 2.9153134078844998, 0.6463010784553866, 3.354313454493788, 3.544280286069605, 3.6803658022557135, 2.748256391560148, 3.122010638019491, 1.5153957542716858, 3.123773375929548, 2.1274709671916274, 0.6314021242811438, 1.4862887344267892, 2.6341563518266145], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19643459510991326, "mean_inference_ms": 1.011454083390683, "mean_action_processing_ms": 0.042017367316900554, "mean_env_wait_ms": 0.9329745271501722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 281600, "timers": {"sample_time_ms": 3873.701, "sample_throughput": 3304.334, "learn_time_ms": 3974.356, "learn_throughput": 3220.648, "update_time_ms": 1.545}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.01770215534605086, "policy_loss": -0.048725285939872263, "vf_loss": 0.016371407471597196, "vf_explained_var": 0.8820138573646545, "kl": 0.014651724128052592, "entropy": -3.51453058719635, "entropy_coeff": 0.0}}, "num_steps_sampled": 281600, "num_steps_trained": 281600}, "done": false, "episodes_total": 272, "training_iteration": 22, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-02-28", "timestamp": 1617649348, "time_this_iter_s": 6.902735233306885, "time_total_s": 163.39356803894043, "pid": 21096, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 54.98410367965698, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.760000000000005, "ram_util_percent": 62.05}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 3.346552915655658, "episode_reward_min": 1.0105782807836987, "episode_reward_mean": 1.8669352765458627, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.065837173512826, 1.0105782807836987, 1.1371222229721214, 1.4184090925626287, 1.3799198711283296, 1.3344200678601865, 3.346552915655658, 3.242642587891453], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17884974923452535, "mean_inference_ms": 0.9892209666286089, "mean_action_processing_ms": 0.04216501818531234, "mean_env_wait_ms": 0.953585635416959, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 294400, "timers": {"sample_time_ms": 4120.659, "sample_throughput": 3106.3, "learn_time_ms": 3754.746, "learn_throughput": 3409.018, "update_time_ms": 1.676}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.018501102440059185, "policy_loss": -0.047097134990617635, "vf_loss": 0.013263370813801885, "vf_explained_var": 0.8707184791564941, "kl": 0.015332660656422376, "entropy": -3.5149544405937196, "entropy_coeff": 0.0}}, "num_steps_sampled": 294400, "num_steps_trained": 294400}, "done": false, "episodes_total": 280, "training_iteration": 23, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-03-41", "timestamp": 1617649421, "time_this_iter_s": 7.880039691925049, "time_total_s": 171.27360773086548, "pid": 22128, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.880039691925049, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.54999999999999, "ram_util_percent": 61.79166666666666}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 4.190942072986938, "episode_reward_min": 0.9220535997212382, "episode_reward_mean": 2.2846388157447293, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1311684065872032, 2.571484236532315, 0.9220535997212382, 2.8936214770800675, 2.7745472203701174, 2.816692350091458, 1.7406920642006196, 2.57650503435984, 2.8896151373204404, 1.8889195948398632, 2.3578193036388457, 2.944227055296268, 2.8334664748807232, 2.6767965673908867, 2.6872987702097735, 4.190942072986938, 2.065837173512826, 1.0105782807836987, 1.1371222229721214, 1.4184090925626287, 1.3799198711283296, 1.3344200678601865, 3.346552915655658, 3.242642587891453], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.191695572467204, "mean_inference_ms": 0.984610695064379, "mean_action_processing_ms": 0.041956124625393325, "mean_env_wait_ms": 0.9343774724117142, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 307200, "timers": {"sample_time_ms": 3946.927, "sample_throughput": 3243.029, "learn_time_ms": 3782.835, "learn_throughput": 3383.706, "update_time_ms": 1.542}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.019871271695010365, "policy_loss": -0.05229250377044082, "vf_loss": 0.016672561010345817, "vf_explained_var": 0.8984915018081665, "kl": 0.01574867048300803, "entropy": -3.5475452876091005, "entropy_coeff": 0.0}}, "num_steps_sampled": 307200, "num_steps_trained": 307200}, "done": false, "episodes_total": 296, "training_iteration": 24, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-03-49", "timestamp": 1617649429, "time_this_iter_s": 7.590273141860962, "time_total_s": 178.86388087272644, "pid": 22128, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.47031283378601, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.99090909090909, "ram_util_percent": 61.91818181818181}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 6.175134804429527, "episode_reward_min": 0.9220535997212382, "episode_reward_mean": 2.4440491019334276, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.22246096602389, 3.0724915276444245, 2.2935555713262086, 1.9076903576733248, 1.9733295484387807, 2.596716883099122, 2.1368600253609054, 6.175134804429527, 2.065837173512826, 1.0105782807836987, 1.1371222229721214, 1.4184090925626287, 1.3799198711283296, 1.3344200678601865, 3.346552915655658, 3.242642587891453, 1.1311684065872032, 2.571484236532315, 0.9220535997212382, 2.8936214770800675, 2.7745472203701174, 2.816692350091458, 1.7406920642006196, 2.57650503435984, 2.8896151373204404, 1.8889195948398632, 2.3578193036388457, 2.944227055296268, 2.8334664748807232, 2.6767965673908867, 2.6872987702097735, 4.190942072986938], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1903381634619219, "mean_inference_ms": 0.9916819453580737, "mean_action_processing_ms": 0.041823470333413326, "mean_env_wait_ms": 0.9274785789316315, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 320000, "timers": {"sample_time_ms": 3924.409, "sample_throughput": 3261.638, "learn_time_ms": 3838.431, "learn_throughput": 3334.696, "update_time_ms": 1.543}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.01995719336438924, "policy_loss": -0.05228757807984948, "vf_loss": 0.017095862552523614, "vf_explained_var": 0.8865997791290283, "kl": 0.01523452227935195, "entropy": -3.5440688514709473, "entropy_coeff": 0.0}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 304, "training_iteration": 25, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-03-57", "timestamp": 1617649437, "time_this_iter_s": 7.835386753082275, "time_total_s": 186.69926762580872, "pid": 22128, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.305699586868286, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.92727272727273, "ram_util_percent": 62.07272727272728}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 6.175134804429527, "episode_reward_min": 0.9220535997212382, "episode_reward_mean": 2.6996862506548602, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6005862558440112, 3.5964977714540787, 1.5802883950858226, 5.798563854616759, 4.989652240088481, 5.295029551481296, 2.1154032392656115, 5.662968034312366, 1.163702928680121, 2.596807659978357, 1.5589221211166562, 4.428161552323707, 2.662646805335087, 1.682990558941051, 4.180272049604698, 2.4628757514355253, 2.065837173512826, 1.0105782807836987, 1.1371222229721214, 1.4184090925626287, 1.3799198711283296, 1.3344200678601865, 3.346552915655658, 3.242642587891453, 1.1311684065872032, 2.571484236532315, 0.9220535997212382, 2.8936214770800675, 2.7745472203701174, 2.816692350091458, 1.7406920642006196, 2.57650503435984, 2.8896151373204404, 1.8889195948398632, 2.3578193036388457, 2.944227055296268, 2.8334664748807232, 2.6767965673908867, 2.6872987702097735, 4.190942072986938, 3.22246096602389, 3.0724915276444245, 2.2935555713262086, 1.9076903576733248, 1.9733295484387807, 2.596716883099122, 2.1368600253609054, 6.175134804429527], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19218760987220848, "mean_inference_ms": 1.000767287254639, "mean_action_processing_ms": 0.0418676512293172, "mean_env_wait_ms": 0.9241554341697876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 332800, "timers": {"sample_time_ms": 3972.742, "sample_throughput": 3221.956, "learn_time_ms": 3783.521, "learn_throughput": 3383.092, "update_time_ms": 1.491}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.008031426295638085, "policy_loss": -0.04835604153573513, "vf_loss": 0.025549761997535825, "vf_explained_var": 0.8684924244880676, "kl": 0.01477485497482121, "entropy": -3.5937720489501954, "entropy_coeff": 0.0}}, "num_steps_sampled": 332800, "num_steps_trained": 332800}, "done": false, "episodes_total": 320, "training_iteration": 26, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-04-05", "timestamp": 1617649445, "time_this_iter_s": 7.742931604385376, "time_total_s": 194.4421992301941, "pid": 22128, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.048631191253662, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.0, "ram_util_percent": 62.036363636363646}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 6.175134804429527, "episode_reward_min": 0.7317649754547175, "episode_reward_mean": 2.735825356591379, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.707943938349178, 4.353700108233124, 2.0119554999864815, 0.8887382110604212, 1.2030989652380129, 1.5192385921762446, 2.424006590723445, 3.9887753059810116, 2.4389713449000867, 4.661138658267908, 3.7403482231531777, 2.4685498661505982, 3.2634973714877837, 0.7317649754547175, 4.494061440675942, 4.6120936985767855, 2.065837173512826, 1.0105782807836987, 1.1371222229721214, 1.4184090925626287, 1.3799198711283296, 1.3344200678601865, 3.346552915655658, 3.242642587891453, 1.1311684065872032, 2.571484236532315, 0.9220535997212382, 2.8936214770800675, 2.7745472203701174, 2.816692350091458, 1.7406920642006196, 2.57650503435984, 2.8896151373204404, 1.8889195948398632, 2.3578193036388457, 2.944227055296268, 2.8334664748807232, 2.6767965673908867, 2.6872987702097735, 4.190942072986938, 3.22246096602389, 3.0724915276444245, 2.2935555713262086, 1.9076903576733248, 1.9733295484387807, 2.596716883099122, 2.1368600253609054, 6.175134804429527, 1.6005862558440112, 3.5964977714540787, 1.5802883950858226, 5.798563854616759, 4.989652240088481, 5.295029551481296, 2.1154032392656115, 5.662968034312366, 1.163702928680121, 2.596807659978357, 1.5589221211166562, 4.428161552323707, 2.662646805335087, 1.682990558941051, 4.180272049604698, 2.4628757514355253], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1955960205435437, "mean_inference_ms": 1.0062789687598022, "mean_action_processing_ms": 0.04200489156211758, "mean_env_wait_ms": 0.9245703946361415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 345600, "timers": {"sample_time_ms": 3996.105, "sample_throughput": 3203.119, "learn_time_ms": 3781.178, "learn_throughput": 3385.189, "update_time_ms": 1.547}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.002420100923627615, "policy_loss": -0.04639198313467205, "vf_loss": 0.03232103237882256, "vf_explained_var": 0.8610174655914307, "kl": 0.01649105113931, "entropy": -3.6284536933898925, "entropy_coeff": 0.0}}, "num_steps_sampled": 345600, "num_steps_trained": 345600}, "done": false, "episodes_total": 336, "training_iteration": 27, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-04-12", "timestamp": 1617649452, "time_this_iter_s": 7.868952751159668, "time_total_s": 202.31115198135376, "pid": 22128, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.91758394241333, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 47.39090909090908, "ram_util_percent": 62.07272727272727}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 6.175134804429527, "episode_reward_min": 0.7317649754547175, "episode_reward_mean": 2.7607431922107617, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.718762573878469, 2.928435719858498, 2.748024667274185, 4.408229069671081, 2.2963776365388995, 2.84412569531047, 4.034965429197705, 1.7017662255973338, 2.065837173512826, 1.0105782807836987, 1.1371222229721214, 1.4184090925626287, 1.3799198711283296, 1.3344200678601865, 3.346552915655658, 3.242642587891453, 1.1311684065872032, 2.571484236532315, 0.9220535997212382, 2.8936214770800675, 2.7745472203701174, 2.816692350091458, 1.7406920642006196, 2.57650503435984, 2.8896151373204404, 1.8889195948398632, 2.3578193036388457, 2.944227055296268, 2.8334664748807232, 2.6767965673908867, 2.6872987702097735, 4.190942072986938, 3.22246096602389, 3.0724915276444245, 2.2935555713262086, 1.9076903576733248, 1.9733295484387807, 2.596716883099122, 2.1368600253609054, 6.175134804429527, 1.6005862558440112, 3.5964977714540787, 1.5802883950858226, 5.798563854616759, 4.989652240088481, 5.295029551481296, 2.1154032392656115, 5.662968034312366, 1.163702928680121, 2.596807659978357, 1.5589221211166562, 4.428161552323707, 2.662646805335087, 1.682990558941051, 4.180272049604698, 2.4628757514355253, 2.707943938349178, 4.353700108233124, 2.0119554999864815, 0.8887382110604212, 1.2030989652380129, 1.5192385921762446, 2.424006590723445, 3.9887753059810116, 2.4389713449000867, 4.661138658267908, 3.7403482231531777, 2.4685498661505982, 3.2634973714877837, 0.7317649754547175, 4.494061440675942, 4.6120936985767855], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19587697872321452, "mean_inference_ms": 1.006572253518259, "mean_action_processing_ms": 0.04202278415952973, "mean_env_wait_ms": 0.9236382261050589, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 358400, "timers": {"sample_time_ms": 3925.32, "sample_throughput": 3260.881, "learn_time_ms": 3884.024, "learn_throughput": 3295.551, "update_time_ms": 1.612}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.019457270167768003, "policy_loss": -0.050584082221612335, "vf_loss": 0.01549928723834455, "vf_explained_var": 0.8971145153045654, "kl": 0.01562752518802881, "entropy": -3.6047919392585754, "entropy_coeff": 0.0}}, "num_steps_sampled": 358400, "num_steps_trained": 358400}, "done": false, "episodes_total": 344, "training_iteration": 28, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-04-20", "timestamp": 1617649460, "time_this_iter_s": 7.978989124298096, "time_total_s": 210.29014110565186, "pid": 22128, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.896573066711426, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 49.275000000000006, "ram_util_percent": 58.633333333333326}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 15.800505919082465, "episode_reward_min": 0.7317649754547175, "episode_reward_mean": 3.157083513391076, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.993775160511488, 6.231845598509682, 2.139693498162488, 5.074897749838633, 3.4087005582709713, 4.240218718206169, 3.399177402071457, 15.800505919082465, 8.084366346594955, 5.472082861727848, 1.1610583763607876, 2.6011863886541207, 4.065052452948967, 3.3324124041557397, 4.468676305936444, 1.5761895982076113, 2.065837173512826, 1.0105782807836987, 1.1371222229721214, 1.4184090925626287, 1.3799198711283296, 1.3344200678601865, 3.346552915655658, 3.242642587891453, 1.1311684065872032, 2.571484236532315, 0.9220535997212382, 2.8936214770800675, 2.7745472203701174, 2.816692350091458, 1.7406920642006196, 2.57650503435984, 2.8896151373204404, 1.8889195948398632, 2.3578193036388457, 2.944227055296268, 2.8334664748807232, 2.6767965673908867, 2.6872987702097735, 4.190942072986938, 3.22246096602389, 3.0724915276444245, 2.2935555713262086, 1.9076903576733248, 1.9733295484387807, 2.596716883099122, 2.1368600253609054, 6.175134804429527, 1.6005862558440112, 3.5964977714540787, 1.5802883950858226, 5.798563854616759, 4.989652240088481, 5.295029551481296, 2.1154032392656115, 5.662968034312366, 1.163702928680121, 2.596807659978357, 1.5589221211166562, 4.428161552323707, 2.662646805335087, 1.682990558941051, 4.180272049604698, 2.4628757514355253, 2.707943938349178, 4.353700108233124, 2.0119554999864815, 0.8887382110604212, 1.2030989652380129, 1.5192385921762446, 2.424006590723445, 3.9887753059810116, 2.4389713449000867, 4.661138658267908, 3.7403482231531777, 2.4685498661505982, 3.2634973714877837, 0.7317649754547175, 4.494061440675942, 4.6120936985767855, 2.718762573878469, 2.928435719858498, 2.748024667274185, 4.408229069671081, 2.2963776365388995, 2.84412569531047, 4.034965429197705, 1.7017662255973338], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19781643596633297, "mean_inference_ms": 1.0101201670976303, "mean_action_processing_ms": 0.04219960240170346, "mean_env_wait_ms": 0.9258992358066519, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 371200, "timers": {"sample_time_ms": 3995.127, "sample_throughput": 3203.903, "learn_time_ms": 3861.597, "learn_throughput": 3314.69, "update_time_ms": 1.571}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.051853447938337925, "policy_loss": -0.03899383704178035, "vf_loss": 0.07801031714305282, "vf_explained_var": 0.7829954624176025, "kl": 0.012836967948824168, "entropy": -3.6609363770484924, "entropy_coeff": 0.0}}, "num_steps_sampled": 371200, "num_steps_trained": 371200}, "done": false, "episodes_total": 360, "training_iteration": 29, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-04-29", "timestamp": 1617649469, "time_this_iter_s": 8.148506164550781, "time_total_s": 218.43864727020264, "pid": 22128, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 55.04507923126221, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 53.9, "ram_util_percent": 61.9909090909091}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 7.002282616480004, "episode_reward_min": 1.0357948849648277, "episode_reward_mean": 3.6429650241030727, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.159261573581176, 7.002282616480004, 2.7897069240600016, 3.313021627095881, 4.526364026428053, 2.4540986239193434, 1.0357948849648277, 3.863189916295294], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21288312650486352, "mean_inference_ms": 1.182261665935147, "mean_action_processing_ms": 0.05047787434603555, "mean_env_wait_ms": 1.1521786879480518, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 384000, "timers": {"sample_time_ms": 4739.44, "sample_throughput": 2700.741, "learn_time_ms": 3551.274, "learn_throughput": 3604.34, "update_time_ms": 1.626}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.01190886603668332, "policy_loss": -0.04775030372664332, "vf_loss": 0.020111165838316084, "vf_explained_var": 0.8886615037918091, "kl": 0.01573027078062296, "entropy": -3.6383677387237547, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 368, "training_iteration": 30, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-05-43", "timestamp": 1617649543, "time_this_iter_s": 8.295443296432495, "time_total_s": 226.73409056663513, "pid": 23028, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.295443296432495, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 55.75, "ram_util_percent": 61.79166666666666}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 11.489568583031422, "episode_reward_min": 1.0357948849648277, "episode_reward_mean": 4.863423392345573, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.294379527290025, 4.430612907889369, 4.299836296728102, 7.525092893430159, 2.1626320289553926, 7.068238728825255, 5.685735944472849, 5.578610410869709, 5.343801628395589, 4.210615494964565, 3.040549584469944, 11.489568583031422, 6.941830311832808, 7.720092864072566, 3.5573937311207855, 4.229450287120612, 4.159261573581176, 7.002282616480004, 2.7897069240600016, 3.313021627095881, 4.526364026428053, 2.4540986239193434, 1.0357948849648277, 3.863189916295294], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22782398175043647, "mean_inference_ms": 1.1640303977604998, "mean_action_processing_ms": 0.049600238974082694, "mean_env_wait_ms": 1.1205249204201742, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 396800, "timers": {"sample_time_ms": 4554.897, "sample_throughput": 2810.162, "learn_time_ms": 3640.315, "learn_throughput": 3516.179, "update_time_ms": 1.633}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.026286756237968802, "policy_loss": -0.04548590247519314, "vf_loss": 0.05634671784937382, "vf_explained_var": 0.8679801225662231, "kl": 0.015425940584391356, "entropy": -3.694523298740387, "entropy_coeff": 0.0}}, "num_steps_sampled": 396800, "num_steps_trained": 396800}, "done": false, "episodes_total": 384, "training_iteration": 31, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-05-51", "timestamp": 1617649551, "time_this_iter_s": 8.106090307235718, "time_total_s": 234.84018087387085, "pid": 23028, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.401533603668213, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.65833333333333, "ram_util_percent": 61.96666666666667}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 12.953156863913126, "episode_reward_min": 1.0357948849648277, "episode_reward_mean": 5.028246537415418, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.953156863913126, 3.2727817570661584, 6.8544556529567195, 4.505639878188987, 5.2996880170983305, 3.1218436585031197, 5.4860598368176285, 2.6881021164555987, 4.159261573581176, 7.002282616480004, 2.7897069240600016, 3.313021627095881, 4.526364026428053, 2.4540986239193434, 1.0357948849648277, 3.863189916295294, 4.294379527290025, 4.430612907889369, 4.299836296728102, 7.525092893430159, 2.1626320289553926, 7.068238728825255, 5.685735944472849, 5.578610410869709, 5.343801628395589, 4.210615494964565, 3.040549584469944, 11.489568583031422, 6.941830311832808, 7.720092864072566, 3.5573937311207855, 4.229450287120612], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22743310768463149, "mean_inference_ms": 1.1668385252324636, "mean_action_processing_ms": 0.049376600559311035, "mean_env_wait_ms": 1.111867483324257, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 409600, "timers": {"sample_time_ms": 4551.344, "sample_throughput": 2812.356, "learn_time_ms": 3695.816, "learn_throughput": 3463.376, "update_time_ms": 1.714}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.013207100867293774, "policy_loss": -0.0454818774247542, "vf_loss": 0.04446559239178896, "vf_explained_var": 0.8814949989318848, "kl": 0.0142233853507787, "entropy": -3.685985291004181, "entropy_coeff": 0.0}}, "num_steps_sampled": 409600, "num_steps_trained": 409600}, "done": false, "episodes_total": 392, "training_iteration": 32, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-06-00", "timestamp": 1617649560, "time_this_iter_s": 8.359131813049316, "time_total_s": 243.19931268692017, "pid": 23028, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.76066541671753, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 49.44166666666666, "ram_util_percent": 62.116666666666674}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 12.953156863913126, "episode_reward_min": 1.0357948849648277, "episode_reward_mean": 4.8134937581571595, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.059301512667375, 3.8999222051802436, 7.691927448409967, 3.5430776388211953, 2.5326636281102317, 2.57795229659748, 1.243657123689176, 3.16630047089627, 6.399627763371508, 6.9364674942536455, 1.7650516732488923, 2.4792545309659806, 3.47652827958189, 4.997272524523443, 3.8469471454633988, 4.527859458469559, 4.159261573581176, 7.002282616480004, 2.7897069240600016, 3.313021627095881, 4.526364026428053, 2.4540986239193434, 1.0357948849648277, 3.863189916295294, 4.294379527290025, 4.430612907889369, 4.299836296728102, 7.525092893430159, 2.1626320289553926, 7.068238728825255, 5.685735944472849, 5.578610410869709, 5.343801628395589, 4.210615494964565, 3.040549584469944, 11.489568583031422, 6.941830311832808, 7.720092864072566, 3.5573937311207855, 4.229450287120612, 12.953156863913126, 3.2727817570661584, 6.8544556529567195, 4.505639878188987, 5.2996880170983305, 3.1218436585031197, 5.4860598368176285, 2.6881021164555987], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2304192740582208, "mean_inference_ms": 1.1689744330122496, "mean_action_processing_ms": 0.049226871889372026, "mean_env_wait_ms": 1.1028239117162526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 422400, "timers": {"sample_time_ms": 4557.135, "sample_throughput": 2808.782, "learn_time_ms": 3690.511, "learn_throughput": 3468.355, "update_time_ms": 1.664}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.0064718166505917905, "policy_loss": -0.04635144967585802, "vf_loss": 0.037226242404431106, "vf_explained_var": 0.9090874195098877, "kl": 0.015597023675218225, "entropy": -3.7023480463027956, "entropy_coeff": 0.0}}, "num_steps_sampled": 422400, "num_steps_trained": 422400}, "done": false, "episodes_total": 408, "training_iteration": 33, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-06-08", "timestamp": 1617649568, "time_this_iter_s": 8.255515336990356, "time_total_s": 251.45482802391052, "pid": 23028, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.016180753707886, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 49.208333333333336, "ram_util_percent": 62.18333333333333}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 12.953156863913126, "episode_reward_min": 1.0357948849648277, "episode_reward_mean": 5.1956487254764445, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.570840579427301, 6.078471474339715, 4.115560669796859, 4.845570509564277, 3.818990616236075, 11.410035758226774, 7.032648086340243, 11.678426932668666, 5.785763041037414, 9.855380554601064, 7.653263612564944, 7.175926185888105, 3.3420802310038766, 3.293645525762199, 2.5137492075802705, 3.303465053911, 4.159261573581176, 7.002282616480004, 2.7897069240600016, 3.313021627095881, 4.526364026428053, 2.4540986239193434, 1.0357948849648277, 3.863189916295294, 4.294379527290025, 4.430612907889369, 4.299836296728102, 7.525092893430159, 2.1626320289553926, 7.068238728825255, 5.685735944472849, 5.578610410869709, 5.343801628395589, 4.210615494964565, 3.040549584469944, 11.489568583031422, 6.941830311832808, 7.720092864072566, 3.5573937311207855, 4.229450287120612, 12.953156863913126, 3.2727817570661584, 6.8544556529567195, 4.505639878188987, 5.2996880170983305, 3.1218436585031197, 5.4860598368176285, 2.6881021164555987, 11.059301512667375, 3.8999222051802436, 7.691927448409967, 3.5430776388211953, 2.5326636281102317, 2.57795229659748, 1.243657123689176, 3.16630047089627, 6.399627763371508, 6.9364674942536455, 1.7650516732488923, 2.4792545309659806, 3.47652827958189, 4.997272524523443, 3.8469471454633988, 4.527859458469559], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2325826024302659, "mean_inference_ms": 1.166345685241171, "mean_action_processing_ms": 0.049075966592572795, "mean_env_wait_ms": 1.0955395409367144, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 435200, "timers": {"sample_time_ms": 4515.154, "sample_throughput": 2834.898, "learn_time_ms": 3762.916, "learn_throughput": 3401.617, "update_time_ms": 1.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.07285873998887837, "policy_loss": -0.04453831265680492, "vf_loss": 0.10075126692652703, "vf_explained_var": 0.8354987502098083, "kl": 0.016645784862339495, "entropy": -3.7636736822128296, "entropy_coeff": 0.0}}, "num_steps_sampled": 435200, "num_steps_trained": 435200}, "done": false, "episodes_total": 424, "training_iteration": 34, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-06-16", "timestamp": 1617649576, "time_this_iter_s": 8.407521724700928, "time_total_s": 259.86234974861145, "pid": 23028, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.42370247840881, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.75833333333333, "ram_util_percent": 62.116666666666674}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 12.953156863913126, "episode_reward_min": 1.0357948849648277, "episode_reward_mean": 5.340349345932454, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.8161188533253325, 7.6605993846931995, 4.12585838887102, 6.246840430349033, 5.683151274112262, 1.7673778721371516, 8.745874971168762, 11.93781330198753, 4.159261573581176, 7.002282616480004, 2.7897069240600016, 3.313021627095881, 4.526364026428053, 2.4540986239193434, 1.0357948849648277, 3.863189916295294, 4.294379527290025, 4.430612907889369, 4.299836296728102, 7.525092893430159, 2.1626320289553926, 7.068238728825255, 5.685735944472849, 5.578610410869709, 5.343801628395589, 4.210615494964565, 3.040549584469944, 11.489568583031422, 6.941830311832808, 7.720092864072566, 3.5573937311207855, 4.229450287120612, 12.953156863913126, 3.2727817570661584, 6.8544556529567195, 4.505639878188987, 5.2996880170983305, 3.1218436585031197, 5.4860598368176285, 2.6881021164555987, 11.059301512667375, 3.8999222051802436, 7.691927448409967, 3.5430776388211953, 2.5326636281102317, 2.57795229659748, 1.243657123689176, 3.16630047089627, 6.399627763371508, 6.9364674942536455, 1.7650516732488923, 2.4792545309659806, 3.47652827958189, 4.997272524523443, 3.8469471454633988, 4.527859458469559, 9.570840579427301, 6.078471474339715, 4.115560669796859, 4.845570509564277, 3.818990616236075, 11.410035758226774, 7.032648086340243, 11.678426932668666, 5.785763041037414, 9.855380554601064, 7.653263612564944, 7.175926185888105, 3.3420802310038766, 3.293645525762199, 2.5137492075802705, 3.303465053911], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23277590812923915, "mean_inference_ms": 1.1658568949016708, "mean_action_processing_ms": 0.0490581222131888, "mean_env_wait_ms": 1.0937261875602171, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 448000, "timers": {"sample_time_ms": 4509.617, "sample_throughput": 2838.378, "learn_time_ms": 3776.81, "learn_throughput": 3389.103, "update_time_ms": 1.702}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.011304439618252218, "policy_loss": -0.04763650433626026, "vf_loss": 0.04340201634913683, "vf_explained_var": 0.8820514678955078, "kl": 0.01553892657160759, "entropy": -3.725145137310028, "entropy_coeff": 0.0}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 432, "training_iteration": 35, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-06-25", "timestamp": 1617649585, "time_this_iter_s": 8.335572957992554, "time_total_s": 268.197922706604, "pid": 23028, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.75927543640137, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 51.18333333333334, "ram_util_percent": 62.05833333333334}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 12.953156863913126, "episode_reward_min": 1.0357948849648277, "episode_reward_mean": 5.441805951795694, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0946338359510346, 7.106111389729419, 5.907868674883594, 5.096881357519231, 7.029589114689989, 4.93339859082945, 6.937656031295971, 8.224173102342421, 3.499980913628394, 6.2174101393425305, 5.608663118781859, 6.898389599802596, 6.775429396194311, 3.640616327493908, 4.2987022774336765, 9.104266980965987, 4.159261573581176, 7.002282616480004, 2.7897069240600016, 3.313021627095881, 4.526364026428053, 2.4540986239193434, 1.0357948849648277, 3.863189916295294, 4.294379527290025, 4.430612907889369, 4.299836296728102, 7.525092893430159, 2.1626320289553926, 7.068238728825255, 5.685735944472849, 5.578610410869709, 5.343801628395589, 4.210615494964565, 3.040549584469944, 11.489568583031422, 6.941830311832808, 7.720092864072566, 3.5573937311207855, 4.229450287120612, 12.953156863913126, 3.2727817570661584, 6.8544556529567195, 4.505639878188987, 5.2996880170983305, 3.1218436585031197, 5.4860598368176285, 2.6881021164555987, 11.059301512667375, 3.8999222051802436, 7.691927448409967, 3.5430776388211953, 2.5326636281102317, 2.57795229659748, 1.243657123689176, 3.16630047089627, 6.399627763371508, 6.9364674942536455, 1.7650516732488923, 2.4792545309659806, 3.47652827958189, 4.997272524523443, 3.8469471454633988, 4.527859458469559, 9.570840579427301, 6.078471474339715, 4.115560669796859, 4.845570509564277, 3.818990616236075, 11.410035758226774, 7.032648086340243, 11.678426932668666, 5.785763041037414, 9.855380554601064, 7.653263612564944, 7.175926185888105, 3.3420802310038766, 3.293645525762199, 2.5137492075802705, 3.303465053911, 5.8161188533253325, 7.6605993846931995, 4.12585838887102, 6.246840430349033, 5.683151274112262, 1.7673778721371516, 8.745874971168762, 11.93781330198753], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23358385168664467, "mean_inference_ms": 1.1641429205476572, "mean_action_processing_ms": 0.04902225024783847, "mean_env_wait_ms": 1.09021504076717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 460800, "timers": {"sample_time_ms": 4503.065, "sample_throughput": 2842.508, "learn_time_ms": 3886.011, "learn_throughput": 3293.866, "update_time_ms": 1.697}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.014304064139723778, "policy_loss": -0.04735312931239605, "vf_loss": 0.045384346041828394, "vf_explained_var": 0.9280754923820496, "kl": 0.016272846907377243, "entropy": -3.765932788848877, "entropy_coeff": 0.0}}, "num_steps_sampled": 460800, "num_steps_trained": 460800}, "done": false, "episodes_total": 448, "training_iteration": 36, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-06-34", "timestamp": 1617649594, "time_this_iter_s": 9.012974977493286, "time_total_s": 277.2108976840973, "pid": 23028, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 58.77225041389465, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 56.83846153846154, "ram_util_percent": 58.792307692307695}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 12.939958769690108, "episode_reward_min": 3.9447223577881445, "episode_reward_mean": 7.860002194718193, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.253112435971117, 5.382914815890627, 3.9447223577881445, 10.403148781076656, 9.057198377551043, 12.939958769690108, 7.739126608453212, 6.159835411324639], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21168293616385997, "mean_inference_ms": 1.1525213495036497, "mean_action_processing_ms": 0.048973089750672334, "mean_env_wait_ms": 1.1197940064250937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 473600, "timers": {"sample_time_ms": 4672.727, "sample_throughput": 2739.3, "learn_time_ms": 5040.46, "learn_throughput": 2539.451, "update_time_ms": 1.697}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.01275054644793272, "policy_loss": -0.04442304991651327, "vf_loss": 0.04181592000648379, "vf_explained_var": 0.8996764421463013, "kl": 0.015357675999402999, "entropy": -3.748089611530304, "entropy_coeff": 0.0}}, "num_steps_sampled": 473600, "num_steps_trained": 473600}, "done": false, "episodes_total": 456, "training_iteration": 37, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-08-46", "timestamp": 1617649726, "time_this_iter_s": 9.71976923942566, "time_total_s": 286.93066692352295, "pid": 24278, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.71976923942566, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 65.64285714285714, "ram_util_percent": 60.03571428571428}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 13.426811502704004, "episode_reward_min": 3.9447223577881445, "episode_reward_mean": 7.041928399477828, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.242776063556487, 6.303770165334611, 5.785689750018962, 5.994629429868028, 7.241180187783149, 7.174028511489517, 4.915676537503877, 4.188972842336438, 5.209810932437623, 13.426811502704004, 4.761371305531741, 6.6908822723160934, 7.643495271789389, 5.620094777857604, 9.144099278591886, 4.782975200602915, 7.253112435971117, 5.382914815890627, 3.9447223577881445, 10.403148781076656, 9.057198377551043, 12.939958769690108, 7.739126608453212, 6.159835411324639], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21546509015425128, "mean_inference_ms": 1.1150704235355193, "mean_action_processing_ms": 0.047341241223153585, "mean_env_wait_ms": 1.0694603266403593, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 486400, "timers": {"sample_time_ms": 4357.147, "sample_throughput": 2937.702, "learn_time_ms": 4500.092, "learn_throughput": 2844.386, "update_time_ms": 1.546}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.03771568030118942, "policy_loss": -0.04296588814817369, "vf_loss": 0.06568317566066981, "vf_explained_var": 0.9158859252929688, "kl": 0.01499839337542653, "entropy": -3.7807306385040285, "entropy_coeff": 0.0}}, "num_steps_sampled": 486400, "num_steps_trained": 486400}, "done": false, "episodes_total": 472, "training_iteration": 38, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-08-54", "timestamp": 1617649734, "time_this_iter_s": 8.009058475494385, "time_total_s": 294.93972539901733, "pid": 24278, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.728827714920044, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 48.625, "ram_util_percent": 61.883333333333326}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 13.426811502704004, "episode_reward_min": 3.9447223577881445, "episode_reward_mean": 7.218826022075104, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.7418812143406734, 6.740327257587885, 5.115034370399098, 8.494469519251522, 9.937274415822138, 9.772836568450309, 11.211906444887024, 5.9824213281968275, 7.253112435971117, 5.382914815890627, 3.9447223577881445, 10.403148781076656, 9.057198377551043, 12.939958769690108, 7.739126608453212, 6.159835411324639, 7.242776063556487, 6.303770165334611, 5.785689750018962, 5.994629429868028, 7.241180187783149, 7.174028511489517, 4.915676537503877, 4.188972842336438, 5.209810932437623, 13.426811502704004, 4.761371305531741, 6.6908822723160934, 7.643495271789389, 5.620094777857604, 9.144099278591886, 4.782975200602915], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20918488132517793, "mean_inference_ms": 1.0933219737338904, "mean_action_processing_ms": 0.04607556105882306, "mean_env_wait_ms": 1.0362211412660767, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 499200, "timers": {"sample_time_ms": 3941.925, "sample_throughput": 3247.144, "learn_time_ms": 4353.413, "learn_throughput": 2940.222, "update_time_ms": 1.587}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.01802094966173172, "policy_loss": -0.04506083526648581, "vf_loss": 0.04696071242913604, "vf_explained_var": 0.9262714385986328, "kl": 0.016121074417605998, "entropy": -3.759438350200653, "entropy_coeff": 0.0}}, "num_steps_sampled": 499200, "num_steps_trained": 499200}, "done": false, "episodes_total": 480, "training_iteration": 39, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-09-01", "timestamp": 1617649741, "time_this_iter_s": 7.1779868602752686, "time_total_s": 302.1177122592926, "pid": 24278, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.906814575195312, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 38.92, "ram_util_percent": 62.080000000000005}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 22.00972650076299, "episode_reward_min": 2.208462393750843, "episode_reward_mean": 7.522218461561335, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.948484260984976, 9.37036561821256, 3.999851008895761, 5.886297161178936, 6.91991859558514, 22.00972650076299, 10.31151666516864, 2.208462393750843, 5.266291354566062, 3.150792386071233, 6.937292399540082, 5.050699995765015, 7.362667085407388, 12.359752435016668, 6.021838781561023, 12.260096806073351, 7.253112435971117, 5.382914815890627, 3.9447223577881445, 10.403148781076656, 9.057198377551043, 12.939958769690108, 7.739126608453212, 6.159835411324639, 7.242776063556487, 6.303770165334611, 5.785689750018962, 5.994629429868028, 7.241180187783149, 7.174028511489517, 4.915676537503877, 4.188972842336438, 5.209810932437623, 13.426811502704004, 4.761371305531741, 6.6908822723160934, 7.643495271789389, 5.620094777857604, 9.144099278591886, 4.782975200602915, 4.7418812143406734, 6.740327257587885, 5.115034370399098, 8.494469519251522, 9.937274415822138, 9.772836568450309, 11.211906444887024, 5.9824213281968275], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2061568218368738, "mean_inference_ms": 1.0741291122781036, "mean_action_processing_ms": 0.04497991570774698, "mean_env_wait_ms": 1.0061279261896927, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 512000, "timers": {"sample_time_ms": 4021.919, "sample_throughput": 3182.561, "learn_time_ms": 4220.465, "learn_throughput": 3032.841, "update_time_ms": 1.6}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.1658458719914779, "policy_loss": -0.038651284421794115, "vf_loss": 0.19078938908874987, "vf_explained_var": 0.8229765295982361, "kl": 0.013707763478159905, "entropy": -3.780700330734253, "entropy_coeff": 0.0}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 496, "training_iteration": 40, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-09-10", "timestamp": 1617649750, "time_this_iter_s": 8.090877056121826, "time_total_s": 310.20858931541443, "pid": 24278, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.99769163131714, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.975, "ram_util_percent": 62.13333333333335}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 22.00972650076299, "episode_reward_min": 2.1255035221784198, "episode_reward_mean": 7.52933895214339, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.058430717378112, 6.029066730100597, 3.5018869882873735, 3.370901395417288, 17.56016145061557, 8.703902114964789, 8.600537839860863, 5.807477305012106, 5.523809601693956, 6.094623870987188, 9.468179749808685, 5.891694381088634, 13.480260985131755, 7.763092684130417, 2.1255035221784198, 4.831677445577184, 7.253112435971117, 5.382914815890627, 3.9447223577881445, 10.403148781076656, 9.057198377551043, 12.939958769690108, 7.739126608453212, 6.159835411324639, 7.242776063556487, 6.303770165334611, 5.785689750018962, 5.994629429868028, 7.241180187783149, 7.174028511489517, 4.915676537503877, 4.188972842336438, 5.209810932437623, 13.426811502704004, 4.761371305531741, 6.6908822723160934, 7.643495271789389, 5.620094777857604, 9.144099278591886, 4.782975200602915, 4.7418812143406734, 6.740327257587885, 5.115034370399098, 8.494469519251522, 9.937274415822138, 9.772836568450309, 11.211906444887024, 5.9824213281968275, 10.948484260984976, 9.37036561821256, 3.999851008895761, 5.886297161178936, 6.91991859558514, 22.00972650076299, 10.31151666516864, 2.208462393750843, 5.266291354566062, 3.150792386071233, 6.937292399540082, 5.050699995765015, 7.362667085407388, 12.359752435016668, 6.021838781561023, 12.260096806073351], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20550708581033122, "mean_inference_ms": 1.0618268945768436, "mean_action_processing_ms": 0.04435610492014839, "mean_env_wait_ms": 0.9892817726215053, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 524800, "timers": {"sample_time_ms": 3974.417, "sample_throughput": 3220.598, "learn_time_ms": 4177.267, "learn_throughput": 3064.204, "update_time_ms": 1.634}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.08321488271467388, "policy_loss": -0.04197084116749465, "vf_loss": 0.10882017206400633, "vf_explained_var": 0.9037198424339294, "kl": 0.01636555129662156, "entropy": -3.8354859375953674, "entropy_coeff": 0.0}}, "num_steps_sampled": 524800, "num_steps_trained": 524800}, "done": false, "episodes_total": 512, "training_iteration": 41, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-09-17", "timestamp": 1617649757, "time_this_iter_s": 7.795788049697876, "time_total_s": 318.0043773651123, "pid": 24278, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.793479681015015, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 45.26363636363636, "ram_util_percent": 62.0}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 22.00972650076299, "episode_reward_min": 2.1255035221784198, "episode_reward_mean": 7.361444289310937, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.378495781162266, 6.984053839635745, 6.574745410154251, 4.401993469615797, 8.630200843891094, 2.314238575389534, 8.753990184248982, 5.1085777891128235, 7.253112435971117, 5.382914815890627, 3.9447223577881445, 10.403148781076656, 9.057198377551043, 12.939958769690108, 7.739126608453212, 6.159835411324639, 7.242776063556487, 6.303770165334611, 5.785689750018962, 5.994629429868028, 7.241180187783149, 7.174028511489517, 4.915676537503877, 4.188972842336438, 5.209810932437623, 13.426811502704004, 4.761371305531741, 6.6908822723160934, 7.643495271789389, 5.620094777857604, 9.144099278591886, 4.782975200602915, 4.7418812143406734, 6.740327257587885, 5.115034370399098, 8.494469519251522, 9.937274415822138, 9.772836568450309, 11.211906444887024, 5.9824213281968275, 10.948484260984976, 9.37036561821256, 3.999851008895761, 5.886297161178936, 6.91991859558514, 22.00972650076299, 10.31151666516864, 2.208462393750843, 5.266291354566062, 3.150792386071233, 6.937292399540082, 5.050699995765015, 7.362667085407388, 12.359752435016668, 6.021838781561023, 12.260096806073351, 12.058430717378112, 6.029066730100597, 3.5018869882873735, 3.370901395417288, 17.56016145061557, 8.703902114964789, 8.600537839860863, 5.807477305012106, 5.523809601693956, 6.094623870987188, 9.468179749808685, 5.891694381088634, 13.480260985131755, 7.763092684130417, 2.1255035221784198, 4.831677445577184], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20420070097142135, "mean_inference_ms": 1.054456620815965, "mean_action_processing_ms": 0.04402569406935555, "mean_env_wait_ms": 0.9805042955073515, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 537600, "timers": {"sample_time_ms": 3835.767, "sample_throughput": 3337.012, "learn_time_ms": 4123.143, "learn_throughput": 3104.428, "update_time_ms": 1.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": -0.004784131674095988, "policy_loss": -0.04698382280766964, "vf_loss": 0.02691608067601919, "vf_explained_var": 0.9459879398345947, "kl": 0.015283611183986068, "entropy": -3.7544277262687684, "entropy_coeff": 0.0}}, "num_steps_sampled": 537600, "num_steps_trained": 537600}, "done": false, "episodes_total": 520, "training_iteration": 42, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-09-24", "timestamp": 1617649764, "time_this_iter_s": 7.0017969608306885, "time_total_s": 325.006174325943, "pid": 24278, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.7952766418457, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.17, "ram_util_percent": 62.080000000000005}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 22.00972650076299, "episode_reward_min": 2.1255035221784198, "episode_reward_mean": 7.759527401896665, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.309939192902828, 5.758031612714631, 9.139814560149391, 5.253483964115461, 9.30779536069644, 19.081128346214363, 9.659194089750969, 14.702257086764137, 5.863911287734148, 9.166269214977062, 11.580661235428673, 6.436049815851242, 3.8704975696392943, 4.993635808774289, 9.996494969743251, 12.695258421062798, 7.253112435971117, 5.382914815890627, 3.9447223577881445, 10.403148781076656, 9.057198377551043, 12.939958769690108, 7.739126608453212, 6.159835411324639, 7.242776063556487, 6.303770165334611, 5.785689750018962, 5.994629429868028, 7.241180187783149, 7.174028511489517, 4.915676537503877, 4.188972842336438, 5.209810932437623, 13.426811502704004, 4.761371305531741, 6.6908822723160934, 7.643495271789389, 5.620094777857604, 9.144099278591886, 4.782975200602915, 4.7418812143406734, 6.740327257587885, 5.115034370399098, 8.494469519251522, 9.937274415822138, 9.772836568450309, 11.211906444887024, 5.9824213281968275, 10.948484260984976, 9.37036561821256, 3.999851008895761, 5.886297161178936, 6.91991859558514, 22.00972650076299, 10.31151666516864, 2.208462393750843, 5.266291354566062, 3.150792386071233, 6.937292399540082, 5.050699995765015, 7.362667085407388, 12.359752435016668, 6.021838781561023, 12.260096806073351, 12.058430717378112, 6.029066730100597, 3.5018869882873735, 3.370901395417288, 17.56016145061557, 8.703902114964789, 8.600537839860863, 5.807477305012106, 5.523809601693956, 6.094623870987188, 9.468179749808685, 5.891694381088634, 13.480260985131755, 7.763092684130417, 2.1255035221784198, 4.831677445577184, 5.378495781162266, 6.984053839635745, 6.574745410154251, 4.401993469615797, 8.630200843891094, 2.314238575389534, 8.753990184248982, 5.1085777891128235], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2034071967253012, "mean_inference_ms": 1.044703728964541, "mean_action_processing_ms": 0.04360260590998422, "mean_env_wait_ms": 0.9690002749416629, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 550400, "timers": {"sample_time_ms": 3866.185, "sample_throughput": 3310.757, "learn_time_ms": 4080.249, "learn_throughput": 3137.064, "update_time_ms": 1.61}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.08328836076892912, "policy_loss": -0.040024137781001626, "vf_loss": 0.10556370012462139, "vf_explained_var": 0.8900262713432312, "kl": 0.017748798048123716, "entropy": -3.815770344734192, "entropy_coeff": 0.0}}, "num_steps_sampled": 550400, "num_steps_trained": 550400}, "done": false, "episodes_total": 536, "training_iteration": 43, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-09-32", "timestamp": 1617649772, "time_this_iter_s": 7.880066633224487, "time_total_s": 332.8862409591675, "pid": 24278, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 55.67534327507019, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 45.800000000000004, "ram_util_percent": 62.13636363636365}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 11.255703583790469, "episode_reward_min": 5.223051026826115, "episode_reward_mean": 8.488268879494715, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.248644916632323, 9.618808868463619, 8.682783566410135, 5.223051026826115, 9.24281373408181, 10.018830932237963, 11.255703583790469, 6.615514407515289], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17860682586965376, "mean_inference_ms": 1.036315579327995, "mean_action_processing_ms": 0.04412242206166045, "mean_env_wait_ms": 1.0227624101239692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 563200, "timers": {"sample_time_ms": 4446.593, "sample_throughput": 2878.608, "learn_time_ms": 3660.99, "learn_throughput": 3496.322, "update_time_ms": 1.745}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.013710154278669506, "policy_loss": -0.04399374001659453, "vf_loss": 0.04268870444968343, "vf_explained_var": 0.9291030764579773, "kl": 0.01501518995501101, "entropy": -3.781084439754486, "entropy_coeff": 0.0}}, "num_steps_sampled": 563200, "num_steps_trained": 563200}, "done": false, "episodes_total": 544, "training_iteration": 44, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-10-04", "timestamp": 1617649804, "time_this_iter_s": 8.114713430404663, "time_total_s": 341.00095438957214, "pid": 25766, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.114713430404663, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.0, "ram_util_percent": 62.416666666666664}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 19.436819542056917, "episode_reward_min": 1.9827918364085888, "episode_reward_mean": 7.922419714031009, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.536976287637852, 8.823974132993404, 7.195840360849045, 3.789521651548151, 19.436819542056917, 7.01964847995597, 9.66665615400788, 6.750813496169559, 6.3385242853340795, 5.976722460575766, 1.9827918364085888, 6.996221140629615, 10.050700358680835, 10.399714245032394, 5.434455126681898, 5.832542542224545, 7.248644916632323, 9.618808868463619, 8.682783566410135, 5.223051026826115, 9.24281373408181, 10.018830932237963, 11.255703583790469, 6.615514407515289], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1990499034836065, "mean_inference_ms": 1.0536605991131032, "mean_action_processing_ms": 0.04481876235718448, "mean_env_wait_ms": 1.0180123811792552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 576000, "timers": {"sample_time_ms": 4336.334, "sample_throughput": 2951.802, "learn_time_ms": 3715.742, "learn_throughput": 3444.804, "update_time_ms": 1.623}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.07722256051376462, "policy_loss": -0.04137365818023682, "vf_loss": 0.10286048788577318, "vf_explained_var": 0.9006232619285583, "kl": 0.015735728619620203, "entropy": -3.852782905101776, "entropy_coeff": 0.0}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 560, "training_iteration": 45, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-10-12", "timestamp": 1617649812, "time_this_iter_s": 8.003374814987183, "time_total_s": 349.0043292045593, "pid": 25766, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.118088245391846, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 46.80833333333333, "ram_util_percent": 62.683333333333344}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 19.752007709794952, "episode_reward_min": 1.9827918364085888, "episode_reward_mean": 8.498749904470388, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.14847203465024, 4.196731962153836, 19.752007709794952, 7.997652293683217, 10.861959900439594, 9.466364509144901, 7.538761074630129, 10.85997432181137, 7.248644916632323, 9.618808868463619, 8.682783566410135, 5.223051026826115, 9.24281373408181, 10.018830932237963, 11.255703583790469, 6.615514407515289, 6.536976287637852, 8.823974132993404, 7.195840360849045, 3.789521651548151, 19.436819542056917, 7.01964847995597, 9.66665615400788, 6.750813496169559, 6.3385242853340795, 5.976722460575766, 1.9827918364085888, 6.996221140629615, 10.050700358680835, 10.399714245032394, 5.434455126681898, 5.832542542224545], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19950136743200902, "mean_inference_ms": 1.0610267930495678, "mean_action_processing_ms": 0.044819298043938846, "mean_env_wait_ms": 1.0130450064974885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 588800, "timers": {"sample_time_ms": 4267.554, "sample_throughput": 2999.376, "learn_time_ms": 3732.339, "learn_throughput": 3429.485, "update_time_ms": 1.564}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.05686293799430132, "policy_loss": -0.040821835366077724, "vf_loss": 0.08131079975515604, "vf_explained_var": 0.9108448624610901, "kl": 0.016373973935842515, "entropy": -3.8159144282341004, "entropy_coeff": 0.0}}, "num_steps_sampled": 588800, "num_steps_trained": 588800}, "done": false, "episodes_total": 568, "training_iteration": 46, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-10-20", "timestamp": 1617649820, "time_this_iter_s": 7.902766704559326, "time_total_s": 356.90709590911865, "pid": 25766, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.020854949951172, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.89090909090908, "ram_util_percent": 62.6}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 19.752007709794952, "episode_reward_min": 1.9827918364085888, "episode_reward_mean": 9.479037119779663, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.700591799673264, 9.930067215930354, 11.775805974005504, 18.10040198891347, 12.485341144262282, 10.786426605211055, 9.778812613281131, 14.489454441764273, 3.6000128916444645, 4.146731629967825, 6.474096870505344, 10.598824598456105, 11.018916811833085, 13.328068549720447, 15.950584717796193, 17.869646953406566, 7.248644916632323, 9.618808868463619, 8.682783566410135, 5.223051026826115, 9.24281373408181, 10.018830932237963, 11.255703583790469, 6.615514407515289, 6.536976287637852, 8.823974132993404, 7.195840360849045, 3.789521651548151, 19.436819542056917, 7.01964847995597, 9.66665615400788, 6.750813496169559, 6.3385242853340795, 5.976722460575766, 1.9827918364085888, 6.996221140629615, 10.050700358680835, 10.399714245032394, 5.434455126681898, 5.832542542224545, 11.14847203465024, 4.196731962153836, 19.752007709794952, 7.997652293683217, 10.861959900439594, 9.466364509144901, 7.538761074630129, 10.85997432181137], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20230824152397434, "mean_inference_ms": 1.062883015454937, "mean_action_processing_ms": 0.0446449757159548, "mean_env_wait_ms": 1.002427063130579, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 601600, "timers": {"sample_time_ms": 4194.471, "sample_throughput": 3051.636, "learn_time_ms": 3736.689, "learn_throughput": 3425.493, "update_time_ms": 1.567}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.09316564152017236, "policy_loss": -0.04414626974612475, "vf_loss": 0.12221309486776591, "vf_explained_var": 0.8903016448020935, "kl": 0.01509881580248475, "entropy": -3.8783558320999147, "entropy_coeff": 0.0}}, "num_steps_sampled": 601600, "num_steps_trained": 601600}, "done": false, "episodes_total": 584, "training_iteration": 47, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-10-28", "timestamp": 1617649828, "time_this_iter_s": 7.7316811084747314, "time_total_s": 364.6387770175934, "pid": 25766, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.752536058425903, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.02727272727273, "ram_util_percent": 62.62727272727273}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 21.591407328384925, "episode_reward_min": 1.9827918364085888, "episode_reward_mean": 10.037959971748272, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.736543450962834, 8.800588958160528, 3.3749185034876614, 21.591407328384925, 10.986444892897463, 7.655306853604602, 7.503882577095517, 11.231315854182823, 10.20458878536611, 14.272500290862041, 10.949580628117232, 13.635746983836727, 12.445305762649337, 13.964137719213726, 6.983438055359892, 14.099949798284097, 7.248644916632323, 9.618808868463619, 8.682783566410135, 5.223051026826115, 9.24281373408181, 10.018830932237963, 11.255703583790469, 6.615514407515289, 6.536976287637852, 8.823974132993404, 7.195840360849045, 3.789521651548151, 19.436819542056917, 7.01964847995597, 9.66665615400788, 6.750813496169559, 6.3385242853340795, 5.976722460575766, 1.9827918364085888, 6.996221140629615, 10.050700358680835, 10.399714245032394, 5.434455126681898, 5.832542542224545, 11.14847203465024, 4.196731962153836, 19.752007709794952, 7.997652293683217, 10.861959900439594, 9.466364509144901, 7.538761074630129, 10.85997432181137, 12.700591799673264, 9.930067215930354, 11.775805974005504, 18.10040198891347, 12.485341144262282, 10.786426605211055, 9.778812613281131, 14.489454441764273, 3.6000128916444645, 4.146731629967825, 6.474096870505344, 10.598824598456105, 11.018916811833085, 13.328068549720447, 15.950584717796193, 17.869646953406566], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20420072400505324, "mean_inference_ms": 1.0609532653872917, "mean_action_processing_ms": 0.04448510116381674, "mean_env_wait_ms": 0.9947105527076548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 614400, "timers": {"sample_time_ms": 4134.9, "sample_throughput": 3095.601, "learn_time_ms": 3781.54, "learn_throughput": 3384.864, "update_time_ms": 1.678}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.1482717168983072, "policy_loss": -0.042074990191031246, "vf_loss": 0.1740472349524498, "vf_explained_var": 0.8823472857475281, "kl": 0.016299473037943244, "entropy": -3.932122218608856, "entropy_coeff": 0.0}}, "num_steps_sampled": 614400, "num_steps_trained": 614400}, "done": false, "episodes_total": 600, "training_iteration": 48, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-10-35", "timestamp": 1617649835, "time_this_iter_s": 7.868026494979858, "time_total_s": 372.50680351257324, "pid": 25766, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.62056255340576, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 43.56363636363636, "ram_util_percent": 62.718181818181826}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 21.591407328384925, "episode_reward_min": 1.9827918364085888, "episode_reward_mean": 10.335533745409133, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.926414241405174, 10.623764689054543, 15.540045042303785, 6.3625624555921725, 16.493215653976705, 8.706555570075535, 13.257990868935462, 20.81844295622491, 7.248644916632323, 9.618808868463619, 8.682783566410135, 5.223051026826115, 9.24281373408181, 10.018830932237963, 11.255703583790469, 6.615514407515289, 6.536976287637852, 8.823974132993404, 7.195840360849045, 3.789521651548151, 19.436819542056917, 7.01964847995597, 9.66665615400788, 6.750813496169559, 6.3385242853340795, 5.976722460575766, 1.9827918364085888, 6.996221140629615, 10.050700358680835, 10.399714245032394, 5.434455126681898, 5.832542542224545, 11.14847203465024, 4.196731962153836, 19.752007709794952, 7.997652293683217, 10.861959900439594, 9.466364509144901, 7.538761074630129, 10.85997432181137, 12.700591799673264, 9.930067215930354, 11.775805974005504, 18.10040198891347, 12.485341144262282, 10.786426605211055, 9.778812613281131, 14.489454441764273, 3.6000128916444645, 4.146731629967825, 6.474096870505344, 10.598824598456105, 11.018916811833085, 13.328068549720447, 15.950584717796193, 17.869646953406566, 19.736543450962834, 8.800588958160528, 3.3749185034876614, 21.591407328384925, 10.986444892897463, 7.655306853604602, 7.503882577095517, 11.231315854182823, 10.20458878536611, 14.272500290862041, 10.949580628117232, 13.635746983836727, 12.445305762649337, 13.964137719213726, 6.983438055359892, 14.099949798284097], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20432627970176048, "mean_inference_ms": 1.0593187941318614, "mean_action_processing_ms": 0.04441138163241995, "mean_env_wait_ms": 0.9912630484070747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 627200, "timers": {"sample_time_ms": 4078.307, "sample_throughput": 3138.557, "learn_time_ms": 3851.184, "learn_throughput": 3323.653, "update_time_ms": 1.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.052906426014378664, "policy_loss": -0.04179401035420596, "vf_loss": 0.07851232543587684, "vf_explained_var": 0.9256011843681335, "kl": 0.016188110718503596, "entropy": -3.8475336050987243, "entropy_coeff": 0.0}}, "num_steps_sampled": 627200, "num_steps_trained": 627200}, "done": false, "episodes_total": 608, "training_iteration": 49, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-10-44", "timestamp": 1617649844, "time_this_iter_s": 8.002126693725586, "time_total_s": 380.5089302062988, "pid": 25766, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.62268924713135, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.791666666666664, "ram_util_percent": 59.01666666666666}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 21.591407328384925, "episode_reward_min": 1.9827918364085888, "episode_reward_mean": 10.408572605966642, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.518705715152096, 3.923144365492897, 12.539273116924601, 15.67108564206168, 9.417739699753778, 9.916955956085605, 17.959411732699138, 9.273295078863136, 18.047626217609935, 8.048957157157432, 12.309829764911543, 6.334872762477783, 8.84538372143352, 8.140033330708999, 6.721890958168427, 16.127754436106297, 7.248644916632323, 9.618808868463619, 8.682783566410135, 5.223051026826115, 9.24281373408181, 10.018830932237963, 11.255703583790469, 6.615514407515289, 6.536976287637852, 8.823974132993404, 7.195840360849045, 3.789521651548151, 19.436819542056917, 7.01964847995597, 9.66665615400788, 6.750813496169559, 6.3385242853340795, 5.976722460575766, 1.9827918364085888, 6.996221140629615, 10.050700358680835, 10.399714245032394, 5.434455126681898, 5.832542542224545, 11.14847203465024, 4.196731962153836, 19.752007709794952, 7.997652293683217, 10.861959900439594, 9.466364509144901, 7.538761074630129, 10.85997432181137, 12.700591799673264, 9.930067215930354, 11.775805974005504, 18.10040198891347, 12.485341144262282, 10.786426605211055, 9.778812613281131, 14.489454441764273, 3.6000128916444645, 4.146731629967825, 6.474096870505344, 10.598824598456105, 11.018916811833085, 13.328068549720447, 15.950584717796193, 17.869646953406566, 19.736543450962834, 8.800588958160528, 3.3749185034876614, 21.591407328384925, 10.986444892897463, 7.655306853604602, 7.503882577095517, 11.231315854182823, 10.20458878536611, 14.272500290862041, 10.949580628117232, 13.635746983836727, 12.445305762649337, 13.964137719213726, 6.983438055359892, 14.099949798284097, 9.926414241405174, 10.623764689054543, 15.540045042303785, 6.3625624555921725, 16.493215653976705, 8.706555570075535, 13.257990868935462, 20.81844295622491], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20441542744931276, "mean_inference_ms": 1.0517843943364638, "mean_action_processing_ms": 0.04409673471040867, "mean_env_wait_ms": 0.981161443439925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 640000, "timers": {"sample_time_ms": 3979.147, "sample_throughput": 3216.77, "learn_time_ms": 3853.486, "learn_throughput": 3321.668, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.1438997975550592, "policy_loss": -0.039661833653226494, "vf_loss": 0.16771871246397496, "vf_explained_var": 0.9008079767227173, "kl": 0.01584291541017592, "entropy": -3.9255041790008547, "entropy_coeff": 0.0}}, "num_steps_sampled": 640000, "num_steps_trained": 640000}, "done": false, "episodes_total": 624, "training_iteration": 50, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-10-51", "timestamp": 1617649851, "time_this_iter_s": 7.257984638214111, "time_total_s": 387.76691484451294, "pid": 25766, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 54.88067388534546, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 37.239999999999995, "ram_util_percent": 62.7}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 13.804930377230743, "episode_reward_min": 6.614486607916017, "episode_reward_mean": 10.614957971612828, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.972356617700797, 6.614486607916017, 12.848541044936347, 9.860874089610904, 12.52484970601603, 9.146192379651545, 13.804930377230743, 10.14743294984024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14200964843683284, "mean_inference_ms": 0.8404428775723021, "mean_action_processing_ms": 0.03558065949344099, "mean_env_wait_ms": 0.8219498012454565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 652800, "timers": {"sample_time_ms": 3730.861, "sample_throughput": 3430.844, "learn_time_ms": 3775.027, "learn_throughput": 3390.705, "update_time_ms": 1.456}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.025851006601005793, "policy_loss": -0.04408740060403943, "vf_loss": 0.05427943963557482, "vf_explained_var": 0.9467020630836487, "kl": 0.01565896898508072, "entropy": -3.8619686698913576, "entropy_coeff": 0.0}}, "num_steps_sampled": 652800, "num_steps_trained": 652800}, "done": false, "episodes_total": 632, "training_iteration": 51, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-11-19", "timestamp": 1617649879, "time_this_iter_s": 7.510048866271973, "time_total_s": 395.2769637107849, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.510048866271973, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.518181818181816, "ram_util_percent": 62.4}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 21.35954218064378, "episode_reward_min": 4.662766712667349, "episode_reward_mean": 11.79948859009385, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.46105434632286, 9.931428368744909, 16.17709752826524, 16.383409964201356, 13.513662625027383, 7.5777561057759435, 9.311025439757582, 9.846328891456967, 21.267206972103292, 9.754388813539963, 10.223582825067934, 9.5294693355729, 9.732029636806631, 21.35954218064378, 11.537312643395651, 4.662766712667349, 9.972356617700797, 6.614486607916017, 12.848541044936347, 9.860874089610904, 12.52484970601603, 9.146192379651545, 13.804930377230743, 10.14743294984024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16727727609671153, "mean_inference_ms": 0.8613680156354228, "mean_action_processing_ms": 0.0364067693730776, "mean_env_wait_ms": 0.8232417507508499, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 665600, "timers": {"sample_time_ms": 3656.4, "sample_throughput": 3500.711, "learn_time_ms": 3759.223, "learn_throughput": 3404.959, "update_time_ms": 1.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.17037826472893358, "policy_loss": -0.03894723069854081, "vf_loss": 0.1932488300651312, "vf_explained_var": 0.8970811367034912, "kl": 0.01607666688039899, "entropy": -3.961079008579254, "entropy_coeff": 0.0}}, "num_steps_sampled": 665600, "num_steps_trained": 665600}, "done": false, "episodes_total": 648, "training_iteration": 52, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-11-26", "timestamp": 1617649886, "time_this_iter_s": 7.332803010940552, "time_total_s": 402.60976672172546, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.842851877212524, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.6, "ram_util_percent": 62.6}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 21.61944433602637, "episode_reward_min": 4.662766712667349, "episode_reward_mean": 12.65829168582794, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.288769182929158, 16.83444060978354, 12.564467776659955, 13.346839796021179, 21.61944433602637, 10.264036636937426, 19.51234257374943, 17.44726687213467, 9.972356617700797, 6.614486607916017, 12.848541044936347, 9.860874089610904, 12.52484970601603, 9.146192379651545, 13.804930377230743, 10.14743294984024, 17.46105434632286, 9.931428368744909, 16.17709752826524, 16.383409964201356, 13.513662625027383, 7.5777561057759435, 9.311025439757582, 9.846328891456967, 21.267206972103292, 9.754388813539963, 10.223582825067934, 9.5294693355729, 9.732029636806631, 21.35954218064378, 11.537312643395651, 4.662766712667349], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17090946746208846, "mean_inference_ms": 0.886032296983098, "mean_action_processing_ms": 0.03710697302665758, "mean_env_wait_ms": 0.8355851338861069, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 678400, "timers": {"sample_time_ms": 3798.209, "sample_throughput": 3370.009, "learn_time_ms": 3842.167, "learn_throughput": 3331.454, "update_time_ms": 1.617}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.11178712031804025, "policy_loss": -0.041779752736911174, "vf_loss": 0.13618238858878612, "vf_explained_var": 0.9189624786376953, "kl": 0.017384485686197878, "entropy": -3.9131538605690004, "entropy_coeff": 0.0}}, "num_steps_sampled": 678400, "num_steps_trained": 678400}, "done": false, "episodes_total": 656, "training_iteration": 53, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-11-34", "timestamp": 1617649894, "time_this_iter_s": 8.097175359725952, "time_total_s": 410.7069420814514, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.940027236938477, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.9909090909091, "ram_util_percent": 62.6}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 21.61944433602637, "episode_reward_min": 4.662766712667349, "episode_reward_mean": 12.424728227029325, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.486988465553416, 6.620960227978414, 10.214548478635331, 10.649272220564024, 20.682510679562064, 12.108161697577993, 11.932422129978804, 10.10793055037191, 9.467553346577764, 10.005958101489586, 10.18453986996084, 15.121345730304206, 11.049048247440004, 10.52190501353813, 7.481505365003011, 18.686970826378005, 9.972356617700797, 6.614486607916017, 12.848541044936347, 9.860874089610904, 12.52484970601603, 9.146192379651545, 13.804930377230743, 10.14743294984024, 17.46105434632286, 9.931428368744909, 16.17709752826524, 16.383409964201356, 13.513662625027383, 7.5777561057759435, 9.311025439757582, 9.846328891456967, 21.267206972103292, 9.754388813539963, 10.223582825067934, 9.5294693355729, 9.732029636806631, 21.35954218064378, 11.537312643395651, 4.662766712667349, 10.288769182929158, 16.83444060978354, 12.564467776659955, 13.346839796021179, 21.61944433602637, 10.264036636937426, 19.51234257374943, 17.44726687213467], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1745846892437004, "mean_inference_ms": 0.9003917843265347, "mean_action_processing_ms": 0.03743402742862643, "mean_env_wait_ms": 0.8376563235327747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 691200, "timers": {"sample_time_ms": 3644.432, "sample_throughput": 3512.208, "learn_time_ms": 3839.1, "learn_throughput": 3334.115, "update_time_ms": 1.589}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.11552086439915002, "policy_loss": -0.04044678684324026, "vf_loss": 0.14095967300236226, "vf_explained_var": 0.9249961972236633, "kl": 0.01500797925516963, "entropy": -3.966077036857605, "entropy_coeff": 0.0}}, "num_steps_sampled": 691200, "num_steps_trained": 691200}, "done": false, "episodes_total": 672, "training_iteration": 54, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-11-41", "timestamp": 1617649901, "time_this_iter_s": 7.0197203159332275, "time_total_s": 417.72666239738464, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.959747552871704, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.24999999999999, "ram_util_percent": 62.66000000000001}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 21.61944433602637, "episode_reward_min": 4.662766712667349, "episode_reward_mean": 12.261404328430725, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.61302889293426, 11.187789824251379, 17.93328690137492, 7.4127132699378855, 13.181748589449258, 15.492107941448928, 7.880594525195324, 16.906157786277177, 6.272400801238697, 7.373644869622828, 10.939102631035764, 8.465643946099187, 8.425564948295667, 12.077664495131359, 13.587014466407387, 12.59445823345888, 9.972356617700797, 6.614486607916017, 12.848541044936347, 9.860874089610904, 12.52484970601603, 9.146192379651545, 13.804930377230743, 10.14743294984024, 17.46105434632286, 9.931428368744909, 16.17709752826524, 16.383409964201356, 13.513662625027383, 7.5777561057759435, 9.311025439757582, 9.846328891456967, 21.267206972103292, 9.754388813539963, 10.223582825067934, 9.5294693355729, 9.732029636806631, 21.35954218064378, 11.537312643395651, 4.662766712667349, 10.288769182929158, 16.83444060978354, 12.564467776659955, 13.346839796021179, 21.61944433602637, 10.264036636937426, 19.51234257374943, 17.44726687213467, 16.486988465553416, 6.620960227978414, 10.214548478635331, 10.649272220564024, 20.682510679562064, 12.108161697577993, 11.932422129978804, 10.10793055037191, 9.467553346577764, 10.005958101489586, 10.18453986996084, 15.121345730304206, 11.049048247440004, 10.52190501353813, 7.481505365003011, 18.686970826378005], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17798675251749013, "mean_inference_ms": 0.9084375059229021, "mean_action_processing_ms": 0.03769549494335048, "mean_env_wait_ms": 0.840196161123955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 704000, "timers": {"sample_time_ms": 3652.39, "sample_throughput": 3504.554, "learn_time_ms": 3840.051, "learn_throughput": 3333.289, "update_time_ms": 1.566}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.12387411894742399, "policy_loss": -0.04096423193346709, "vf_loss": 0.14839936017990113, "vf_explained_var": 0.9247892498970032, "kl": 0.01643899044021964, "entropy": -4.018532366752624, "entropy_coeff": 0.0}}, "num_steps_sampled": 704000, "num_steps_trained": 704000}, "done": false, "episodes_total": 688, "training_iteration": 55, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-11-49", "timestamp": 1617649909, "time_this_iter_s": 7.537060022354126, "time_total_s": 425.26372241973877, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.49680757522583, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.736363636363635, "ram_util_percent": 62.70000000000002}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 21.61944433602637, "episode_reward_min": 4.662766712667349, "episode_reward_mean": 12.296696903068229, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.4845012085502045, 10.969418156959867, 15.71254934037556, 11.99985811220501, 14.89127184538257, 10.451817148685032, 13.721313485257653, 15.401570703930037, 9.972356617700797, 6.614486607916017, 12.848541044936347, 9.860874089610904, 12.52484970601603, 9.146192379651545, 13.804930377230743, 10.14743294984024, 17.46105434632286, 9.931428368744909, 16.17709752826524, 16.383409964201356, 13.513662625027383, 7.5777561057759435, 9.311025439757582, 9.846328891456967, 21.267206972103292, 9.754388813539963, 10.223582825067934, 9.5294693355729, 9.732029636806631, 21.35954218064378, 11.537312643395651, 4.662766712667349, 10.288769182929158, 16.83444060978354, 12.564467776659955, 13.346839796021179, 21.61944433602637, 10.264036636937426, 19.51234257374943, 17.44726687213467, 16.486988465553416, 6.620960227978414, 10.214548478635331, 10.649272220564024, 20.682510679562064, 12.108161697577993, 11.932422129978804, 10.10793055037191, 9.467553346577764, 10.005958101489586, 10.18453986996084, 15.121345730304206, 11.049048247440004, 10.52190501353813, 7.481505365003011, 18.686970826378005, 18.61302889293426, 11.187789824251379, 17.93328690137492, 7.4127132699378855, 13.181748589449258, 15.492107941448928, 7.880594525195324, 16.906157786277177, 6.272400801238697, 7.373644869622828, 10.939102631035764, 8.465643946099187, 8.425564948295667, 12.077664495131359, 13.587014466407387, 12.59445823345888], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17871778930924295, "mean_inference_ms": 0.9125408374221734, "mean_action_processing_ms": 0.03785789664777475, "mean_env_wait_ms": 0.8426083358052853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 716800, "timers": {"sample_time_ms": 3687.596, "sample_throughput": 3471.096, "learn_time_ms": 3851.995, "learn_throughput": 3322.954, "update_time_ms": 1.55}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.048873053183779123, "policy_loss": -0.040819202386774125, "vf_loss": 0.07489613004028797, "vf_explained_var": 0.9438020586967468, "kl": 0.014796125274151563, "entropy": -3.9417131328582764, "entropy_coeff": 0.0}}, "num_steps_sampled": 716800, "num_steps_trained": 716800}, "done": false, "episodes_total": 696, "training_iteration": 56, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-11-57", "timestamp": 1617649917, "time_this_iter_s": 7.781367540359497, "time_total_s": 433.04508996009827, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.27817511558533, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.88181818181818, "ram_util_percent": 62.73636363636364}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 23.776393909055415, "episode_reward_min": 4.441534577645219, "episode_reward_mean": 12.665573723756546, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.776393909055415, 18.27293796361951, 15.636718448317598, 15.160688174396984, 20.169912714747877, 20.3593537357718, 18.315391920850406, 7.525454177915588, 10.01338841034624, 7.794182470895523, 10.38212266046101, 4.441534577645219, 15.578927629747884, 12.888935665665496, 19.439934385128577, 9.452433825098673, 9.972356617700797, 6.614486607916017, 12.848541044936347, 9.860874089610904, 12.52484970601603, 9.146192379651545, 13.804930377230743, 10.14743294984024, 17.46105434632286, 9.931428368744909, 16.17709752826524, 16.383409964201356, 13.513662625027383, 7.5777561057759435, 9.311025439757582, 9.846328891456967, 21.267206972103292, 9.754388813539963, 10.223582825067934, 9.5294693355729, 9.732029636806631, 21.35954218064378, 11.537312643395651, 4.662766712667349, 10.288769182929158, 16.83444060978354, 12.564467776659955, 13.346839796021179, 21.61944433602637, 10.264036636937426, 19.51234257374943, 17.44726687213467, 16.486988465553416, 6.620960227978414, 10.214548478635331, 10.649272220564024, 20.682510679562064, 12.108161697577993, 11.932422129978804, 10.10793055037191, 9.467553346577764, 10.005958101489586, 10.18453986996084, 15.121345730304206, 11.049048247440004, 10.52190501353813, 7.481505365003011, 18.686970826378005, 18.61302889293426, 11.187789824251379, 17.93328690137492, 7.4127132699378855, 13.181748589449258, 15.492107941448928, 7.880594525195324, 16.906157786277177, 6.272400801238697, 7.373644869622828, 10.939102631035764, 8.465643946099187, 8.425564948295667, 12.077664495131359, 13.587014466407387, 12.59445823345888, 7.4845012085502045, 10.969418156959867, 15.71254934037556, 11.99985811220501, 14.89127184538257, 10.451817148685032, 13.721313485257653, 15.401570703930037], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17965174091795905, "mean_inference_ms": 0.9149172187367747, "mean_action_processing_ms": 0.037960077680147655, "mean_env_wait_ms": 0.8426539233684358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 729600, "timers": {"sample_time_ms": 3606.567, "sample_throughput": 3549.082, "learn_time_ms": 3856.641, "learn_throughput": 3318.951, "update_time_ms": 1.56}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.17345585441216826, "policy_loss": -0.038801842210814355, "vf_loss": 0.1948185057193041, "vf_explained_var": 0.922565221786499, "kl": 0.017439190819859503, "entropy": -4.039206233024597, "entropy_coeff": 0.0}}, "num_steps_sampled": 729600, "num_steps_trained": 729600}, "done": false, "episodes_total": 712, "training_iteration": 57, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-12-04", "timestamp": 1617649924, "time_this_iter_s": 7.011688709259033, "time_total_s": 440.0567786693573, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.28986382484436, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 39.39, "ram_util_percent": 62.70000000000001}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 23.776393909055415, "episode_reward_min": 4.441534577645219, "episode_reward_mean": 13.012719819275185, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.3957725258172, 12.276154320678396, 19.869949768010066, 13.372440931575955, 21.58352795319554, 17.50629587480791, 9.405732287486494, 21.240741298269942, 9.972356617700797, 6.614486607916017, 12.848541044936347, 9.860874089610904, 12.52484970601603, 9.146192379651545, 13.804930377230743, 10.14743294984024, 17.46105434632286, 9.931428368744909, 16.17709752826524, 16.383409964201356, 13.513662625027383, 7.5777561057759435, 9.311025439757582, 9.846328891456967, 21.267206972103292, 9.754388813539963, 10.223582825067934, 9.5294693355729, 9.732029636806631, 21.35954218064378, 11.537312643395651, 4.662766712667349, 10.288769182929158, 16.83444060978354, 12.564467776659955, 13.346839796021179, 21.61944433602637, 10.264036636937426, 19.51234257374943, 17.44726687213467, 16.486988465553416, 6.620960227978414, 10.214548478635331, 10.649272220564024, 20.682510679562064, 12.108161697577993, 11.932422129978804, 10.10793055037191, 9.467553346577764, 10.005958101489586, 10.18453986996084, 15.121345730304206, 11.049048247440004, 10.52190501353813, 7.481505365003011, 18.686970826378005, 18.61302889293426, 11.187789824251379, 17.93328690137492, 7.4127132699378855, 13.181748589449258, 15.492107941448928, 7.880594525195324, 16.906157786277177, 6.272400801238697, 7.373644869622828, 10.939102631035764, 8.465643946099187, 8.425564948295667, 12.077664495131359, 13.587014466407387, 12.59445823345888, 7.4845012085502045, 10.969418156959867, 15.71254934037556, 11.99985811220501, 14.89127184538257, 10.451817148685032, 13.721313485257653, 15.401570703930037, 23.776393909055415, 18.27293796361951, 15.636718448317598, 15.160688174396984, 20.169912714747877, 20.3593537357718, 18.315391920850406, 7.525454177915588, 10.01338841034624, 7.794182470895523, 10.38212266046101, 4.441534577645219, 15.578927629747884, 12.888935665665496, 19.439934385128577, 9.452433825098673], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17995459882163858, "mean_inference_ms": 0.9165562331990618, "mean_action_processing_ms": 0.038035288723967116, "mean_env_wait_ms": 0.8434984553911091, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 742400, "timers": {"sample_time_ms": 3633.904, "sample_throughput": 3522.383, "learn_time_ms": 3827.376, "learn_throughput": 3344.328, "update_time_ms": 1.536}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.08050271620042622, "policy_loss": -0.04248122575692832, "vf_loss": 0.106358642578125, "vf_explained_var": 0.9440849423408508, "kl": 0.016625297768041492, "entropy": -3.9873248314857483, "entropy_coeff": 0.0}}, "num_steps_sampled": 742400, "num_steps_trained": 742400}, "done": false, "episodes_total": 720, "training_iteration": 58, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-12-11", "timestamp": 1617649931, "time_this_iter_s": 7.455410957336426, "time_total_s": 447.5121896266937, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 59.745274782180786, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.02727272727273, "ram_util_percent": 62.75454545454546}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 24.408989552929576, "episode_reward_min": 4.441534577645219, "episode_reward_mean": 13.174871461370683, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.492782939693107, 22.770033012552602, 8.73348177552977, 10.509867388477819, 24.408989552929576, 19.891129078900804, 5.497917955917597, 17.503561511145538, 16.14946016512498, 5.9004655399106944, 7.657383374100936, 12.670345967759168, 16.12937440316489, 18.872465075111194, 8.92343132272517, 9.028008404043941, 13.513662625027383, 7.5777561057759435, 9.311025439757582, 9.846328891456967, 21.267206972103292, 9.754388813539963, 10.223582825067934, 9.5294693355729, 9.732029636806631, 21.35954218064378, 11.537312643395651, 4.662766712667349, 10.288769182929158, 16.83444060978354, 12.564467776659955, 13.346839796021179, 21.61944433602637, 10.264036636937426, 19.51234257374943, 17.44726687213467, 16.486988465553416, 6.620960227978414, 10.214548478635331, 10.649272220564024, 20.682510679562064, 12.108161697577993, 11.932422129978804, 10.10793055037191, 9.467553346577764, 10.005958101489586, 10.18453986996084, 15.121345730304206, 11.049048247440004, 10.52190501353813, 7.481505365003011, 18.686970826378005, 18.61302889293426, 11.187789824251379, 17.93328690137492, 7.4127132699378855, 13.181748589449258, 15.492107941448928, 7.880594525195324, 16.906157786277177, 6.272400801238697, 7.373644869622828, 10.939102631035764, 8.465643946099187, 8.425564948295667, 12.077664495131359, 13.587014466407387, 12.59445823345888, 7.4845012085502045, 10.969418156959867, 15.71254934037556, 11.99985811220501, 14.89127184538257, 10.451817148685032, 13.721313485257653, 15.401570703930037, 23.776393909055415, 18.27293796361951, 15.636718448317598, 15.160688174396984, 20.169912714747877, 20.3593537357718, 18.315391920850406, 7.525454177915588, 10.01338841034624, 7.794182470895523, 10.38212266046101, 4.441534577645219, 15.578927629747884, 12.888935665665496, 19.439934385128577, 9.452433825098673, 19.3957725258172, 12.276154320678396, 19.869949768010066, 13.372440931575955, 21.58352795319554, 17.50629587480791, 9.405732287486494, 21.240741298269942], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18398681749824902, "mean_inference_ms": 0.927430593318485, "mean_action_processing_ms": 0.03843206632611272, "mean_env_wait_ms": 0.8474048304931159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 755200, "timers": {"sample_time_ms": 3643.256, "sample_throughput": 3513.34, "learn_time_ms": 3845.667, "learn_throughput": 3328.422, "update_time_ms": 1.545}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.15840301530435683, "policy_loss": -0.03849590135738254, "vf_loss": 0.18172765128314494, "vf_explained_var": 0.9173240065574646, "kl": 0.015171261951327324, "entropy": -4.059091408252716, "entropy_coeff": 0.0}}, "num_steps_sampled": 755200, "num_steps_trained": 755200}, "done": false, "episodes_total": 736, "training_iteration": 59, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-12-19", "timestamp": 1617649939, "time_this_iter_s": 7.716986656188965, "time_total_s": 455.2291762828827, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 67.46226143836975, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 46.49090909090909, "ram_util_percent": 62.70000000000002}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 31.70966526142184, "episode_reward_min": 4.441534577645219, "episode_reward_mean": 13.874333258247738, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.861893708137453, 15.112156291169612, 31.70966526142184, 13.674467047913963, 12.46240654729028, 19.88429073280182, 17.52014318376774, 10.93114590380135, 21.237874021043275, 11.308631211571813, 12.518325935071813, 23.080395709643817, 29.055034917721333, 13.750203003780795, 11.002858268761084, 7.186277491016359, 21.61944433602637, 10.264036636937426, 19.51234257374943, 17.44726687213467, 16.486988465553416, 6.620960227978414, 10.214548478635331, 10.649272220564024, 20.682510679562064, 12.108161697577993, 11.932422129978804, 10.10793055037191, 9.467553346577764, 10.005958101489586, 10.18453986996084, 15.121345730304206, 11.049048247440004, 10.52190501353813, 7.481505365003011, 18.686970826378005, 18.61302889293426, 11.187789824251379, 17.93328690137492, 7.4127132699378855, 13.181748589449258, 15.492107941448928, 7.880594525195324, 16.906157786277177, 6.272400801238697, 7.373644869622828, 10.939102631035764, 8.465643946099187, 8.425564948295667, 12.077664495131359, 13.587014466407387, 12.59445823345888, 7.4845012085502045, 10.969418156959867, 15.71254934037556, 11.99985811220501, 14.89127184538257, 10.451817148685032, 13.721313485257653, 15.401570703930037, 23.776393909055415, 18.27293796361951, 15.636718448317598, 15.160688174396984, 20.169912714747877, 20.3593537357718, 18.315391920850406, 7.525454177915588, 10.01338841034624, 7.794182470895523, 10.38212266046101, 4.441534577645219, 15.578927629747884, 12.888935665665496, 19.439934385128577, 9.452433825098673, 19.3957725258172, 12.276154320678396, 19.869949768010066, 13.372440931575955, 21.58352795319554, 17.50629587480791, 9.405732287486494, 21.240741298269942, 8.492782939693107, 22.770033012552602, 8.73348177552977, 10.509867388477819, 24.408989552929576, 19.891129078900804, 5.497917955917597, 17.503561511145538, 16.14946016512498, 5.9004655399106944, 7.657383374100936, 12.670345967759168, 16.12937440316489, 18.872465075111194, 8.92343132272517, 9.028008404043941], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18532991216402406, "mean_inference_ms": 0.9328074984651405, "mean_action_processing_ms": 0.03862930046558433, "mean_env_wait_ms": 0.8492661953261063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 768000, "timers": {"sample_time_ms": 3600.814, "sample_throughput": 3554.752, "learn_time_ms": 3840.066, "learn_throughput": 3333.276, "update_time_ms": 1.557}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.22196235299110412, "policy_loss": -0.03939002782572061, "vf_loss": 0.24474585078656674, "vf_explained_var": 0.9075301289558411, "kl": 0.016606531962752344, "entropy": -4.122166616916656, "entropy_coeff": 0.0}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 752, "training_iteration": 60, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-12-26", "timestamp": 1617649946, "time_this_iter_s": 7.015212297439575, "time_total_s": 462.24438858032227, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 74.47747373580933, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 37.13, "ram_util_percent": 62.65000000000001}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 37.673266852426956, "episode_reward_min": 4.441534577645219, "episode_reward_mean": 14.04692852720221, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.673266852426956, 12.709238717782096, 9.49664665836201, 14.636246201480104, 18.185885131288806, 14.68822117844101, 7.992044307619507, 14.692837659625935, 20.682510679562064, 12.108161697577993, 11.932422129978804, 10.10793055037191, 9.467553346577764, 10.005958101489586, 10.18453986996084, 15.121345730304206, 11.049048247440004, 10.52190501353813, 7.481505365003011, 18.686970826378005, 18.61302889293426, 11.187789824251379, 17.93328690137492, 7.4127132699378855, 13.181748589449258, 15.492107941448928, 7.880594525195324, 16.906157786277177, 6.272400801238697, 7.373644869622828, 10.939102631035764, 8.465643946099187, 8.425564948295667, 12.077664495131359, 13.587014466407387, 12.59445823345888, 7.4845012085502045, 10.969418156959867, 15.71254934037556, 11.99985811220501, 14.89127184538257, 10.451817148685032, 13.721313485257653, 15.401570703930037, 23.776393909055415, 18.27293796361951, 15.636718448317598, 15.160688174396984, 20.169912714747877, 20.3593537357718, 18.315391920850406, 7.525454177915588, 10.01338841034624, 7.794182470895523, 10.38212266046101, 4.441534577645219, 15.578927629747884, 12.888935665665496, 19.439934385128577, 9.452433825098673, 19.3957725258172, 12.276154320678396, 19.869949768010066, 13.372440931575955, 21.58352795319554, 17.50629587480791, 9.405732287486494, 21.240741298269942, 8.492782939693107, 22.770033012552602, 8.73348177552977, 10.509867388477819, 24.408989552929576, 19.891129078900804, 5.497917955917597, 17.503561511145538, 16.14946016512498, 5.9004655399106944, 7.657383374100936, 12.670345967759168, 16.12937440316489, 18.872465075111194, 8.92343132272517, 9.028008404043941, 10.861893708137453, 15.112156291169612, 31.70966526142184, 13.674467047913963, 12.46240654729028, 19.88429073280182, 17.52014318376774, 10.93114590380135, 21.237874021043275, 11.308631211571813, 12.518325935071813, 23.080395709643817, 29.055034917721333, 13.750203003780795, 11.002858268761084, 7.186277491016359], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18563632988491918, "mean_inference_ms": 0.9310862175124632, "mean_action_processing_ms": 0.03861706572289678, "mean_env_wait_ms": 0.8478783060123426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 780800, "timers": {"sample_time_ms": 3571.64, "sample_throughput": 3583.788, "learn_time_ms": 3907.089, "learn_throughput": 3276.097, "update_time_ms": 1.574}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.13149078158661723, "policy_loss": -0.03941903995350003, "vf_loss": 0.15636559952050447, "vf_explained_var": 0.916778564453125, "kl": 0.014544219793751836, "entropy": -4.018366801738739, "entropy_coeff": 0.0}}, "num_steps_sampled": 780800, "num_steps_trained": 780800}, "done": false, "episodes_total": 760, "training_iteration": 61, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-12-34", "timestamp": 1617649954, "time_this_iter_s": 7.89103889465332, "time_total_s": 470.1354274749756, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 82.36851263046265, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 48.58181818181818, "ram_util_percent": 60.03636363636363}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 37.673266852426956, "episode_reward_min": 4.441534577645219, "episode_reward_mean": 15.474377326120258, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.272110017745735, 18.113426036476586, 4.889582190216618, 30.18192980067537, 18.358874702286826, 34.74362111946572, 22.681904790823086, 16.77523310530463, 25.205610986918295, 30.755987169325415, 19.35947767413767, 8.180180399999227, 15.630417914953899, 17.547153909124066, 29.507024623452217, 26.039015897580313, 13.181748589449258, 15.492107941448928, 7.880594525195324, 16.906157786277177, 6.272400801238697, 7.373644869622828, 10.939102631035764, 8.465643946099187, 8.425564948295667, 12.077664495131359, 13.587014466407387, 12.59445823345888, 7.4845012085502045, 10.969418156959867, 15.71254934037556, 11.99985811220501, 14.89127184538257, 10.451817148685032, 13.721313485257653, 15.401570703930037, 23.776393909055415, 18.27293796361951, 15.636718448317598, 15.160688174396984, 20.169912714747877, 20.3593537357718, 18.315391920850406, 7.525454177915588, 10.01338841034624, 7.794182470895523, 10.38212266046101, 4.441534577645219, 15.578927629747884, 12.888935665665496, 19.439934385128577, 9.452433825098673, 19.3957725258172, 12.276154320678396, 19.869949768010066, 13.372440931575955, 21.58352795319554, 17.50629587480791, 9.405732287486494, 21.240741298269942, 8.492782939693107, 22.770033012552602, 8.73348177552977, 10.509867388477819, 24.408989552929576, 19.891129078900804, 5.497917955917597, 17.503561511145538, 16.14946016512498, 5.9004655399106944, 7.657383374100936, 12.670345967759168, 16.12937440316489, 18.872465075111194, 8.92343132272517, 9.028008404043941, 10.861893708137453, 15.112156291169612, 31.70966526142184, 13.674467047913963, 12.46240654729028, 19.88429073280182, 17.52014318376774, 10.93114590380135, 21.237874021043275, 11.308631211571813, 12.518325935071813, 23.080395709643817, 29.055034917721333, 13.750203003780795, 11.002858268761084, 7.186277491016359, 37.673266852426956, 12.709238717782096, 9.49664665836201, 14.636246201480104, 18.185885131288806, 14.68822117844101, 7.992044307619507, 14.692837659625935], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18693353695828058, "mean_inference_ms": 0.9325057060489809, "mean_action_processing_ms": 0.038794829233707, "mean_env_wait_ms": 0.8505026499934978, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 793600, "timers": {"sample_time_ms": 3650.567, "sample_throughput": 3506.304, "learn_time_ms": 3945.552, "learn_throughput": 3244.159, "update_time_ms": 1.52}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.38583821639418603, "policy_loss": -0.03956470322795212, "vf_loss": 0.4071795079112053, "vf_explained_var": 0.8976318836212158, "kl": 0.018223412120714783, "entropy": -4.11330863237381, "entropy_coeff": 0.0}}, "num_steps_sampled": 793600, "num_steps_trained": 793600}, "done": false, "episodes_total": 776, "training_iteration": 62, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-12-42", "timestamp": 1617649962, "time_this_iter_s": 8.50711965560913, "time_total_s": 478.6425471305847, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 90.87563228607178, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 57.56153846153845, "ram_util_percent": 62.576923076923094}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 37.673266852426956, "episode_reward_min": 4.441534577645219, "episode_reward_mean": 16.080702935853072, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.297215292447758, 10.328476665511209, 24.238806417861323, 26.191705504626164, 23.34249737094736, 9.952117449576114, 20.952361254790294, 21.840782107888106, 8.425564948295667, 12.077664495131359, 13.587014466407387, 12.59445823345888, 7.4845012085502045, 10.969418156959867, 15.71254934037556, 11.99985811220501, 14.89127184538257, 10.451817148685032, 13.721313485257653, 15.401570703930037, 23.776393909055415, 18.27293796361951, 15.636718448317598, 15.160688174396984, 20.169912714747877, 20.3593537357718, 18.315391920850406, 7.525454177915588, 10.01338841034624, 7.794182470895523, 10.38212266046101, 4.441534577645219, 15.578927629747884, 12.888935665665496, 19.439934385128577, 9.452433825098673, 19.3957725258172, 12.276154320678396, 19.869949768010066, 13.372440931575955, 21.58352795319554, 17.50629587480791, 9.405732287486494, 21.240741298269942, 8.492782939693107, 22.770033012552602, 8.73348177552977, 10.509867388477819, 24.408989552929576, 19.891129078900804, 5.497917955917597, 17.503561511145538, 16.14946016512498, 5.9004655399106944, 7.657383374100936, 12.670345967759168, 16.12937440316489, 18.872465075111194, 8.92343132272517, 9.028008404043941, 10.861893708137453, 15.112156291169612, 31.70966526142184, 13.674467047913963, 12.46240654729028, 19.88429073280182, 17.52014318376774, 10.93114590380135, 21.237874021043275, 11.308631211571813, 12.518325935071813, 23.080395709643817, 29.055034917721333, 13.750203003780795, 11.002858268761084, 7.186277491016359, 37.673266852426956, 12.709238717782096, 9.49664665836201, 14.636246201480104, 18.185885131288806, 14.68822117844101, 7.992044307619507, 14.692837659625935, 27.272110017745735, 18.113426036476586, 4.889582190216618, 30.18192980067537, 18.358874702286826, 34.74362111946572, 22.681904790823086, 16.77523310530463, 25.205610986918295, 30.755987169325415, 19.35947767413767, 8.180180399999227, 15.630417914953899, 17.547153909124066, 29.507024623452217, 26.039015897580313], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18738586955365083, "mean_inference_ms": 0.9338459200421574, "mean_action_processing_ms": 0.03891631252794283, "mean_env_wait_ms": 0.8525058461853006, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 806400, "timers": {"sample_time_ms": 3672.715, "sample_throughput": 3485.16, "learn_time_ms": 3949.072, "learn_throughput": 3241.268, "update_time_ms": 1.588}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.14834010027348996, "policy_loss": -0.04341189296450466, "vf_loss": 0.17553781554102899, "vf_explained_var": 0.9434748888015747, "kl": 0.016214178008958698, "entropy": -4.05640971660614, "entropy_coeff": 0.0}}, "num_steps_sampled": 806400, "num_steps_trained": 806400}, "done": false, "episodes_total": 784, "training_iteration": 63, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-12-51", "timestamp": 1617649971, "time_this_iter_s": 8.355201959609985, "time_total_s": 486.9977490901947, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 99.23083424568176, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 58.291666666666686, "ram_util_percent": 62.76666666666665}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 38.76547265025252, "episode_reward_min": 4.441534577645219, "episode_reward_mean": 17.010657322513097, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.615467977980764, 25.153098679049553, 20.500713681910145, 22.307410648649704, 38.11067727118499, 20.16859528520648, 13.616942245377206, 38.76547265025252, 14.763517518848527, 8.873913133493858, 17.945245682130786, 12.317751390065943, 13.455383728909768, 13.945491915425869, 20.345379046983805, 18.274118450561467, 20.169912714747877, 20.3593537357718, 18.315391920850406, 7.525454177915588, 10.01338841034624, 7.794182470895523, 10.38212266046101, 4.441534577645219, 15.578927629747884, 12.888935665665496, 19.439934385128577, 9.452433825098673, 19.3957725258172, 12.276154320678396, 19.869949768010066, 13.372440931575955, 21.58352795319554, 17.50629587480791, 9.405732287486494, 21.240741298269942, 8.492782939693107, 22.770033012552602, 8.73348177552977, 10.509867388477819, 24.408989552929576, 19.891129078900804, 5.497917955917597, 17.503561511145538, 16.14946016512498, 5.9004655399106944, 7.657383374100936, 12.670345967759168, 16.12937440316489, 18.872465075111194, 8.92343132272517, 9.028008404043941, 10.861893708137453, 15.112156291169612, 31.70966526142184, 13.674467047913963, 12.46240654729028, 19.88429073280182, 17.52014318376774, 10.93114590380135, 21.237874021043275, 11.308631211571813, 12.518325935071813, 23.080395709643817, 29.055034917721333, 13.750203003780795, 11.002858268761084, 7.186277491016359, 37.673266852426956, 12.709238717782096, 9.49664665836201, 14.636246201480104, 18.185885131288806, 14.68822117844101, 7.992044307619507, 14.692837659625935, 27.272110017745735, 18.113426036476586, 4.889582190216618, 30.18192980067537, 18.358874702286826, 34.74362111946572, 22.681904790823086, 16.77523310530463, 25.205610986918295, 30.755987169325415, 19.35947767413767, 8.180180399999227, 15.630417914953899, 17.547153909124066, 29.507024623452217, 26.039015897580313, 10.297215292447758, 10.328476665511209, 24.238806417861323, 26.191705504626164, 23.34249737094736, 9.952117449576114, 20.952361254790294, 21.840782107888106], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18883441665769435, "mean_inference_ms": 0.9386650744280556, "mean_action_processing_ms": 0.03917640031114085, "mean_env_wait_ms": 0.8581291994688846, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 819200, "timers": {"sample_time_ms": 3788.812, "sample_throughput": 3378.368, "learn_time_ms": 3989.456, "learn_throughput": 3208.457, "update_time_ms": 1.58}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.3888146162778139, "policy_loss": -0.031622000904753804, "vf_loss": 0.4044678783416748, "vf_explained_var": 0.9107710123062134, "kl": 0.01596874267794192, "entropy": -4.125379068851471, "entropy_coeff": 0.0}}, "num_steps_sampled": 819200, "num_steps_trained": 819200}, "done": false, "episodes_total": 800, "training_iteration": 64, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-12-59", "timestamp": 1617649979, "time_this_iter_s": 8.585301160812378, "time_total_s": 495.5830502510071, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 107.81613540649414, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 59.65833333333334, "ram_util_percent": 62.958333333333336}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 48.33685316401493, "episode_reward_min": 4.889582190216618, "episode_reward_mean": 18.494119783536252, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.33685316401493, 18.504803032166123, 22.969011406992415, 13.449493901845587, 34.70469735409699, 35.98609765628923, 10.879804400693502, 23.997277951477876, 17.119513282535845, 27.77293838085592, 18.28537888834441, 25.615831566098013, 10.907661719327987, 19.836052401932193, 16.74773128051406, 24.508989435486228, 21.58352795319554, 17.50629587480791, 9.405732287486494, 21.240741298269942, 8.492782939693107, 22.770033012552602, 8.73348177552977, 10.509867388477819, 24.408989552929576, 19.891129078900804, 5.497917955917597, 17.503561511145538, 16.14946016512498, 5.9004655399106944, 7.657383374100936, 12.670345967759168, 16.12937440316489, 18.872465075111194, 8.92343132272517, 9.028008404043941, 10.861893708137453, 15.112156291169612, 31.70966526142184, 13.674467047913963, 12.46240654729028, 19.88429073280182, 17.52014318376774, 10.93114590380135, 21.237874021043275, 11.308631211571813, 12.518325935071813, 23.080395709643817, 29.055034917721333, 13.750203003780795, 11.002858268761084, 7.186277491016359, 37.673266852426956, 12.709238717782096, 9.49664665836201, 14.636246201480104, 18.185885131288806, 14.68822117844101, 7.992044307619507, 14.692837659625935, 27.272110017745735, 18.113426036476586, 4.889582190216618, 30.18192980067537, 18.358874702286826, 34.74362111946572, 22.681904790823086, 16.77523310530463, 25.205610986918295, 30.755987169325415, 19.35947767413767, 8.180180399999227, 15.630417914953899, 17.547153909124066, 29.507024623452217, 26.039015897580313, 10.297215292447758, 10.328476665511209, 24.238806417861323, 26.191705504626164, 23.34249737094736, 9.952117449576114, 20.952361254790294, 21.840782107888106, 14.615467977980764, 25.153098679049553, 20.500713681910145, 22.307410648649704, 38.11067727118499, 20.16859528520648, 13.616942245377206, 38.76547265025252, 14.763517518848527, 8.873913133493858, 17.945245682130786, 12.317751390065943, 13.455383728909768, 13.945491915425869, 20.345379046983805, 18.274118450561467], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19143563474229397, "mean_inference_ms": 0.9461471453975459, "mean_action_processing_ms": 0.0395572503043686, "mean_env_wait_ms": 0.8667737583307056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 832000, "timers": {"sample_time_ms": 3859.954, "sample_throughput": 3316.102, "learn_time_ms": 4002.532, "learn_throughput": 3197.976, "update_time_ms": 1.604}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.5119211253523827, "policy_loss": -0.03653062807396054, "vf_loss": 0.529251903295517, "vf_explained_var": 0.8984948992729187, "kl": 0.019199855206534267, "entropy": -4.185474402904511, "entropy_coeff": 0.0}}, "num_steps_sampled": 832000, "num_steps_trained": 832000}, "done": false, "episodes_total": 816, "training_iteration": 65, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-13-08", "timestamp": 1617649988, "time_this_iter_s": 8.377485752105713, "time_total_s": 503.9605360031128, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 116.19362115859985, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 55.4, "ram_util_percent": 63.01666666666667}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 48.33685316401493, "episode_reward_min": 4.889582190216618, "episode_reward_mean": 18.662555882019504, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.813581229170609, 21.0844605704892, 27.425756558409354, 9.15483940986532, 20.50578573038658, 19.13790125009224, 17.759732897450206, 10.204014732475136, 24.408989552929576, 19.891129078900804, 5.497917955917597, 17.503561511145538, 16.14946016512498, 5.9004655399106944, 7.657383374100936, 12.670345967759168, 16.12937440316489, 18.872465075111194, 8.92343132272517, 9.028008404043941, 10.861893708137453, 15.112156291169612, 31.70966526142184, 13.674467047913963, 12.46240654729028, 19.88429073280182, 17.52014318376774, 10.93114590380135, 21.237874021043275, 11.308631211571813, 12.518325935071813, 23.080395709643817, 29.055034917721333, 13.750203003780795, 11.002858268761084, 7.186277491016359, 37.673266852426956, 12.709238717782096, 9.49664665836201, 14.636246201480104, 18.185885131288806, 14.68822117844101, 7.992044307619507, 14.692837659625935, 27.272110017745735, 18.113426036476586, 4.889582190216618, 30.18192980067537, 18.358874702286826, 34.74362111946572, 22.681904790823086, 16.77523310530463, 25.205610986918295, 30.755987169325415, 19.35947767413767, 8.180180399999227, 15.630417914953899, 17.547153909124066, 29.507024623452217, 26.039015897580313, 10.297215292447758, 10.328476665511209, 24.238806417861323, 26.191705504626164, 23.34249737094736, 9.952117449576114, 20.952361254790294, 21.840782107888106, 14.615467977980764, 25.153098679049553, 20.500713681910145, 22.307410648649704, 38.11067727118499, 20.16859528520648, 13.616942245377206, 38.76547265025252, 14.763517518848527, 8.873913133493858, 17.945245682130786, 12.317751390065943, 13.455383728909768, 13.945491915425869, 20.345379046983805, 18.274118450561467, 48.33685316401493, 18.504803032166123, 22.969011406992415, 13.449493901845587, 34.70469735409699, 35.98609765628923, 10.879804400693502, 23.997277951477876, 17.119513282535845, 27.77293838085592, 18.28537888834441, 25.615831566098013, 10.907661719327987, 19.836052401932193, 16.74773128051406, 24.508989435486228], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19218510017684448, "mean_inference_ms": 0.9482618845574813, "mean_action_processing_ms": 0.03966238039556474, "mean_env_wait_ms": 0.8688475363142277, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 844800, "timers": {"sample_time_ms": 3764.334, "sample_throughput": 3400.336, "learn_time_ms": 3961.0, "learn_throughput": 3231.507, "update_time_ms": 1.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.09383887574076652, "policy_loss": -0.04079393527470529, "vf_loss": 0.11861936766654253, "vf_explained_var": 0.9554756879806519, "kl": 0.016013440880924462, "entropy": -4.088058445453644, "entropy_coeff": 0.0}}, "num_steps_sampled": 844800, "num_steps_trained": 844800}, "done": false, "episodes_total": 824, "training_iteration": 66, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-13-14", "timestamp": 1617649994, "time_this_iter_s": 6.41081690788269, "time_total_s": 510.3713529109955, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 122.60443806648254, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.93333333333333, "ram_util_percent": 63.199999999999996}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 48.33685316401493, "episode_reward_min": 4.889582190216618, "episode_reward_mean": 19.42433349445097, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.579633861274022, 9.489869994537079, 17.950022191499954, 9.138472600744485, 19.395848844263362, 12.028760930398706, 8.428146147933775, 12.231133095361857, 27.00729222235017, 14.314587745701841, 20.664902321125187, 33.76905404997839, 27.743568988445034, 25.663886826909103, 19.6011152306758, 27.162180851424885, 12.46240654729028, 19.88429073280182, 17.52014318376774, 10.93114590380135, 21.237874021043275, 11.308631211571813, 12.518325935071813, 23.080395709643817, 29.055034917721333, 13.750203003780795, 11.002858268761084, 7.186277491016359, 37.673266852426956, 12.709238717782096, 9.49664665836201, 14.636246201480104, 18.185885131288806, 14.68822117844101, 7.992044307619507, 14.692837659625935, 27.272110017745735, 18.113426036476586, 4.889582190216618, 30.18192980067537, 18.358874702286826, 34.74362111946572, 22.681904790823086, 16.77523310530463, 25.205610986918295, 30.755987169325415, 19.35947767413767, 8.180180399999227, 15.630417914953899, 17.547153909124066, 29.507024623452217, 26.039015897580313, 10.297215292447758, 10.328476665511209, 24.238806417861323, 26.191705504626164, 23.34249737094736, 9.952117449576114, 20.952361254790294, 21.840782107888106, 14.615467977980764, 25.153098679049553, 20.500713681910145, 22.307410648649704, 38.11067727118499, 20.16859528520648, 13.616942245377206, 38.76547265025252, 14.763517518848527, 8.873913133493858, 17.945245682130786, 12.317751390065943, 13.455383728909768, 13.945491915425869, 20.345379046983805, 18.274118450561467, 48.33685316401493, 18.504803032166123, 22.969011406992415, 13.449493901845587, 34.70469735409699, 35.98609765628923, 10.879804400693502, 23.997277951477876, 17.119513282535845, 27.77293838085592, 18.28537888834441, 25.615831566098013, 10.907661719327987, 19.836052401932193, 16.74773128051406, 24.508989435486228, 11.813581229170609, 21.0844605704892, 27.425756558409354, 9.15483940986532, 20.50578573038658, 19.13790125009224, 17.759732897450206, 10.204014732475136], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1933106501148342, "mean_inference_ms": 0.9511948158248866, "mean_action_processing_ms": 0.03982826203190965, "mean_env_wait_ms": 0.8722764358301037, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 857600, "timers": {"sample_time_ms": 3751.617, "sample_throughput": 3411.862, "learn_time_ms": 3922.25, "learn_throughput": 3263.433, "update_time_ms": 1.634}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.29364359088242054, "policy_loss": -0.03658886631950736, "vf_loss": 0.31272184461355207, "vf_explained_var": 0.9324343204498291, "kl": 0.01751061265356839, "entropy": -4.193320322036743, "entropy_coeff": 0.0}}, "num_steps_sampled": 857600, "num_steps_trained": 857600}, "done": false, "episodes_total": 840, "training_iteration": 67, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-13-21", "timestamp": 1617650001, "time_this_iter_s": 6.497718334197998, "time_total_s": 516.8690712451935, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 129.10215640068054, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 27.31111111111111, "ram_util_percent": 63.21111111111111}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 48.33685316401493, "episode_reward_min": 4.889582190216618, "episode_reward_mean": 20.051062061598916, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.029892958722797, 24.624233935049716, 13.511166254989197, 20.788250282928516, 17.79874649051157, 22.16972644298359, 22.663924238521464, 42.03012935607991, 29.055034917721333, 13.750203003780795, 11.002858268761084, 7.186277491016359, 37.673266852426956, 12.709238717782096, 9.49664665836201, 14.636246201480104, 18.185885131288806, 14.68822117844101, 7.992044307619507, 14.692837659625935, 27.272110017745735, 18.113426036476586, 4.889582190216618, 30.18192980067537, 18.358874702286826, 34.74362111946572, 22.681904790823086, 16.77523310530463, 25.205610986918295, 30.755987169325415, 19.35947767413767, 8.180180399999227, 15.630417914953899, 17.547153909124066, 29.507024623452217, 26.039015897580313, 10.297215292447758, 10.328476665511209, 24.238806417861323, 26.191705504626164, 23.34249737094736, 9.952117449576114, 20.952361254790294, 21.840782107888106, 14.615467977980764, 25.153098679049553, 20.500713681910145, 22.307410648649704, 38.11067727118499, 20.16859528520648, 13.616942245377206, 38.76547265025252, 14.763517518848527, 8.873913133493858, 17.945245682130786, 12.317751390065943, 13.455383728909768, 13.945491915425869, 20.345379046983805, 18.274118450561467, 48.33685316401493, 18.504803032166123, 22.969011406992415, 13.449493901845587, 34.70469735409699, 35.98609765628923, 10.879804400693502, 23.997277951477876, 17.119513282535845, 27.77293838085592, 18.28537888834441, 25.615831566098013, 10.907661719327987, 19.836052401932193, 16.74773128051406, 24.508989435486228, 11.813581229170609, 21.0844605704892, 27.425756558409354, 9.15483940986532, 20.50578573038658, 19.13790125009224, 17.759732897450206, 10.204014732475136, 25.579633861274022, 9.489869994537079, 17.950022191499954, 9.138472600744485, 19.395848844263362, 12.028760930398706, 8.428146147933775, 12.231133095361857, 27.00729222235017, 14.314587745701841, 20.664902321125187, 33.76905404997839, 27.743568988445034, 25.663886826909103, 19.6011152306758, 27.162180851424885], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19369634545708744, "mean_inference_ms": 0.952225434078677, "mean_action_processing_ms": 0.03990596617484976, "mean_env_wait_ms": 0.873602865304207, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 870400, "timers": {"sample_time_ms": 3661.661, "sample_throughput": 3495.681, "learn_time_ms": 3909.974, "learn_throughput": 3273.679, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.2519646238535643, "policy_loss": -0.036450987439602615, "vf_loss": 0.2712422251701355, "vf_explained_var": 0.9318195581436157, "kl": 0.017173384577035905, "entropy": -4.136060533523559, "entropy_coeff": 0.0}}, "num_steps_sampled": 870400, "num_steps_trained": 870400}, "done": false, "episodes_total": 848, "training_iteration": 68, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-13-27", "timestamp": 1617650007, "time_this_iter_s": 6.431923151016235, "time_total_s": 523.3009943962097, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 135.53407955169678, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 25.38, "ram_util_percent": 63.33}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 48.33685316401493, "episode_reward_min": 8.180180399999227, "episode_reward_mean": 21.146665214752307, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.84791497477707, 16.97465872378423, 28.14453120313496, 10.421896622361487, 14.309371939099696, 19.06145910490523, 34.702905308299, 22.178745789478143, 22.055922839664085, 32.01002464536484, 31.25206405120597, 17.6768895218875, 21.333772863826667, 23.106037609508018, 18.044610368637496, 26.965318182824657, 18.358874702286826, 34.74362111946572, 22.681904790823086, 16.77523310530463, 25.205610986918295, 30.755987169325415, 19.35947767413767, 8.180180399999227, 15.630417914953899, 17.547153909124066, 29.507024623452217, 26.039015897580313, 10.297215292447758, 10.328476665511209, 24.238806417861323, 26.191705504626164, 23.34249737094736, 9.952117449576114, 20.952361254790294, 21.840782107888106, 14.615467977980764, 25.153098679049553, 20.500713681910145, 22.307410648649704, 38.11067727118499, 20.16859528520648, 13.616942245377206, 38.76547265025252, 14.763517518848527, 8.873913133493858, 17.945245682130786, 12.317751390065943, 13.455383728909768, 13.945491915425869, 20.345379046983805, 18.274118450561467, 48.33685316401493, 18.504803032166123, 22.969011406992415, 13.449493901845587, 34.70469735409699, 35.98609765628923, 10.879804400693502, 23.997277951477876, 17.119513282535845, 27.77293838085592, 18.28537888834441, 25.615831566098013, 10.907661719327987, 19.836052401932193, 16.74773128051406, 24.508989435486228, 11.813581229170609, 21.0844605704892, 27.425756558409354, 9.15483940986532, 20.50578573038658, 19.13790125009224, 17.759732897450206, 10.204014732475136, 25.579633861274022, 9.489869994537079, 17.950022191499954, 9.138472600744485, 19.395848844263362, 12.028760930398706, 8.428146147933775, 12.231133095361857, 27.00729222235017, 14.314587745701841, 20.664902321125187, 33.76905404997839, 27.743568988445034, 25.663886826909103, 19.6011152306758, 27.162180851424885, 28.029892958722797, 24.624233935049716, 13.511166254989197, 20.788250282928516, 17.79874649051157, 22.16972644298359, 22.663924238521464, 42.03012935607991], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19395957295100183, "mean_inference_ms": 0.9539337258267494, "mean_action_processing_ms": 0.039987472007508365, "mean_env_wait_ms": 0.875477158298951, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 883200, "timers": {"sample_time_ms": 3580.752, "sample_throughput": 3574.669, "learn_time_ms": 3864.221, "learn_throughput": 3312.44, "update_time_ms": 1.64}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.3999986298382282, "policy_loss": -0.03392820488195866, "vf_loss": 0.4161558201909065, "vf_explained_var": 0.9190543293952942, "kl": 0.017771012671291827, "entropy": -4.207549231052399, "entropy_coeff": 0.0}}, "num_steps_sampled": 883200, "num_steps_trained": 883200}, "done": false, "episodes_total": 864, "training_iteration": 69, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-13-34", "timestamp": 1617650014, "time_this_iter_s": 6.450378656387329, "time_total_s": 529.751373052597, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 141.9844582080841, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 27.044444444444444, "ram_util_percent": 63.36666666666666}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 60.0015730220556, "episode_reward_min": 8.428146147933775, "episode_reward_mean": 22.718573509885054, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.62549006496916, 41.369423760513946, 25.456307293709894, 33.434057382706484, 27.15253838516997, 52.02167076142615, 24.423403964413378, 25.352009605898637, 60.0015730220556, 15.373673508317275, 41.64400175637371, 23.288705968504875, 19.4787011291977, 12.656279815552864, 53.73406068626394, 15.019638582019319, 23.34249737094736, 9.952117449576114, 20.952361254790294, 21.840782107888106, 14.615467977980764, 25.153098679049553, 20.500713681910145, 22.307410648649704, 38.11067727118499, 20.16859528520648, 13.616942245377206, 38.76547265025252, 14.763517518848527, 8.873913133493858, 17.945245682130786, 12.317751390065943, 13.455383728909768, 13.945491915425869, 20.345379046983805, 18.274118450561467, 48.33685316401493, 18.504803032166123, 22.969011406992415, 13.449493901845587, 34.70469735409699, 35.98609765628923, 10.879804400693502, 23.997277951477876, 17.119513282535845, 27.77293838085592, 18.28537888834441, 25.615831566098013, 10.907661719327987, 19.836052401932193, 16.74773128051406, 24.508989435486228, 11.813581229170609, 21.0844605704892, 27.425756558409354, 9.15483940986532, 20.50578573038658, 19.13790125009224, 17.759732897450206, 10.204014732475136, 25.579633861274022, 9.489869994537079, 17.950022191499954, 9.138472600744485, 19.395848844263362, 12.028760930398706, 8.428146147933775, 12.231133095361857, 27.00729222235017, 14.314587745701841, 20.664902321125187, 33.76905404997839, 27.743568988445034, 25.663886826909103, 19.6011152306758, 27.162180851424885, 28.029892958722797, 24.624233935049716, 13.511166254989197, 20.788250282928516, 17.79874649051157, 22.16972644298359, 22.663924238521464, 42.03012935607991, 42.84791497477707, 16.97465872378423, 28.14453120313496, 10.421896622361487, 14.309371939099696, 19.06145910490523, 34.702905308299, 22.178745789478143, 22.055922839664085, 32.01002464536484, 31.25206405120597, 17.6768895218875, 21.333772863826667, 23.106037609508018, 18.044610368637496, 26.965318182824657], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19369876429981858, "mean_inference_ms": 0.9513429816128601, "mean_action_processing_ms": 0.03990354708471987, "mean_env_wait_ms": 0.873289954140853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 896000, "timers": {"sample_time_ms": 3554.987, "sample_throughput": 3600.576, "learn_time_ms": 3833.162, "learn_throughput": 3339.28, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.001115468310867559, "total_loss": 0.9455265402793884, "policy_loss": -0.027004157099872826, "vf_loss": 0.946654953956604, "vf_explained_var": 0.8836545348167419, "kl": 0.02587574761360884, "entropy": -4.270064597129822, "entropy_coeff": 0.0}}, "num_steps_sampled": 896000, "num_steps_trained": 896000}, "done": false, "episodes_total": 880, "training_iteration": 70, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-13-40", "timestamp": 1617650020, "time_this_iter_s": 6.446422576904297, "time_total_s": 536.1977956295013, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 148.4308807849884, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.0, "ram_util_percent": 63.22222222222222}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 60.0015730220556, "episode_reward_min": 8.428146147933775, "episode_reward_mean": 23.655841342244226, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.07643770481896, 27.92016237286518, 20.23306674423477, 50.811332013516214, 10.873544466129456, 36.177978928829354, 44.88991296222619, 27.40879721408885, 38.11067727118499, 20.16859528520648, 13.616942245377206, 38.76547265025252, 14.763517518848527, 8.873913133493858, 17.945245682130786, 12.317751390065943, 13.455383728909768, 13.945491915425869, 20.345379046983805, 18.274118450561467, 48.33685316401493, 18.504803032166123, 22.969011406992415, 13.449493901845587, 34.70469735409699, 35.98609765628923, 10.879804400693502, 23.997277951477876, 17.119513282535845, 27.77293838085592, 18.28537888834441, 25.615831566098013, 10.907661719327987, 19.836052401932193, 16.74773128051406, 24.508989435486228, 11.813581229170609, 21.0844605704892, 27.425756558409354, 9.15483940986532, 20.50578573038658, 19.13790125009224, 17.759732897450206, 10.204014732475136, 25.579633861274022, 9.489869994537079, 17.950022191499954, 9.138472600744485, 19.395848844263362, 12.028760930398706, 8.428146147933775, 12.231133095361857, 27.00729222235017, 14.314587745701841, 20.664902321125187, 33.76905404997839, 27.743568988445034, 25.663886826909103, 19.6011152306758, 27.162180851424885, 28.029892958722797, 24.624233935049716, 13.511166254989197, 20.788250282928516, 17.79874649051157, 22.16972644298359, 22.663924238521464, 42.03012935607991, 42.84791497477707, 16.97465872378423, 28.14453120313496, 10.421896622361487, 14.309371939099696, 19.06145910490523, 34.702905308299, 22.178745789478143, 22.055922839664085, 32.01002464536484, 31.25206405120597, 17.6768895218875, 21.333772863826667, 23.106037609508018, 18.044610368637496, 26.965318182824657, 22.62549006496916, 41.369423760513946, 25.456307293709894, 33.434057382706484, 27.15253838516997, 52.02167076142615, 24.423403964413378, 25.352009605898637, 60.0015730220556, 15.373673508317275, 41.64400175637371, 23.288705968504875, 19.4787011291977, 12.656279815552864, 53.73406068626394, 15.019638582019319], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19328678356259965, "mean_inference_ms": 0.9494835043975632, "mean_action_processing_ms": 0.03982611585123377, "mean_env_wait_ms": 0.8711205758455373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 908800, "timers": {"sample_time_ms": 3618.183, "sample_throughput": 3537.687, "learn_time_ms": 3820.231, "learn_throughput": 3350.582, "update_time_ms": 1.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.419827594012022, "policy_loss": -0.02618584541603923, "vf_loss": 0.42422728255391123, "vf_explained_var": 0.9247733354568481, "kl": 0.01452410795725882, "entropy": -4.156710579395294, "entropy_coeff": 0.0}}, "num_steps_sampled": 908800, "num_steps_trained": 908800}, "done": false, "episodes_total": 888, "training_iteration": 71, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-13-49", "timestamp": 1617650029, "time_this_iter_s": 8.394747257232666, "time_total_s": 544.592542886734, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 156.82562804222107, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 54.84166666666667, "ram_util_percent": 63.458333333333336}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 60.0015730220556, "episode_reward_min": 8.428146147933775, "episode_reward_mean": 24.36132004507156, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.043341633326595, 18.16739784614401, 27.215264681266238, 12.716260805953175, 27.514323301963927, 23.892027830100677, 22.870427906461916, 27.21964239370002, 34.272683830160666, 30.496129383070528, 35.536088622262056, 20.617040087296036, 25.632181559900573, 24.03365248594188, 22.117494895053195, 27.04656284359278, 34.70469735409699, 35.98609765628923, 10.879804400693502, 23.997277951477876, 17.119513282535845, 27.77293838085592, 18.28537888834441, 25.615831566098013, 10.907661719327987, 19.836052401932193, 16.74773128051406, 24.508989435486228, 11.813581229170609, 21.0844605704892, 27.425756558409354, 9.15483940986532, 20.50578573038658, 19.13790125009224, 17.759732897450206, 10.204014732475136, 25.579633861274022, 9.489869994537079, 17.950022191499954, 9.138472600744485, 19.395848844263362, 12.028760930398706, 8.428146147933775, 12.231133095361857, 27.00729222235017, 14.314587745701841, 20.664902321125187, 33.76905404997839, 27.743568988445034, 25.663886826909103, 19.6011152306758, 27.162180851424885, 28.029892958722797, 24.624233935049716, 13.511166254989197, 20.788250282928516, 17.79874649051157, 22.16972644298359, 22.663924238521464, 42.03012935607991, 42.84791497477707, 16.97465872378423, 28.14453120313496, 10.421896622361487, 14.309371939099696, 19.06145910490523, 34.702905308299, 22.178745789478143, 22.055922839664085, 32.01002464536484, 31.25206405120597, 17.6768895218875, 21.333772863826667, 23.106037609508018, 18.044610368637496, 26.965318182824657, 22.62549006496916, 41.369423760513946, 25.456307293709894, 33.434057382706484, 27.15253838516997, 52.02167076142615, 24.423403964413378, 25.352009605898637, 60.0015730220556, 15.373673508317275, 41.64400175637371, 23.288705968504875, 19.4787011291977, 12.656279815552864, 53.73406068626394, 15.019638582019319, 34.07643770481896, 27.92016237286518, 20.23306674423477, 50.811332013516214, 10.873544466129456, 36.177978928829354, 44.88991296222619, 27.40879721408885], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19267934537797007, "mean_inference_ms": 0.9455139799909749, "mean_action_processing_ms": 0.03967392561477367, "mean_env_wait_ms": 0.8671907873317669, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 921600, "timers": {"sample_time_ms": 3624.008, "sample_throughput": 3532.001, "learn_time_ms": 3884.594, "learn_throughput": 3295.067, "update_time_ms": 1.667}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.4061579456925392, "policy_loss": -0.0349312349408865, "vf_loss": 0.4205045735836029, "vf_explained_var": 0.9546093940734863, "kl": 0.013723068591207265, "entropy": -4.249683728218079, "entropy_coeff": 0.0}}, "num_steps_sampled": 921600, "num_steps_trained": 921600}, "done": false, "episodes_total": 904, "training_iteration": 72, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-13-58", "timestamp": 1617650038, "time_this_iter_s": 9.209786415100098, "time_total_s": 553.8023293018341, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 166.03541445732117, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 59.46923076923077, "ram_util_percent": 63.46923076923077}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 60.0015730220556, "episode_reward_min": 8.428146147933775, "episode_reward_mean": 24.173221538370548, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.30015793067008, 36.59073174676403, 17.852680382226968, 19.9457140555991, 17.672132695765967, 16.69248835319685, 13.416162325995353, 18.081621320071676, 10.907661719327987, 19.836052401932193, 16.74773128051406, 24.508989435486228, 11.813581229170609, 21.0844605704892, 27.425756558409354, 9.15483940986532, 20.50578573038658, 19.13790125009224, 17.759732897450206, 10.204014732475136, 25.579633861274022, 9.489869994537079, 17.950022191499954, 9.138472600744485, 19.395848844263362, 12.028760930398706, 8.428146147933775, 12.231133095361857, 27.00729222235017, 14.314587745701841, 20.664902321125187, 33.76905404997839, 27.743568988445034, 25.663886826909103, 19.6011152306758, 27.162180851424885, 28.029892958722797, 24.624233935049716, 13.511166254989197, 20.788250282928516, 17.79874649051157, 22.16972644298359, 22.663924238521464, 42.03012935607991, 42.84791497477707, 16.97465872378423, 28.14453120313496, 10.421896622361487, 14.309371939099696, 19.06145910490523, 34.702905308299, 22.178745789478143, 22.055922839664085, 32.01002464536484, 31.25206405120597, 17.6768895218875, 21.333772863826667, 23.106037609508018, 18.044610368637496, 26.965318182824657, 22.62549006496916, 41.369423760513946, 25.456307293709894, 33.434057382706484, 27.15253838516997, 52.02167076142615, 24.423403964413378, 25.352009605898637, 60.0015730220556, 15.373673508317275, 41.64400175637371, 23.288705968504875, 19.4787011291977, 12.656279815552864, 53.73406068626394, 15.019638582019319, 34.07643770481896, 27.92016237286518, 20.23306674423477, 50.811332013516214, 10.873544466129456, 36.177978928829354, 44.88991296222619, 27.40879721408885, 25.043341633326595, 18.16739784614401, 27.215264681266238, 12.716260805953175, 27.514323301963927, 23.892027830100677, 22.870427906461916, 27.21964239370002, 34.272683830160666, 30.496129383070528, 35.536088622262056, 20.617040087296036, 25.632181559900573, 24.03365248594188, 22.117494895053195, 27.04656284359278], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19229685527022503, "mean_inference_ms": 0.9432858177689059, "mean_action_processing_ms": 0.03960000836770468, "mean_env_wait_ms": 0.8651039902297463, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 934400, "timers": {"sample_time_ms": 3643.319, "sample_throughput": 3513.28, "learn_time_ms": 3909.457, "learn_throughput": 3274.112, "update_time_ms": 1.608}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.20324595183134078, "policy_loss": -0.037367101926356554, "vf_loss": 0.21971336737275124, "vf_explained_var": 0.9685667157173157, "kl": 0.013933126162737609, "entropy": -4.1891687297821045, "entropy_coeff": 0.0}}, "num_steps_sampled": 934400, "num_steps_trained": 934400}, "done": false, "episodes_total": 912, "training_iteration": 73, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-14-07", "timestamp": 1617650047, "time_this_iter_s": 8.796690702438354, "time_total_s": 562.5990200042725, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 174.83210515975952, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 61.44615384615385, "ram_util_percent": 64.60769230769232}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 69.01074872349169, "episode_reward_min": 8.428146147933775, "episode_reward_mean": 25.51733939110068, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.332973099597108, 19.34600981833099, 18.724755565995302, 36.8776493963689, 21.734909184542932, 13.534537918839678, 34.88541199665756, 11.231374096997296, 21.81907521113674, 14.810372557453158, 18.92948514799637, 69.01074872349169, 14.824209923866212, 19.150408918181817, 47.5709770107432, 30.8733925664695, 19.395848844263362, 12.028760930398706, 8.428146147933775, 12.231133095361857, 27.00729222235017, 14.314587745701841, 20.664902321125187, 33.76905404997839, 27.743568988445034, 25.663886826909103, 19.6011152306758, 27.162180851424885, 28.029892958722797, 24.624233935049716, 13.511166254989197, 20.788250282928516, 17.79874649051157, 22.16972644298359, 22.663924238521464, 42.03012935607991, 42.84791497477707, 16.97465872378423, 28.14453120313496, 10.421896622361487, 14.309371939099696, 19.06145910490523, 34.702905308299, 22.178745789478143, 22.055922839664085, 32.01002464536484, 31.25206405120597, 17.6768895218875, 21.333772863826667, 23.106037609508018, 18.044610368637496, 26.965318182824657, 22.62549006496916, 41.369423760513946, 25.456307293709894, 33.434057382706484, 27.15253838516997, 52.02167076142615, 24.423403964413378, 25.352009605898637, 60.0015730220556, 15.373673508317275, 41.64400175637371, 23.288705968504875, 19.4787011291977, 12.656279815552864, 53.73406068626394, 15.019638582019319, 34.07643770481896, 27.92016237286518, 20.23306674423477, 50.811332013516214, 10.873544466129456, 36.177978928829354, 44.88991296222619, 27.40879721408885, 25.043341633326595, 18.16739784614401, 27.215264681266238, 12.716260805953175, 27.514323301963927, 23.892027830100677, 22.870427906461916, 27.21964239370002, 34.272683830160666, 30.496129383070528, 35.536088622262056, 20.617040087296036, 25.632181559900573, 24.03365248594188, 22.117494895053195, 27.04656284359278, 35.30015793067008, 36.59073174676403, 17.852680382226968, 19.9457140555991, 17.672132695765967, 16.69248835319685, 13.416162325995353, 18.081621320071676], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1920933083838009, "mean_inference_ms": 0.9430386196025407, "mean_action_processing_ms": 0.03959227016910652, "mean_env_wait_ms": 0.8648315631674248, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 947200, "timers": {"sample_time_ms": 3648.957, "sample_throughput": 3507.852, "learn_time_ms": 3907.622, "learn_throughput": 3275.65, "update_time_ms": 1.614}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.7822246679663658, "policy_loss": -0.03146003132686019, "vf_loss": 0.7925616875290871, "vf_explained_var": 0.8916680216789246, "kl": 0.014082007016986609, "entropy": -4.237789402008056, "entropy_coeff": 0.0}}, "num_steps_sampled": 947200, "num_steps_trained": 947200}, "done": false, "episodes_total": 928, "training_iteration": 74, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-14-15", "timestamp": 1617650055, "time_this_iter_s": 8.622501850128174, "time_total_s": 571.2215218544006, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 183.4546070098877, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 58.98333333333334, "ram_util_percent": 64.68333333333335}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 69.01074872349169, "episode_reward_min": 10.421896622361487, "episode_reward_mean": 25.34668085311121, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.171969122015916, 16.39580032584044, 11.431701335653935, 15.07435232501631, 20.514527376928722, 15.91704731574913, 17.63937955456752, 25.940314630246043, 19.891209310110767, 25.617541620698965, 23.65362998811856, 17.188144025464354, 18.26664008839713, 23.53603599815359, 17.45938470488966, 17.200489165459192, 17.79874649051157, 22.16972644298359, 22.663924238521464, 42.03012935607991, 42.84791497477707, 16.97465872378423, 28.14453120313496, 10.421896622361487, 14.309371939099696, 19.06145910490523, 34.702905308299, 22.178745789478143, 22.055922839664085, 32.01002464536484, 31.25206405120597, 17.6768895218875, 21.333772863826667, 23.106037609508018, 18.044610368637496, 26.965318182824657, 22.62549006496916, 41.369423760513946, 25.456307293709894, 33.434057382706484, 27.15253838516997, 52.02167076142615, 24.423403964413378, 25.352009605898637, 60.0015730220556, 15.373673508317275, 41.64400175637371, 23.288705968504875, 19.4787011291977, 12.656279815552864, 53.73406068626394, 15.019638582019319, 34.07643770481896, 27.92016237286518, 20.23306674423477, 50.811332013516214, 10.873544466129456, 36.177978928829354, 44.88991296222619, 27.40879721408885, 25.043341633326595, 18.16739784614401, 27.215264681266238, 12.716260805953175, 27.514323301963927, 23.892027830100677, 22.870427906461916, 27.21964239370002, 34.272683830160666, 30.496129383070528, 35.536088622262056, 20.617040087296036, 25.632181559900573, 24.03365248594188, 22.117494895053195, 27.04656284359278, 35.30015793067008, 36.59073174676403, 17.852680382226968, 19.9457140555991, 17.672132695765967, 16.69248835319685, 13.416162325995353, 18.081621320071676, 12.332973099597108, 19.34600981833099, 18.724755565995302, 36.8776493963689, 21.734909184542932, 13.534537918839678, 34.88541199665756, 11.231374096997296, 21.81907521113674, 14.810372557453158, 18.92948514799637, 69.01074872349169, 14.824209923866212, 19.150408918181817, 47.5709770107432, 30.8733925664695], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1923301630065218, "mean_inference_ms": 0.9431923056704825, "mean_action_processing_ms": 0.03961929937178135, "mean_env_wait_ms": 0.8653838719338447, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 960000, "timers": {"sample_time_ms": 3514.392, "sample_throughput": 3642.166, "learn_time_ms": 3858.405, "learn_throughput": 3317.433, "update_time_ms": 1.577}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.2701721434481442, "policy_loss": -0.04124272049404681, "vf_loss": 0.2911140462756157, "vf_explained_var": 0.9539141058921814, "kl": 0.013533877991139889, "entropy": -4.299557285308838, "entropy_coeff": 0.0}}, "num_steps_sampled": 960000, "num_steps_trained": 960000}, "done": false, "episodes_total": 944, "training_iteration": 75, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-14-22", "timestamp": 1617650062, "time_this_iter_s": 6.5397629737854, "time_total_s": 577.761284828186, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 189.9943699836731, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 26.52, "ram_util_percent": 65.07}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 69.01074872349169, "episode_reward_min": 10.873544466129456, "episode_reward_mean": 26.199505644240006, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.951715129444445, 25.82544948240165, 28.25644038924834, 46.43817785652118, 26.975175760299347, 24.45059424248711, 28.831163644731806, 65.60529065990042, 14.309371939099696, 19.06145910490523, 34.702905308299, 22.178745789478143, 22.055922839664085, 32.01002464536484, 31.25206405120597, 17.6768895218875, 21.333772863826667, 23.106037609508018, 18.044610368637496, 26.965318182824657, 22.62549006496916, 41.369423760513946, 25.456307293709894, 33.434057382706484, 27.15253838516997, 52.02167076142615, 24.423403964413378, 25.352009605898637, 60.0015730220556, 15.373673508317275, 41.64400175637371, 23.288705968504875, 19.4787011291977, 12.656279815552864, 53.73406068626394, 15.019638582019319, 34.07643770481896, 27.92016237286518, 20.23306674423477, 50.811332013516214, 10.873544466129456, 36.177978928829354, 44.88991296222619, 27.40879721408885, 25.043341633326595, 18.16739784614401, 27.215264681266238, 12.716260805953175, 27.514323301963927, 23.892027830100677, 22.870427906461916, 27.21964239370002, 34.272683830160666, 30.496129383070528, 35.536088622262056, 20.617040087296036, 25.632181559900573, 24.03365248594188, 22.117494895053195, 27.04656284359278, 35.30015793067008, 36.59073174676403, 17.852680382226968, 19.9457140555991, 17.672132695765967, 16.69248835319685, 13.416162325995353, 18.081621320071676, 12.332973099597108, 19.34600981833099, 18.724755565995302, 36.8776493963689, 21.734909184542932, 13.534537918839678, 34.88541199665756, 11.231374096997296, 21.81907521113674, 14.810372557453158, 18.92948514799637, 69.01074872349169, 14.824209923866212, 19.150408918181817, 47.5709770107432, 30.8733925664695, 32.171969122015916, 16.39580032584044, 11.431701335653935, 15.07435232501631, 20.514527376928722, 15.91704731574913, 17.63937955456752, 25.940314630246043, 19.891209310110767, 25.617541620698965, 23.65362998811856, 17.188144025464354, 18.26664008839713, 23.53603599815359, 17.45938470488966, 17.200489165459192], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19243757847100304, "mean_inference_ms": 0.9439953798820312, "mean_action_processing_ms": 0.03965358238111208, "mean_env_wait_ms": 0.8659687304232473, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 972800, "timers": {"sample_time_ms": 3532.94, "sample_throughput": 3623.044, "learn_time_ms": 3855.381, "learn_throughput": 3320.035, "update_time_ms": 1.553}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.48917519152164457, "policy_loss": -0.020330897783860564, "vf_loss": 0.48320201128721235, "vf_explained_var": 0.9155269861221313, "kl": 0.017536054365336895, "entropy": -4.184461698532105, "entropy_coeff": 0.0}}, "num_steps_sampled": 972800, "num_steps_trained": 972800}, "done": false, "episodes_total": 952, "training_iteration": 76, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-14-29", "timestamp": 1617650069, "time_this_iter_s": 6.565595865249634, "time_total_s": 584.3268806934357, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 196.55996584892273, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 27.955555555555556, "ram_util_percent": 65.05555555555556}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 69.01074872349169, "episode_reward_min": 10.873544466129456, "episode_reward_mean": 26.424527790631927, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.204036919351424, 28.003383212110823, 16.37339177194255, 20.18827287287368, 14.801272737271761, 39.836524753841275, 32.05116491102214, 17.99950419735651, 21.91552331211606, 16.179198682496818, 45.709415318432406, 14.46131665069746, 36.41539728503895, 25.070167806509478, 22.190488224653365, 44.68555671007834, 27.15253838516997, 52.02167076142615, 24.423403964413378, 25.352009605898637, 60.0015730220556, 15.373673508317275, 41.64400175637371, 23.288705968504875, 19.4787011291977, 12.656279815552864, 53.73406068626394, 15.019638582019319, 34.07643770481896, 27.92016237286518, 20.23306674423477, 50.811332013516214, 10.873544466129456, 36.177978928829354, 44.88991296222619, 27.40879721408885, 25.043341633326595, 18.16739784614401, 27.215264681266238, 12.716260805953175, 27.514323301963927, 23.892027830100677, 22.870427906461916, 27.21964239370002, 34.272683830160666, 30.496129383070528, 35.536088622262056, 20.617040087296036, 25.632181559900573, 24.03365248594188, 22.117494895053195, 27.04656284359278, 35.30015793067008, 36.59073174676403, 17.852680382226968, 19.9457140555991, 17.672132695765967, 16.69248835319685, 13.416162325995353, 18.081621320071676, 12.332973099597108, 19.34600981833099, 18.724755565995302, 36.8776493963689, 21.734909184542932, 13.534537918839678, 34.88541199665756, 11.231374096997296, 21.81907521113674, 14.810372557453158, 18.92948514799637, 69.01074872349169, 14.824209923866212, 19.150408918181817, 47.5709770107432, 30.8733925664695, 32.171969122015916, 16.39580032584044, 11.431701335653935, 15.07435232501631, 20.514527376928722, 15.91704731574913, 17.63937955456752, 25.940314630246043, 19.891209310110767, 25.617541620698965, 23.65362998811856, 17.188144025464354, 18.26664008839713, 23.53603599815359, 17.45938470488966, 17.200489165459192, 41.951715129444445, 25.82544948240165, 28.25644038924834, 46.43817785652118, 26.975175760299347, 24.45059424248711, 28.831163644731806, 65.60529065990042], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19271317803060176, "mean_inference_ms": 0.9451866125650684, "mean_action_processing_ms": 0.03971538315155518, "mean_env_wait_ms": 0.8672755904353744, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 985600, "timers": {"sample_time_ms": 3529.571, "sample_throughput": 3626.503, "learn_time_ms": 3861.759, "learn_throughput": 3314.551, "update_time_ms": 1.526}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.5754272058606148, "policy_loss": -0.0318476789817214, "vf_loss": 0.5846557405591011, "vf_explained_var": 0.9351552724838257, "kl": 0.015079429177567362, "entropy": -4.285106616020203, "entropy_coeff": 0.0}}, "num_steps_sampled": 985600, "num_steps_trained": 985600}, "done": false, "episodes_total": 968, "training_iteration": 77, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-14-35", "timestamp": 1617650075, "time_this_iter_s": 6.527083396911621, "time_total_s": 590.8539640903473, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 203.08704924583435, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 26.566666666666666, "ram_util_percent": 65.0}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 69.01074872349169, "episode_reward_min": 10.873544466129456, "episode_reward_mean": 25.72102182844324, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.431395774798219, 15.361747765529383, 22.669697568350017, 44.14385826242483, 31.342865899958362, 25.77225530572453, 18.82747602633624, 25.357684150168957, 19.4787011291977, 12.656279815552864, 53.73406068626394, 15.019638582019319, 34.07643770481896, 27.92016237286518, 20.23306674423477, 50.811332013516214, 10.873544466129456, 36.177978928829354, 44.88991296222619, 27.40879721408885, 25.043341633326595, 18.16739784614401, 27.215264681266238, 12.716260805953175, 27.514323301963927, 23.892027830100677, 22.870427906461916, 27.21964239370002, 34.272683830160666, 30.496129383070528, 35.536088622262056, 20.617040087296036, 25.632181559900573, 24.03365248594188, 22.117494895053195, 27.04656284359278, 35.30015793067008, 36.59073174676403, 17.852680382226968, 19.9457140555991, 17.672132695765967, 16.69248835319685, 13.416162325995353, 18.081621320071676, 12.332973099597108, 19.34600981833099, 18.724755565995302, 36.8776493963689, 21.734909184542932, 13.534537918839678, 34.88541199665756, 11.231374096997296, 21.81907521113674, 14.810372557453158, 18.92948514799637, 69.01074872349169, 14.824209923866212, 19.150408918181817, 47.5709770107432, 30.8733925664695, 32.171969122015916, 16.39580032584044, 11.431701335653935, 15.07435232501631, 20.514527376928722, 15.91704731574913, 17.63937955456752, 25.940314630246043, 19.891209310110767, 25.617541620698965, 23.65362998811856, 17.188144025464354, 18.26664008839713, 23.53603599815359, 17.45938470488966, 17.200489165459192, 41.951715129444445, 25.82544948240165, 28.25644038924834, 46.43817785652118, 26.975175760299347, 24.45059424248711, 28.831163644731806, 65.60529065990042, 32.204036919351424, 28.003383212110823, 16.37339177194255, 20.18827287287368, 14.801272737271761, 39.836524753841275, 32.05116491102214, 17.99950419735651, 21.91552331211606, 16.179198682496818, 45.709415318432406, 14.46131665069746, 36.41539728503895, 25.070167806509478, 22.190488224653365, 44.68555671007834], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19279139962885786, "mean_inference_ms": 0.9454737246660468, "mean_action_processing_ms": 0.039744415624367965, "mean_env_wait_ms": 0.8677012036255718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 998400, "timers": {"sample_time_ms": 3525.198, "sample_throughput": 3631.002, "learn_time_ms": 3856.942, "learn_throughput": 3318.691, "update_time_ms": 1.505}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.2671195813640952, "policy_loss": -0.03512887917459011, "vf_loss": 0.2834556010365486, "vf_explained_var": 0.9600037336349487, "kl": 0.012528575658798217, "entropy": -4.2116097784042354, "entropy_coeff": 0.0}}, "num_steps_sampled": 998400, "num_steps_trained": 998400}, "done": false, "episodes_total": 976, "training_iteration": 78, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-14-42", "timestamp": 1617650082, "time_this_iter_s": 6.339665651321411, "time_total_s": 597.1936297416687, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 209.42671489715576, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 26.366666666666664, "ram_util_percent": 64.96666666666667}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 69.01074872349169, "episode_reward_min": 11.231374096997296, "episode_reward_mean": 26.33508006724104, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.31286875068906, 17.6863624696454, 31.625380779653554, 38.41005403572188, 30.67265628929501, 40.99473787741938, 26.055883124644723, 23.445504560794312, 16.044126973152427, 64.74868923072688, 24.884899555116405, 24.90102346386977, 21.41355600780333, 46.155581794039705, 23.596756318929934, 31.87992023471179, 27.514323301963927, 23.892027830100677, 22.870427906461916, 27.21964239370002, 34.272683830160666, 30.496129383070528, 35.536088622262056, 20.617040087296036, 25.632181559900573, 24.03365248594188, 22.117494895053195, 27.04656284359278, 35.30015793067008, 36.59073174676403, 17.852680382226968, 19.9457140555991, 17.672132695765967, 16.69248835319685, 13.416162325995353, 18.081621320071676, 12.332973099597108, 19.34600981833099, 18.724755565995302, 36.8776493963689, 21.734909184542932, 13.534537918839678, 34.88541199665756, 11.231374096997296, 21.81907521113674, 14.810372557453158, 18.92948514799637, 69.01074872349169, 14.824209923866212, 19.150408918181817, 47.5709770107432, 30.8733925664695, 32.171969122015916, 16.39580032584044, 11.431701335653935, 15.07435232501631, 20.514527376928722, 15.91704731574913, 17.63937955456752, 25.940314630246043, 19.891209310110767, 25.617541620698965, 23.65362998811856, 17.188144025464354, 18.26664008839713, 23.53603599815359, 17.45938470488966, 17.200489165459192, 41.951715129444445, 25.82544948240165, 28.25644038924834, 46.43817785652118, 26.975175760299347, 24.45059424248711, 28.831163644731806, 65.60529065990042, 32.204036919351424, 28.003383212110823, 16.37339177194255, 20.18827287287368, 14.801272737271761, 39.836524753841275, 32.05116491102214, 17.99950419735651, 21.91552331211606, 16.179198682496818, 45.709415318432406, 14.46131665069746, 36.41539728503895, 25.070167806509478, 22.190488224653365, 44.68555671007834, 15.431395774798219, 15.361747765529383, 22.669697568350017, 44.14385826242483, 31.342865899958362, 25.77225530572453, 18.82747602633624, 25.357684150168957], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1925502211225051, "mean_inference_ms": 0.9450628995732545, "mean_action_processing_ms": 0.03972677785957507, "mean_env_wait_ms": 0.867232177074849, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1011200, "timers": {"sample_time_ms": 3530.856, "sample_throughput": 3625.184, "learn_time_ms": 3849.526, "learn_throughput": 3325.085, "update_time_ms": 1.502}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.7461974376440048, "policy_loss": -0.026597677199169993, "vf_loss": 0.7491139337420464, "vf_explained_var": 0.9197550415992737, "kl": 0.015787450559437276, "entropy": -4.2926574277877805, "entropy_coeff": 0.0}}, "num_steps_sampled": 1011200, "num_steps_trained": 1011200}, "done": false, "episodes_total": 992, "training_iteration": 79, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-14-48", "timestamp": 1617650088, "time_this_iter_s": 6.432708978652954, "time_total_s": 603.6263387203217, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 215.85942387580872, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.919999999999998, "ram_util_percent": 65.0}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 69.01074872349169, "episode_reward_min": 11.231374096997296, "episode_reward_mean": 26.460770213476245, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.11997762598205, 33.83440239628458, 15.008635612025692, 27.941166305824723, 16.535495219727036, 26.19210529278413, 19.491141695789857, 11.879918315595095, 37.637606438125744, 19.939825253195846, 37.85835255582051, 19.555789010420796, 12.518035034182212, 63.83776652235369, 23.56272133983745, 36.59361526033468, 17.672132695765967, 16.69248835319685, 13.416162325995353, 18.081621320071676, 12.332973099597108, 19.34600981833099, 18.724755565995302, 36.8776493963689, 21.734909184542932, 13.534537918839678, 34.88541199665756, 11.231374096997296, 21.81907521113674, 14.810372557453158, 18.92948514799637, 69.01074872349169, 14.824209923866212, 19.150408918181817, 47.5709770107432, 30.8733925664695, 32.171969122015916, 16.39580032584044, 11.431701335653935, 15.07435232501631, 20.514527376928722, 15.91704731574913, 17.63937955456752, 25.940314630246043, 19.891209310110767, 25.617541620698965, 23.65362998811856, 17.188144025464354, 18.26664008839713, 23.53603599815359, 17.45938470488966, 17.200489165459192, 41.951715129444445, 25.82544948240165, 28.25644038924834, 46.43817785652118, 26.975175760299347, 24.45059424248711, 28.831163644731806, 65.60529065990042, 32.204036919351424, 28.003383212110823, 16.37339177194255, 20.18827287287368, 14.801272737271761, 39.836524753841275, 32.05116491102214, 17.99950419735651, 21.91552331211606, 16.179198682496818, 45.709415318432406, 14.46131665069746, 36.41539728503895, 25.070167806509478, 22.190488224653365, 44.68555671007834, 15.431395774798219, 15.361747765529383, 22.669697568350017, 44.14385826242483, 31.342865899958362, 25.77225530572453, 18.82747602633624, 25.357684150168957, 35.31286875068906, 17.6863624696454, 31.625380779653554, 38.41005403572188, 30.67265628929501, 40.99473787741938, 26.055883124644723, 23.445504560794312, 16.044126973152427, 64.74868923072688, 24.884899555116405, 24.90102346386977, 21.41355600780333, 46.155581794039705, 23.596756318929934, 31.87992023471179], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19205334518545947, "mean_inference_ms": 0.941943251736979, "mean_action_processing_ms": 0.03960911373099453, "mean_env_wait_ms": 0.8643424325033934, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1024000, "timers": {"sample_time_ms": 3528.585, "sample_throughput": 3627.517, "learn_time_ms": 3916.871, "learn_throughput": 3267.914, "update_time_ms": 1.515}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.7198058623075485, "policy_loss": -0.02643567243590951, "vf_loss": 0.7193641540408134, "vf_explained_var": 0.922464907169342, "kl": 0.017918254937976597, "entropy": -4.345559272766113, "entropy_coeff": 0.0}}, "num_steps_sampled": 1024000, "num_steps_trained": 1024000}, "done": false, "episodes_total": 1008, "training_iteration": 80, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-14-55", "timestamp": 1617650095, "time_this_iter_s": 7.100541591644287, "time_total_s": 610.7268803119659, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 222.959965467453, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 39.88, "ram_util_percent": 61.010000000000005}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 95.4396265726745, "episode_reward_min": 11.231374096997296, "episode_reward_mean": 27.77582353426007, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.13389669598418, 95.4396265726745, 26.966770392413316, 45.42786453482496, 14.767703301750794, 23.093795315631244, 30.93026915440976, 12.889198686016417, 21.734909184542932, 13.534537918839678, 34.88541199665756, 11.231374096997296, 21.81907521113674, 14.810372557453158, 18.92948514799637, 69.01074872349169, 14.824209923866212, 19.150408918181817, 47.5709770107432, 30.8733925664695, 32.171969122015916, 16.39580032584044, 11.431701335653935, 15.07435232501631, 20.514527376928722, 15.91704731574913, 17.63937955456752, 25.940314630246043, 19.891209310110767, 25.617541620698965, 23.65362998811856, 17.188144025464354, 18.26664008839713, 23.53603599815359, 17.45938470488966, 17.200489165459192, 41.951715129444445, 25.82544948240165, 28.25644038924834, 46.43817785652118, 26.975175760299347, 24.45059424248711, 28.831163644731806, 65.60529065990042, 32.204036919351424, 28.003383212110823, 16.37339177194255, 20.18827287287368, 14.801272737271761, 39.836524753841275, 32.05116491102214, 17.99950419735651, 21.91552331211606, 16.179198682496818, 45.709415318432406, 14.46131665069746, 36.41539728503895, 25.070167806509478, 22.190488224653365, 44.68555671007834, 15.431395774798219, 15.361747765529383, 22.669697568350017, 44.14385826242483, 31.342865899958362, 25.77225530572453, 18.82747602633624, 25.357684150168957, 35.31286875068906, 17.6863624696454, 31.625380779653554, 38.41005403572188, 30.67265628929501, 40.99473787741938, 26.055883124644723, 23.445504560794312, 16.044126973152427, 64.74868923072688, 24.884899555116405, 24.90102346386977, 21.41355600780333, 46.155581794039705, 23.596756318929934, 31.87992023471179, 41.11997762598205, 33.83440239628458, 15.008635612025692, 27.941166305824723, 16.535495219727036, 26.19210529278413, 19.491141695789857, 11.879918315595095, 37.637606438125744, 19.939825253195846, 37.85835255582051, 19.555789010420796, 12.518035034182212, 63.83776652235369, 23.56272133983745, 36.59361526033468], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19163865621971482, "mean_inference_ms": 0.9401391318143323, "mean_action_processing_ms": 0.03953216992653644, "mean_env_wait_ms": 0.8622458325509431, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1036800, "timers": {"sample_time_ms": 3558.604, "sample_throughput": 3596.916, "learn_time_ms": 3901.636, "learn_throughput": 3280.675, "update_time_ms": 1.514}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.001115468310867559, "total_loss": 0.9818953004479408, "policy_loss": -0.015147912581451237, "vf_loss": 0.9618775954842568, "vf_explained_var": 0.8790504932403564, "kl": 0.023443747702986004, "entropy": -4.1998788022995, "entropy_coeff": 0.0}}, "num_steps_sampled": 1036800, "num_steps_trained": 1036800}, "done": false, "episodes_total": 1016, "training_iteration": 81, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-04", "timestamp": 1617650104, "time_this_iter_s": 8.542568683624268, "time_total_s": 619.2694489955902, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 231.50253415107727, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 57.50833333333335, "ram_util_percent": 63.449999999999996}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 95.4396265726745, "episode_reward_min": 11.879918315595095, "episode_reward_mean": 28.993635894439443, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.22330560693806, 38.1882523572298, 21.391910384279328, 30.094002741856645, 14.761145954796433, 38.389038378730866, 12.931727456539281, 37.99757681785375, 32.77019857978219, 69.90329486515233, 52.32402871117643, 18.809847535052523, 16.777861965845553, 19.172290015754566, 27.76232197201994, 25.73315903983243, 20.514527376928722, 15.91704731574913, 17.63937955456752, 25.940314630246043, 19.891209310110767, 25.617541620698965, 23.65362998811856, 17.188144025464354, 18.26664008839713, 23.53603599815359, 17.45938470488966, 17.200489165459192, 41.951715129444445, 25.82544948240165, 28.25644038924834, 46.43817785652118, 26.975175760299347, 24.45059424248711, 28.831163644731806, 65.60529065990042, 32.204036919351424, 28.003383212110823, 16.37339177194255, 20.18827287287368, 14.801272737271761, 39.836524753841275, 32.05116491102214, 17.99950419735651, 21.91552331211606, 16.179198682496818, 45.709415318432406, 14.46131665069746, 36.41539728503895, 25.070167806509478, 22.190488224653365, 44.68555671007834, 15.431395774798219, 15.361747765529383, 22.669697568350017, 44.14385826242483, 31.342865899958362, 25.77225530572453, 18.82747602633624, 25.357684150168957, 35.31286875068906, 17.6863624696454, 31.625380779653554, 38.41005403572188, 30.67265628929501, 40.99473787741938, 26.055883124644723, 23.445504560794312, 16.044126973152427, 64.74868923072688, 24.884899555116405, 24.90102346386977, 21.41355600780333, 46.155581794039705, 23.596756318929934, 31.87992023471179, 41.11997762598205, 33.83440239628458, 15.008635612025692, 27.941166305824723, 16.535495219727036, 26.19210529278413, 19.491141695789857, 11.879918315595095, 37.637606438125744, 19.939825253195846, 37.85835255582051, 19.555789010420796, 12.518035034182212, 63.83776652235369, 23.56272133983745, 36.59361526033468, 35.13389669598418, 95.4396265726745, 26.966770392413316, 45.42786453482496, 14.767703301750794, 23.093795315631244, 30.93026915440976, 12.889198686016417], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19102947940646994, "mean_inference_ms": 0.9366478815080691, "mean_action_processing_ms": 0.03939081942078697, "mean_env_wait_ms": 0.8587123495484562, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1049600, "timers": {"sample_time_ms": 3529.026, "sample_throughput": 3627.063, "learn_time_ms": 3833.018, "learn_throughput": 3339.405, "update_time_ms": 1.479}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 1.3398203539848328, "policy_loss": -0.014885905031114817, "vf_loss": 1.3107607913017274, "vf_explained_var": 0.8981737494468689, "kl": 0.019531320473179223, "entropy": -4.304194655418396, "entropy_coeff": 0.0}}, "num_steps_sampled": 1049600, "num_steps_trained": 1049600}, "done": false, "episodes_total": 1032, "training_iteration": 82, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-12", "timestamp": 1617650112, "time_this_iter_s": 8.22682523727417, "time_total_s": 627.4962742328644, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 239.72935938835144, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 55.0, "ram_util_percent": 63.916666666666664}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 95.4396265726745, "episode_reward_min": 9.24116493010929, "episode_reward_mean": 29.331568845054313, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.20321106350704, 22.334172839326854, 19.151642193864603, 19.112721107413996, 26.65174953010044, 46.248848468460636, 24.211578750587194, 9.24116493010929, 18.26664008839713, 23.53603599815359, 17.45938470488966, 17.200489165459192, 41.951715129444445, 25.82544948240165, 28.25644038924834, 46.43817785652118, 26.975175760299347, 24.45059424248711, 28.831163644731806, 65.60529065990042, 32.204036919351424, 28.003383212110823, 16.37339177194255, 20.18827287287368, 14.801272737271761, 39.836524753841275, 32.05116491102214, 17.99950419735651, 21.91552331211606, 16.179198682496818, 45.709415318432406, 14.46131665069746, 36.41539728503895, 25.070167806509478, 22.190488224653365, 44.68555671007834, 15.431395774798219, 15.361747765529383, 22.669697568350017, 44.14385826242483, 31.342865899958362, 25.77225530572453, 18.82747602633624, 25.357684150168957, 35.31286875068906, 17.6863624696454, 31.625380779653554, 38.41005403572188, 30.67265628929501, 40.99473787741938, 26.055883124644723, 23.445504560794312, 16.044126973152427, 64.74868923072688, 24.884899555116405, 24.90102346386977, 21.41355600780333, 46.155581794039705, 23.596756318929934, 31.87992023471179, 41.11997762598205, 33.83440239628458, 15.008635612025692, 27.941166305824723, 16.535495219727036, 26.19210529278413, 19.491141695789857, 11.879918315595095, 37.637606438125744, 19.939825253195846, 37.85835255582051, 19.555789010420796, 12.518035034182212, 63.83776652235369, 23.56272133983745, 36.59361526033468, 35.13389669598418, 95.4396265726745, 26.966770392413316, 45.42786453482496, 14.767703301750794, 23.093795315631244, 30.93026915440976, 12.889198686016417, 58.22330560693806, 38.1882523572298, 21.391910384279328, 30.094002741856645, 14.761145954796433, 38.389038378730866, 12.931727456539281, 37.99757681785375, 32.77019857978219, 69.90329486515233, 52.32402871117643, 18.809847535052523, 16.777861965845553, 19.172290015754566, 27.76232197201994, 25.73315903983243], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19081445859046867, "mean_inference_ms": 0.935416722773565, "mean_action_processing_ms": 0.039350133908605034, "mean_env_wait_ms": 0.8575565069150665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1062400, "timers": {"sample_time_ms": 3503.102, "sample_throughput": 3653.904, "learn_time_ms": 3816.594, "learn_throughput": 3353.776, "update_time_ms": 1.481}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.2884546826407313, "policy_loss": -0.031240055402740836, "vf_loss": 0.29582259625196455, "vf_explained_var": 0.9664968848228455, "kl": 0.010609839451499284, "entropy": -4.218054642677307, "entropy_coeff": 0.0}}, "num_steps_sampled": 1062400, "num_steps_trained": 1062400}, "done": false, "episodes_total": 1040, "training_iteration": 83, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-20", "timestamp": 1617650120, "time_this_iter_s": 8.3742036819458, "time_total_s": 635.8704779148102, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 248.10356307029724, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 56.06666666666666, "ram_util_percent": 63.949999999999996}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 95.4396265726745, "episode_reward_min": 9.24116493010929, "episode_reward_mean": 29.495055830622686, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.148339994838135, 44.44283361414665, 20.29248358990826, 11.739794176410937, 45.95823795806126, 52.20983710692964, 21.46520424035256, 21.539585804443927, 33.93465770046577, 29.097639450845342, 16.725593968286947, 43.45420306112782, 21.944636196414013, 33.31751357926652, 36.58571235535737, 29.0580676581953, 14.801272737271761, 39.836524753841275, 32.05116491102214, 17.99950419735651, 21.91552331211606, 16.179198682496818, 45.709415318432406, 14.46131665069746, 36.41539728503895, 25.070167806509478, 22.190488224653365, 44.68555671007834, 15.431395774798219, 15.361747765529383, 22.669697568350017, 44.14385826242483, 31.342865899958362, 25.77225530572453, 18.82747602633624, 25.357684150168957, 35.31286875068906, 17.6863624696454, 31.625380779653554, 38.41005403572188, 30.67265628929501, 40.99473787741938, 26.055883124644723, 23.445504560794312, 16.044126973152427, 64.74868923072688, 24.884899555116405, 24.90102346386977, 21.41355600780333, 46.155581794039705, 23.596756318929934, 31.87992023471179, 41.11997762598205, 33.83440239628458, 15.008635612025692, 27.941166305824723, 16.535495219727036, 26.19210529278413, 19.491141695789857, 11.879918315595095, 37.637606438125744, 19.939825253195846, 37.85835255582051, 19.555789010420796, 12.518035034182212, 63.83776652235369, 23.56272133983745, 36.59361526033468, 35.13389669598418, 95.4396265726745, 26.966770392413316, 45.42786453482496, 14.767703301750794, 23.093795315631244, 30.93026915440976, 12.889198686016417, 58.22330560693806, 38.1882523572298, 21.391910384279328, 30.094002741856645, 14.761145954796433, 38.389038378730866, 12.931727456539281, 37.99757681785375, 32.77019857978219, 69.90329486515233, 52.32402871117643, 18.809847535052523, 16.777861965845553, 19.172290015754566, 27.76232197201994, 25.73315903983243, 33.20321106350704, 22.334172839326854, 19.151642193864603, 19.112721107413996, 26.65174953010044, 46.248848468460636, 24.211578750587194, 9.24116493010929], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19074096697084925, "mean_inference_ms": 0.9351872881095595, "mean_action_processing_ms": 0.03933641306959559, "mean_env_wait_ms": 0.8572918116985686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1075200, "timers": {"sample_time_ms": 3480.653, "sample_throughput": 3677.47, "learn_time_ms": 3821.078, "learn_throughput": 3349.84, "update_time_ms": 1.53}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.6205680596828461, "policy_loss": -0.026204964788630606, "vf_loss": 0.6209493306279182, "vf_explained_var": 0.9363234043121338, "kl": 0.011477199606597424, "entropy": -4.277917051315308, "entropy_coeff": 0.0}}, "num_steps_sampled": 1075200, "num_steps_trained": 1075200}, "done": false, "episodes_total": 1056, "training_iteration": 84, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-29", "timestamp": 1617650129, "time_this_iter_s": 8.446340322494507, "time_total_s": 644.3168182373047, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 256.54990339279175, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 55.475000000000016, "ram_util_percent": 64.05833333333334}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 95.4396265726745, "episode_reward_min": 9.24116493010929, "episode_reward_mean": 30.31214422883759, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.88950524316016, 38.80561898254513, 16.603486262916405, 33.617344467829426, 18.45068154720617, 46.864435615826665, 29.036911848153153, 27.101727417214516, 29.783990597479328, 31.684487401590196, 61.111368761497175, 25.982287685276575, 30.476282782859414, 26.365666258082797, 24.22948115304271, 25.62779375742665, 31.342865899958362, 25.77225530572453, 18.82747602633624, 25.357684150168957, 35.31286875068906, 17.6863624696454, 31.625380779653554, 38.41005403572188, 30.67265628929501, 40.99473787741938, 26.055883124644723, 23.445504560794312, 16.044126973152427, 64.74868923072688, 24.884899555116405, 24.90102346386977, 21.41355600780333, 46.155581794039705, 23.596756318929934, 31.87992023471179, 41.11997762598205, 33.83440239628458, 15.008635612025692, 27.941166305824723, 16.535495219727036, 26.19210529278413, 19.491141695789857, 11.879918315595095, 37.637606438125744, 19.939825253195846, 37.85835255582051, 19.555789010420796, 12.518035034182212, 63.83776652235369, 23.56272133983745, 36.59361526033468, 35.13389669598418, 95.4396265726745, 26.966770392413316, 45.42786453482496, 14.767703301750794, 23.093795315631244, 30.93026915440976, 12.889198686016417, 58.22330560693806, 38.1882523572298, 21.391910384279328, 30.094002741856645, 14.761145954796433, 38.389038378730866, 12.931727456539281, 37.99757681785375, 32.77019857978219, 69.90329486515233, 52.32402871117643, 18.809847535052523, 16.777861965845553, 19.172290015754566, 27.76232197201994, 25.73315903983243, 33.20321106350704, 22.334172839326854, 19.151642193864603, 19.112721107413996, 26.65174953010044, 46.248848468460636, 24.211578750587194, 9.24116493010929, 16.148339994838135, 44.44283361414665, 20.29248358990826, 11.739794176410937, 45.95823795806126, 52.20983710692964, 21.46520424035256, 21.539585804443927, 33.93465770046577, 29.097639450845342, 16.725593968286947, 43.45420306112782, 21.944636196414013, 33.31751357926652, 36.58571235535737, 29.0580676581953], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1912823723056375, "mean_inference_ms": 0.9365284968392134, "mean_action_processing_ms": 0.03940489041900341, "mean_env_wait_ms": 0.8589768166468812, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1088000, "timers": {"sample_time_ms": 3610.926, "sample_throughput": 3544.797, "learn_time_ms": 3886.763, "learn_throughput": 3293.229, "update_time_ms": 1.54}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 1.0456065702438355, "policy_loss": -0.02252146864309907, "vf_loss": 1.03574711561203, "vf_explained_var": 0.9156309366226196, "kl": 0.014391519259661437, "entropy": -4.3423824834823606, "entropy_coeff": 0.0}}, "num_steps_sampled": 1088000, "num_steps_trained": 1088000}, "done": false, "episodes_total": 1072, "training_iteration": 85, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-37", "timestamp": 1617650137, "time_this_iter_s": 8.499954462051392, "time_total_s": 652.8167726993561, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 265.04985785484314, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 57.775000000000006, "ram_util_percent": 64.10000000000001}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 95.4396265726745, "episode_reward_min": 9.24116493010929, "episode_reward_mean": 30.182655079524793, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.325751547613265, 22.725010878249698, 31.515022498292325, 17.95549526065381, 21.934888025568924, 20.07909963139429, 35.9927427963865, 38.85802184845948, 30.67265628929501, 40.99473787741938, 26.055883124644723, 23.445504560794312, 16.044126973152427, 64.74868923072688, 24.884899555116405, 24.90102346386977, 21.41355600780333, 46.155581794039705, 23.596756318929934, 31.87992023471179, 41.11997762598205, 33.83440239628458, 15.008635612025692, 27.941166305824723, 16.535495219727036, 26.19210529278413, 19.491141695789857, 11.879918315595095, 37.637606438125744, 19.939825253195846, 37.85835255582051, 19.555789010420796, 12.518035034182212, 63.83776652235369, 23.56272133983745, 36.59361526033468, 35.13389669598418, 95.4396265726745, 26.966770392413316, 45.42786453482496, 14.767703301750794, 23.093795315631244, 30.93026915440976, 12.889198686016417, 58.22330560693806, 38.1882523572298, 21.391910384279328, 30.094002741856645, 14.761145954796433, 38.389038378730866, 12.931727456539281, 37.99757681785375, 32.77019857978219, 69.90329486515233, 52.32402871117643, 18.809847535052523, 16.777861965845553, 19.172290015754566, 27.76232197201994, 25.73315903983243, 33.20321106350704, 22.334172839326854, 19.151642193864603, 19.112721107413996, 26.65174953010044, 46.248848468460636, 24.211578750587194, 9.24116493010929, 16.148339994838135, 44.44283361414665, 20.29248358990826, 11.739794176410937, 45.95823795806126, 52.20983710692964, 21.46520424035256, 21.539585804443927, 33.93465770046577, 29.097639450845342, 16.725593968286947, 43.45420306112782, 21.944636196414013, 33.31751357926652, 36.58571235535737, 29.0580676581953, 44.88950524316016, 38.80561898254513, 16.603486262916405, 33.617344467829426, 18.45068154720617, 46.864435615826665, 29.036911848153153, 27.101727417214516, 29.783990597479328, 31.684487401590196, 61.111368761497175, 25.982287685276575, 30.476282782859414, 26.365666258082797, 24.22948115304271, 25.62779375742665], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1916110071575167, "mean_inference_ms": 0.9381993718686168, "mean_action_processing_ms": 0.03947378755051703, "mean_env_wait_ms": 0.8604565963870436, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1100800, "timers": {"sample_time_ms": 3727.056, "sample_throughput": 3434.346, "learn_time_ms": 3958.557, "learn_throughput": 3233.502, "update_time_ms": 1.544}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.20479030162096024, "policy_loss": -0.030691199246793987, "vf_loss": 0.21605416156351567, "vf_explained_var": 0.9651924967765808, "kl": 0.008634372996166349, "entropy": -4.193486046791077, "entropy_coeff": 0.0}}, "num_steps_sampled": 1100800, "num_steps_trained": 1100800}, "done": false, "episodes_total": 1080, "training_iteration": 86, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-46", "timestamp": 1617650146, "time_this_iter_s": 8.446108341217041, "time_total_s": 661.2628810405731, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 273.4959661960602, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 57.525, "ram_util_percent": 64.06666666666666}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 95.4396265726745, "episode_reward_min": 9.24116493010929, "episode_reward_mean": 29.781908882556145, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.73240041888615, 42.89834179312071, 23.098655847214047, 14.15500195046153, 28.765124061064373, 17.81927624359988, 38.336067503331805, 19.090642192985726, 19.07499862431953, 19.98298154534435, 25.272897322687843, 22.217954721118808, 20.821812316746534, 55.75124990082793, 27.020772105458757, 28.584721126588402, 16.535495219727036, 26.19210529278413, 19.491141695789857, 11.879918315595095, 37.637606438125744, 19.939825253195846, 37.85835255582051, 19.555789010420796, 12.518035034182212, 63.83776652235369, 23.56272133983745, 36.59361526033468, 35.13389669598418, 95.4396265726745, 26.966770392413316, 45.42786453482496, 14.767703301750794, 23.093795315631244, 30.93026915440976, 12.889198686016417, 58.22330560693806, 38.1882523572298, 21.391910384279328, 30.094002741856645, 14.761145954796433, 38.389038378730866, 12.931727456539281, 37.99757681785375, 32.77019857978219, 69.90329486515233, 52.32402871117643, 18.809847535052523, 16.777861965845553, 19.172290015754566, 27.76232197201994, 25.73315903983243, 33.20321106350704, 22.334172839326854, 19.151642193864603, 19.112721107413996, 26.65174953010044, 46.248848468460636, 24.211578750587194, 9.24116493010929, 16.148339994838135, 44.44283361414665, 20.29248358990826, 11.739794176410937, 45.95823795806126, 52.20983710692964, 21.46520424035256, 21.539585804443927, 33.93465770046577, 29.097639450845342, 16.725593968286947, 43.45420306112782, 21.944636196414013, 33.31751357926652, 36.58571235535737, 29.0580676581953, 44.88950524316016, 38.80561898254513, 16.603486262916405, 33.617344467829426, 18.45068154720617, 46.864435615826665, 29.036911848153153, 27.101727417214516, 29.783990597479328, 31.684487401590196, 61.111368761497175, 25.982287685276575, 30.476282782859414, 26.365666258082797, 24.22948115304271, 25.62779375742665, 22.325751547613265, 22.725010878249698, 31.515022498292325, 17.95549526065381, 21.934888025568924, 20.07909963139429, 35.9927427963865, 38.85802184845948], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19253218065978242, "mean_inference_ms": 0.9424453128494781, "mean_action_processing_ms": 0.039659778242083235, "mean_env_wait_ms": 0.8648384147468161, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1113600, "timers": {"sample_time_ms": 3847.577, "sample_throughput": 3326.769, "learn_time_ms": 4017.859, "learn_throughput": 3185.776, "update_time_ms": 1.619}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.9300249201059342, "policy_loss": -0.02666114005493, "vf_loss": 0.9288358572125435, "vf_explained_var": 0.9143003821372986, "kl": 0.0123778713401407, "entropy": -4.301952233314514, "entropy_coeff": 0.0}}, "num_steps_sampled": 1113600, "num_steps_trained": 1113600}, "done": false, "episodes_total": 1096, "training_iteration": 87, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-54", "timestamp": 1617650154, "time_this_iter_s": 8.328298330307007, "time_total_s": 669.5911793708801, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 281.8242645263672, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 55.375, "ram_util_percent": 64.1}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 95.4396265726745, "episode_reward_min": 9.24116493010929, "episode_reward_mean": 29.951902315389567, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.457933469319325, 22.67131943988112, 22.889972538111827, 38.83742894335633, 23.652198447061366, 21.35862346956974, 32.03498798843368, 18.187112769068047, 12.518035034182212, 63.83776652235369, 23.56272133983745, 36.59361526033468, 35.13389669598418, 95.4396265726745, 26.966770392413316, 45.42786453482496, 14.767703301750794, 23.093795315631244, 30.93026915440976, 12.889198686016417, 58.22330560693806, 38.1882523572298, 21.391910384279328, 30.094002741856645, 14.761145954796433, 38.389038378730866, 12.931727456539281, 37.99757681785375, 32.77019857978219, 69.90329486515233, 52.32402871117643, 18.809847535052523, 16.777861965845553, 19.172290015754566, 27.76232197201994, 25.73315903983243, 33.20321106350704, 22.334172839326854, 19.151642193864603, 19.112721107413996, 26.65174953010044, 46.248848468460636, 24.211578750587194, 9.24116493010929, 16.148339994838135, 44.44283361414665, 20.29248358990826, 11.739794176410937, 45.95823795806126, 52.20983710692964, 21.46520424035256, 21.539585804443927, 33.93465770046577, 29.097639450845342, 16.725593968286947, 43.45420306112782, 21.944636196414013, 33.31751357926652, 36.58571235535737, 29.0580676581953, 44.88950524316016, 38.80561898254513, 16.603486262916405, 33.617344467829426, 18.45068154720617, 46.864435615826665, 29.036911848153153, 27.101727417214516, 29.783990597479328, 31.684487401590196, 61.111368761497175, 25.982287685276575, 30.476282782859414, 26.365666258082797, 24.22948115304271, 25.62779375742665, 22.325751547613265, 22.725010878249698, 31.515022498292325, 17.95549526065381, 21.934888025568924, 20.07909963139429, 35.9927427963865, 38.85802184845948, 49.73240041888615, 42.89834179312071, 23.098655847214047, 14.15500195046153, 28.765124061064373, 17.81927624359988, 38.336067503331805, 19.090642192985726, 19.07499862431953, 19.98298154534435, 25.272897322687843, 22.217954721118808, 20.821812316746534, 55.75124990082793, 27.020772105458757, 28.584721126588402], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19302432847567386, "mean_inference_ms": 0.944883954805579, "mean_action_processing_ms": 0.03977477502260086, "mean_env_wait_ms": 0.8674322932986342, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1126400, "timers": {"sample_time_ms": 3969.195, "sample_throughput": 3224.835, "learn_time_ms": 4080.279, "learn_throughput": 3137.04, "update_time_ms": 1.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.22173328746110202, "policy_loss": -0.029259868022054433, "vf_loss": 0.2206758154928684, "vf_explained_var": 0.9716963171958923, "kl": 0.013474373035132886, "entropy": -4.234496583938599, "entropy_coeff": 0.0}}, "num_steps_sampled": 1126400, "num_steps_trained": 1126400}, "done": false, "episodes_total": 1104, "training_iteration": 88, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-03", "timestamp": 1617650163, "time_this_iter_s": 8.181748390197754, "time_total_s": 677.7729277610779, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 290.00601291656494, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 54.79166666666668, "ram_util_percent": 64.1}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 69.90329486515233, "episode_reward_min": 9.24116493010929, "episode_reward_mean": 29.24521867699158, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.934902009690934, 24.730679666742166, 20.985821425996736, 39.18728745696098, 33.664786203431156, 33.044552897054075, 35.32694442587472, 26.55362191766586, 34.76324393572176, 17.398675085560747, 18.452972782033253, 31.083554562545054, 25.670738042399844, 47.18428041176245, 26.153191347525855, 58.25511788995311, 14.761145954796433, 38.389038378730866, 12.931727456539281, 37.99757681785375, 32.77019857978219, 69.90329486515233, 52.32402871117643, 18.809847535052523, 16.777861965845553, 19.172290015754566, 27.76232197201994, 25.73315903983243, 33.20321106350704, 22.334172839326854, 19.151642193864603, 19.112721107413996, 26.65174953010044, 46.248848468460636, 24.211578750587194, 9.24116493010929, 16.148339994838135, 44.44283361414665, 20.29248358990826, 11.739794176410937, 45.95823795806126, 52.20983710692964, 21.46520424035256, 21.539585804443927, 33.93465770046577, 29.097639450845342, 16.725593968286947, 43.45420306112782, 21.944636196414013, 33.31751357926652, 36.58571235535737, 29.0580676581953, 44.88950524316016, 38.80561898254513, 16.603486262916405, 33.617344467829426, 18.45068154720617, 46.864435615826665, 29.036911848153153, 27.101727417214516, 29.783990597479328, 31.684487401590196, 61.111368761497175, 25.982287685276575, 30.476282782859414, 26.365666258082797, 24.22948115304271, 25.62779375742665, 22.325751547613265, 22.725010878249698, 31.515022498292325, 17.95549526065381, 21.934888025568924, 20.07909963139429, 35.9927427963865, 38.85802184845948, 49.73240041888615, 42.89834179312071, 23.098655847214047, 14.15500195046153, 28.765124061064373, 17.81927624359988, 38.336067503331805, 19.090642192985726, 19.07499862431953, 19.98298154534435, 25.272897322687843, 22.217954721118808, 20.821812316746534, 55.75124990082793, 27.020772105458757, 28.584721126588402, 26.457933469319325, 22.67131943988112, 22.889972538111827, 38.83742894335633, 23.652198447061366, 21.35862346956974, 32.03498798843368, 18.187112769068047], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19399773570404527, "mean_inference_ms": 0.9502163479360859, "mean_action_processing_ms": 0.03999602782819799, "mean_env_wait_ms": 0.872863462398018, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1139200, "timers": {"sample_time_ms": 4098.767, "sample_throughput": 3122.891, "learn_time_ms": 4169.4, "learn_throughput": 3069.986, "update_time_ms": 1.674}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.5876655569672584, "policy_loss": -0.02137455982156098, "vf_loss": 0.5837256617844104, "vf_explained_var": 0.9359886646270752, "kl": 0.011250868388451636, "entropy": -4.293592448234558, "entropy_coeff": 0.0}}, "num_steps_sampled": 1139200, "num_steps_trained": 1139200}, "done": false, "episodes_total": 1120, "training_iteration": 89, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-11", "timestamp": 1617650171, "time_this_iter_s": 8.62004804611206, "time_total_s": 686.3929758071899, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 298.626060962677, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 57.23333333333333, "ram_util_percent": 64.125}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 61.111368761497175, "episode_reward_min": 9.24116493010929, "episode_reward_mean": 29.7490102890537, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.139358262817, 53.55555549398541, 20.7943696582106, 26.50349787034985, 26.829732856471907, 52.59236896970889, 20.04329566011304, 36.73634906744314, 26.046791704775544, 26.061017878623623, 35.9591337690726, 31.810020640780166, 20.3100735540564, 12.331154279746476, 32.24199843703259, 57.55868159967343, 26.65174953010044, 46.248848468460636, 24.211578750587194, 9.24116493010929, 16.148339994838135, 44.44283361414665, 20.29248358990826, 11.739794176410937, 45.95823795806126, 52.20983710692964, 21.46520424035256, 21.539585804443927, 33.93465770046577, 29.097639450845342, 16.725593968286947, 43.45420306112782, 21.944636196414013, 33.31751357926652, 36.58571235535737, 29.0580676581953, 44.88950524316016, 38.80561898254513, 16.603486262916405, 33.617344467829426, 18.45068154720617, 46.864435615826665, 29.036911848153153, 27.101727417214516, 29.783990597479328, 31.684487401590196, 61.111368761497175, 25.982287685276575, 30.476282782859414, 26.365666258082797, 24.22948115304271, 25.62779375742665, 22.325751547613265, 22.725010878249698, 31.515022498292325, 17.95549526065381, 21.934888025568924, 20.07909963139429, 35.9927427963865, 38.85802184845948, 49.73240041888615, 42.89834179312071, 23.098655847214047, 14.15500195046153, 28.765124061064373, 17.81927624359988, 38.336067503331805, 19.090642192985726, 19.07499862431953, 19.98298154534435, 25.272897322687843, 22.217954721118808, 20.821812316746534, 55.75124990082793, 27.020772105458757, 28.584721126588402, 26.457933469319325, 22.67131943988112, 22.889972538111827, 38.83742894335633, 23.652198447061366, 21.35862346956974, 32.03498798843368, 18.187112769068047, 25.934902009690934, 24.730679666742166, 20.985821425996736, 39.18728745696098, 33.664786203431156, 33.044552897054075, 35.32694442587472, 26.55362191766586, 34.76324393572176, 17.398675085560747, 18.452972782033253, 31.083554562545054, 25.670738042399844, 47.18428041176245, 26.153191347525855, 58.25511788995311], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19537036056261875, "mean_inference_ms": 0.9547778894653564, "mean_action_processing_ms": 0.040198355729647986, "mean_env_wait_ms": 0.8778345901523705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1152000, "timers": {"sample_time_ms": 4271.911, "sample_throughput": 2996.317, "learn_time_ms": 4187.478, "learn_throughput": 3056.732, "update_time_ms": 1.664}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.77710643440485, "policy_loss": -0.028459904082119465, "vf_loss": 0.7778699362277984, "vf_explained_var": 0.9240711331367493, "kl": 0.012309511145576834, "entropy": -4.344836983680725, "entropy_coeff": 0.0}}, "num_steps_sampled": 1152000, "num_steps_trained": 1152000}, "done": false, "episodes_total": 1136, "training_iteration": 90, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-20", "timestamp": 1617650180, "time_this_iter_s": 9.013796329498291, "time_total_s": 695.4067721366882, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 307.6398572921753, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 56.1923076923077, "ram_util_percent": 64.15384615384617}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 61.111368761497175, "episode_reward_min": 12.331154279746476, "episode_reward_mean": 30.018214572156634, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.519575962896504, 30.006297232596435, 18.724804724529736, 38.364313879927536, 45.54403127357976, 22.592721148236556, 20.180728798274757, 33.96474834481374, 45.95823795806126, 52.20983710692964, 21.46520424035256, 21.539585804443927, 33.93465770046577, 29.097639450845342, 16.725593968286947, 43.45420306112782, 21.944636196414013, 33.31751357926652, 36.58571235535737, 29.0580676581953, 44.88950524316016, 38.80561898254513, 16.603486262916405, 33.617344467829426, 18.45068154720617, 46.864435615826665, 29.036911848153153, 27.101727417214516, 29.783990597479328, 31.684487401590196, 61.111368761497175, 25.982287685276575, 30.476282782859414, 26.365666258082797, 24.22948115304271, 25.62779375742665, 22.325751547613265, 22.725010878249698, 31.515022498292325, 17.95549526065381, 21.934888025568924, 20.07909963139429, 35.9927427963865, 38.85802184845948, 49.73240041888615, 42.89834179312071, 23.098655847214047, 14.15500195046153, 28.765124061064373, 17.81927624359988, 38.336067503331805, 19.090642192985726, 19.07499862431953, 19.98298154534435, 25.272897322687843, 22.217954721118808, 20.821812316746534, 55.75124990082793, 27.020772105458757, 28.584721126588402, 26.457933469319325, 22.67131943988112, 22.889972538111827, 38.83742894335633, 23.652198447061366, 21.35862346956974, 32.03498798843368, 18.187112769068047, 25.934902009690934, 24.730679666742166, 20.985821425996736, 39.18728745696098, 33.664786203431156, 33.044552897054075, 35.32694442587472, 26.55362191766586, 34.76324393572176, 17.398675085560747, 18.452972782033253, 31.083554562545054, 25.670738042399844, 47.18428041176245, 26.153191347525855, 58.25511788995311, 32.139358262817, 53.55555549398541, 20.7943696582106, 26.50349787034985, 26.829732856471907, 52.59236896970889, 20.04329566011304, 36.73634906744314, 26.046791704775544, 26.061017878623623, 35.9591337690726, 31.810020640780166, 20.3100735540564, 12.331154279746476, 32.24199843703259, 57.55868159967343], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1959154297354799, "mean_inference_ms": 0.9571745443178001, "mean_action_processing_ms": 0.040298035280063454, "mean_env_wait_ms": 0.8800538371244465, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1164800, "timers": {"sample_time_ms": 4270.727, "sample_throughput": 2997.148, "learn_time_ms": 4204.248, "learn_throughput": 3044.539, "update_time_ms": 1.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.32790075019001963, "policy_loss": -0.02826517994515598, "vf_loss": 0.3379626440256834, "vf_explained_var": 0.9514898657798767, "kl": 0.008090348057448864, "entropy": -4.2281857776641845, "entropy_coeff": 0.0}}, "num_steps_sampled": 1164800, "num_steps_trained": 1164800}, "done": false, "episodes_total": 1144, "training_iteration": 91, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-29", "timestamp": 1617650189, "time_this_iter_s": 8.70031189918518, "time_total_s": 704.1070840358734, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 316.3401691913605, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 59.849999999999994, "ram_util_percent": 63.775000000000006}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 68.15574882241285, "episode_reward_min": 12.331154279746476, "episode_reward_mean": 29.588851931189733, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.115831638917301, 22.11534056064875, 18.046527006559092, 16.642498616180994, 38.01732854419943, 56.41014314495524, 22.121936934476754, 22.059438027074506, 68.15574882241285, 22.437771848574684, 32.23620595786257, 17.451179800294618, 42.87087455907145, 22.577039361756487, 21.95912060110137, 40.05359451542144, 18.45068154720617, 46.864435615826665, 29.036911848153153, 27.101727417214516, 29.783990597479328, 31.684487401590196, 61.111368761497175, 25.982287685276575, 30.476282782859414, 26.365666258082797, 24.22948115304271, 25.62779375742665, 22.325751547613265, 22.725010878249698, 31.515022498292325, 17.95549526065381, 21.934888025568924, 20.07909963139429, 35.9927427963865, 38.85802184845948, 49.73240041888615, 42.89834179312071, 23.098655847214047, 14.15500195046153, 28.765124061064373, 17.81927624359988, 38.336067503331805, 19.090642192985726, 19.07499862431953, 19.98298154534435, 25.272897322687843, 22.217954721118808, 20.821812316746534, 55.75124990082793, 27.020772105458757, 28.584721126588402, 26.457933469319325, 22.67131943988112, 22.889972538111827, 38.83742894335633, 23.652198447061366, 21.35862346956974, 32.03498798843368, 18.187112769068047, 25.934902009690934, 24.730679666742166, 20.985821425996736, 39.18728745696098, 33.664786203431156, 33.044552897054075, 35.32694442587472, 26.55362191766586, 34.76324393572176, 17.398675085560747, 18.452972782033253, 31.083554562545054, 25.670738042399844, 47.18428041176245, 26.153191347525855, 58.25511788995311, 32.139358262817, 53.55555549398541, 20.7943696582106, 26.50349787034985, 26.829732856471907, 52.59236896970889, 20.04329566011304, 36.73634906744314, 26.046791704775544, 26.061017878623623, 35.9591337690726, 31.810020640780166, 20.3100735540564, 12.331154279746476, 32.24199843703259, 57.55868159967343, 16.519575962896504, 30.006297232596435, 18.724804724529736, 38.364313879927536, 45.54403127357976, 22.592721148236556, 20.180728798274757, 33.96474834481374], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19713628359444793, "mean_inference_ms": 0.9617811957250086, "mean_action_processing_ms": 0.04049833915987303, "mean_env_wait_ms": 0.8848062330091818, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1177600, "timers": {"sample_time_ms": 4296.313, "sample_throughput": 2979.299, "learn_time_ms": 4230.811, "learn_throughput": 3025.424, "update_time_ms": 1.678}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.9655889245867729, "policy_loss": -0.019028693600557745, "vf_loss": 0.9495359221100808, "vf_explained_var": 0.9215068817138672, "kl": 0.015591862015426158, "entropy": -4.296971836090088, "entropy_coeff": 0.0}}, "num_steps_sampled": 1177600, "num_steps_trained": 1177600}, "done": false, "episodes_total": 1160, "training_iteration": 92, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-38", "timestamp": 1617650198, "time_this_iter_s": 8.749065160751343, "time_total_s": 712.8561491966248, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 325.0892343521118, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 58.68461538461539, "ram_util_percent": 63.64615384615384}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 68.15574882241285, "episode_reward_min": 12.331154279746476, "episode_reward_mean": 29.21595022676451, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.842558963388882, 43.74764662144051, 34.89186955784101, 38.48717860912945, 18.35764494782052, 18.753723885887002, 20.2997017141096, 33.34539613210413, 30.476282782859414, 26.365666258082797, 24.22948115304271, 25.62779375742665, 22.325751547613265, 22.725010878249698, 31.515022498292325, 17.95549526065381, 21.934888025568924, 20.07909963139429, 35.9927427963865, 38.85802184845948, 49.73240041888615, 42.89834179312071, 23.098655847214047, 14.15500195046153, 28.765124061064373, 17.81927624359988, 38.336067503331805, 19.090642192985726, 19.07499862431953, 19.98298154534435, 25.272897322687843, 22.217954721118808, 20.821812316746534, 55.75124990082793, 27.020772105458757, 28.584721126588402, 26.457933469319325, 22.67131943988112, 22.889972538111827, 38.83742894335633, 23.652198447061366, 21.35862346956974, 32.03498798843368, 18.187112769068047, 25.934902009690934, 24.730679666742166, 20.985821425996736, 39.18728745696098, 33.664786203431156, 33.044552897054075, 35.32694442587472, 26.55362191766586, 34.76324393572176, 17.398675085560747, 18.452972782033253, 31.083554562545054, 25.670738042399844, 47.18428041176245, 26.153191347525855, 58.25511788995311, 32.139358262817, 53.55555549398541, 20.7943696582106, 26.50349787034985, 26.829732856471907, 52.59236896970889, 20.04329566011304, 36.73634906744314, 26.046791704775544, 26.061017878623623, 35.9591337690726, 31.810020640780166, 20.3100735540564, 12.331154279746476, 32.24199843703259, 57.55868159967343, 16.519575962896504, 30.006297232596435, 18.724804724529736, 38.364313879927536, 45.54403127357976, 22.592721148236556, 20.180728798274757, 33.96474834481374, 13.115831638917301, 22.11534056064875, 18.046527006559092, 16.642498616180994, 38.01732854419943, 56.41014314495524, 22.121936934476754, 22.059438027074506, 68.15574882241285, 22.437771848574684, 32.23620595786257, 17.451179800294618, 42.87087455907145, 22.577039361756487, 21.95912060110137, 40.05359451542144], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19766366456457718, "mean_inference_ms": 0.9637743858917349, "mean_action_processing_ms": 0.040594848528309725, "mean_env_wait_ms": 0.8869077028051021, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1190400, "timers": {"sample_time_ms": 4292.311, "sample_throughput": 2982.077, "learn_time_ms": 4279.098, "learn_throughput": 2991.285, "update_time_ms": 1.707}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.3666854877769947, "policy_loss": -0.025819760109297932, "vf_loss": 0.370297325104475, "vf_explained_var": 0.9576637744903564, "kl": 0.00987018648069352, "entropy": -4.253979339599609, "entropy_coeff": 0.0}}, "num_steps_sampled": 1190400, "num_steps_trained": 1190400}, "done": false, "episodes_total": 1168, "training_iteration": 93, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-47", "timestamp": 1617650207, "time_this_iter_s": 8.815957069396973, "time_total_s": 721.6721062660217, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 333.9051914215088, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 57.44615384615384, "ram_util_percent": 60.784615384615385}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 68.15574882241285, "episode_reward_min": 12.331154279746476, "episode_reward_mean": 29.36601187542098, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.68077780713612, 27.762769750776524, 21.964078998216383, 21.831798518444128, 16.14815188584754, 43.921376143215745, 25.35593664042142, 44.92554637600846, 44.9371574690096, 14.476922050768605, 19.093891076297634, 20.07011074543384, 32.273171112417735, 34.76412082326389, 23.575335344705017, 29.194676571396457, 28.765124061064373, 17.81927624359988, 38.336067503331805, 19.090642192985726, 19.07499862431953, 19.98298154534435, 25.272897322687843, 22.217954721118808, 20.821812316746534, 55.75124990082793, 27.020772105458757, 28.584721126588402, 26.457933469319325, 22.67131943988112, 22.889972538111827, 38.83742894335633, 23.652198447061366, 21.35862346956974, 32.03498798843368, 18.187112769068047, 25.934902009690934, 24.730679666742166, 20.985821425996736, 39.18728745696098, 33.664786203431156, 33.044552897054075, 35.32694442587472, 26.55362191766586, 34.76324393572176, 17.398675085560747, 18.452972782033253, 31.083554562545054, 25.670738042399844, 47.18428041176245, 26.153191347525855, 58.25511788995311, 32.139358262817, 53.55555549398541, 20.7943696582106, 26.50349787034985, 26.829732856471907, 52.59236896970889, 20.04329566011304, 36.73634906744314, 26.046791704775544, 26.061017878623623, 35.9591337690726, 31.810020640780166, 20.3100735540564, 12.331154279746476, 32.24199843703259, 57.55868159967343, 16.519575962896504, 30.006297232596435, 18.724804724529736, 38.364313879927536, 45.54403127357976, 22.592721148236556, 20.180728798274757, 33.96474834481374, 13.115831638917301, 22.11534056064875, 18.046527006559092, 16.642498616180994, 38.01732854419943, 56.41014314495524, 22.121936934476754, 22.059438027074506, 68.15574882241285, 22.437771848574684, 32.23620595786257, 17.451179800294618, 42.87087455907145, 22.577039361756487, 21.95912060110137, 40.05359451542144, 24.842558963388882, 43.74764662144051, 34.89186955784101, 38.48717860912945, 18.35764494782052, 18.753723885887002, 20.2997017141096, 33.34539613210413], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19890848651654058, "mean_inference_ms": 0.9687568181170001, "mean_action_processing_ms": 0.04080869759010811, "mean_env_wait_ms": 0.892029563810692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1203200, "timers": {"sample_time_ms": 4356.087, "sample_throughput": 2938.417, "learn_time_ms": 4225.667, "learn_throughput": 3029.107, "update_time_ms": 1.662}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.5455072855949402, "policy_loss": -0.026834105337038637, "vf_loss": 0.5460666435956955, "vf_explained_var": 0.942491888999939, "kl": 0.011677662525326014, "entropy": -4.312411165237426, "entropy_coeff": 0.0}}, "num_steps_sampled": 1203200, "num_steps_trained": 1203200}, "done": false, "episodes_total": 1184, "training_iteration": 94, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-55", "timestamp": 1617650215, "time_this_iter_s": 8.547664642333984, "time_total_s": 730.2197709083557, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 342.4528560638428, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 57.15833333333333, "ram_util_percent": 63.69166666666667}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 68.15574882241285, "episode_reward_min": 12.331154279746476, "episode_reward_mean": 30.350243362407614, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.910833312348203, 28.963351528833545, 19.56117481451547, 18.191945448681125, 41.314483698275886, 67.84156616362934, 40.02216629485507, 36.54140378681496, 20.346363689992145, 41.872578227860544, 50.29502203796898, 37.36483114009925, 31.705793718162262, 16.358679249827198, 16.192521534502387, 33.53558610703986, 23.652198447061366, 21.35862346956974, 32.03498798843368, 18.187112769068047, 25.934902009690934, 24.730679666742166, 20.985821425996736, 39.18728745696098, 33.664786203431156, 33.044552897054075, 35.32694442587472, 26.55362191766586, 34.76324393572176, 17.398675085560747, 18.452972782033253, 31.083554562545054, 25.670738042399844, 47.18428041176245, 26.153191347525855, 58.25511788995311, 32.139358262817, 53.55555549398541, 20.7943696582106, 26.50349787034985, 26.829732856471907, 52.59236896970889, 20.04329566011304, 36.73634906744314, 26.046791704775544, 26.061017878623623, 35.9591337690726, 31.810020640780166, 20.3100735540564, 12.331154279746476, 32.24199843703259, 57.55868159967343, 16.519575962896504, 30.006297232596435, 18.724804724529736, 38.364313879927536, 45.54403127357976, 22.592721148236556, 20.180728798274757, 33.96474834481374, 13.115831638917301, 22.11534056064875, 18.046527006559092, 16.642498616180994, 38.01732854419943, 56.41014314495524, 22.121936934476754, 22.059438027074506, 68.15574882241285, 22.437771848574684, 32.23620595786257, 17.451179800294618, 42.87087455907145, 22.577039361756487, 21.95912060110137, 40.05359451542144, 24.842558963388882, 43.74764662144051, 34.89186955784101, 38.48717860912945, 18.35764494782052, 18.753723885887002, 20.2997017141096, 33.34539613210413, 42.68077780713612, 27.762769750776524, 21.964078998216383, 21.831798518444128, 16.14815188584754, 43.921376143215745, 25.35593664042142, 44.92554637600846, 44.9371574690096, 14.476922050768605, 19.093891076297634, 20.07011074543384, 32.273171112417735, 34.76412082326389, 23.575335344705017, 29.194676571396457], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20005371285172185, "mean_inference_ms": 0.9724035311253272, "mean_action_processing_ms": 0.04097955999507654, "mean_env_wait_ms": 0.8960551114102466, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1216000, "timers": {"sample_time_ms": 4284.743, "sample_throughput": 2987.344, "learn_time_ms": 4222.429, "learn_throughput": 3031.431, "update_time_ms": 1.73}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 1.0584829753637315, "policy_loss": -0.025171093242242933, "vf_loss": 1.0553241533041, "vf_explained_var": 0.9086005687713623, "kl": 0.012591076102107763, "entropy": -4.355696420669556, "entropy_coeff": 0.0}}, "num_steps_sampled": 1216000, "num_steps_trained": 1216000}, "done": false, "episodes_total": 1200, "training_iteration": 95, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-03", "timestamp": 1617650223, "time_this_iter_s": 7.755628347396851, "time_total_s": 737.9753992557526, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 350.2084844112396, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 40.64545454545455, "ram_util_percent": 63.68181818181818}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 68.15574882241285, "episode_reward_min": 12.331154279746476, "episode_reward_mean": 31.018987740347498, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.01969707557358, 32.55836390940111, 19.327318929148745, 31.835391919985597, 39.794110995864735, 24.48007908371581, 52.14707731754908, 40.78401179627365, 33.664786203431156, 33.044552897054075, 35.32694442587472, 26.55362191766586, 34.76324393572176, 17.398675085560747, 18.452972782033253, 31.083554562545054, 25.670738042399844, 47.18428041176245, 26.153191347525855, 58.25511788995311, 32.139358262817, 53.55555549398541, 20.7943696582106, 26.50349787034985, 26.829732856471907, 52.59236896970889, 20.04329566011304, 36.73634906744314, 26.046791704775544, 26.061017878623623, 35.9591337690726, 31.810020640780166, 20.3100735540564, 12.331154279746476, 32.24199843703259, 57.55868159967343, 16.519575962896504, 30.006297232596435, 18.724804724529736, 38.364313879927536, 45.54403127357976, 22.592721148236556, 20.180728798274757, 33.96474834481374, 13.115831638917301, 22.11534056064875, 18.046527006559092, 16.642498616180994, 38.01732854419943, 56.41014314495524, 22.121936934476754, 22.059438027074506, 68.15574882241285, 22.437771848574684, 32.23620595786257, 17.451179800294618, 42.87087455907145, 22.577039361756487, 21.95912060110137, 40.05359451542144, 24.842558963388882, 43.74764662144051, 34.89186955784101, 38.48717860912945, 18.35764494782052, 18.753723885887002, 20.2997017141096, 33.34539613210413, 42.68077780713612, 27.762769750776524, 21.964078998216383, 21.831798518444128, 16.14815188584754, 43.921376143215745, 25.35593664042142, 44.92554637600846, 44.9371574690096, 14.476922050768605, 19.093891076297634, 20.07011074543384, 32.273171112417735, 34.76412082326389, 23.575335344705017, 29.194676571396457, 31.910833312348203, 28.963351528833545, 19.56117481451547, 18.191945448681125, 41.314483698275886, 67.84156616362934, 40.02216629485507, 36.54140378681496, 20.346363689992145, 41.872578227860544, 50.29502203796898, 37.36483114009925, 31.705793718162262, 16.358679249827198, 16.192521534502387, 33.53558610703986], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2005283431154954, "mean_inference_ms": 0.9741069070494928, "mean_action_processing_ms": 0.04105296235980575, "mean_env_wait_ms": 0.8975789943090237, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1228800, "timers": {"sample_time_ms": 4216.709, "sample_throughput": 3035.543, "learn_time_ms": 4164.124, "learn_throughput": 3073.876, "update_time_ms": 1.735}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.3580596266686916, "policy_loss": -0.026688726553693413, "vf_loss": 0.3620562468469143, "vf_explained_var": 0.9548906683921814, "kl": 0.010085382596589625, "entropy": -4.273643050193787, "entropy_coeff": 0.0}}, "num_steps_sampled": 1228800, "num_steps_trained": 1228800}, "done": false, "episodes_total": 1208, "training_iteration": 96, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-10", "timestamp": 1617650230, "time_this_iter_s": 7.182179689407349, "time_total_s": 745.1575789451599, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 357.390664100647, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 38.040000000000006, "ram_util_percent": 63.620000000000005}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 73.1980759958046, "episode_reward_min": 12.331154279746476, "episode_reward_mean": 31.454677623011506, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.94032530367832, 59.27259861514993, 54.565078313997425, 37.089517848612985, 27.48042788653806, 27.901254064759204, 25.09956041603988, 24.18379905667869, 49.61476342420746, 25.1115509112539, 73.1980759958046, 17.66917892798183, 20.059195391611354, 18.42159387587992, 29.9333857424489, 19.57314327864901, 26.829732856471907, 52.59236896970889, 20.04329566011304, 36.73634906744314, 26.046791704775544, 26.061017878623623, 35.9591337690726, 31.810020640780166, 20.3100735540564, 12.331154279746476, 32.24199843703259, 57.55868159967343, 16.519575962896504, 30.006297232596435, 18.724804724529736, 38.364313879927536, 45.54403127357976, 22.592721148236556, 20.180728798274757, 33.96474834481374, 13.115831638917301, 22.11534056064875, 18.046527006559092, 16.642498616180994, 38.01732854419943, 56.41014314495524, 22.121936934476754, 22.059438027074506, 68.15574882241285, 22.437771848574684, 32.23620595786257, 17.451179800294618, 42.87087455907145, 22.577039361756487, 21.95912060110137, 40.05359451542144, 24.842558963388882, 43.74764662144051, 34.89186955784101, 38.48717860912945, 18.35764494782052, 18.753723885887002, 20.2997017141096, 33.34539613210413, 42.68077780713612, 27.762769750776524, 21.964078998216383, 21.831798518444128, 16.14815188584754, 43.921376143215745, 25.35593664042142, 44.92554637600846, 44.9371574690096, 14.476922050768605, 19.093891076297634, 20.07011074543384, 32.273171112417735, 34.76412082326389, 23.575335344705017, 29.194676571396457, 31.910833312348203, 28.963351528833545, 19.56117481451547, 18.191945448681125, 41.314483698275886, 67.84156616362934, 40.02216629485507, 36.54140378681496, 20.346363689992145, 41.872578227860544, 50.29502203796898, 37.36483114009925, 31.705793718162262, 16.358679249827198, 16.192521534502387, 33.53558610703986, 32.01969707557358, 32.55836390940111, 19.327318929148745, 31.835391919985597, 39.794110995864735, 24.48007908371581, 52.14707731754908, 40.78401179627365], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20107843674708575, "mean_inference_ms": 0.9760495245485284, "mean_action_processing_ms": 0.04114794899904086, "mean_env_wait_ms": 0.8995952987509406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1241600, "timers": {"sample_time_ms": 4104.141, "sample_throughput": 3118.801, "learn_time_ms": 4177.403, "learn_throughput": 3064.105, "update_time_ms": 1.696}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 1.1055620408058167, "policy_loss": -0.02146810037549585, "vf_loss": 1.0942068323493004, "vf_explained_var": 0.9190698862075806, "kl": 0.014588136496022343, "entropy": -4.327423295974731, "entropy_coeff": 0.0}}, "num_steps_sampled": 1241600, "num_steps_trained": 1241600}, "done": false, "episodes_total": 1224, "training_iteration": 97, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-18", "timestamp": 1617650238, "time_this_iter_s": 7.333669424057007, "time_total_s": 752.4912483692169, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 364.724333524704, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 42.30909090909091, "ram_util_percent": 63.69090909090908}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 73.1980759958046, "episode_reward_min": 12.331154279746476, "episode_reward_mean": 31.588928999849262, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.09805639747113, 29.6676678900414, 39.735010037763914, 28.269899625130638, 32.32340856088745, 29.799038227717396, 34.933238368737726, 26.67752912301548, 20.3100735540564, 12.331154279746476, 32.24199843703259, 57.55868159967343, 16.519575962896504, 30.006297232596435, 18.724804724529736, 38.364313879927536, 45.54403127357976, 22.592721148236556, 20.180728798274757, 33.96474834481374, 13.115831638917301, 22.11534056064875, 18.046527006559092, 16.642498616180994, 38.01732854419943, 56.41014314495524, 22.121936934476754, 22.059438027074506, 68.15574882241285, 22.437771848574684, 32.23620595786257, 17.451179800294618, 42.87087455907145, 22.577039361756487, 21.95912060110137, 40.05359451542144, 24.842558963388882, 43.74764662144051, 34.89186955784101, 38.48717860912945, 18.35764494782052, 18.753723885887002, 20.2997017141096, 33.34539613210413, 42.68077780713612, 27.762769750776524, 21.964078998216383, 21.831798518444128, 16.14815188584754, 43.921376143215745, 25.35593664042142, 44.92554637600846, 44.9371574690096, 14.476922050768605, 19.093891076297634, 20.07011074543384, 32.273171112417735, 34.76412082326389, 23.575335344705017, 29.194676571396457, 31.910833312348203, 28.963351528833545, 19.56117481451547, 18.191945448681125, 41.314483698275886, 67.84156616362934, 40.02216629485507, 36.54140378681496, 20.346363689992145, 41.872578227860544, 50.29502203796898, 37.36483114009925, 31.705793718162262, 16.358679249827198, 16.192521534502387, 33.53558610703986, 32.01969707557358, 32.55836390940111, 19.327318929148745, 31.835391919985597, 39.794110995864735, 24.48007908371581, 52.14707731754908, 40.78401179627365, 54.94032530367832, 59.27259861514993, 54.565078313997425, 37.089517848612985, 27.48042788653806, 27.901254064759204, 25.09956041603988, 24.18379905667869, 49.61476342420746, 25.1115509112539, 73.1980759958046, 17.66917892798183, 20.059195391611354, 18.42159387587992, 29.9333857424489, 19.57314327864901], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20112356957624528, "mean_inference_ms": 0.9762709639290557, "mean_action_processing_ms": 0.041170983667239806, "mean_env_wait_ms": 0.8998409083406742, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1254400, "timers": {"sample_time_ms": 3998.518, "sample_throughput": 3201.186, "learn_time_ms": 4127.033, "learn_throughput": 3101.501, "update_time_ms": 1.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.28281971137970685, "policy_loss": -0.028295993064530192, "vf_loss": 0.29021011844277383, "vf_explained_var": 0.972682774066925, "kl": 0.00929137201514095, "entropy": -4.296259651184082, "entropy_coeff": 0.0}}, "num_steps_sampled": 1254400, "num_steps_trained": 1254400}, "done": false, "episodes_total": 1232, "training_iteration": 98, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-24", "timestamp": 1617650244, "time_this_iter_s": 6.621268272399902, "time_total_s": 759.1125166416168, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 371.3456017971039, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 28.21111111111111, "ram_util_percent": 63.6888888888889}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 73.1980759958046, "episode_reward_min": 14.476922050768605, "episode_reward_mean": 33.20610682403449, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.339056853325452, 24.027893603075732, 32.62918477444714, 50.31475914759895, 47.72668488043099, 37.90418387900669, 38.20905947482215, 31.662151696063276, 31.952678723392395, 31.080639096111426, 25.61447822049497, 30.10837419602778, 47.30007177486326, 54.418683189033764, 25.028777212353113, 54.660432755145486, 38.01732854419943, 56.41014314495524, 22.121936934476754, 22.059438027074506, 68.15574882241285, 22.437771848574684, 32.23620595786257, 17.451179800294618, 42.87087455907145, 22.577039361756487, 21.95912060110137, 40.05359451542144, 24.842558963388882, 43.74764662144051, 34.89186955784101, 38.48717860912945, 18.35764494782052, 18.753723885887002, 20.2997017141096, 33.34539613210413, 42.68077780713612, 27.762769750776524, 21.964078998216383, 21.831798518444128, 16.14815188584754, 43.921376143215745, 25.35593664042142, 44.92554637600846, 44.9371574690096, 14.476922050768605, 19.093891076297634, 20.07011074543384, 32.273171112417735, 34.76412082326389, 23.575335344705017, 29.194676571396457, 31.910833312348203, 28.963351528833545, 19.56117481451547, 18.191945448681125, 41.314483698275886, 67.84156616362934, 40.02216629485507, 36.54140378681496, 20.346363689992145, 41.872578227860544, 50.29502203796898, 37.36483114009925, 31.705793718162262, 16.358679249827198, 16.192521534502387, 33.53558610703986, 32.01969707557358, 32.55836390940111, 19.327318929148745, 31.835391919985597, 39.794110995864735, 24.48007908371581, 52.14707731754908, 40.78401179627365, 54.94032530367832, 59.27259861514993, 54.565078313997425, 37.089517848612985, 27.48042788653806, 27.901254064759204, 25.09956041603988, 24.18379905667869, 49.61476342420746, 25.1115509112539, 73.1980759958046, 17.66917892798183, 20.059195391611354, 18.42159387587992, 29.9333857424489, 19.57314327864901, 48.09805639747113, 29.6676678900414, 39.735010037763914, 28.269899625130638, 32.32340856088745, 29.799038227717396, 34.933238368737726, 26.67752912301548], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20105596600129325, "mean_inference_ms": 0.9767628620401012, "mean_action_processing_ms": 0.0411962540479807, "mean_env_wait_ms": 0.9003734215485296, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1267200, "timers": {"sample_time_ms": 3940.555, "sample_throughput": 3248.274, "learn_time_ms": 4087.844, "learn_throughput": 3131.235, "update_time_ms": 1.709}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.7488136866688728, "policy_loss": -0.021929415594786405, "vf_loss": 0.7454804521799088, "vf_explained_var": 0.9427277445793152, "kl": 0.011227843998931349, "entropy": -4.345214366912842, "entropy_coeff": 0.0}}, "num_steps_sampled": 1267200, "num_steps_trained": 1267200}, "done": false, "episodes_total": 1248, "training_iteration": 99, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-32", "timestamp": 1617650252, "time_this_iter_s": 7.648455381393433, "time_total_s": 766.7609720230103, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 378.9940571784973, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 45.67272727272728, "ram_util_percent": 63.58181818181819}, "trial_id": "9a1ab_00000"}
{"episode_reward_max": 73.1980759958046, "episode_reward_min": 14.476922050768605, "episode_reward_mean": 32.483888324475075, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.44280457309973, 30.397107928429428, 23.261689229785233, 50.11414190283876, 32.59635319553652, 35.33974750837357, 27.37412569788093, 21.055850809383276, 35.803265809575386, 26.588901953170172, 23.318692906070574, 27.402463602598512, 22.842648927230062, 29.561927915110907, 28.20449349920356, 24.793570454773246, 18.35764494782052, 18.753723885887002, 20.2997017141096, 33.34539613210413, 42.68077780713612, 27.762769750776524, 21.964078998216383, 21.831798518444128, 16.14815188584754, 43.921376143215745, 25.35593664042142, 44.92554637600846, 44.9371574690096, 14.476922050768605, 19.093891076297634, 20.07011074543384, 32.273171112417735, 34.76412082326389, 23.575335344705017, 29.194676571396457, 31.910833312348203, 28.963351528833545, 19.56117481451547, 18.191945448681125, 41.314483698275886, 67.84156616362934, 40.02216629485507, 36.54140378681496, 20.346363689992145, 41.872578227860544, 50.29502203796898, 37.36483114009925, 31.705793718162262, 16.358679249827198, 16.192521534502387, 33.53558610703986, 32.01969707557358, 32.55836390940111, 19.327318929148745, 31.835391919985597, 39.794110995864735, 24.48007908371581, 52.14707731754908, 40.78401179627365, 54.94032530367832, 59.27259861514993, 54.565078313997425, 37.089517848612985, 27.48042788653806, 27.901254064759204, 25.09956041603988, 24.18379905667869, 49.61476342420746, 25.1115509112539, 73.1980759958046, 17.66917892798183, 20.059195391611354, 18.42159387587992, 29.9333857424489, 19.57314327864901, 48.09805639747113, 29.6676678900414, 39.735010037763914, 28.269899625130638, 32.32340856088745, 29.799038227717396, 34.933238368737726, 26.67752912301548, 17.339056853325452, 24.027893603075732, 32.62918477444714, 50.31475914759895, 47.72668488043099, 37.90418387900669, 38.20905947482215, 31.662151696063276, 31.952678723392395, 31.080639096111426, 25.61447822049497, 30.10837419602778, 47.30007177486326, 54.418683189033764, 25.028777212353113, 54.660432755145486], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20089328129517164, "mean_inference_ms": 0.9756264683963355, "mean_action_processing_ms": 0.04116273276233387, "mean_env_wait_ms": 0.8994753744283284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1280000, "timers": {"sample_time_ms": 3786.302, "sample_throughput": 3380.607, "learn_time_ms": 4019.286, "learn_throughput": 3184.645, "update_time_ms": 1.734}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.001115468310867559, "total_loss": 0.49153042048215867, "policy_loss": -0.02521376308053732, "vf_loss": 0.4901035189628601, "vf_explained_var": 0.961335301399231, "kl": 0.011840296648442746, "entropy": -4.392045087814331, "entropy_coeff": 0.0}}, "num_steps_sampled": 1280000, "num_steps_trained": 1280000}, "done": true, "episodes_total": 1264, "training_iteration": 100, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-39", "timestamp": 1617650259, "time_this_iter_s": 6.782434940338135, "time_total_s": 773.5434069633484, "pid": 26431, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 12584, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0011154683108675588, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9780832449501784, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.19403144783027254, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 385.77649211883545, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 27.150000000000006, "ram_util_percent": 63.6}, "trial_id": "9a1ab_00000"}
