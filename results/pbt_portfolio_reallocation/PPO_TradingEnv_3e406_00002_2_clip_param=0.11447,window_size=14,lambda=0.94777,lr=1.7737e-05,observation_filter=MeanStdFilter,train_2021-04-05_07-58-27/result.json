{"episode_reward_max": 0.11822033613676686, "episode_reward_min": -0.5737886111074733, "episode_reward_mean": -0.21874747836185468, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21257853650903846, "mean_inference_ms": 0.9719416811749653, "mean_action_processing_ms": 0.041447021625377806, "mean_env_wait_ms": 0.9690331114636553, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 8000, "timers": {"sample_time_ms": 2476.583, "sample_throughput": 3230.257, "learn_time_ms": 2403.844, "learn_throughput": 3328.003, "update_time_ms": 1.434}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0018040099816899451, "policy_loss": -0.008433715942951421, "vf_loss": 0.005730550669665847, "vf_explained_var": 0.06023602560162544, "kl": 0.0008991546023430096, "entropy": -3.2525582389226035, "entropy_coeff": 0.0}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 8, "training_iteration": 1, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-58-39", "timestamp": 1617634719, "time_this_iter_s": 4.885881662368774, "time_total_s": 4.885881662368774, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4.885881662368774, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 55.971428571428575, "ram_util_percent": 54.6}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.5737886111074733, "episode_reward_mean": -0.1329435768009127, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.215317989157892, "mean_inference_ms": 1.0142965075565114, "mean_action_processing_ms": 0.04307899092575889, "mean_env_wait_ms": 0.9925374208805178, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 16000, "timers": {"sample_time_ms": 2597.673, "sample_throughput": 3079.68, "learn_time_ms": 2277.264, "learn_throughput": 3512.988, "update_time_ms": 1.554}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.001280104061440816, "policy_loss": -0.007413519073336843, "vf_loss": 0.0056054595939164596, "vf_explained_var": 0.21122418344020844, "kl": 0.001055910103281753, "entropy": -3.2553560733795166, "entropy_coeff": 0.0}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 16, "training_iteration": 2, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-58-44", "timestamp": 1617634724, "time_this_iter_s": 4.8756444454193115, "time_total_s": 9.761526107788086, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.761526107788086, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 61.74285714285714, "ram_util_percent": 59.88571428571428}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.6044750238713306, "episode_reward_mean": -0.16938727513974614, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.059989380804106096, -0.6044750238713306, -0.5289560762628522, -0.5090918166629069, 0.1867198412632487, -0.3000176752225152, -0.10099494761797245, -0.021392295360868507, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686, -0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21242063157488822, "mean_inference_ms": 1.0155975025171147, "mean_action_processing_ms": 0.04305046733912018, "mean_env_wait_ms": 0.9827385469803934, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 24000, "timers": {"sample_time_ms": 2487.729, "sample_throughput": 3215.784, "learn_time_ms": 2132.83, "learn_throughput": 3750.886, "update_time_ms": 1.541}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0034532974370651776, "policy_loss": -0.008167033091128345, "vf_loss": 0.004386304116379174, "vf_explained_var": 0.4889206886291504, "kl": 0.0013097356542915342, "entropy": -3.258890189821758, "entropy_coeff": 0.0}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 24, "training_iteration": 3, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-58-48", "timestamp": 1617634728, "time_this_iter_s": 4.117506504058838, "time_total_s": 13.879032611846924, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.879032611846924, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.1, "ram_util_percent": 60.03333333333334}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.6044750238713306, "episode_reward_mean": -0.18941766160124862, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.24645670907531214, -0.16837410049107693, -0.19379890785527898, -0.3953201032553425, -0.1307475013886571, -0.07690346638880463, -0.44215544954133557, -0.34231432989024096, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686, -0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335, -0.059989380804106096, -0.6044750238713306, -0.5289560762628522, -0.5090918166629069, 0.1867198412632487, -0.3000176752225152, -0.10099494761797245, -0.021392295360868507], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20828374520088028, "mean_inference_ms": 1.0027949839431465, "mean_action_processing_ms": 0.042461414400772945, "mean_env_wait_ms": 0.9623870985072408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 32000, "timers": {"sample_time_ms": 2322.628, "sample_throughput": 3444.374, "learn_time_ms": 2115.246, "learn_throughput": 3782.066, "update_time_ms": 1.509}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.004126200422881142, "policy_loss": -0.008359059617514647, "vf_loss": 0.004073057859574282, "vf_explained_var": 0.6237258315086365, "kl": 0.001278392401420408, "entropy": -3.2632637894342817, "entropy_coeff": 0.0}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 32, "training_iteration": 4, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-58-52", "timestamp": 1617634732, "time_this_iter_s": 3.895287275314331, "time_total_s": 17.774319887161255, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.774319887161255, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.75, "ram_util_percent": 60.11666666666667}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.6044750238713306, "episode_reward_mean": -0.185318491495423, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.39495611905815786, 0.188164495852559, -0.4552183438613261, -0.3466984876065097, -0.2864035885597561, -0.4118168235351661, -0.3194467468957577, -0.11491111302916646, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686, -0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335, -0.059989380804106096, -0.6044750238713306, -0.5289560762628522, -0.5090918166629069, 0.1867198412632487, -0.3000176752225152, -0.10099494761797245, -0.021392295360868507, -0.24645670907531214, -0.16837410049107693, -0.19379890785527898, -0.3953201032553425, -0.1307475013886571, -0.07690346638880463, -0.44215544954133557, -0.34231432989024096], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20743369111253113, "mean_inference_ms": 1.0017884643353199, "mean_action_processing_ms": 0.04238086412923579, "mean_env_wait_ms": 0.9559861453057057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 40000, "timers": {"sample_time_ms": 2402.057, "sample_throughput": 3330.479, "learn_time_ms": 2102.943, "learn_throughput": 3804.193, "update_time_ms": 1.528}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0010185064969673043, "policy_loss": -0.005391945293734944, "vf_loss": 0.0042838525463132155, "vf_explained_var": 0.6823135614395142, "kl": 0.0014334044489447797, "entropy": -3.271058483729287, "entropy_coeff": 0.0}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 40, "training_iteration": 5, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-58-57", "timestamp": 1617634737, "time_this_iter_s": 4.779121398925781, "time_total_s": 22.553441286087036, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.553441286087036, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 59.68571428571429, "ram_util_percent": 60.114285714285714}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.6889305418458735, "episode_reward_mean": -0.19393774450565257, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6889305418458735, -0.38587105085479206, -0.30280118178006965, -0.07739156998939656, 0.21410339568367553, -0.5280065619445911, -0.04791594393175169, -0.07945862179160335, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686, -0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335, -0.059989380804106096, -0.6044750238713306, -0.5289560762628522, -0.5090918166629069, 0.1867198412632487, -0.3000176752225152, -0.10099494761797245, -0.021392295360868507, -0.24645670907531214, -0.16837410049107693, -0.19379890785527898, -0.3953201032553425, -0.1307475013886571, -0.07690346638880463, -0.44215544954133557, -0.34231432989024096, 0.39495611905815786, 0.188164495852559, -0.4552183438613261, -0.3466984876065097, -0.2864035885597561, -0.4118168235351661, -0.3194467468957577, -0.11491111302916646], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2057905221831886, "mean_inference_ms": 0.9959263221339416, "mean_action_processing_ms": 0.0421064428887765, "mean_env_wait_ms": 0.9460174727397174, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 48000, "timers": {"sample_time_ms": 2336.482, "sample_throughput": 3423.951, "learn_time_ms": 2047.188, "learn_throughput": 3907.8, "update_time_ms": 1.523}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.004063894706112998, "policy_loss": -0.008043929069702114, "vf_loss": 0.003931947662273333, "vf_explained_var": 0.7292965650558472, "kl": 0.0015387892748953567, "entropy": -3.2737709302750844, "entropy_coeff": 0.0}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 6, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-59-01", "timestamp": 1617634741, "time_this_iter_s": 3.7830870151519775, "time_total_s": 26.336528301239014, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.336528301239014, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.0, "ram_util_percent": 60.2}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.6889305418458735, "episode_reward_mean": -0.19477421966564165, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.35033734196757865, -0.29846168018974345, -0.4927827254718586, 0.19380829557679635, -0.027072841510204948, -0.3348091489971886, 0.0336146549945846, -0.32230377743941674, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686, -0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335, -0.059989380804106096, -0.6044750238713306, -0.5289560762628522, -0.5090918166629069, 0.1867198412632487, -0.3000176752225152, -0.10099494761797245, -0.021392295360868507, -0.24645670907531214, -0.16837410049107693, -0.19379890785527898, -0.3953201032553425, -0.1307475013886571, -0.07690346638880463, -0.44215544954133557, -0.34231432989024096, 0.39495611905815786, 0.188164495852559, -0.4552183438613261, -0.3466984876065097, -0.2864035885597561, -0.4118168235351661, -0.3194467468957577, -0.11491111302916646, -0.6889305418458735, -0.38587105085479206, -0.30280118178006965, -0.07739156998939656, 0.21410339568367553, -0.5280065619445911, -0.04791594393175169, -0.07945862179160335], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20493545041725433, "mean_inference_ms": 0.9920768601868563, "mean_action_processing_ms": 0.04191099477395642, "mean_env_wait_ms": 0.9387158558358202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 56000, "timers": {"sample_time_ms": 2343.374, "sample_throughput": 3413.882, "learn_time_ms": 2063.153, "learn_throughput": 3877.561, "update_time_ms": 1.51}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.006586908643680905, "policy_loss": -0.009663378524165305, "vf_loss": 0.0030496827666721647, "vf_explained_var": 0.7897593379020691, "kl": 0.0017144630315698802, "entropy": -3.280812554889255, "entropy_coeff": 0.0}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 56, "training_iteration": 7, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-59-05", "timestamp": 1617634745, "time_this_iter_s": 4.55007791519165, "time_total_s": 30.886606216430664, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.886606216430664, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 48.67142857142857, "ram_util_percent": 60.199999999999996}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.6889305418458735, "episode_reward_mean": -0.16739689147110334, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.07567010083547265, -0.18390579786843675, -0.08508543574049826, 0.35713484394680095, -0.028093839844804958, 0.4025190937641152, 0.17180979978804123, -0.3647533160844247, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686, -0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335, -0.059989380804106096, -0.6044750238713306, -0.5289560762628522, -0.5090918166629069, 0.1867198412632487, -0.3000176752225152, -0.10099494761797245, -0.021392295360868507, -0.24645670907531214, -0.16837410049107693, -0.19379890785527898, -0.3953201032553425, -0.1307475013886571, -0.07690346638880463, -0.44215544954133557, -0.34231432989024096, 0.39495611905815786, 0.188164495852559, -0.4552183438613261, -0.3466984876065097, -0.2864035885597561, -0.4118168235351661, -0.3194467468957577, -0.11491111302916646, -0.6889305418458735, -0.38587105085479206, -0.30280118178006965, -0.07739156998939656, 0.21410339568367553, -0.5280065619445911, -0.04791594393175169, -0.07945862179160335, -0.35033734196757865, -0.29846168018974345, -0.4927827254718586, 0.19380829557679635, -0.027072841510204948, -0.3348091489971886, 0.0336146549945846, -0.32230377743941674], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20493857620821282, "mean_inference_ms": 0.9917720182398299, "mean_action_processing_ms": 0.041873758961778265, "mean_env_wait_ms": 0.9357721767483824, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 64000, "timers": {"sample_time_ms": 2388.288, "sample_throughput": 3349.68, "learn_time_ms": 2038.449, "learn_throughput": 3924.553, "update_time_ms": 1.538}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0035193867478815334, "policy_loss": -0.006616089537384964, "vf_loss": 0.003085647491619937, "vf_explained_var": 0.8169577717781067, "kl": 0.0014149450645264653, "entropy": -3.2891536629389204, "entropy_coeff": 0.0}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 64, "training_iteration": 8, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-59-10", "timestamp": 1617634750, "time_this_iter_s": 4.574059963226318, "time_total_s": 35.46066617965698, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.46066617965698, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.25, "ram_util_percent": 60.199999999999996}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.6889305418458735, "episode_reward_mean": -0.1715141681781493, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.28466808248825015, -0.41774031500206854, -0.16796849753885712, -0.39140250724290326, 0.48610325570850454, -0.4562049803722119, -0.0792633496757742, -0.32447457806457697, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686, -0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335, -0.059989380804106096, -0.6044750238713306, -0.5289560762628522, -0.5090918166629069, 0.1867198412632487, -0.3000176752225152, -0.10099494761797245, -0.021392295360868507, -0.24645670907531214, -0.16837410049107693, -0.19379890785527898, -0.3953201032553425, -0.1307475013886571, -0.07690346638880463, -0.44215544954133557, -0.34231432989024096, 0.39495611905815786, 0.188164495852559, -0.4552183438613261, -0.3466984876065097, -0.2864035885597561, -0.4118168235351661, -0.3194467468957577, -0.11491111302916646, -0.6889305418458735, -0.38587105085479206, -0.30280118178006965, -0.07739156998939656, 0.21410339568367553, -0.5280065619445911, -0.04791594393175169, -0.07945862179160335, -0.35033734196757865, -0.29846168018974345, -0.4927827254718586, 0.19380829557679635, -0.027072841510204948, -0.3348091489971886, 0.0336146549945846, -0.32230377743941674, -0.07567010083547265, -0.18390579786843675, -0.08508543574049826, 0.35713484394680095, -0.028093839844804958, 0.4025190937641152, 0.17180979978804123, -0.3647533160844247], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2044585309570488, "mean_inference_ms": 0.9896336746398462, "mean_action_processing_ms": 0.041764372740037095, "mean_env_wait_ms": 0.9314526440734474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 72000, "timers": {"sample_time_ms": 2347.221, "sample_throughput": 3408.286, "learn_time_ms": 2023.363, "learn_throughput": 3953.814, "update_time_ms": 1.517}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.00515655984008123, "policy_loss": -0.007796588900779921, "vf_loss": 0.002634113998196664, "vf_explained_var": 0.8584168553352356, "kl": 0.0015143431918991227, "entropy": -3.2998663281637524, "entropy_coeff": 0.0}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 72, "training_iteration": 9, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-59-14", "timestamp": 1617634754, "time_this_iter_s": 3.9277913570404053, "time_total_s": 39.38845753669739, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.38845753669739, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 31.000000000000004, "ram_util_percent": 60.31666666666667}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.6889305418458735, "episode_reward_mean": -0.14374914438057948, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.12078396419138882, -0.07160978592191447, -0.39551038047262554, 0.2094455803902786, -0.45390338690671456, -0.03464512964321442, 0.8826099013456719, 0.5919177953975197, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686, -0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335, -0.059989380804106096, -0.6044750238713306, -0.5289560762628522, -0.5090918166629069, 0.1867198412632487, -0.3000176752225152, -0.10099494761797245, -0.021392295360868507, -0.24645670907531214, -0.16837410049107693, -0.19379890785527898, -0.3953201032553425, -0.1307475013886571, -0.07690346638880463, -0.44215544954133557, -0.34231432989024096, 0.39495611905815786, 0.188164495852559, -0.4552183438613261, -0.3466984876065097, -0.2864035885597561, -0.4118168235351661, -0.3194467468957577, -0.11491111302916646, -0.6889305418458735, -0.38587105085479206, -0.30280118178006965, -0.07739156998939656, 0.21410339568367553, -0.5280065619445911, -0.04791594393175169, -0.07945862179160335, -0.35033734196757865, -0.29846168018974345, -0.4927827254718586, 0.19380829557679635, -0.027072841510204948, -0.3348091489971886, 0.0336146549945846, -0.32230377743941674, -0.07567010083547265, -0.18390579786843675, -0.08508543574049826, 0.35713484394680095, -0.028093839844804958, 0.4025190937641152, 0.17180979978804123, -0.3647533160844247, -0.28466808248825015, -0.41774031500206854, -0.16796849753885712, -0.39140250724290326, 0.48610325570850454, -0.4562049803722119, -0.0792633496757742, -0.32447457806457697], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.204443638965692, "mean_inference_ms": 0.9894963667190695, "mean_action_processing_ms": 0.04174190569532653, "mean_env_wait_ms": 0.9295866535212298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 80000, "timers": {"sample_time_ms": 2386.428, "sample_throughput": 3352.291, "learn_time_ms": 2042.59, "learn_throughput": 3916.596, "update_time_ms": 1.513}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0040778110010756385, "policy_loss": -0.007435334240278554, "vf_loss": 0.0033540289834259993, "vf_explained_var": 0.8489755988121033, "kl": 0.001789734124146875, "entropy": -3.3102041161249556, "entropy_coeff": 0.0}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 80, "training_iteration": 10, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-59-19", "timestamp": 1617634759, "time_this_iter_s": 4.961320877075195, "time_total_s": 44.34977841377258, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.34977841377258, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 61.300000000000004, "ram_util_percent": 60.199999999999996}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.6889305418458735, "episode_reward_mean": -0.12132927251699038, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.32523983734081585, -0.35571714913902885, 0.7331830097322671, 0.6451434390634951, -0.3331697541802656, -0.24893754146790337, 0.23062606111588946, -0.17341233351406293, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686, -0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335, -0.059989380804106096, -0.6044750238713306, -0.5289560762628522, -0.5090918166629069, 0.1867198412632487, -0.3000176752225152, -0.10099494761797245, -0.021392295360868507, -0.24645670907531214, -0.16837410049107693, -0.19379890785527898, -0.3953201032553425, -0.1307475013886571, -0.07690346638880463, -0.44215544954133557, -0.34231432989024096, 0.39495611905815786, 0.188164495852559, -0.4552183438613261, -0.3466984876065097, -0.2864035885597561, -0.4118168235351661, -0.3194467468957577, -0.11491111302916646, -0.6889305418458735, -0.38587105085479206, -0.30280118178006965, -0.07739156998939656, 0.21410339568367553, -0.5280065619445911, -0.04791594393175169, -0.07945862179160335, -0.35033734196757865, -0.29846168018974345, -0.4927827254718586, 0.19380829557679635, -0.027072841510204948, -0.3348091489971886, 0.0336146549945846, -0.32230377743941674, -0.07567010083547265, -0.18390579786843675, -0.08508543574049826, 0.35713484394680095, -0.028093839844804958, 0.4025190937641152, 0.17180979978804123, -0.3647533160844247, -0.28466808248825015, -0.41774031500206854, -0.16796849753885712, -0.39140250724290326, 0.48610325570850454, -0.4562049803722119, -0.0792633496757742, -0.32447457806457697, 0.12078396419138882, -0.07160978592191447, -0.39551038047262554, 0.2094455803902786, -0.45390338690671456, -0.03464512964321442, 0.8826099013456719, 0.5919177953975197], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.204199332380302, "mean_inference_ms": 0.9887561443108283, "mean_action_processing_ms": 0.0416969380974807, "mean_env_wait_ms": 0.927337461839804, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 88000, "timers": {"sample_time_ms": 2353.217, "sample_throughput": 3399.602, "learn_time_ms": 1982.045, "learn_throughput": 4036.235, "update_time_ms": 1.513}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0030394065681667555, "policy_loss": -0.006298637150653771, "vf_loss": 0.003257861031988074, "vf_explained_var": 0.8643040657043457, "kl": 0.0014040050806388969, "entropy": -3.321622716055976, "entropy_coeff": 0.0}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 88, "training_iteration": 11, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-59-23", "timestamp": 1617634763, "time_this_iter_s": 3.948829174041748, "time_total_s": 48.29860758781433, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.29860758781433, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 37.18333333333334, "ram_util_percent": 60.26666666666667}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.0745043175507027, "episode_reward_min": -0.6889305418458735, "episode_reward_mean": -0.09991826064944727, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.019605608531672036, -0.3242871606708404, 0.5074783322016949, -0.1054387257618592, 1.025518147376753, 0.12130516065540276, -0.018763301748209393, -0.14059510143639764, 0.09083871472692029, -0.40687324235365596, -0.11369581285593111, -0.18449507119843067, -0.35203098450283876, -0.3281551557401948, -0.5737886111074733, 0.11822033613676686, -0.10013126396281746, 1.0745043175507027, -0.1818924524294142, -0.421183017344246, -0.3935440909747586, -0.08680206883277952, -0.44951145019895605, 0.18144262427250335, -0.059989380804106096, -0.6044750238713306, -0.5289560762628522, -0.5090918166629069, 0.1867198412632487, -0.3000176752225152, -0.10099494761797245, -0.021392295360868507, -0.24645670907531214, -0.16837410049107693, -0.19379890785527898, -0.3953201032553425, -0.1307475013886571, -0.07690346638880463, -0.44215544954133557, -0.34231432989024096, 0.39495611905815786, 0.188164495852559, -0.4552183438613261, -0.3466984876065097, -0.2864035885597561, -0.4118168235351661, -0.3194467468957577, -0.11491111302916646, -0.6889305418458735, -0.38587105085479206, -0.30280118178006965, -0.07739156998939656, 0.21410339568367553, -0.5280065619445911, -0.04791594393175169, -0.07945862179160335, -0.35033734196757865, -0.29846168018974345, -0.4927827254718586, 0.19380829557679635, -0.027072841510204948, -0.3348091489971886, 0.0336146549945846, -0.32230377743941674, -0.07567010083547265, -0.18390579786843675, -0.08508543574049826, 0.35713484394680095, -0.028093839844804958, 0.4025190937641152, 0.17180979978804123, -0.3647533160844247, -0.28466808248825015, -0.41774031500206854, -0.16796849753885712, -0.39140250724290326, 0.48610325570850454, -0.4562049803722119, -0.0792633496757742, -0.32447457806457697, 0.12078396419138882, -0.07160978592191447, -0.39551038047262554, 0.2094455803902786, -0.45390338690671456, -0.03464512964321442, 0.8826099013456719, 0.5919177953975197, 0.32523983734081585, -0.35571714913902885, 0.7331830097322671, 0.6451434390634951, -0.3331697541802656, -0.24893754146790337, 0.23062606111588946, -0.17341233351406293], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.203723181829799, "mean_inference_ms": 0.9869856152534188, "mean_action_processing_ms": 0.041612383536395466, "mean_env_wait_ms": 0.9242403527833624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 96000, "timers": {"sample_time_ms": 2280.387, "sample_throughput": 3508.177, "learn_time_ms": 1981.312, "learn_throughput": 4037.729, "update_time_ms": 1.495}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00048828125, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.00346012699550816, "policy_loss": -0.006900903369699206, "vf_loss": 0.003440006658257473, "vf_explained_var": 0.8718582987785339, "kl": 0.0015786562284957322, "entropy": -3.3347203845069524, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 12, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-59-27", "timestamp": 1617634767, "time_this_iter_s": 4.140401363372803, "time_total_s": 52.439008951187134, "pid": 4345, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.439008951187134, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 43.083333333333336, "ram_util_percent": 60.300000000000004}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.1568631694301117, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.09079862524560614, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16998026992653037, "mean_inference_ms": 0.8704483687699021, "mean_action_processing_ms": 0.03731354966863886, "mean_env_wait_ms": 0.8805788956679308, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 104000, "timers": {"sample_time_ms": 2662.487, "sample_throughput": 3004.71, "learn_time_ms": 2412.428, "learn_throughput": 3316.161, "update_time_ms": 1.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0006971366644378692, "policy_loss": -0.005256833641656807, "vf_loss": 0.0035991676351321594, "vf_explained_var": 0.8783026933670044, "kl": 0.0009605287757169988, "entropy": -3.3369989281608943, "entropy_coeff": 0.0}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 104, "training_iteration": 13, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-59-48", "timestamp": 1617634788, "time_this_iter_s": 5.0798022747039795, "time_total_s": 57.51881122589111, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.0798022747039795, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.5, "ram_util_percent": 59.849999999999994}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.2564250384513556, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.14267336490990595, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.22802773736504145, 0.424738486214276, -0.10969461361367094, 1.2564250384513556, -0.18952462304594608, 0.23921268138768537, 0.3357545826613244, -0.17249897809633652, -0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17189302938178241, "mean_inference_ms": 0.854010328176859, "mean_action_processing_ms": 0.03654315021438223, "mean_env_wait_ms": 0.8399004929316862, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 112000, "timers": {"sample_time_ms": 2333.655, "sample_throughput": 3428.099, "learn_time_ms": 2387.638, "learn_throughput": 3350.592, "update_time_ms": 1.643}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.003381867974346119, "policy_loss": -0.0077343155585584186, "vf_loss": 0.0037886742132878493, "vf_explained_var": 0.8825818300247192, "kl": 0.0011275445761543418, "entropy": -3.346799059519692, "entropy_coeff": 0.0}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 112, "training_iteration": 14, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-59-52", "timestamp": 1617634792, "time_this_iter_s": 4.373034954071045, "time_total_s": 61.89184617996216, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.452837228775024, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 38.56666666666667, "ram_util_percent": 60.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 1.5556276588519822, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.28659710315202275, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2723008835737337, -0.17599149584584162, 1.5556276588519822, 0.4244380702763606, 0.9208958610993876, 0.687223033905028, -0.17000120900022808, 1.0810638342296288, -0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017, -0.22802773736504145, 0.424738486214276, -0.10969461361367094, 1.2564250384513556, -0.18952462304594608, 0.23921268138768537, 0.3357545826613244, -0.17249897809633652], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17713084739115428, "mean_inference_ms": 0.8655081214752274, "mean_action_processing_ms": 0.037030149453243205, "mean_env_wait_ms": 0.8379613978094058, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 120000, "timers": {"sample_time_ms": 2339.896, "sample_throughput": 3418.955, "learn_time_ms": 2400.812, "learn_throughput": 3332.206, "update_time_ms": 1.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0022220341784376946, "policy_loss": -0.007128621939392317, "vf_loss": 0.004580687110622724, "vf_explained_var": 0.8751928210258484, "kl": 0.001303603569607413, "entropy": -3.352611462275187, "entropy_coeff": 0.0}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 120, "training_iteration": 15, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_07-59-57", "timestamp": 1617634797, "time_this_iter_s": 4.785897970199585, "time_total_s": 66.67774415016174, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.23873519897461, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.08571428571429, "ram_util_percent": 60.07142857142858}, "trial_id": "3e406_00002"}
{"episode_reward_max": 2.4248094234569058, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.38908677637469763, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.17205644970836942, 2.4248094234569058, 0.013323999950514143, 1.2109460808018948, 0.28991124733713436, 1.029899649611079, 0.12412393451617065, 0.30737558295970957, -0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017, -0.22802773736504145, 0.424738486214276, -0.10969461361367094, 1.2564250384513556, -0.18952462304594608, 0.23921268138768537, 0.3357545826613244, -0.17249897809633652, 0.2723008835737337, -0.17599149584584162, 1.5556276588519822, 0.4244380702763606, 0.9208958610993876, 0.687223033905028, -0.17000120900022808, 1.0810638342296288], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18042017459062698, "mean_inference_ms": 0.8828373688538382, "mean_action_processing_ms": 0.03777338992741826, "mean_env_wait_ms": 0.8469364903155374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 128000, "timers": {"sample_time_ms": 2413.137, "sample_throughput": 3315.187, "learn_time_ms": 2391.113, "learn_throughput": 3345.723, "update_time_ms": 1.588}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0017065048395168213, "policy_loss": -0.006708407153685887, "vf_loss": 0.004814807602780915, "vf_explained_var": 0.8855502605438232, "kl": 0.001496760789970202, "entropy": -3.362858337069315, "entropy_coeff": 0.0}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 128, "training_iteration": 16, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-00-02", "timestamp": 1617634802, "time_this_iter_s": 5.0012359619140625, "time_total_s": 71.6789801120758, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.239971160888672, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.55714285714286, "ram_util_percent": 60.10000000000001}, "trial_id": "3e406_00002"}
{"episode_reward_max": 2.6359560569810054, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.47427921736427087, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.26063281485967627, 2.6359560569810054, 0.9508139936736011, 0.6613440670636854, 1.30277746328469, 0.3963575880327097, 0.16368187026874748, 0.6700936261357526, -0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017, -0.22802773736504145, 0.424738486214276, -0.10969461361367094, 1.2564250384513556, -0.18952462304594608, 0.23921268138768537, 0.3357545826613244, -0.17249897809633652, 0.2723008835737337, -0.17599149584584162, 1.5556276588519822, 0.4244380702763606, 0.9208958610993876, 0.687223033905028, -0.17000120900022808, 1.0810638342296288, 0.17205644970836942, 2.4248094234569058, 0.013323999950514143, 1.2109460808018948, 0.28991124733713436, 1.029899649611079, 0.12412393451617065, 0.30737558295970957], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18189657568824946, "mean_inference_ms": 0.8988218788422024, "mean_action_processing_ms": 0.03820477370709012, "mean_env_wait_ms": 0.8510004403134408, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 136000, "timers": {"sample_time_ms": 2404.12, "sample_throughput": 3327.621, "learn_time_ms": 2423.814, "learn_throughput": 3300.583, "update_time_ms": 1.602}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0024696278814522045, "policy_loss": -0.008388989191088412, "vf_loss": 0.005813414859215891, "vf_explained_var": 0.8907463550567627, "kl": 0.0016951548297786051, "entropy": -3.3853684569162037, "entropy_coeff": 0.0}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 136, "training_iteration": 17, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-00-07", "timestamp": 1617634807, "time_this_iter_s": 4.928837776184082, "time_total_s": 76.60781788825989, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.168808937072754, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 46.271428571428565, "ram_util_percent": 60.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 2.6359560569810054, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.5006873812881883, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.05954840974772457, 0.33094603585120974, 0.33703961213278943, 1.0254274418401153, 2.0530418980924896, 0.45585068388051253, 0.7658990109446357, 0.03407251477272277, -0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017, -0.22802773736504145, 0.424738486214276, -0.10969461361367094, 1.2564250384513556, -0.18952462304594608, 0.23921268138768537, 0.3357545826613244, -0.17249897809633652, 0.2723008835737337, -0.17599149584584162, 1.5556276588519822, 0.4244380702763606, 0.9208958610993876, 0.687223033905028, -0.17000120900022808, 1.0810638342296288, 0.17205644970836942, 2.4248094234569058, 0.013323999950514143, 1.2109460808018948, 0.28991124733713436, 1.029899649611079, 0.12412393451617065, 0.30737558295970957, -0.26063281485967627, 2.6359560569810054, 0.9508139936736011, 0.6613440670636854, 1.30277746328469, 0.3963575880327097, 0.16368187026874748, 0.6700936261357526], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18229965767225007, "mean_inference_ms": 0.9057246067883082, "mean_action_processing_ms": 0.03834648510908357, "mean_env_wait_ms": 0.8498615362985925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 144000, "timers": {"sample_time_ms": 2342.565, "sample_throughput": 3415.06, "learn_time_ms": 2436.921, "learn_throughput": 3282.831, "update_time_ms": 1.594}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.003505510374134968, "policy_loss": -0.008706008542388205, "vf_loss": 0.005149585693808538, "vf_explained_var": 0.9076011776924133, "kl": 0.0016292026081669425, "entropy": -3.401013590040661, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 18, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-00-11", "timestamp": 1617634811, "time_this_iter_s": 4.543390989303589, "time_total_s": 81.15120887756348, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.712199926376343, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.114285714285714, "ram_util_percent": 60.08571428571429}, "trial_id": "3e406_00002"}
{"episode_reward_max": 2.6359560569810054, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.5601999680626777, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.061639302630617, 0.7402691657442795, 0.955822019764687, 1.0484006217569446, 0.25539824575911574, 0.7928891261227744, 1.3701150063020817, 1.1136704215964115, -0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017, -0.22802773736504145, 0.424738486214276, -0.10969461361367094, 1.2564250384513556, -0.18952462304594608, 0.23921268138768537, 0.3357545826613244, -0.17249897809633652, 0.2723008835737337, -0.17599149584584162, 1.5556276588519822, 0.4244380702763606, 0.9208958610993876, 0.687223033905028, -0.17000120900022808, 1.0810638342296288, 0.17205644970836942, 2.4248094234569058, 0.013323999950514143, 1.2109460808018948, 0.28991124733713436, 1.029899649611079, 0.12412393451617065, 0.30737558295970957, -0.26063281485967627, 2.6359560569810054, 0.9508139936736011, 0.6613440670636854, 1.30277746328469, 0.3963575880327097, 0.16368187026874748, 0.6700936261357526, 0.05954840974772457, 0.33094603585120974, 0.33703961213278943, 1.0254274418401153, 2.0530418980924896, 0.45585068388051253, 0.7658990109446357, 0.03407251477272277], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18297703019820047, "mean_inference_ms": 0.9124077137738283, "mean_action_processing_ms": 0.038545967721286205, "mean_env_wait_ms": 0.8510226206428851, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 152000, "timers": {"sample_time_ms": 2361.961, "sample_throughput": 3387.015, "learn_time_ms": 2428.519, "learn_throughput": 3294.189, "update_time_ms": 1.615}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.003942480909505061, "policy_loss": -0.008376648353915366, "vf_loss": 0.004407900854915617, "vf_explained_var": 0.9247618317604065, "kl": 0.0016811042488183057, "entropy": -3.4263019221169606, "entropy_coeff": 0.0}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 152, "training_iteration": 19, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-00-16", "timestamp": 1617634816, "time_this_iter_s": 4.8622212409973145, "time_total_s": 86.01343011856079, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.57442116737366, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.614285714285714, "ram_util_percent": 60.12857142857143}, "trial_id": "3e406_00002"}
{"episode_reward_max": 2.7825744424680665, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.6400273392148789, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.294477202210596, 0.6561286780470128, 1.3254193180348977, 0.5462156612913753, 0.3736074240592224, 1.3198886915670993, 2.7825744424680665, 1.2922400805640208, -0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017, -0.22802773736504145, 0.424738486214276, -0.10969461361367094, 1.2564250384513556, -0.18952462304594608, 0.23921268138768537, 0.3357545826613244, -0.17249897809633652, 0.2723008835737337, -0.17599149584584162, 1.5556276588519822, 0.4244380702763606, 0.9208958610993876, 0.687223033905028, -0.17000120900022808, 1.0810638342296288, 0.17205644970836942, 2.4248094234569058, 0.013323999950514143, 1.2109460808018948, 0.28991124733713436, 1.029899649611079, 0.12412393451617065, 0.30737558295970957, -0.26063281485967627, 2.6359560569810054, 0.9508139936736011, 0.6613440670636854, 1.30277746328469, 0.3963575880327097, 0.16368187026874748, 0.6700936261357526, 0.05954840974772457, 0.33094603585120974, 0.33703961213278943, 1.0254274418401153, 2.0530418980924896, 0.45585068388051253, 0.7658990109446357, 0.03407251477272277, 1.061639302630617, 0.7402691657442795, 0.955822019764687, 1.0484006217569446, 0.25539824575911574, 0.7928891261227744, 1.3701150063020817, 1.1136704215964115], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18374443616819064, "mean_inference_ms": 0.9198049544027616, "mean_action_processing_ms": 0.038812344457283536, "mean_env_wait_ms": 0.8544215181399419, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 160000, "timers": {"sample_time_ms": 2393.347, "sample_throughput": 3342.599, "learn_time_ms": 2424.871, "learn_throughput": 3299.145, "update_time_ms": 1.598}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.003194985083407826, "policy_loss": -0.008220186146597067, "vf_loss": 0.005012838521026193, "vf_explained_var": 0.9218478202819824, "kl": 0.0015823419782377425, "entropy": -3.4392293672713024, "entropy_coeff": 0.0}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 160, "training_iteration": 20, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-00-21", "timestamp": 1617634821, "time_this_iter_s": 5.019150733947754, "time_total_s": 91.03258085250854, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.59357190132141, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.49999999999999, "ram_util_percent": 60.10000000000001}, "trial_id": "3e406_00002"}
{"episode_reward_max": 3.7273051084241775, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.7587660487113834, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.7273051084241775, 0.7406579934398063, 1.9601994578165791, 0.8746184660740193, 0.6979492558481164, 1.8208837391904558, 3.3450992659053815, 0.5026925107688269, -0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017, -0.22802773736504145, 0.424738486214276, -0.10969461361367094, 1.2564250384513556, -0.18952462304594608, 0.23921268138768537, 0.3357545826613244, -0.17249897809633652, 0.2723008835737337, -0.17599149584584162, 1.5556276588519822, 0.4244380702763606, 0.9208958610993876, 0.687223033905028, -0.17000120900022808, 1.0810638342296288, 0.17205644970836942, 2.4248094234569058, 0.013323999950514143, 1.2109460808018948, 0.28991124733713436, 1.029899649611079, 0.12412393451617065, 0.30737558295970957, -0.26063281485967627, 2.6359560569810054, 0.9508139936736011, 0.6613440670636854, 1.30277746328469, 0.3963575880327097, 0.16368187026874748, 0.6700936261357526, 0.05954840974772457, 0.33094603585120974, 0.33703961213278943, 1.0254274418401153, 2.0530418980924896, 0.45585068388051253, 0.7658990109446357, 0.03407251477272277, 1.061639302630617, 0.7402691657442795, 0.955822019764687, 1.0484006217569446, 0.25539824575911574, 0.7928891261227744, 1.3701150063020817, 1.1136704215964115, 1.294477202210596, 0.6561286780470128, 1.3254193180348977, 0.5462156612913753, 0.3736074240592224, 1.3198886915670993, 2.7825744424680665, 1.2922400805640208], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1842977327558277, "mean_inference_ms": 0.9257780949770049, "mean_action_processing_ms": 0.0390392238725548, "mean_env_wait_ms": 0.8573623063483125, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 168000, "timers": {"sample_time_ms": 2383.271, "sample_throughput": 3356.732, "learn_time_ms": 2441.721, "learn_throughput": 3276.378, "update_time_ms": 1.615}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.0027188250410651402, "policy_loss": -0.006238091027452832, "vf_loss": 0.008951545633848697, "vf_explained_var": 0.8905335664749146, "kl": 0.0013746381219890383, "entropy": -3.456054816170344, "entropy_coeff": 0.0}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 168, "training_iteration": 21, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-00-26", "timestamp": 1617634826, "time_this_iter_s": 4.885257959365845, "time_total_s": 95.91783881187439, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.478829860687256, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 48.94285714285714, "ram_util_percent": 59.042857142857144}, "trial_id": "3e406_00002"}
{"episode_reward_max": 3.7273051084241775, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.8132945201309102, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.381596574729322, 0.9231465098320144, 0.8669612237355433, 1.5808068101056802, 1.1877920011726264, 1.252715563990697, 2.2934208419817015, 0.945966577705637, -0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017, -0.22802773736504145, 0.424738486214276, -0.10969461361367094, 1.2564250384513556, -0.18952462304594608, 0.23921268138768537, 0.3357545826613244, -0.17249897809633652, 0.2723008835737337, -0.17599149584584162, 1.5556276588519822, 0.4244380702763606, 0.9208958610993876, 0.687223033905028, -0.17000120900022808, 1.0810638342296288, 0.17205644970836942, 2.4248094234569058, 0.013323999950514143, 1.2109460808018948, 0.28991124733713436, 1.029899649611079, 0.12412393451617065, 0.30737558295970957, -0.26063281485967627, 2.6359560569810054, 0.9508139936736011, 0.6613440670636854, 1.30277746328469, 0.3963575880327097, 0.16368187026874748, 0.6700936261357526, 0.05954840974772457, 0.33094603585120974, 0.33703961213278943, 1.0254274418401153, 2.0530418980924896, 0.45585068388051253, 0.7658990109446357, 0.03407251477272277, 1.061639302630617, 0.7402691657442795, 0.955822019764687, 1.0484006217569446, 0.25539824575911574, 0.7928891261227744, 1.3701150063020817, 1.1136704215964115, 1.294477202210596, 0.6561286780470128, 1.3254193180348977, 0.5462156612913753, 0.3736074240592224, 1.3198886915670993, 2.7825744424680665, 1.2922400805640208, 3.7273051084241775, 0.7406579934398063, 1.9601994578165791, 0.8746184660740193, 0.6979492558481164, 1.8208837391904558, 3.3450992659053815, 0.5026925107688269], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18487589887671588, "mean_inference_ms": 0.9291616680779221, "mean_action_processing_ms": 0.03916835700867307, "mean_env_wait_ms": 0.8583610028872867, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 176000, "timers": {"sample_time_ms": 2344.535, "sample_throughput": 3412.19, "learn_time_ms": 2504.894, "learn_throughput": 3193.748, "update_time_ms": 1.57}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0021490207799370327, "policy_loss": -0.007363852350011704, "vf_loss": 0.005211927033665162, "vf_explained_var": 0.9374778866767883, "kl": 0.0014870483834769517, "entropy": -3.466344579817757, "entropy_coeff": 0.0}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 176, "training_iteration": 22, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-00-31", "timestamp": 1617634831, "time_this_iter_s": 5.075421094894409, "time_total_s": 100.9932599067688, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.554250955581665, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 51.15714285714286, "ram_util_percent": 55.01428571428572}, "trial_id": "3e406_00002"}
{"episode_reward_max": 3.7273051084241775, "episode_reward_min": -0.3959098969523518, "episode_reward_mean": 0.8944743224229849, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.912991854957004, 2.5546954978167777, 0.14710992431937342, 1.5918017088684042, 2.003095104088137, 2.178833838958392, 3.5597776943023334, 0.7018731394394211, -0.2309284757561999, 0.12354938580178554, -0.11148833610199982, 0.28884057649258255, -0.3959098969523518, 1.1568631694301117, -0.08362757102567897, -0.02090984992340017, -0.22802773736504145, 0.424738486214276, -0.10969461361367094, 1.2564250384513556, -0.18952462304594608, 0.23921268138768537, 0.3357545826613244, -0.17249897809633652, 0.2723008835737337, -0.17599149584584162, 1.5556276588519822, 0.4244380702763606, 0.9208958610993876, 0.687223033905028, -0.17000120900022808, 1.0810638342296288, 0.17205644970836942, 2.4248094234569058, 0.013323999950514143, 1.2109460808018948, 0.28991124733713436, 1.029899649611079, 0.12412393451617065, 0.30737558295970957, -0.26063281485967627, 2.6359560569810054, 0.9508139936736011, 0.6613440670636854, 1.30277746328469, 0.3963575880327097, 0.16368187026874748, 0.6700936261357526, 0.05954840974772457, 0.33094603585120974, 0.33703961213278943, 1.0254274418401153, 2.0530418980924896, 0.45585068388051253, 0.7658990109446357, 0.03407251477272277, 1.061639302630617, 0.7402691657442795, 0.955822019764687, 1.0484006217569446, 0.25539824575911574, 0.7928891261227744, 1.3701150063020817, 1.1136704215964115, 1.294477202210596, 0.6561286780470128, 1.3254193180348977, 0.5462156612913753, 0.3736074240592224, 1.3198886915670993, 2.7825744424680665, 1.2922400805640208, 3.7273051084241775, 0.7406579934398063, 1.9601994578165791, 0.8746184660740193, 0.6979492558481164, 1.8208837391904558, 3.3450992659053815, 0.5026925107688269, 1.381596574729322, 0.9231465098320144, 0.8669612237355433, 1.5808068101056802, 1.1877920011726264, 1.252715563990697, 2.2934208419817015, 0.945966577705637], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18571168815010475, "mean_inference_ms": 0.9336282154865772, "mean_action_processing_ms": 0.039352990250460844, "mean_env_wait_ms": 0.8609161769516702, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 184000, "timers": {"sample_time_ms": 2356.757, "sample_throughput": 3394.495, "learn_time_ms": 2505.632, "learn_throughput": 3192.808, "update_time_ms": 1.567}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.0033993135014223673, "policy_loss": -0.006631994220827307, "vf_loss": 0.01002958994950094, "vf_explained_var": 0.9025659561157227, "kl": 0.0017584689656302097, "entropy": -3.492344629196894, "entropy_coeff": 0.0}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 184, "training_iteration": 23, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-00-37", "timestamp": 1617634837, "time_this_iter_s": 5.211937665939331, "time_total_s": 106.20519757270813, "pid": 5250, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.766188621520996, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 57.614285714285714, "ram_util_percent": 59.9}, "trial_id": "3e406_00002"}
{"episode_reward_max": 4.470506422323594, "episode_reward_min": 0.9662101117478645, "episode_reward_mean": 2.3270116038257074, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22900440952518247, "mean_inference_ms": 1.0833511878917745, "mean_action_processing_ms": 0.04598361390692133, "mean_env_wait_ms": 1.0849455377081414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 192000, "timers": {"sample_time_ms": 3109.544, "sample_throughput": 2572.724, "learn_time_ms": 2418.411, "learn_throughput": 3307.957, "update_time_ms": 1.378}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.004460823766532398, "policy_loss": -0.006351206969055865, "vf_loss": 0.009968688260645621, "vf_explained_var": 0.9205251336097717, "kl": 0.0008433429757133126, "entropy": -3.511619215919858, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 192, "training_iteration": 24, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-02-37", "timestamp": 1617634957, "time_this_iter_s": 5.532090663909912, "time_total_s": 111.73728823661804, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.532090663909912, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 58.0375, "ram_util_percent": 58.7875}, "trial_id": "3e406_00002"}
{"episode_reward_max": 4.470506422323594, "episode_reward_min": 0.9011551306255308, "episode_reward_mean": 1.9922075527528242, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9958952424866119, 0.916900398451683, 1.4675807246360542, 1.8365542288554946, 3.228466670519323, 2.50185575310783, 0.9011551306255308, 1.4108198647570016, 4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22797292383887846, "mean_inference_ms": 1.0601172484605221, "mean_action_processing_ms": 0.045130576076074805, "mean_env_wait_ms": 1.040792754659851, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 200000, "timers": {"sample_time_ms": 2740.347, "sample_throughput": 2919.339, "learn_time_ms": 2555.267, "learn_throughput": 3130.789, "update_time_ms": 1.529}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0009103912919286698, "policy_loss": -0.008279247593785089, "vf_loss": 0.006710003824934127, "vf_explained_var": 0.9450383186340332, "kl": 0.001317704113067261, "entropy": -3.523163129412939, "entropy_coeff": 0.0}}, "num_steps_sampled": 200000, "num_steps_trained": 200000}, "done": false, "episodes_total": 200, "training_iteration": 25, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-02-42", "timestamp": 1617634962, "time_this_iter_s": 5.069522857666016, "time_total_s": 116.80681109428406, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.601613521575928, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 51.325, "ram_util_percent": 55.6625}, "trial_id": "3e406_00002"}
{"episode_reward_max": 4.470506422323594, "episode_reward_min": 0.9011551306255308, "episode_reward_mean": 1.9594821161627103, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6030181219886348, 1.0473679665993139, 1.9020052580754157, 2.5136740309566536, 0.9110245085353477, 3.2191274783362234, 2.749543940948517, 1.2064886384197564, 4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888, 0.9958952424866119, 0.916900398451683, 1.4675807246360542, 1.8365542288554946, 3.228466670519323, 2.50185575310783, 0.9011551306255308, 1.4108198647570016], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22910279229781047, "mean_inference_ms": 1.0631349826712626, "mean_action_processing_ms": 0.04525739941031393, "mean_env_wait_ms": 1.032675680702481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 208000, "timers": {"sample_time_ms": 2731.679, "sample_throughput": 2928.602, "learn_time_ms": 2628.349, "learn_throughput": 3043.736, "update_time_ms": 1.544}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 1.7737077411020705e-05, "total_loss": -0.0010387862973388225, "policy_loss": -0.008753199847267261, "vf_loss": 0.007257832968164058, "vf_explained_var": 0.9432835578918457, "kl": 0.0018263183061092618, "entropy": -3.551575149808611, "entropy_coeff": 0.0}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 208, "training_iteration": 26, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-02-48", "timestamp": 1617634968, "time_this_iter_s": 5.49460506439209, "time_total_s": 122.30141615867615, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.096218585968018, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 59.724999999999994, "ram_util_percent": 60.0125}, "trial_id": "3e406_00002"}
{"episode_reward_max": 4.470506422323594, "episode_reward_min": 0.833113210803696, "episode_reward_mean": 2.005282720703403, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.6485562826249147, 1.2678363126347474, 2.6968231248782466, 1.0034727835056687, 2.7566840416922, 2.1972390117229614, 0.833113210803696, 2.737751506741404, 4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888, 0.9958952424866119, 0.916900398451683, 1.4675807246360542, 1.8365542288554946, 3.228466670519323, 2.50185575310783, 0.9011551306255308, 1.4108198647570016, 1.6030181219886348, 1.0473679665993139, 1.9020052580754157, 2.5136740309566536, 0.9110245085353477, 3.2191274783362234, 2.749543940948517, 1.2064886384197564], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22539615605815033, "mean_inference_ms": 1.0489850883754894, "mean_action_processing_ms": 0.044632707220610274, "mean_env_wait_ms": 1.0110142200819119, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 216000, "timers": {"sample_time_ms": 2550.607, "sample_throughput": 3136.508, "learn_time_ms": 2538.424, "learn_throughput": 3151.562, "update_time_ms": 1.598}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.0016580239559213321, "policy_loss": -0.006767135475658708, "vf_loss": 0.008232974949928503, "vf_explained_var": 0.9375289678573608, "kl": 0.0015374767106203805, "entropy": -3.5666007163032654, "entropy_coeff": 0.0}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 216, "training_iteration": 27, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-02-52", "timestamp": 1617634972, "time_this_iter_s": 4.282064914703369, "time_total_s": 126.58348107337952, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.378283500671387, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.533333333333335, "ram_util_percent": 60.18333333333333}, "trial_id": "3e406_00002"}
{"episode_reward_max": 4.470506422323594, "episode_reward_min": 0.833113210803696, "episode_reward_mean": 2.0218235058132863, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.032314303055455, 1.5925150269546653, 1.4083308247950308, 2.8711508680526263, 3.348039262584093, 3.037929026085953, 1.3851775512797357, 2.028436307214998, 4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888, 0.9958952424866119, 0.916900398451683, 1.4675807246360542, 1.8365542288554946, 3.228466670519323, 2.50185575310783, 0.9011551306255308, 1.4108198647570016, 1.6030181219886348, 1.0473679665993139, 1.9020052580754157, 2.5136740309566536, 0.9110245085353477, 3.2191274783362234, 2.749543940948517, 1.2064886384197564, 3.6485562826249147, 1.2678363126347474, 2.6968231248782466, 1.0034727835056687, 2.7566840416922, 2.1972390117229614, 0.833113210803696, 2.737751506741404], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2221214463656173, "mean_inference_ms": 1.0392782387477149, "mean_action_processing_ms": 0.04393485813463525, "mean_env_wait_ms": 0.9896992433395632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 224000, "timers": {"sample_time_ms": 2480.622, "sample_throughput": 3224.998, "learn_time_ms": 2579.419, "learn_throughput": 3101.473, "update_time_ms": 1.56}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.0027474788209748647, "policy_loss": -0.007262044992770941, "vf_loss": 0.009909749614991366, "vf_explained_var": 0.932694673538208, "kl": 0.001596391626027605, "entropy": -3.592727191864498, "entropy_coeff": 0.0}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 224, "training_iteration": 28, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-02-57", "timestamp": 1617634977, "time_this_iter_s": 4.949996471405029, "time_total_s": 131.53347754478455, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.328279972076416, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.98571428571428, "ram_util_percent": 60.199999999999996}, "trial_id": "3e406_00002"}
{"episode_reward_max": 4.743131666317864, "episode_reward_min": 0.833113210803696, "episode_reward_mean": 2.0819338617337055, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2112114130878076, 1.845447780454506, 1.655531530664332, 1.8536799197862246, 4.743131666317864, 1.2735658739703593, 4.020483479122595, 2.4568334672827166, 4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888, 0.9958952424866119, 0.916900398451683, 1.4675807246360542, 1.8365542288554946, 3.228466670519323, 2.50185575310783, 0.9011551306255308, 1.4108198647570016, 1.6030181219886348, 1.0473679665993139, 1.9020052580754157, 2.5136740309566536, 0.9110245085353477, 3.2191274783362234, 2.749543940948517, 1.2064886384197564, 3.6485562826249147, 1.2678363126347474, 2.6968231248782466, 1.0034727835056687, 2.7566840416922, 2.1972390117229614, 0.833113210803696, 2.737751506741404, 1.032314303055455, 1.5925150269546653, 1.4083308247950308, 2.8711508680526263, 3.348039262584093, 3.037929026085953, 1.3851775512797357, 2.028436307214998], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2202720652066509, "mean_inference_ms": 1.0366604538203326, "mean_action_processing_ms": 0.0436518201108765, "mean_env_wait_ms": 0.9793391879990186, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 232000, "timers": {"sample_time_ms": 2537.984, "sample_throughput": 3152.108, "learn_time_ms": 2529.384, "learn_throughput": 3162.826, "update_time_ms": 1.548}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.002314201497014553, "policy_loss": -0.006462897972336837, "vf_loss": 0.008722450103729016, "vf_explained_var": 0.9413004517555237, "kl": 0.0017487076739411032, "entropy": -3.618120204834711, "entropy_coeff": 0.0}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 232, "training_iteration": 29, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-03-02", "timestamp": 1617634982, "time_this_iter_s": 5.1095871925354, "time_total_s": 136.64306473731995, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.437867164611816, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 51.65714285714286, "ram_util_percent": 60.24285714285715}, "trial_id": "3e406_00002"}
{"episode_reward_max": 4.9267264600914285, "episode_reward_min": 0.7384477474107316, "episode_reward_mean": 2.165336374246777, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.033123177245002, 3.3733916547614857, 2.4249015082398864, 1.4190411142387478, 2.3081930075075716, 0.7384477474107316, 2.102186925106818, 4.9267264600914285, 4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888, 0.9958952424866119, 0.916900398451683, 1.4675807246360542, 1.8365542288554946, 3.228466670519323, 2.50185575310783, 0.9011551306255308, 1.4108198647570016, 1.6030181219886348, 1.0473679665993139, 1.9020052580754157, 2.5136740309566536, 0.9110245085353477, 3.2191274783362234, 2.749543940948517, 1.2064886384197564, 3.6485562826249147, 1.2678363126347474, 2.6968231248782466, 1.0034727835056687, 2.7566840416922, 2.1972390117229614, 0.833113210803696, 2.737751506741404, 1.032314303055455, 1.5925150269546653, 1.4083308247950308, 2.8711508680526263, 3.348039262584093, 3.037929026085953, 1.3851775512797357, 2.028436307214998, 1.2112114130878076, 1.845447780454506, 1.655531530664332, 1.8536799197862246, 4.743131666317864, 1.2735658739703593, 4.020483479122595, 2.4568334672827166], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21815403370673062, "mean_inference_ms": 1.030263727732225, "mean_action_processing_ms": 0.04327641744125416, "mean_env_wait_ms": 0.967565218547802, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 240000, "timers": {"sample_time_ms": 2444.47, "sample_throughput": 3272.694, "learn_time_ms": 2481.809, "learn_throughput": 3223.455, "update_time_ms": 1.562}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.0020168758633117827, "policy_loss": -0.008864722953784087, "vf_loss": 0.010851343421058523, "vf_explained_var": 0.9329215288162231, "kl": 0.0019362235888986596, "entropy": -3.6498613433232383, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 240, "training_iteration": 30, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-03-06", "timestamp": 1617634986, "time_this_iter_s": 4.085451364517212, "time_total_s": 140.72851610183716, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.52331852912903, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.099999999999998, "ram_util_percent": 60.300000000000004}, "trial_id": "3e406_00002"}
{"episode_reward_max": 7.2795180102562185, "episode_reward_min": 0.7384477474107316, "episode_reward_mean": 2.29447537521848, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.3597245435691105, 4.554255896000566, 2.332001189431192, 7.2795180102562185, 1.5297322296956377, 2.6732249209906733, 1.8826056280257455, 2.9765246381940615, 4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888, 0.9958952424866119, 0.916900398451683, 1.4675807246360542, 1.8365542288554946, 3.228466670519323, 2.50185575310783, 0.9011551306255308, 1.4108198647570016, 1.6030181219886348, 1.0473679665993139, 1.9020052580754157, 2.5136740309566536, 0.9110245085353477, 3.2191274783362234, 2.749543940948517, 1.2064886384197564, 3.6485562826249147, 1.2678363126347474, 2.6968231248782466, 1.0034727835056687, 2.7566840416922, 2.1972390117229614, 0.833113210803696, 2.737751506741404, 1.032314303055455, 1.5925150269546653, 1.4083308247950308, 2.8711508680526263, 3.348039262584093, 3.037929026085953, 1.3851775512797357, 2.028436307214998, 1.2112114130878076, 1.845447780454506, 1.655531530664332, 1.8536799197862246, 4.743131666317864, 1.2735658739703593, 4.020483479122595, 2.4568334672827166, 4.033123177245002, 3.3733916547614857, 2.4249015082398864, 1.4190411142387478, 2.3081930075075716, 0.7384477474107316, 2.102186925106818, 4.9267264600914285], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21710692842473905, "mean_inference_ms": 1.0270035407105524, "mean_action_processing_ms": 0.043072950770746986, "mean_env_wait_ms": 0.9604815016378554, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 248000, "timers": {"sample_time_ms": 2478.352, "sample_throughput": 3227.951, "learn_time_ms": 2495.631, "learn_throughput": 3205.602, "update_time_ms": 1.54}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.00567890495978414, "policy_loss": -0.00733935475970308, "vf_loss": 0.013007232121058874, "vf_explained_var": 0.933060884475708, "kl": 0.0014117406939880715, "entropy": -3.673527399698893, "entropy_coeff": 0.0}}, "num_steps_sampled": 248000, "num_steps_trained": 248000}, "done": false, "episodes_total": 248, "training_iteration": 31, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-03-11", "timestamp": 1617634991, "time_this_iter_s": 5.314130067825317, "time_total_s": 146.04264616966248, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.837448596954346, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 56.15, "ram_util_percent": 60.3}, "trial_id": "3e406_00002"}
{"episode_reward_max": 7.2795180102562185, "episode_reward_min": 0.7384477474107316, "episode_reward_mean": 2.354478232049329, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.783590767241682, 4.156222646222999, 2.4021610388288623, 2.8809891487859303, 1.9250988260776127, 3.8416610914151095, 1.45980417680105, 2.2264809981956977, 4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888, 0.9958952424866119, 0.916900398451683, 1.4675807246360542, 1.8365542288554946, 3.228466670519323, 2.50185575310783, 0.9011551306255308, 1.4108198647570016, 1.6030181219886348, 1.0473679665993139, 1.9020052580754157, 2.5136740309566536, 0.9110245085353477, 3.2191274783362234, 2.749543940948517, 1.2064886384197564, 3.6485562826249147, 1.2678363126347474, 2.6968231248782466, 1.0034727835056687, 2.7566840416922, 2.1972390117229614, 0.833113210803696, 2.737751506741404, 1.032314303055455, 1.5925150269546653, 1.4083308247950308, 2.8711508680526263, 3.348039262584093, 3.037929026085953, 1.3851775512797357, 2.028436307214998, 1.2112114130878076, 1.845447780454506, 1.655531530664332, 1.8536799197862246, 4.743131666317864, 1.2735658739703593, 4.020483479122595, 2.4568334672827166, 4.033123177245002, 3.3733916547614857, 2.4249015082398864, 1.4190411142387478, 2.3081930075075716, 0.7384477474107316, 2.102186925106818, 4.9267264600914285, 2.3597245435691105, 4.554255896000566, 2.332001189431192, 7.2795180102562185, 1.5297322296956377, 2.6732249209906733, 1.8826056280257455, 2.9765246381940615], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21590132042723129, "mean_inference_ms": 1.0237416854629897, "mean_action_processing_ms": 0.04289094213683975, "mean_env_wait_ms": 0.9544112132655154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 256000, "timers": {"sample_time_ms": 2468.274, "sample_throughput": 3241.131, "learn_time_ms": 2475.888, "learn_throughput": 3231.163, "update_time_ms": 1.587}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.001970998514147978, "policy_loss": -0.007840822687343, "vf_loss": 0.009806079878693535, "vf_explained_var": 0.9480645060539246, "kl": 0.0014698409368210132, "entropy": -3.6902794989328536, "entropy_coeff": 0.0}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 256, "training_iteration": 32, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-03-16", "timestamp": 1617634996, "time_this_iter_s": 4.71239447593689, "time_total_s": 150.75504064559937, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.549843072891235, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 37.050000000000004, "ram_util_percent": 60.300000000000004}, "trial_id": "3e406_00002"}
{"episode_reward_max": 7.2795180102562185, "episode_reward_min": 0.7384477474107316, "episode_reward_mean": 2.532186196247147, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.4658732747388035, 2.8864079375698846, 7.182784342019081, 3.9035746902260717, 2.0853377562240594, 5.32520465638946, 4.112622158503265, 2.0906581765494336, 4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888, 0.9958952424866119, 0.916900398451683, 1.4675807246360542, 1.8365542288554946, 3.228466670519323, 2.50185575310783, 0.9011551306255308, 1.4108198647570016, 1.6030181219886348, 1.0473679665993139, 1.9020052580754157, 2.5136740309566536, 0.9110245085353477, 3.2191274783362234, 2.749543940948517, 1.2064886384197564, 3.6485562826249147, 1.2678363126347474, 2.6968231248782466, 1.0034727835056687, 2.7566840416922, 2.1972390117229614, 0.833113210803696, 2.737751506741404, 1.032314303055455, 1.5925150269546653, 1.4083308247950308, 2.8711508680526263, 3.348039262584093, 3.037929026085953, 1.3851775512797357, 2.028436307214998, 1.2112114130878076, 1.845447780454506, 1.655531530664332, 1.8536799197862246, 4.743131666317864, 1.2735658739703593, 4.020483479122595, 2.4568334672827166, 4.033123177245002, 3.3733916547614857, 2.4249015082398864, 1.4190411142387478, 2.3081930075075716, 0.7384477474107316, 2.102186925106818, 4.9267264600914285, 2.3597245435691105, 4.554255896000566, 2.332001189431192, 7.2795180102562185, 1.5297322296956377, 2.6732249209906733, 1.8826056280257455, 2.9765246381940615, 3.783590767241682, 4.156222646222999, 2.4021610388288623, 2.8809891487859303, 1.9250988260776127, 3.8416610914151095, 1.45980417680105, 2.2264809981956977], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21455821125960178, "mean_inference_ms": 1.019386157316254, "mean_action_processing_ms": 0.04267509530966361, "mean_env_wait_ms": 0.9478644281656653, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 264000, "timers": {"sample_time_ms": 2422.567, "sample_throughput": 3302.282, "learn_time_ms": 2481.615, "learn_throughput": 3223.708, "update_time_ms": 1.57}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.013125154618469496, "policy_loss": -0.00723590428334853, "vf_loss": 0.020357418480137036, "vf_explained_var": 0.914985179901123, "kl": 0.0018629855938285353, "entropy": -3.7303279997810486, "entropy_coeff": 0.0}}, "num_steps_sampled": 264000, "num_steps_trained": 264000}, "done": false, "episodes_total": 264, "training_iteration": 33, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-03-21", "timestamp": 1617635001, "time_this_iter_s": 4.55071496963501, "time_total_s": 155.30575561523438, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.100558042526245, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 37.68571428571429, "ram_util_percent": 60.22857142857142}, "trial_id": "3e406_00002"}
{"episode_reward_max": 7.2795180102562185, "episode_reward_min": 0.7384477474107316, "episode_reward_mean": 2.69257814691025, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.1883303191299697, 6.564692745026691, 4.5471816394301765, 4.834652338753926, 2.883586170026341, 4.456242323183795, 3.5109313789942327, 5.386364313785114, 4.470506422323594, 1.908008795710988, 1.4779089982691973, 2.2494786210654554, 0.9662101117478645, 3.981776416099123, 1.3285418565825498, 2.233661608806888, 0.9958952424866119, 0.916900398451683, 1.4675807246360542, 1.8365542288554946, 3.228466670519323, 2.50185575310783, 0.9011551306255308, 1.4108198647570016, 1.6030181219886348, 1.0473679665993139, 1.9020052580754157, 2.5136740309566536, 0.9110245085353477, 3.2191274783362234, 2.749543940948517, 1.2064886384197564, 3.6485562826249147, 1.2678363126347474, 2.6968231248782466, 1.0034727835056687, 2.7566840416922, 2.1972390117229614, 0.833113210803696, 2.737751506741404, 1.032314303055455, 1.5925150269546653, 1.4083308247950308, 2.8711508680526263, 3.348039262584093, 3.037929026085953, 1.3851775512797357, 2.028436307214998, 1.2112114130878076, 1.845447780454506, 1.655531530664332, 1.8536799197862246, 4.743131666317864, 1.2735658739703593, 4.020483479122595, 2.4568334672827166, 4.033123177245002, 3.3733916547614857, 2.4249015082398864, 1.4190411142387478, 2.3081930075075716, 0.7384477474107316, 2.102186925106818, 4.9267264600914285, 2.3597245435691105, 4.554255896000566, 2.332001189431192, 7.2795180102562185, 1.5297322296956377, 2.6732249209906733, 1.8826056280257455, 2.9765246381940615, 3.783590767241682, 4.156222646222999, 2.4021610388288623, 2.8809891487859303, 1.9250988260776127, 3.8416610914151095, 1.45980417680105, 2.2264809981956977, 5.4658732747388035, 2.8864079375698846, 7.182784342019081, 3.9035746902260717, 2.0853377562240594, 5.32520465638946, 4.112622158503265, 2.0906581765494336], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21367923191854324, "mean_inference_ms": 1.0170935695286734, "mean_action_processing_ms": 0.042558351911305865, "mean_env_wait_ms": 0.9438775284030796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 272000, "timers": {"sample_time_ms": 2383.855, "sample_throughput": 3355.909, "learn_time_ms": 2482.122, "learn_throughput": 3223.048, "update_time_ms": 1.589}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.008564328811767082, "policy_loss": -0.007690739862266041, "vf_loss": 0.016253279477712653, "vf_explained_var": 0.9387643337249756, "kl": 0.0018322575922375397, "entropy": -3.7675023495204867, "entropy_coeff": 0.0}}, "num_steps_sampled": 272000, "num_steps_trained": 272000}, "done": false, "episodes_total": 272, "training_iteration": 34, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-03-26", "timestamp": 1617635006, "time_this_iter_s": 5.15206241607666, "time_total_s": 160.45781803131104, "pid": 6537, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 54.252620458602905, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 56.62857142857143, "ram_util_percent": 60.228571428571435}, "trial_id": "3e406_00002"}
{"episode_reward_max": 8.550000329175173, "episode_reward_min": 3.8168501174442886, "episode_reward_mean": 6.012050758065799, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18519434061917395, "mean_inference_ms": 0.9977387024329736, "mean_action_processing_ms": 0.042144919966127015, "mean_env_wait_ms": 1.011992280895298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 280000, "timers": {"sample_time_ms": 2718.943, "sample_throughput": 2942.32, "learn_time_ms": 2393.401, "learn_throughput": 3342.523, "update_time_ms": 1.479}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.024170895853626823, "policy_loss": -0.0064711132870307045, "vf_loss": 0.029526125521413864, "vf_explained_var": 0.921528160572052, "kl": 0.001115883048254228, "entropy": -3.7896050536443315, "entropy_coeff": 0.0}}, "num_steps_sampled": 280000, "num_steps_trained": 280000}, "done": false, "episodes_total": 280, "training_iteration": 35, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-13", "timestamp": 1617635053, "time_this_iter_s": 5.11682915687561, "time_total_s": 165.57464718818665, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.11682915687561, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 50.225, "ram_util_percent": 59.9625}, "trial_id": "3e406_00002"}
{"episode_reward_max": 8.550000329175173, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 5.396691437962048, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18119016619674472, "mean_inference_ms": 0.9599595863165842, "mean_action_processing_ms": 0.04050487737984532, "mean_env_wait_ms": 0.9481378400360492, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 288000, "timers": {"sample_time_ms": 2389.912, "sample_throughput": 3347.403, "learn_time_ms": 2432.428, "learn_throughput": 3288.895, "update_time_ms": 1.615}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.007042103727895116, "policy_loss": -0.011603174021556265, "vf_loss": 0.01796218001889804, "vf_explained_var": 0.9516070485115051, "kl": 0.0013662027028788412, "entropy": -3.817543449855986, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 288, "training_iteration": 36, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-17", "timestamp": 1617635057, "time_this_iter_s": 4.538467168807983, "time_total_s": 170.11311435699463, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.655296325683594, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.43333333333333, "ram_util_percent": 60.06666666666667}, "trial_id": "3e406_00002"}
{"episode_reward_max": 11.174876747704207, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 5.642521311567182, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.180974409480809, "mean_inference_ms": 0.9358490146590519, "mean_action_processing_ms": 0.03946868284167828, "mean_env_wait_ms": 0.9093305611697113, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 296000, "timers": {"sample_time_ms": 2252.956, "sample_throughput": 3550.891, "learn_time_ms": 2426.749, "learn_throughput": 3296.592, "update_time_ms": 1.6}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.028369842215426384, "policy_loss": -0.00710025793384938, "vf_loss": 0.03512463077074952, "vf_explained_var": 0.9189139008522034, "kl": 0.00138187659941318, "entropy": -3.8411488343798923, "entropy_coeff": 0.0}}, "num_steps_sampled": 296000, "num_steps_trained": 296000}, "done": false, "episodes_total": 296, "training_iteration": 37, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-22", "timestamp": 1617635062, "time_this_iter_s": 4.399898052215576, "time_total_s": 174.5130124092102, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.05519437789917, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 32.07142857142857, "ram_util_percent": 56.442857142857136}, "trial_id": "3e406_00002"}
{"episode_reward_max": 11.174876747704207, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 5.53482361705036, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17940241414325964, "mean_inference_ms": 0.9169209154324212, "mean_action_processing_ms": 0.03863558225728761, "mean_env_wait_ms": 0.8809203651640019, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 304000, "timers": {"sample_time_ms": 2142.196, "sample_throughput": 3734.485, "learn_time_ms": 2354.775, "learn_throughput": 3397.352, "update_time_ms": 1.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.011781815106847457, "policy_loss": -0.006492507895306935, "vf_loss": 0.018056623415932768, "vf_explained_var": 0.9583032727241516, "kl": 0.001741606998996484, "entropy": -3.8711220082782565, "entropy_coeff": 0.0}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 304, "training_iteration": 38, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-26", "timestamp": 1617635066, "time_this_iter_s": 3.9545950889587402, "time_total_s": 178.46760749816895, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18.00978946685791, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.16, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 12.049357227549477, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 5.8476102057308355, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17757256194623286, "mean_inference_ms": 0.9074204293270911, "mean_action_processing_ms": 0.03795263950397315, "mean_env_wait_ms": 0.8586425144992461, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 312000, "timers": {"sample_time_ms": 2089.582, "sample_throughput": 3828.517, "learn_time_ms": 2346.739, "learn_throughput": 3408.985, "update_time_ms": 1.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.026291032706106467, "policy_loss": -0.006772399628682742, "vf_loss": 0.03295961072638867, "vf_explained_var": 0.9336854219436646, "kl": 0.0016611488443607138, "entropy": -3.8975523010132807, "entropy_coeff": 0.0}}, "num_steps_sampled": 312000, "num_steps_trained": 312000}, "done": false, "episodes_total": 312, "training_iteration": 39, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-30", "timestamp": 1617635070, "time_this_iter_s": 4.1995837688446045, "time_total_s": 182.66719126701355, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.209373235702515, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.250000000000004, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 17.855850754235043, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 6.059822038336553, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1758598264054079, "mean_inference_ms": 0.898266562718217, "mean_action_processing_ms": 0.037390129940848615, "mean_env_wait_ms": 0.8407967326713859, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 320000, "timers": {"sample_time_ms": 2035.819, "sample_throughput": 3929.623, "learn_time_ms": 2325.626, "learn_throughput": 3439.933, "update_time_ms": 1.629}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.04433545836853602, "policy_loss": -0.0055654942989349365, "vf_loss": 0.049847016184930766, "vf_explained_var": 0.9148947596549988, "kl": 0.0017259733840113594, "entropy": -3.9179848337930347, "entropy_coeff": 0.0}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 320, "training_iteration": 40, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-34", "timestamp": 1617635074, "time_this_iter_s": 3.992203712463379, "time_total_s": 186.65939497947693, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.201576948165894, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 21.76666666666667, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 17.855850754235043, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 6.190750807002251, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.685329883307533, 2.6829275145066034, 5.186484954381777, 12.676024659163176, 4.694355631098144, 8.489099316431446, 7.208013792774066, 7.188351600308767, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1743997102588875, "mean_inference_ms": 0.8901661453607845, "mean_action_processing_ms": 0.03694205666521054, "mean_env_wait_ms": 0.8266602360546983, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 328000, "timers": {"sample_time_ms": 1998.168, "sample_throughput": 4003.668, "learn_time_ms": 2299.494, "learn_throughput": 3479.026, "update_time_ms": 1.675}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.027098420800434217, "policy_loss": -0.006640805988498624, "vf_loss": 0.03371177377208831, "vf_explained_var": 0.9441882967948914, "kl": 0.0017567696567210886, "entropy": -3.941354471539694, "entropy_coeff": 0.0}}, "num_steps_sampled": 328000, "num_steps_trained": 328000}, "done": false, "episodes_total": 328, "training_iteration": 41, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-38", "timestamp": 1617635078, "time_this_iter_s": 3.9212405681610107, "time_total_s": 190.58063554763794, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.122817516326904, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.416666666666668, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 17.855850754235043, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 6.451612952766302, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.389118413046061, 6.076327929129258, 10.069266934425142, 6.779502059098857, 5.92876757853169, 7.368947601065187, 5.284090448259998, 11.325162821361113, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043, 7.685329883307533, 2.6829275145066034, 5.186484954381777, 12.676024659163176, 4.694355631098144, 8.489099316431446, 7.208013792774066, 7.188351600308767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17313989789335738, "mean_inference_ms": 0.8828341658989193, "mean_action_processing_ms": 0.036567304196137476, "mean_env_wait_ms": 0.8148984206516656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 336000, "timers": {"sample_time_ms": 1963.303, "sample_throughput": 4074.765, "learn_time_ms": 2283.506, "learn_throughput": 3503.385, "update_time_ms": 1.656}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.028122394611792906, "policy_loss": -0.006213385641338333, "vf_loss": 0.03432565933418653, "vf_explained_var": 0.9515478014945984, "kl": 0.0012953353931181252, "entropy": -3.966764120828538, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 336, "training_iteration": 42, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-42", "timestamp": 1617635082, "time_this_iter_s": 3.896796226501465, "time_total_s": 194.4774317741394, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.01961374282837, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.44, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 17.855850754235043, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 6.709195802481452, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.746624423458883, 7.1924146674939955, 17.557212229318942, 3.40134536715638, 13.575562227300122, 7.923588741613667, 10.68090396142694, 5.08121718385225, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043, 7.685329883307533, 2.6829275145066034, 5.186484954381777, 12.676024659163176, 4.694355631098144, 8.489099316431446, 7.208013792774066, 7.188351600308767, 13.389118413046061, 6.076327929129258, 10.069266934425142, 6.779502059098857, 5.92876757853169, 7.368947601065187, 5.284090448259998, 11.325162821361113], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17203826634082905, "mean_inference_ms": 0.8762856279083137, "mean_action_processing_ms": 0.03624919861142125, "mean_env_wait_ms": 0.804975861506208, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 344000, "timers": {"sample_time_ms": 1937.213, "sample_throughput": 4129.644, "learn_time_ms": 2268.566, "learn_throughput": 3526.457, "update_time_ms": 1.674}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.046847131191974596, "policy_loss": -0.008297833687965833, "vf_loss": 0.055137670850233425, "vf_explained_var": 0.9339793920516968, "kl": 0.0018674091598580753, "entropy": -3.991822878519694, "entropy_coeff": 0.0}}, "num_steps_sampled": 344000, "num_steps_trained": 344000}, "done": false, "episodes_total": 344, "training_iteration": 43, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-46", "timestamp": 1617635086, "time_this_iter_s": 3.8838937282562256, "time_total_s": 198.36132550239563, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.903507471084595, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.03333333333333, "ram_util_percent": 51.050000000000004}, "trial_id": "3e406_00002"}
{"episode_reward_max": 17.855850754235043, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 6.814408533444867, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.629769392543199, 4.940999533884892, 8.33385978798453, 4.043527479090769, 12.508852273148026, 11.115777520062348, 5.652791988247172, 10.865006921963909, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043, 7.685329883307533, 2.6829275145066034, 5.186484954381777, 12.676024659163176, 4.694355631098144, 8.489099316431446, 7.208013792774066, 7.188351600308767, 13.389118413046061, 6.076327929129258, 10.069266934425142, 6.779502059098857, 5.92876757853169, 7.368947601065187, 5.284090448259998, 11.325162821361113, 4.746624423458883, 7.1924146674939955, 17.557212229318942, 3.40134536715638, 13.575562227300122, 7.923588741613667, 10.68090396142694, 5.08121718385225], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1711932539143032, "mean_inference_ms": 0.8705233548617034, "mean_action_processing_ms": 0.03597974818313702, "mean_env_wait_ms": 0.7965775567547331, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 352000, "timers": {"sample_time_ms": 1918.613, "sample_throughput": 4169.679, "learn_time_ms": 2253.953, "learn_throughput": 3549.32, "update_time_ms": 1.669}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.03704405413378799, "policy_loss": -0.006331003404089383, "vf_loss": 0.04337296303775576, "vf_explained_var": 0.9493334293365479, "kl": 0.0010716782176926258, "entropy": -4.016090056252858, "entropy_coeff": 0.0}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 352, "training_iteration": 44, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-50", "timestamp": 1617635090, "time_this_iter_s": 3.88010573387146, "time_total_s": 202.2414312362671, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.783613204956055, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 26.240000000000002, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 17.855850754235043, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 7.0768512541103625, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.777367145055798, 7.486583032440192, 6.2132738469774695, 10.590985296096493, 7.351749143737861, 11.014642792862356, 16.37412349854357, 8.801502930408715, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043, 7.685329883307533, 2.6829275145066034, 5.186484954381777, 12.676024659163176, 4.694355631098144, 8.489099316431446, 7.208013792774066, 7.188351600308767, 13.389118413046061, 6.076327929129258, 10.069266934425142, 6.779502059098857, 5.92876757853169, 7.368947601065187, 5.284090448259998, 11.325162821361113, 4.746624423458883, 7.1924146674939955, 17.557212229318942, 3.40134536715638, 13.575562227300122, 7.923588741613667, 10.68090396142694, 5.08121718385225, 4.629769392543199, 4.940999533884892, 8.33385978798453, 4.043527479090769, 12.508852273148026, 11.115777520062348, 5.652791988247172, 10.865006921963909], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17042315096341012, "mean_inference_ms": 0.8653883584440082, "mean_action_processing_ms": 0.035745104443780394, "mean_env_wait_ms": 0.7893456127741733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 360000, "timers": {"sample_time_ms": 1819.549, "sample_throughput": 4396.693, "learn_time_ms": 2237.319, "learn_throughput": 3575.708, "update_time_ms": 1.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.05099068422402654, "policy_loss": -0.006608585620092021, "vf_loss": 0.057597678746022875, "vf_explained_var": 0.9448861479759216, "kl": 0.001630936542318927, "entropy": -4.033174026580084, "entropy_coeff": 0.0}}, "num_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 360, "training_iteration": 45, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-53", "timestamp": 1617635093, "time_this_iter_s": 3.9616148471832275, "time_total_s": 206.20304608345032, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.74522805213928, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 22.183333333333337, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 18.975995781279554, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 7.462491718965193, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.3643808683108425, 14.566906807179498, 8.684409393778424, 18.975995781279554, 8.462298220087726, 17.56615567402426, 7.4749017769560115, 10.54124613733039, 3.8168501174442886, 7.3893163459151285, 5.646354646286109, 6.849286002134029, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043, 7.685329883307533, 2.6829275145066034, 5.186484954381777, 12.676024659163176, 4.694355631098144, 8.489099316431446, 7.208013792774066, 7.188351600308767, 13.389118413046061, 6.076327929129258, 10.069266934425142, 6.779502059098857, 5.92876757853169, 7.368947601065187, 5.284090448259998, 11.325162821361113, 4.746624423458883, 7.1924146674939955, 17.557212229318942, 3.40134536715638, 13.575562227300122, 7.923588741613667, 10.68090396142694, 5.08121718385225, 4.629769392543199, 4.940999533884892, 8.33385978798453, 4.043527479090769, 12.508852273148026, 11.115777520062348, 5.652791988247172, 10.865006921963909, 9.777367145055798, 7.486583032440192, 6.2132738469774695, 10.590985296096493, 7.351749143737861, 11.014642792862356, 16.37412349854357, 8.801502930408715], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16972238088343317, "mean_inference_ms": 0.860784166066605, "mean_action_processing_ms": 0.03553860883397078, "mean_env_wait_ms": 0.7830187960483718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 368000, "timers": {"sample_time_ms": 1788.935, "sample_throughput": 4471.935, "learn_time_ms": 2207.487, "learn_throughput": 3624.03, "update_time_ms": 1.674}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00048828125, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.07550636231012288, "policy_loss": -0.007379644653863377, "vf_loss": 0.08288513135815424, "vf_explained_var": 0.9343099594116211, "kl": 0.0017918794016752923, "entropy": -4.057864359446934, "entropy_coeff": 0.0}}, "num_steps_sampled": 368000, "num_steps_trained": 368000}, "done": false, "episodes_total": 368, "training_iteration": 46, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-04-57", "timestamp": 1617635097, "time_this_iter_s": 3.9342353343963623, "time_total_s": 210.13728141784668, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.679463386535645, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 21.333333333333332, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 18.975995781279554, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 7.6658794887420925, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.794172662172784, 5.856619587144459, 8.331858248034651, 11.782359714043368, 10.836766684231165, 9.53921717576152, 11.917861190878813, 7.831695703063517, 4.350058964513675, 7.575127943946171, 3.919411715111819, 8.550000329175173, 5.488058779498745, 3.877284174342459, 4.3969986691834935, 2.808490087623118, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043, 7.685329883307533, 2.6829275145066034, 5.186484954381777, 12.676024659163176, 4.694355631098144, 8.489099316431446, 7.208013792774066, 7.188351600308767, 13.389118413046061, 6.076327929129258, 10.069266934425142, 6.779502059098857, 5.92876757853169, 7.368947601065187, 5.284090448259998, 11.325162821361113, 4.746624423458883, 7.1924146674939955, 17.557212229318942, 3.40134536715638, 13.575562227300122, 7.923588741613667, 10.68090396142694, 5.08121718385225, 4.629769392543199, 4.940999533884892, 8.33385978798453, 4.043527479090769, 12.508852273148026, 11.115777520062348, 5.652791988247172, 10.865006921963909, 9.777367145055798, 7.486583032440192, 6.2132738469774695, 10.590985296096493, 7.351749143737861, 11.014642792862356, 16.37412349854357, 8.801502930408715, 7.3643808683108425, 14.566906807179498, 8.684409393778424, 18.975995781279554, 8.462298220087726, 17.56615567402426, 7.4749017769560115, 10.54124613733039], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16843450584619812, "mean_inference_ms": 0.8512296797853418, "mean_action_processing_ms": 0.0350972390946121, "mean_env_wait_ms": 0.7680813055324278, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 376000, "timers": {"sample_time_ms": 1767.918, "sample_throughput": 4525.098, "learn_time_ms": 2183.599, "learn_throughput": 3663.676, "update_time_ms": 1.671}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000244140625, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.030583209003366175, "policy_loss": -0.006189668277603766, "vf_loss": 0.03677249277040126, "vf_explained_var": 0.9694064855575562, "kl": 0.0015809005773108867, "entropy": -4.075826607053242, "entropy_coeff": 0.0}}, "num_steps_sampled": 376000, "num_steps_trained": 376000}, "done": false, "episodes_total": 376, "training_iteration": 47, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-05-01", "timestamp": 1617635101, "time_this_iter_s": 3.9517409801483154, "time_total_s": 214.089022397995, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.63120436668396, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.439999999999998, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 18.975995781279554, "episode_reward_min": 2.664901290868928, "episode_reward_mean": 8.048070553518157, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.006914442767169, 14.206491746350185, 6.432766714095511, 15.644083930815253, 8.592809937689278, 8.843921603115845, 12.424833102083785, 8.032715664083904, 2.664901290868928, 6.132223069176839, 5.484007151856143, 7.398693720316642, 3.060963917993954, 11.174876747704207, 3.4858182956555233, 5.779993146525516, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043, 7.685329883307533, 2.6829275145066034, 5.186484954381777, 12.676024659163176, 4.694355631098144, 8.489099316431446, 7.208013792774066, 7.188351600308767, 13.389118413046061, 6.076327929129258, 10.069266934425142, 6.779502059098857, 5.92876757853169, 7.368947601065187, 5.284090448259998, 11.325162821361113, 4.746624423458883, 7.1924146674939955, 17.557212229318942, 3.40134536715638, 13.575562227300122, 7.923588741613667, 10.68090396142694, 5.08121718385225, 4.629769392543199, 4.940999533884892, 8.33385978798453, 4.043527479090769, 12.508852273148026, 11.115777520062348, 5.652791988247172, 10.865006921963909, 9.777367145055798, 7.486583032440192, 6.2132738469774695, 10.590985296096493, 7.351749143737861, 11.014642792862356, 16.37412349854357, 8.801502930408715, 7.3643808683108425, 14.566906807179498, 8.684409393778424, 18.975995781279554, 8.462298220087726, 17.56615567402426, 7.4749017769560115, 10.54124613733039, 7.794172662172784, 5.856619587144459, 8.331858248034651, 11.782359714043368, 10.836766684231165, 9.53921717576152, 11.917861190878813, 7.831695703063517], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16677478783305522, "mean_inference_ms": 0.8387481065586401, "mean_action_processing_ms": 0.03450057444192936, "mean_env_wait_ms": 0.7488951846580706, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 384000, "timers": {"sample_time_ms": 1762.695, "sample_throughput": 4538.504, "learn_time_ms": 2185.303, "learn_throughput": 3660.82, "update_time_ms": 1.666}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001220703125, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.05251905307291992, "policy_loss": -0.006858539279727708, "vf_loss": 0.05937740922210708, "vf_explained_var": 0.9561313390731812, "kl": 0.0014931537979652012, "entropy": -4.1016741631523015, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 384, "training_iteration": 48, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-05-05", "timestamp": 1617635105, "time_this_iter_s": 3.9200069904327393, "time_total_s": 218.00902938842773, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 57.5512113571167, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 21.566666666666666, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 18.975995781279554, "episode_reward_min": 2.6829275145066034, "episode_reward_mean": 8.358664872832007, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.303143136218774, 8.655525716506528, 7.607630208880469, 6.517042780567151, 9.338825974103322, 11.032451290933855, 11.106553067311221, 12.679737096961613, 9.684037454163994, 7.112394387119069, 3.411335121977655, 5.364029399079706, 5.830010292723168, 4.485935412168869, 5.471027373531883, 6.695117972282212, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043, 7.685329883307533, 2.6829275145066034, 5.186484954381777, 12.676024659163176, 4.694355631098144, 8.489099316431446, 7.208013792774066, 7.188351600308767, 13.389118413046061, 6.076327929129258, 10.069266934425142, 6.779502059098857, 5.92876757853169, 7.368947601065187, 5.284090448259998, 11.325162821361113, 4.746624423458883, 7.1924146674939955, 17.557212229318942, 3.40134536715638, 13.575562227300122, 7.923588741613667, 10.68090396142694, 5.08121718385225, 4.629769392543199, 4.940999533884892, 8.33385978798453, 4.043527479090769, 12.508852273148026, 11.115777520062348, 5.652791988247172, 10.865006921963909, 9.777367145055798, 7.486583032440192, 6.2132738469774695, 10.590985296096493, 7.351749143737861, 11.014642792862356, 16.37412349854357, 8.801502930408715, 7.3643808683108425, 14.566906807179498, 8.684409393778424, 18.975995781279554, 8.462298220087726, 17.56615567402426, 7.4749017769560115, 10.54124613733039, 7.794172662172784, 5.856619587144459, 8.331858248034651, 11.782359714043368, 10.836766684231165, 9.53921717576152, 11.917861190878813, 7.831695703063517, 5.006914442767169, 14.206491746350185, 6.432766714095511, 15.644083930815253, 8.592809937689278, 8.843921603115845, 12.424833102083785, 8.032715664083904], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1653790037115438, "mean_inference_ms": 0.8307180577857397, "mean_action_processing_ms": 0.0340962844701387, "mean_env_wait_ms": 0.736947756759244, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 392000, "timers": {"sample_time_ms": 1749.741, "sample_throughput": 4572.105, "learn_time_ms": 2170.471, "learn_throughput": 3685.836, "update_time_ms": 1.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-05, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.03633659356643283, "policy_loss": -0.007256960895444665, "vf_loss": 0.04359347816734087, "vf_explained_var": 0.9657055735588074, "kl": 0.0013060214992109982, "entropy": -4.136476736220103, "entropy_coeff": 0.0}}, "num_steps_sampled": 392000, "num_steps_trained": 392000}, "done": false, "episodes_total": 392, "training_iteration": 49, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-05-09", "timestamp": 1617635109, "time_this_iter_s": 3.9225826263427734, "time_total_s": 221.9316120147705, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 61.47379398345947, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 21.96666666666667, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
{"episode_reward_max": 18.975995781279554, "episode_reward_min": 2.6829275145066034, "episode_reward_mean": 8.629215468153355, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.227614513565056, 5.83097238449386, 6.967627647811261, 6.354263232414411, 5.159783783851165, 15.584093577462639, 11.560788104808674, 11.42380370077424, 2.8261151111281637, 5.600139550528623, 4.0265175645229485, 6.75898099111327, 7.580551426687734, 6.285026921009824, 3.451391546498555, 3.4296591882219154, 12.049357227549477, 6.323005876099078, 6.260462787629298, 11.410597509926001, 2.7434089507426944, 5.135935344479417, 7.245519195441734, 3.589815799265205, 11.231789700113696, 4.725007361630625, 4.4397225050127425, 17.855850754235043, 7.685329883307533, 2.6829275145066034, 5.186484954381777, 12.676024659163176, 4.694355631098144, 8.489099316431446, 7.208013792774066, 7.188351600308767, 13.389118413046061, 6.076327929129258, 10.069266934425142, 6.779502059098857, 5.92876757853169, 7.368947601065187, 5.284090448259998, 11.325162821361113, 4.746624423458883, 7.1924146674939955, 17.557212229318942, 3.40134536715638, 13.575562227300122, 7.923588741613667, 10.68090396142694, 5.08121718385225, 4.629769392543199, 4.940999533884892, 8.33385978798453, 4.043527479090769, 12.508852273148026, 11.115777520062348, 5.652791988247172, 10.865006921963909, 9.777367145055798, 7.486583032440192, 6.2132738469774695, 10.590985296096493, 7.351749143737861, 11.014642792862356, 16.37412349854357, 8.801502930408715, 7.3643808683108425, 14.566906807179498, 8.684409393778424, 18.975995781279554, 8.462298220087726, 17.56615567402426, 7.4749017769560115, 10.54124613733039, 7.794172662172784, 5.856619587144459, 8.331858248034651, 11.782359714043368, 10.836766684231165, 9.53921717576152, 11.917861190878813, 7.831695703063517, 5.006914442767169, 14.206491746350185, 6.432766714095511, 15.644083930815253, 8.592809937689278, 8.843921603115845, 12.424833102083785, 8.032715664083904, 9.303143136218774, 8.655525716506528, 7.607630208880469, 6.517042780567151, 9.338825974103322, 11.032451290933855, 11.106553067311221, 12.679737096961613], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1639765650112729, "mean_inference_ms": 0.8247740138095295, "mean_action_processing_ms": 0.03378958666571184, "mean_env_wait_ms": 0.7281568954750675, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 400000, "timers": {"sample_time_ms": 1746.458, "sample_throughput": 4580.7, "learn_time_ms": 2166.656, "learn_throughput": 3692.326, "update_time_ms": 1.679}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-05, "cur_lr": 1.7737077411020705e-05, "total_loss": 0.052902590956479784, "policy_loss": -0.005293570429323212, "vf_loss": 0.05819612540422924, "vf_explained_var": 0.9563999772071838, "kl": 0.001347142138651439, "entropy": -4.173374524192204, "entropy_coeff": 0.0}}, "num_steps_sampled": 400000, "num_steps_trained": 400000}, "done": true, "episodes_total": 400, "training_iteration": 50, "experiment_id": "34945e02ee694e34a38c58dfae4da2ec", "date": "2021-04-05_08-05-13", "timestamp": 1617635113, "time_this_iter_s": 3.922452688217163, "time_total_s": 225.85406470298767, "pid": 8513, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 7278, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 14, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.773707741102072e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.947771792929675, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.11447164128693942, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 65.39624667167664, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.559999999999995, "ram_util_percent": 51.0}, "trial_id": "3e406_00002"}
