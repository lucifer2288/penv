{"episode_reward_max": 0.1443948112992337, "episode_reward_min": -0.5803386091380045, "episode_reward_mean": -0.23160965957430496, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.00415524379781429, 0.1443948112992337, -0.47190733047968225, -0.0812810822986878, -0.4536099703613045, -0.2407486401215262, -0.5803386091380045, -0.1652312116966539], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1921263767137593, "mean_inference_ms": 1.0270791117806946, "mean_action_processing_ms": 0.04367715563348202, "mean_env_wait_ms": 0.9958768992927355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 12800, "timers": {"sample_time_ms": 4408.076, "sample_throughput": 2903.761, "learn_time_ms": 3366.201, "learn_throughput": 3802.506, "update_time_ms": 1.415}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.023639284337405114, "policy_loss": -0.0371658621635288, "vf_loss": 0.0035468865372240543, "vf_explained_var": 0.6521542072296143, "kl": 0.00997969226911664, "entropy": -3.2496677255630493, "entropy_coeff": 0.0}}, "num_steps_sampled": 12800, "num_steps_trained": 12800}, "done": false, "episodes_total": 8, "training_iteration": 1, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-57-29", "timestamp": 1617649049, "time_this_iter_s": 7.779018402099609, "time_total_s": 7.779018402099609, "pid": 18554, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.779018402099609, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 57.666666666666664, "ram_util_percent": 58.37499999999999}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 0.38169470175972564, "episode_reward_min": -0.5894389034275772, "episode_reward_mean": -0.2110952369391564, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.29113057548874066, -0.40089504292906897, -0.4531481718464748, 0.1676426257219743, -0.501149315963549, 0.14418092399627058, -0.43571314080532897, -0.18748951425738203, -0.16297479742738086, -0.5894389034275772, -0.21872026047915027, -0.2543771293529832, 0.38169470175972564, -0.034286322009728476, -0.17670413585972755, -0.2008993515761931, -0.00415524379781429, 0.1443948112992337, -0.47190733047968225, -0.0812810822986878, -0.4536099703613045, -0.2407486401215262, -0.5803386091380045, -0.1652312116966539], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20383484233632662, "mean_inference_ms": 1.0423769424516818, "mean_action_processing_ms": 0.044256447001133604, "mean_env_wait_ms": 0.9941661354040757, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 25600, "timers": {"sample_time_ms": 4269.87, "sample_throughput": 2997.749, "learn_time_ms": 3068.777, "learn_throughput": 4171.043, "update_time_ms": 1.523}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.02336302261799574, "policy_loss": -0.03597418678924441, "vf_loss": 0.003452454167418182, "vf_explained_var": 0.7006310820579529, "kl": 0.009158708709292114, "entropy": -3.2497780394554137, "entropy_coeff": 0.0}}, "num_steps_sampled": 25600, "num_steps_trained": 25600}, "done": false, "episodes_total": 24, "training_iteration": 2, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-57-36", "timestamp": 1617649056, "time_this_iter_s": 6.909418106079102, "time_total_s": 14.688436508178711, "pid": 18554, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.688436508178711, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 52.53333333333333, "ram_util_percent": 61.6888888888889}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 0.5623798060260332, "episode_reward_min": -0.5894389034275772, "episode_reward_mean": -0.17887098191704534, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.42897829632152307, 0.5623798060260332, -0.335056392776268, -0.3257137930088462, 0.3441830958428598, 0.04942052474024816, -0.34371403529337174, -0.1801066440148288, -0.00415524379781429, 0.1443948112992337, -0.47190733047968225, -0.0812810822986878, -0.4536099703613045, -0.2407486401215262, -0.5803386091380045, -0.1652312116966539, -0.29113057548874066, -0.40089504292906897, -0.4531481718464748, 0.1676426257219743, -0.501149315963549, 0.14418092399627058, -0.43571314080532897, -0.18748951425738203, -0.16297479742738086, -0.5894389034275772, -0.21872026047915027, -0.2543771293529832, 0.38169470175972564, -0.034286322009728476, -0.17670413585972755, -0.2008993515761931], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20253545569038472, "mean_inference_ms": 1.0371761403376158, "mean_action_processing_ms": 0.043995647630651086, "mean_env_wait_ms": 0.9842721653492282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 38400, "timers": {"sample_time_ms": 4060.813, "sample_throughput": 3152.078, "learn_time_ms": 3148.403, "learn_throughput": 4065.553, "update_time_ms": 1.526}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.02938941277563572, "policy_loss": -0.0439552631508559, "vf_loss": 0.0034857755177654325, "vf_explained_var": 0.8105288147926331, "kl": 0.011080076247453689, "entropy": -3.271479365825653, "entropy_coeff": 0.0}}, "num_steps_sampled": 38400, "num_steps_trained": 38400}, "done": false, "episodes_total": 32, "training_iteration": 3, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-57-43", "timestamp": 1617649063, "time_this_iter_s": 6.957556486129761, "time_total_s": 21.64599299430847, "pid": 18554, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21.64599299430847, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.89, "ram_util_percent": 61.70000000000001}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 0.8150987290459581, "episode_reward_min": -0.6197940147321986, "episode_reward_mean": -0.15030149259798029, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3316641990435202, -0.3373805573698288, -0.12390011250490318, -0.11618765465974046, 0.04290971208830241, -0.15314720249795966, 0.10084647913882261, -0.11951467872394361, -0.3100652006430882, 0.1529028337170526, 0.8150987290459581, -0.27112323616085243, -0.6197940147321986, -0.031852139585479944, -0.06605154418603776, -0.12167743724018598, -0.00415524379781429, 0.1443948112992337, -0.47190733047968225, -0.0812810822986878, -0.4536099703613045, -0.2407486401215262, -0.5803386091380045, -0.1652312116966539, -0.29113057548874066, -0.40089504292906897, -0.4531481718464748, 0.1676426257219743, -0.501149315963549, 0.14418092399627058, -0.43571314080532897, -0.18748951425738203, -0.16297479742738086, -0.5894389034275772, -0.21872026047915027, -0.2543771293529832, 0.38169470175972564, -0.034286322009728476, -0.17670413585972755, -0.2008993515761931, -0.42897829632152307, 0.5623798060260332, -0.335056392776268, -0.3257137930088462, 0.3441830958428598, 0.04942052474024816, -0.34371403529337174, -0.1801066440148288], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1993098041502234, "mean_inference_ms": 1.0133551920035495, "mean_action_processing_ms": 0.04292286857110126, "mean_env_wait_ms": 0.9531224332673213, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 51200, "timers": {"sample_time_ms": 3808.266, "sample_throughput": 3361.109, "learn_time_ms": 3106.301, "learn_throughput": 4120.657, "update_time_ms": 1.556}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.02862497919937596, "policy_loss": -0.043831152603961525, "vf_loss": 0.003629431496374309, "vf_explained_var": 0.8363500237464905, "kl": 0.011576741077005863, "entropy": -3.273865325450897, "entropy_coeff": 0.0}}, "num_steps_sampled": 51200, "num_steps_trained": 51200}, "done": false, "episodes_total": 48, "training_iteration": 4, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-57-49", "timestamp": 1617649069, "time_this_iter_s": 6.037443399429321, "time_total_s": 27.683436393737793, "pid": 18554, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.683436393737793, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.07777777777778, "ram_util_percent": 61.86666666666666}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 1.0662429711459005, "episode_reward_min": -0.6197940147321986, "episode_reward_mean": -0.09842785820106129, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.005852282016314936, -0.11583693729884259, 0.1180900103136997, 0.12213904782520402, 0.05711702186816159, 0.35933371801534086, -0.4593307178878974, -0.2317681471200006, -0.2936054567308056, -0.4078092950075479, 1.0662429711459005, 0.08616549110382943, -0.031569482290302875, 0.782126420873912, 0.12217477594918158, -0.2525284189083864, -0.00415524379781429, 0.1443948112992337, -0.47190733047968225, -0.0812810822986878, -0.4536099703613045, -0.2407486401215262, -0.5803386091380045, -0.1652312116966539, -0.29113057548874066, -0.40089504292906897, -0.4531481718464748, 0.1676426257219743, -0.501149315963549, 0.14418092399627058, -0.43571314080532897, -0.18748951425738203, -0.16297479742738086, -0.5894389034275772, -0.21872026047915027, -0.2543771293529832, 0.38169470175972564, -0.034286322009728476, -0.17670413585972755, -0.2008993515761931, -0.42897829632152307, 0.5623798060260332, -0.335056392776268, -0.3257137930088462, 0.3441830958428598, 0.04942052474024816, -0.34371403529337174, -0.1801066440148288, -0.3316641990435202, -0.3373805573698288, -0.12390011250490318, -0.11618765465974046, 0.04290971208830241, -0.15314720249795966, 0.10084647913882261, -0.11951467872394361, -0.3100652006430882, 0.1529028337170526, 0.8150987290459581, -0.27112323616085243, -0.6197940147321986, -0.031852139585479944, -0.06605154418603776, -0.12167743724018598], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20063828719198878, "mean_inference_ms": 1.0083782436355404, "mean_action_processing_ms": 0.042685498483417614, "mean_env_wait_ms": 0.9442905317151122, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 64000, "timers": {"sample_time_ms": 3907.286, "sample_throughput": 3275.931, "learn_time_ms": 3066.2, "learn_throughput": 4174.548, "update_time_ms": 1.575}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.03196026615332812, "policy_loss": -0.04891958543099463, "vf_loss": 0.004366750300396234, "vf_explained_var": 0.8201305270195007, "kl": 0.012592568527907133, "entropy": -3.298690764904022, "entropy_coeff": 0.0}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 64, "training_iteration": 5, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-57-56", "timestamp": 1617649076, "time_this_iter_s": 7.215631723403931, "time_total_s": 34.899068117141724, "pid": 18554, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.899068117141724, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.42999999999999, "ram_util_percent": 62.02}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 1.2035520390531365, "episode_reward_min": -0.6197940147321986, "episode_reward_mean": -0.05904482042710321, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2084348212239766, -0.26865374292954625, 0.9283168844627114, 1.2035520390531365, -0.17864879495812902, 0.28434124421902696, 0.10225957603966584, -0.23144617299435066, -0.00415524379781429, 0.1443948112992337, -0.47190733047968225, -0.0812810822986878, -0.4536099703613045, -0.2407486401215262, -0.5803386091380045, -0.1652312116966539, -0.29113057548874066, -0.40089504292906897, -0.4531481718464748, 0.1676426257219743, -0.501149315963549, 0.14418092399627058, -0.43571314080532897, -0.18748951425738203, -0.16297479742738086, -0.5894389034275772, -0.21872026047915027, -0.2543771293529832, 0.38169470175972564, -0.034286322009728476, -0.17670413585972755, -0.2008993515761931, -0.42897829632152307, 0.5623798060260332, -0.335056392776268, -0.3257137930088462, 0.3441830958428598, 0.04942052474024816, -0.34371403529337174, -0.1801066440148288, -0.3316641990435202, -0.3373805573698288, -0.12390011250490318, -0.11618765465974046, 0.04290971208830241, -0.15314720249795966, 0.10084647913882261, -0.11951467872394361, -0.3100652006430882, 0.1529028337170526, 0.8150987290459581, -0.27112323616085243, -0.6197940147321986, -0.031852139585479944, -0.06605154418603776, -0.12167743724018598, -0.005852282016314936, -0.11583693729884259, 0.1180900103136997, 0.12213904782520402, 0.05711702186816159, 0.35933371801534086, -0.4593307178878974, -0.2317681471200006, -0.2936054567308056, -0.4078092950075479, 1.0662429711459005, 0.08616549110382943, -0.031569482290302875, 0.782126420873912, 0.12217477594918158, -0.2525284189083864], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19985382468784849, "mean_inference_ms": 1.0038063410106268, "mean_action_processing_ms": 0.0424820792284358, "mean_env_wait_ms": 0.938207044232562, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 76800, "timers": {"sample_time_ms": 3781.55, "sample_throughput": 3384.855, "learn_time_ms": 3155.462, "learn_throughput": 4056.459, "update_time_ms": 1.558}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.03277958598919213, "policy_loss": -0.049948570732958615, "vf_loss": 0.0042063856986351315, "vf_explained_var": 0.8553194999694824, "kl": 0.012962598819285631, "entropy": -3.3321474814414977, "entropy_coeff": 0.0}}, "num_steps_sampled": 76800, "num_steps_trained": 76800}, "done": false, "episodes_total": 72, "training_iteration": 6, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-58-03", "timestamp": 1617649083, "time_this_iter_s": 6.761157274246216, "time_total_s": 41.66022539138794, "pid": 18554, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.66022539138794, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.339999999999996, "ram_util_percent": 61.9}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 1.2035520390531365, "episode_reward_min": -0.6197940147321986, "episode_reward_mean": 0.03876195531588956, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7426103427022999, 0.24335343956150934, 0.1731611813974543, 0.21579916123750031, 0.2595363324207993, 1.1747417447716804, -0.01898620618552127, 0.687285475892248, 0.11801196419547577, 1.1146945365997376, 0.5630012679115961, 0.016448557095030125, 0.3596051922865495, 0.538248090225421, 0.5112494887361991, 0.9635185697017334, -0.00415524379781429, 0.1443948112992337, -0.47190733047968225, -0.0812810822986878, -0.4536099703613045, -0.2407486401215262, -0.5803386091380045, -0.1652312116966539, -0.29113057548874066, -0.40089504292906897, -0.4531481718464748, 0.1676426257219743, -0.501149315963549, 0.14418092399627058, -0.43571314080532897, -0.18748951425738203, -0.16297479742738086, -0.5894389034275772, -0.21872026047915027, -0.2543771293529832, 0.38169470175972564, -0.034286322009728476, -0.17670413585972755, -0.2008993515761931, -0.42897829632152307, 0.5623798060260332, -0.335056392776268, -0.3257137930088462, 0.3441830958428598, 0.04942052474024816, -0.34371403529337174, -0.1801066440148288, -0.3316641990435202, -0.3373805573698288, -0.12390011250490318, -0.11618765465974046, 0.04290971208830241, -0.15314720249795966, 0.10084647913882261, -0.11951467872394361, -0.3100652006430882, 0.1529028337170526, 0.8150987290459581, -0.27112323616085243, -0.6197940147321986, -0.031852139585479944, -0.06605154418603776, -0.12167743724018598, -0.005852282016314936, -0.11583693729884259, 0.1180900103136997, 0.12213904782520402, 0.05711702186816159, 0.35933371801534086, -0.4593307178878974, -0.2317681471200006, -0.2936054567308056, -0.4078092950075479, 1.0662429711459005, 0.08616549110382943, -0.031569482290302875, 0.782126420873912, 0.12217477594918158, -0.2525284189083864, 0.2084348212239766, -0.26865374292954625, 0.9283168844627114, 1.2035520390531365, -0.17864879495812902, 0.28434124421902696, 0.10225957603966584, -0.23144617299435066], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19860238471611924, "mean_inference_ms": 0.9953551810473907, "mean_action_processing_ms": 0.04210739526442254, "mean_env_wait_ms": 0.927371707741652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 89600, "timers": {"sample_time_ms": 3719.521, "sample_throughput": 3441.303, "learn_time_ms": 3104.299, "learn_throughput": 4123.314, "update_time_ms": 1.53}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.030280819907784463, "policy_loss": -0.04829089033417404, "vf_loss": 0.004976480081677437, "vf_explained_var": 0.8503212928771973, "kl": 0.013033590046688914, "entropy": -3.3371698665618896, "entropy_coeff": 0.0}}, "num_steps_sampled": 89600, "num_steps_trained": 89600}, "done": false, "episodes_total": 88, "training_iteration": 7, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-58-09", "timestamp": 1617649089, "time_this_iter_s": 6.152141094207764, "time_total_s": 47.8123664855957, "pid": 18554, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.8123664855957, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.78888888888889, "ram_util_percent": 62.01111111111111}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 2.3813154423930505, "episode_reward_min": -0.6197940147321986, "episode_reward_mean": 0.11907240119473463, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.197113757178888, 0.8630851860700108, 1.4327687827312636, 0.8185014148632599, 1.0029292097303384, 2.3813154423930505, -0.23712939268254285, 0.5613140466119744, -0.00415524379781429, 0.1443948112992337, -0.47190733047968225, -0.0812810822986878, -0.4536099703613045, -0.2407486401215262, -0.5803386091380045, -0.1652312116966539, -0.29113057548874066, -0.40089504292906897, -0.4531481718464748, 0.1676426257219743, -0.501149315963549, 0.14418092399627058, -0.43571314080532897, -0.18748951425738203, -0.16297479742738086, -0.5894389034275772, -0.21872026047915027, -0.2543771293529832, 0.38169470175972564, -0.034286322009728476, -0.17670413585972755, -0.2008993515761931, -0.42897829632152307, 0.5623798060260332, -0.335056392776268, -0.3257137930088462, 0.3441830958428598, 0.04942052474024816, -0.34371403529337174, -0.1801066440148288, -0.3316641990435202, -0.3373805573698288, -0.12390011250490318, -0.11618765465974046, 0.04290971208830241, -0.15314720249795966, 0.10084647913882261, -0.11951467872394361, -0.3100652006430882, 0.1529028337170526, 0.8150987290459581, -0.27112323616085243, -0.6197940147321986, -0.031852139585479944, -0.06605154418603776, -0.12167743724018598, -0.005852282016314936, -0.11583693729884259, 0.1180900103136997, 0.12213904782520402, 0.05711702186816159, 0.35933371801534086, -0.4593307178878974, -0.2317681471200006, -0.2936054567308056, -0.4078092950075479, 1.0662429711459005, 0.08616549110382943, -0.031569482290302875, 0.782126420873912, 0.12217477594918158, -0.2525284189083864, 0.2084348212239766, -0.26865374292954625, 0.9283168844627114, 1.2035520390531365, -0.17864879495812902, 0.28434124421902696, 0.10225957603966584, -0.23144617299435066, 0.7426103427022999, 0.24335343956150934, 0.1731611813974543, 0.21579916123750031, 0.2595363324207993, 1.1747417447716804, -0.01898620618552127, 0.687285475892248, 0.11801196419547577, 1.1146945365997376, 0.5630012679115961, 0.016448557095030125, 0.3596051922865495, 0.538248090225421, 0.5112494887361991, 0.9635185697017334], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19813038720182097, "mean_inference_ms": 0.9951960475981129, "mean_action_processing_ms": 0.042044174955345175, "mean_env_wait_ms": 0.9251865680576336, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 102400, "timers": {"sample_time_ms": 3814.598, "sample_throughput": 3355.53, "learn_time_ms": 3105.306, "learn_throughput": 4121.977, "update_time_ms": 1.524}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.032354948008432985, "policy_loss": -0.05164991486817598, "vf_loss": 0.005456768360454589, "vf_explained_var": 0.8685513138771057, "kl": 0.013838198920711874, "entropy": -3.3650127935409544, "entropy_coeff": 0.0}}, "num_steps_sampled": 102400, "num_steps_trained": 102400}, "done": false, "episodes_total": 96, "training_iteration": 8, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-58-16", "timestamp": 1617649096, "time_this_iter_s": 7.599506616592407, "time_total_s": 55.41187310218811, "pid": 18554, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 55.41187310218811, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 56.44545454545455, "ram_util_percent": 61.91818181818182}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 2.195943463364613, "episode_reward_min": 0.27176096272676875, "episode_reward_mean": 0.9344945286828165, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.39889255680923275, 1.6911393773561016, 2.195943463364613, 0.37852686061358565, 1.047289039272382, 0.27176096272676875, 1.1329089872060742, 0.35949498211377406], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13837033997916343, "mean_inference_ms": 0.8069763587162987, "mean_action_processing_ms": 0.03445947043676811, "mean_env_wait_ms": 0.7711475637091614, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 115200, "timers": {"sample_time_ms": 3287.309, "sample_throughput": 3893.762, "learn_time_ms": 3815.418, "learn_throughput": 3354.809, "update_time_ms": 1.416}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.033270633681677285, "policy_loss": -0.052358663259074095, "vf_loss": 0.005434387614950537, "vf_explained_var": 0.8844293355941772, "kl": 0.013653642851859332, "entropy": -3.3981958389282227, "entropy_coeff": 0.0}}, "num_steps_sampled": 115200, "num_steps_trained": 115200}, "done": false, "episodes_total": 104, "training_iteration": 9, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-59-28", "timestamp": 1617649168, "time_this_iter_s": 7.106989622116089, "time_total_s": 62.5188627243042, "pid": 19603, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.106989622116089, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 34.80909090909091, "ram_util_percent": 60.445454545454545}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 2.195943463364613, "episode_reward_min": 0.11429570238351383, "episode_reward_mean": 1.028255803297957, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5721093438394425, 0.2228404313418224, 2.1828887634987244, 0.7477627030878047, 1.1739423037237824, 0.4139348497486681, 2.1922068626646727, 1.1462767146951478, 0.9245569999114149, 2.056578101576721, 1.628130007868064, 0.755940490726162, 0.11429570238351383, 1.5957345346482978, 0.759149140511612, 0.7158360994625848, 0.39889255680923275, 1.6911393773561016, 2.195943463364613, 0.37852686061358565, 1.047289039272382, 0.27176096272676875, 1.1329089872060742, 0.35949498211377406], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1797174541607245, "mean_inference_ms": 0.9232721500996245, "mean_action_processing_ms": 0.039575801235463066, "mean_env_wait_ms": 0.8714231111696941, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 128000, "timers": {"sample_time_ms": 3896.322, "sample_throughput": 3285.15, "learn_time_ms": 3899.848, "learn_throughput": 3282.179, "update_time_ms": 1.616}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.030296789156273006, "policy_loss": -0.0526267081592232, "vf_loss": 0.008201167765073479, "vf_explained_var": 0.8646405935287476, "kl": 0.01412875197827816, "entropy": -3.398857958316803, "entropy_coeff": 0.0}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 120, "training_iteration": 10, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-59-37", "timestamp": 1617649177, "time_this_iter_s": 8.496817111968994, "time_total_s": 71.0156798362732, "pid": 19603, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.603806734085083, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 59.150000000000006, "ram_util_percent": 60.0}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 2.3745701258179266, "episode_reward_min": 0.11429570238351383, "episode_reward_mean": 1.1070223575419973, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.7648720460347902, 0.7474864849805534, 0.48289145986663207, 1.1776604578233103, 1.6209385186629035, 0.7224238149835023, 1.8557332540233262, 2.3745701258179266, 0.39889255680923275, 1.6911393773561016, 2.195943463364613, 0.37852686061358565, 1.047289039272382, 0.27176096272676875, 1.1329089872060742, 0.35949498211377406, 0.5721093438394425, 0.2228404313418224, 2.1828887634987244, 0.7477627030878047, 1.1739423037237824, 0.4139348497486681, 2.1922068626646727, 1.1462767146951478, 0.9245569999114149, 2.056578101576721, 1.628130007868064, 0.755940490726162, 0.11429570238351383, 1.5957345346482978, 0.759149140511612, 0.7158360994625848], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17955512062455725, "mean_inference_ms": 0.9238984562912887, "mean_action_processing_ms": 0.03955594818615693, "mean_env_wait_ms": 0.8672789026472736, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 140800, "timers": {"sample_time_ms": 3611.31, "sample_throughput": 3544.421, "learn_time_ms": 3989.22, "learn_throughput": 3208.647, "update_time_ms": 1.575}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.03279641589615494, "policy_loss": -0.055364806167781354, "vf_loss": 0.0076531906332820655, "vf_explained_var": 0.8828482627868652, "kl": 0.014915199037641286, "entropy": -3.4388115763664246, "entropy_coeff": 0.0}}, "num_steps_sampled": 140800, "num_steps_trained": 140800}, "done": false, "episodes_total": 128, "training_iteration": 11, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-59-44", "timestamp": 1617649184, "time_this_iter_s": 7.215967416763306, "time_total_s": 78.2316472530365, "pid": 19603, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.81977415084839, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.51, "ram_util_percent": 61.61}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 3.4730746515566304, "episode_reward_min": 0.11429570238351383, "episode_reward_mean": 1.3936028826598612, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0885607179322982, 0.7233031762850213, 1.55948265843581, 0.809361352122707, 2.1389272715671295, 3.330381429480325, 2.6139697470395697, 2.919593219608676, 2.605420067233684, 1.0494104956866561, 1.604549234133366, 2.58971229470591, 2.0457860687873866, 3.4730746515566304, 1.0827769347639493, 0.8339136069902997, 0.39889255680923275, 1.6911393773561016, 2.195943463364613, 0.37852686061358565, 1.047289039272382, 0.27176096272676875, 1.1329089872060742, 0.35949498211377406, 0.5721093438394425, 0.2228404313418224, 2.1828887634987244, 0.7477627030878047, 1.1739423037237824, 0.4139348497486681, 2.1922068626646727, 1.1462767146951478, 0.9245569999114149, 2.056578101576721, 1.628130007868064, 0.755940490726162, 0.11429570238351383, 1.5957345346482978, 0.759149140511612, 0.7158360994625848, 1.7648720460347902, 0.7474864849805534, 0.48289145986663207, 1.1776604578233103, 1.6209385186629035, 0.7224238149835023, 1.8557332540233262, 2.3745701258179266], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17998601286060933, "mean_inference_ms": 0.9231064255971627, "mean_action_processing_ms": 0.03917501533212215, "mean_env_wait_ms": 0.8533992718540441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 153600, "timers": {"sample_time_ms": 3560.488, "sample_throughput": 3595.013, "learn_time_ms": 3992.643, "learn_throughput": 3205.897, "update_time_ms": 1.593}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.024069117717444896, "policy_loss": -0.049841071935370566, "vf_loss": 0.011572884358465672, "vf_explained_var": 0.8901234269142151, "kl": 0.014199070371687413, "entropy": -3.4882684707641602, "entropy_coeff": 0.0}}, "num_steps_sampled": 153600, "num_steps_trained": 153600}, "done": false, "episodes_total": 144, "training_iteration": 12, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-59-51", "timestamp": 1617649191, "time_this_iter_s": 7.417506456375122, "time_total_s": 85.64915370941162, "pid": 19603, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.23728060722351, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.68181818181818, "ram_util_percent": 61.70000000000002}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 3.4730746515566304, "episode_reward_min": 0.11429570238351383, "episode_reward_mean": 1.4404187929485062, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.208692668707286, 0.991234517275907, 1.1720038763257938, 1.8845802249629053, 0.649346054427888, 3.0323586071856, 2.2546620020424832, 2.3265180819516096, 2.5367412526325293, 1.5781550793124417, 0.9234071886347108, 0.9554273957904487, 0.7538231347529305, 0.5706882061591971, 1.6699441901842356, 1.7862819006850912, 0.39889255680923275, 1.6911393773561016, 2.195943463364613, 0.37852686061358565, 1.047289039272382, 0.27176096272676875, 1.1329089872060742, 0.35949498211377406, 0.5721093438394425, 0.2228404313418224, 2.1828887634987244, 0.7477627030878047, 1.1739423037237824, 0.4139348497486681, 2.1922068626646727, 1.1462767146951478, 0.9245569999114149, 2.056578101576721, 1.628130007868064, 0.755940490726162, 0.11429570238351383, 1.5957345346482978, 0.759149140511612, 0.7158360994625848, 1.7648720460347902, 0.7474864849805534, 0.48289145986663207, 1.1776604578233103, 1.6209385186629035, 0.7224238149835023, 1.8557332540233262, 2.3745701258179266, 2.0885607179322982, 0.7233031762850213, 1.55948265843581, 0.809361352122707, 2.1389272715671295, 3.330381429480325, 2.6139697470395697, 2.919593219608676, 2.605420067233684, 1.0494104956866561, 1.604549234133366, 2.58971229470591, 2.0457860687873866, 3.4730746515566304, 1.0827769347639493, 0.8339136069902997], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18013762275726836, "mean_inference_ms": 0.9183764321844059, "mean_action_processing_ms": 0.038839391306752055, "mean_env_wait_ms": 0.8426091251631846, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 166400, "timers": {"sample_time_ms": 3489.943, "sample_throughput": 3667.682, "learn_time_ms": 3989.791, "learn_throughput": 3208.188, "update_time_ms": 1.624}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.03070607998408377, "policy_loss": -0.056207414604723456, "vf_loss": 0.009370412607677282, "vf_explained_var": 0.9172619581222534, "kl": 0.01613092058338225, "entropy": -3.5106454038619996, "entropy_coeff": 0.0}}, "num_steps_sampled": 166400, "num_steps_trained": 166400}, "done": false, "episodes_total": 160, "training_iteration": 13, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_11-59-59", "timestamp": 1617649199, "time_this_iter_s": 7.1933205127716064, "time_total_s": 92.84247422218323, "pid": 19603, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.43060111999512, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 42.45, "ram_util_percent": 61.919999999999995}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 3.921934720329438, "episode_reward_min": 0.11429570238351383, "episode_reward_mean": 1.577952603172402, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.446244218727718, 0.5566947591690925, 3.4424325888200036, 1.4474804345228427, 2.3085422561395017, 3.255065262683111, 3.921934720329438, 3.047390439316854, 0.39889255680923275, 1.6911393773561016, 2.195943463364613, 0.37852686061358565, 1.047289039272382, 0.27176096272676875, 1.1329089872060742, 0.35949498211377406, 0.5721093438394425, 0.2228404313418224, 2.1828887634987244, 0.7477627030878047, 1.1739423037237824, 0.4139348497486681, 2.1922068626646727, 1.1462767146951478, 0.9245569999114149, 2.056578101576721, 1.628130007868064, 0.755940490726162, 0.11429570238351383, 1.5957345346482978, 0.759149140511612, 0.7158360994625848, 1.7648720460347902, 0.7474864849805534, 0.48289145986663207, 1.1776604578233103, 1.6209385186629035, 0.7224238149835023, 1.8557332540233262, 2.3745701258179266, 2.0885607179322982, 0.7233031762850213, 1.55948265843581, 0.809361352122707, 2.1389272715671295, 3.330381429480325, 2.6139697470395697, 2.919593219608676, 2.605420067233684, 1.0494104956866561, 1.604549234133366, 2.58971229470591, 2.0457860687873866, 3.4730746515566304, 1.0827769347639493, 0.8339136069902997, 2.208692668707286, 0.991234517275907, 1.1720038763257938, 1.8845802249629053, 0.649346054427888, 3.0323586071856, 2.2546620020424832, 2.3265180819516096, 2.5367412526325293, 1.5781550793124417, 0.9234071886347108, 0.9554273957904487, 0.7538231347529305, 0.5706882061591971, 1.6699441901842356, 1.7862819006850912], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1793376164204553, "mean_inference_ms": 0.9149643536668051, "mean_action_processing_ms": 0.038658951903310076, "mean_env_wait_ms": 0.8373009176464785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 179200, "timers": {"sample_time_ms": 3418.124, "sample_throughput": 3744.744, "learn_time_ms": 3996.748, "learn_throughput": 3202.603, "update_time_ms": 1.62}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.021564709804952144, "policy_loss": -0.04981925666797906, "vf_loss": 0.013583203665912152, "vf_explained_var": 0.8760419487953186, "kl": 0.014671342689543962, "entropy": -3.5276664543151854, "entropy_coeff": 0.0}}, "num_steps_sampled": 179200, "num_steps_trained": 179200}, "done": false, "episodes_total": 168, "training_iteration": 14, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-00-06", "timestamp": 1617649206, "time_this_iter_s": 7.097361087799072, "time_total_s": 99.9398353099823, "pid": 19603, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.52796220779419, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.410000000000004, "ram_util_percent": 61.879999999999995}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 6.208246138946834, "episode_reward_min": 0.11429570238351383, "episode_reward_mean": 1.8785278022280345, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.3327156640627735, 2.6863121199906415, 3.1350682974284787, 5.3288765586016105, 2.9807958245482924, 0.5476210309239908, 1.7456814473157292, 2.663651066349145, 2.5244602039482285, 2.4991275471785874, 2.603373499016913, 5.394670602671871, 3.32478544903631, 2.171945441636137, 5.550528275998558, 6.208246138946834, 0.39889255680923275, 1.6911393773561016, 2.195943463364613, 0.37852686061358565, 1.047289039272382, 0.27176096272676875, 1.1329089872060742, 0.35949498211377406, 0.5721093438394425, 0.2228404313418224, 2.1828887634987244, 0.7477627030878047, 1.1739423037237824, 0.4139348497486681, 2.1922068626646727, 1.1462767146951478, 0.9245569999114149, 2.056578101576721, 1.628130007868064, 0.755940490726162, 0.11429570238351383, 1.5957345346482978, 0.759149140511612, 0.7158360994625848, 1.7648720460347902, 0.7474864849805534, 0.48289145986663207, 1.1776604578233103, 1.6209385186629035, 0.7224238149835023, 1.8557332540233262, 2.3745701258179266, 2.0885607179322982, 0.7233031762850213, 1.55948265843581, 0.809361352122707, 2.1389272715671295, 3.330381429480325, 2.6139697470395697, 2.919593219608676, 2.605420067233684, 1.0494104956866561, 1.604549234133366, 2.58971229470591, 2.0457860687873866, 3.4730746515566304, 1.0827769347639493, 0.8339136069902997, 2.208692668707286, 0.991234517275907, 1.1720038763257938, 1.8845802249629053, 0.649346054427888, 3.0323586071856, 2.2546620020424832, 2.3265180819516096, 2.5367412526325293, 1.5781550793124417, 0.9234071886347108, 0.9554273957904487, 0.7538231347529305, 0.5706882061591971, 1.6699441901842356, 1.7862819006850912, 3.446244218727718, 0.5566947591690925, 3.4424325888200036, 1.4474804345228427, 2.3085422561395017, 3.255065262683111, 3.921934720329438, 3.047390439316854], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17830752031511865, "mean_inference_ms": 0.9081785261161265, "mean_action_processing_ms": 0.038333771360080295, "mean_env_wait_ms": 0.8279211881020097, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 192000, "timers": {"sample_time_ms": 3373.78, "sample_throughput": 3793.964, "learn_time_ms": 3988.776, "learn_throughput": 3209.005, "update_time_ms": 1.61}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.009750587102025747, "policy_loss": -0.049187993081286546, "vf_loss": 0.02419483040459454, "vf_explained_var": 0.8800898790359497, "kl": 0.01524257693439722, "entropy": -3.5523758363723754, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 184, "training_iteration": 15, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-00-13", "timestamp": 1617649213, "time_this_iter_s": 7.055910348892212, "time_total_s": 106.99574565887451, "pid": 19603, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.5838725566864, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.57000000000001, "ram_util_percent": 61.79}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 9.563272261841542, "episode_reward_min": 1.8196161222780072, "episode_reward_mean": 4.679494717814871, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.8246816013461595, 4.570285156798487, 1.8196161222780072, 9.563272261841542, 3.6747274189726884, 5.064172579281261, 4.689457011343387, 5.229745590657432], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17582975574614923, "mean_inference_ms": 0.9227689171790481, "mean_action_processing_ms": 0.03927648253622537, "mean_env_wait_ms": 0.8815020453103404, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 204800, "timers": {"sample_time_ms": 4108.566, "sample_throughput": 3115.442, "learn_time_ms": 3559.253, "learn_throughput": 3596.26, "update_time_ms": 1.58}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.012093396196141838, "policy_loss": -0.050747504308819774, "vf_loss": 0.023635902926325798, "vf_explained_var": 0.8673790693283081, "kl": 0.015018206620588899, "entropy": -3.563790783882141, "entropy_coeff": 0.0}}, "num_steps_sampled": 204800, "num_steps_trained": 204800}, "done": false, "episodes_total": 192, "training_iteration": 16, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-00-39", "timestamp": 1617649239, "time_this_iter_s": 7.672418117523193, "time_total_s": 114.6681637763977, "pid": 20226, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.672418117523193, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.02727272727273, "ram_util_percent": 61.57272727272729}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 9.563272261841542, "episode_reward_min": 1.7398800781080688, "episode_reward_mean": 4.70667249673942, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.181835220184256, 3.1423631364484566, 4.9609705219246125, 5.465158899005018, 2.335037038255985, 6.61442068729084, 4.07000497755926, 2.9436324419331665, 3.6748198598036197, 4.910206043153754, 6.232999709148671, 6.380226614584551, 1.7398800781080688, 1.9251626964491741, 8.089996771347566, 6.857467484030124, 2.8246816013461595, 4.570285156798487, 1.8196161222780072, 9.563272261841542, 3.6747274189726884, 5.064172579281261, 4.689457011343387, 5.229745590657432], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18731604728135035, "mean_inference_ms": 0.9243556060242725, "mean_action_processing_ms": 0.039360411313681516, "mean_env_wait_ms": 0.867638222799699, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 217600, "timers": {"sample_time_ms": 3847.224, "sample_throughput": 3327.074, "learn_time_ms": 3715.954, "learn_throughput": 3444.607, "update_time_ms": 1.598}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.0012154650315642356, "policy_loss": -0.05030381384305656, "vf_loss": 0.03464494295418263, "vf_explained_var": 0.899259090423584, "kl": 0.01687433648854494, "entropy": -3.603085763454437, "entropy_coeff": 0.0}}, "num_steps_sampled": 217600, "num_steps_trained": 217600}, "done": false, "episodes_total": 208, "training_iteration": 17, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-00-46", "timestamp": 1617649246, "time_this_iter_s": 7.464463233947754, "time_total_s": 122.13262701034546, "pid": 20226, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.136881351470947, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.18181818181818, "ram_util_percent": 61.74545454545454}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 9.563272261841542, "episode_reward_min": 1.7398800781080688, "episode_reward_mean": 4.845491861356817, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.411561345473729, 4.748365563985425, 3.3795075452476233, 3.1246503643607078, 9.217994191268282, 3.282266911290167, 6.723910882269322, 7.207342837776794, 2.8246816013461595, 4.570285156798487, 1.8196161222780072, 9.563272261841542, 3.6747274189726884, 5.064172579281261, 4.689457011343387, 5.229745590657432, 6.181835220184256, 3.1423631364484566, 4.9609705219246125, 5.465158899005018, 2.335037038255985, 6.61442068729084, 4.07000497755926, 2.9436324419331665, 3.6748198598036197, 4.910206043153754, 6.232999709148671, 6.380226614584551, 1.7398800781080688, 1.9251626964491741, 8.089996771347566, 6.857467484030124], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18523626539015747, "mean_inference_ms": 0.9253388632381211, "mean_action_processing_ms": 0.03939983577637848, "mean_env_wait_ms": 0.8648424559865805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 230400, "timers": {"sample_time_ms": 3766.69, "sample_throughput": 3398.209, "learn_time_ms": 3756.278, "learn_throughput": 3407.628, "update_time_ms": 1.577}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.013774367440491915, "policy_loss": -0.054399595381692055, "vf_loss": 0.02512160207144916, "vf_explained_var": 0.9159549474716187, "kl": 0.01550362654030323, "entropy": -3.612286932468414, "entropy_coeff": 0.0}}, "num_steps_sampled": 230400, "num_steps_trained": 230400}, "done": false, "episodes_total": 216, "training_iteration": 18, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-00-54", "timestamp": 1617649254, "time_this_iter_s": 7.4490742683410645, "time_total_s": 129.58170127868652, "pid": 20226, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.58595561981201, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.5, "ram_util_percent": 61.82727272727273}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 17.6896161893298, "episode_reward_min": 1.7398800781080688, "episode_reward_mean": 5.5344803455362666, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6440008844370757, 7.845766488660155, 8.039720842485973, 6.035548934147565, 4.4924991226690825, 8.726273131805911, 6.973024655614124, 7.054375450311431, 3.0604739024260663, 3.937401578060337, 7.0620625296813415, 8.150913054356947, 7.946287047015636, 17.6896161893298, 5.956343089402074, 4.985010121919164, 2.8246816013461595, 4.570285156798487, 1.8196161222780072, 9.563272261841542, 3.6747274189726884, 5.064172579281261, 4.689457011343387, 5.229745590657432, 6.181835220184256, 3.1423631364484566, 4.9609705219246125, 5.465158899005018, 2.335037038255985, 6.61442068729084, 4.07000497755926, 2.9436324419331665, 3.6748198598036197, 4.910206043153754, 6.232999709148671, 6.380226614584551, 1.7398800781080688, 1.9251626964491741, 8.089996771347566, 6.857467484030124, 4.411561345473729, 4.748365563985425, 3.3795075452476233, 3.1246503643607078, 9.217994191268282, 3.282266911290167, 6.723910882269322, 7.207342837776794], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18569330480512455, "mean_inference_ms": 0.9349609286272508, "mean_action_processing_ms": 0.03944893931146956, "mean_env_wait_ms": 0.860852485540733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 243200, "timers": {"sample_time_ms": 3800.007, "sample_throughput": 3368.415, "learn_time_ms": 3734.438, "learn_throughput": 3427.557, "update_time_ms": 1.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.06501715152524412, "policy_loss": -0.04232270600274205, "vf_loss": 0.09313636340200901, "vf_explained_var": 0.854878306388855, "kl": 0.014203494451940059, "entropy": -3.6555732178688047, "entropy_coeff": 0.0}}, "num_steps_sampled": 243200, "num_steps_trained": 243200}, "done": false, "episodes_total": 232, "training_iteration": 19, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-01-01", "timestamp": 1617649261, "time_this_iter_s": 7.5757880210876465, "time_total_s": 137.15748929977417, "pid": 20226, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.161743640899658, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.190909090909095, "ram_util_percent": 61.93636363636363}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 17.6896161893298, "episode_reward_min": 1.7398800781080688, "episode_reward_mean": 5.951290302296215, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.502229955064144, 4.798340669886225, 3.973769617545538, 5.000057139222135, 8.661154250990567, 11.093707615839584, 6.351525166632374, 10.002090485405608, 9.542566894941709, 10.194959177543444, 7.937819243559074, 3.866815866806955, 2.7485721930841627, 8.381347050420548, 13.795222573569761, 5.377344860705124, 2.8246816013461595, 4.570285156798487, 1.8196161222780072, 9.563272261841542, 3.6747274189726884, 5.064172579281261, 4.689457011343387, 5.229745590657432, 6.181835220184256, 3.1423631364484566, 4.9609705219246125, 5.465158899005018, 2.335037038255985, 6.61442068729084, 4.07000497755926, 2.9436324419331665, 3.6748198598036197, 4.910206043153754, 6.232999709148671, 6.380226614584551, 1.7398800781080688, 1.9251626964491741, 8.089996771347566, 6.857467484030124, 4.411561345473729, 4.748365563985425, 3.3795075452476233, 3.1246503643607078, 9.217994191268282, 3.282266911290167, 6.723910882269322, 7.207342837776794, 2.6440008844370757, 7.845766488660155, 8.039720842485973, 6.035548934147565, 4.4924991226690825, 8.726273131805911, 6.973024655614124, 7.054375450311431, 3.0604739024260663, 3.937401578060337, 7.0620625296813415, 8.150913054356947, 7.946287047015636, 17.6896161893298, 5.956343089402074, 4.985010121919164], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18692252415989885, "mean_inference_ms": 0.938626532985575, "mean_action_processing_ms": 0.039492674620418416, "mean_env_wait_ms": 0.858380876325225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 256000, "timers": {"sample_time_ms": 3771.845, "sample_throughput": 3393.565, "learn_time_ms": 3782.645, "learn_throughput": 3383.876, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.04059015762060881, "policy_loss": -0.05116017831489444, "vf_loss": 0.07401925925165415, "vf_explained_var": 0.9063223004341125, "kl": 0.01773107715882361, "entropy": -3.693964066505432, "entropy_coeff": 0.0}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 248, "training_iteration": 20, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-01-09", "timestamp": 1617649269, "time_this_iter_s": 7.64243745803833, "time_total_s": 144.7999267578125, "pid": 20226, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.80418109893799, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.39999999999999, "ram_util_percent": 61.91818181818181}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 17.6896161893298, "episode_reward_min": 1.7398800781080688, "episode_reward_mean": 6.212292049408742, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.695503077514877, 9.826882315411337, 6.969542915450764, 7.912932168462252, 9.25965383991383, 5.41344825323133, 9.136774032758996, 10.187711607728264, 2.8246816013461595, 4.570285156798487, 1.8196161222780072, 9.563272261841542, 3.6747274189726884, 5.064172579281261, 4.689457011343387, 5.229745590657432, 6.181835220184256, 3.1423631364484566, 4.9609705219246125, 5.465158899005018, 2.335037038255985, 6.61442068729084, 4.07000497755926, 2.9436324419331665, 3.6748198598036197, 4.910206043153754, 6.232999709148671, 6.380226614584551, 1.7398800781080688, 1.9251626964491741, 8.089996771347566, 6.857467484030124, 4.411561345473729, 4.748365563985425, 3.3795075452476233, 3.1246503643607078, 9.217994191268282, 3.282266911290167, 6.723910882269322, 7.207342837776794, 2.6440008844370757, 7.845766488660155, 8.039720842485973, 6.035548934147565, 4.4924991226690825, 8.726273131805911, 6.973024655614124, 7.054375450311431, 3.0604739024260663, 3.937401578060337, 7.0620625296813415, 8.150913054356947, 7.946287047015636, 17.6896161893298, 5.956343089402074, 4.985010121919164, 3.502229955064144, 4.798340669886225, 3.973769617545538, 5.000057139222135, 8.661154250990567, 11.093707615839584, 6.351525166632374, 10.002090485405608, 9.542566894941709, 10.194959177543444, 7.937819243559074, 3.866815866806955, 2.7485721930841627, 8.381347050420548, 13.795222573569761, 5.377344860705124], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18667391635527147, "mean_inference_ms": 0.939175237389347, "mean_action_processing_ms": 0.03950340782332751, "mean_env_wait_ms": 0.8571698158022169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 268800, "timers": {"sample_time_ms": 3730.978, "sample_throughput": 3430.736, "learn_time_ms": 3914.205, "learn_throughput": 3270.141, "update_time_ms": 1.581}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": -0.0062272715847939255, "policy_loss": -0.05353200528770685, "vf_loss": 0.03103649119846523, "vf_explained_var": 0.9382299780845642, "kl": 0.016268242970108985, "entropy": -3.67947252035141, "entropy_coeff": 0.0}}, "num_steps_sampled": 268800, "num_steps_trained": 268800}, "done": false, "episodes_total": 256, "training_iteration": 21, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-01-17", "timestamp": 1617649277, "time_this_iter_s": 8.10601806640625, "time_total_s": 152.90594482421875, "pid": 20226, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.91019916534424, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.881818181818176, "ram_util_percent": 59.94545454545455}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 17.6896161893298, "episode_reward_min": 1.7398800781080688, "episode_reward_mean": 6.783019875484962, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.079888007769762, 8.121663133586036, 17.543378290687734, 9.332320463433627, 9.641763432974615, 10.17372757194524, 13.632679835463888, 6.795361920174866, 6.078560518937129, 10.927295713842488, 10.73924900246263, 6.323488318305836, 5.375329137811988, 6.183765217317796, 6.0854370869509316, 9.586813833582676, 2.8246816013461595, 4.570285156798487, 1.8196161222780072, 9.563272261841542, 3.6747274189726884, 5.064172579281261, 4.689457011343387, 5.229745590657432, 6.181835220184256, 3.1423631364484566, 4.9609705219246125, 5.465158899005018, 2.335037038255985, 6.61442068729084, 4.07000497755926, 2.9436324419331665, 3.6748198598036197, 4.910206043153754, 6.232999709148671, 6.380226614584551, 1.7398800781080688, 1.9251626964491741, 8.089996771347566, 6.857467484030124, 4.411561345473729, 4.748365563985425, 3.3795075452476233, 3.1246503643607078, 9.217994191268282, 3.282266911290167, 6.723910882269322, 7.207342837776794, 2.6440008844370757, 7.845766488660155, 8.039720842485973, 6.035548934147565, 4.4924991226690825, 8.726273131805911, 6.973024655614124, 7.054375450311431, 3.0604739024260663, 3.937401578060337, 7.0620625296813415, 8.150913054356947, 7.946287047015636, 17.6896161893298, 5.956343089402074, 4.985010121919164, 3.502229955064144, 4.798340669886225, 3.973769617545538, 5.000057139222135, 8.661154250990567, 11.093707615839584, 6.351525166632374, 10.002090485405608, 9.542566894941709, 10.194959177543444, 7.937819243559074, 3.866815866806955, 2.7485721930841627, 8.381347050420548, 13.795222573569761, 5.377344860705124, 7.695503077514877, 9.826882315411337, 6.969542915450764, 7.912932168462252, 9.25965383991383, 5.41344825323133, 9.136774032758996, 10.187711607728264], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1889898436306905, "mean_inference_ms": 0.9488095092107575, "mean_action_processing_ms": 0.0399101698559915, "mean_env_wait_ms": 0.8636221346435236, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 281600, "timers": {"sample_time_ms": 3933.631, "sample_throughput": 3253.991, "learn_time_ms": 3917.236, "learn_throughput": 3267.61, "update_time_ms": 1.635}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.053626200328581036, "policy_loss": -0.04667324205860496, "vf_loss": 0.08369501799345017, "vf_explained_var": 0.9165859818458557, "kl": 0.016604422917589547, "entropy": -3.71262656211853, "entropy_coeff": 0.0}}, "num_steps_sampled": 281600, "num_steps_trained": 281600}, "done": false, "episodes_total": 272, "training_iteration": 22, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-01-26", "timestamp": 1617649286, "time_this_iter_s": 9.092204332351685, "time_total_s": 161.99814915657043, "pid": 20226, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 55.00240349769592, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 62.130769230769225, "ram_util_percent": 61.88461538461537}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 11.591176832694071, "episode_reward_min": 4.524048818848433, "episode_reward_mean": 7.395951577512998, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.780311721840176, 6.909166774149304, 5.319854742840186, 11.591176832694071, 5.4367928691489595, 8.002123719328381, 9.604137141254474, 4.524048818848433], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17737459942819475, "mean_inference_ms": 1.0440537402363288, "mean_action_processing_ms": 0.04474804745399527, "mean_env_wait_ms": 0.9947917485222229, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 294400, "timers": {"sample_time_ms": 4310.429, "sample_throughput": 2969.542, "learn_time_ms": 3492.075, "learn_throughput": 3665.442, "update_time_ms": 1.955}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 3.955308347940445e-05, "policy_loss": -0.05222073093056679, "vf_loss": 0.03582724208012223, "vf_explained_var": 0.9399451613426208, "kl": 0.01643304099328816, "entropy": -3.711590847969055, "entropy_coeff": 0.0}}, "num_steps_sampled": 294400, "num_steps_trained": 294400}, "done": false, "episodes_total": 280, "training_iteration": 23, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-03-27", "timestamp": 1617649407, "time_this_iter_s": 7.809713363647461, "time_total_s": 169.8078625202179, "pid": 21910, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.809713363647461, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.56666666666667, "ram_util_percent": 61.78333333333333}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 22.40671862344006, "episode_reward_min": 4.524048818848433, "episode_reward_mean": 11.227362643725286, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.575190571756973, 9.707591699000158, 12.1420967799855, 12.472530180252793, 17.235516007489004, 12.935757852064674, 8.409945212027393, 10.553044363858508, 17.134222250842306, 10.074456199939958, 22.40671862344006, 7.777714650135039, 8.989951455679666, 16.498755949136946, 16.33989295731021, 7.035706076383656, 7.780311721840176, 6.909166774149304, 5.319854742840186, 11.591176832694071, 5.4367928691489595, 8.002123719328381, 9.604137141254474, 4.524048818848433], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19289453481761684, "mean_inference_ms": 1.0302524540636402, "mean_action_processing_ms": 0.04429854225185235, "mean_env_wait_ms": 0.9697148689163063, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 307200, "timers": {"sample_time_ms": 4068.135, "sample_throughput": 3146.405, "learn_time_ms": 3876.624, "learn_throughput": 3301.842, "update_time_ms": 1.721}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.14557815488427878, "policy_loss": -0.04462187549099326, "vf_loss": 0.17408318519592286, "vf_explained_var": 0.8933869004249573, "kl": 0.01611684450879693, "entropy": -3.759554445743561, "entropy_coeff": 0.0}}, "num_steps_sampled": 307200, "num_steps_trained": 307200}, "done": false, "episodes_total": 296, "training_iteration": 24, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-03-35", "timestamp": 1617649415, "time_this_iter_s": 8.093327045440674, "time_total_s": 177.90118956565857, "pid": 21910, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.903040409088135, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 57.3909090909091, "ram_util_percent": 57.9909090909091}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 22.6874349452313, "episode_reward_min": 4.524048818848433, "episode_reward_mean": 11.767740939412093, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.014047014127055, 9.807369618259854, 11.544150615586272, 22.6874349452313, 13.433980899038446, 10.125358168559433, 18.002809443654296, 11.495855907323476, 7.780311721840176, 6.909166774149304, 5.319854742840186, 11.591176832694071, 5.4367928691489595, 8.002123719328381, 9.604137141254474, 4.524048818848433, 20.575190571756973, 9.707591699000158, 12.1420967799855, 12.472530180252793, 17.235516007489004, 12.935757852064674, 8.409945212027393, 10.553044363858508, 17.134222250842306, 10.074456199939958, 22.40671862344006, 7.777714650135039, 8.989951455679666, 16.498755949136946, 16.33989295731021, 7.035706076383656], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19298575606593604, "mean_inference_ms": 1.0248264326952918, "mean_action_processing_ms": 0.044025210934698814, "mean_env_wait_ms": 0.9602406897593363, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 320000, "timers": {"sample_time_ms": 3947.716, "sample_throughput": 3242.381, "learn_time_ms": 3865.971, "learn_throughput": 3310.941, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.07759028621017933, "policy_loss": -0.04537734334822744, "vf_loss": 0.1074677299708128, "vf_explained_var": 0.9253640174865723, "kl": 0.015499900868162513, "entropy": -3.73980596780777, "entropy_coeff": 0.0}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 304, "training_iteration": 25, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-03-43", "timestamp": 1617649423, "time_this_iter_s": 7.5586488246917725, "time_total_s": 185.45983839035034, "pid": 21910, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.461689233779907, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.59090909090909, "ram_util_percent": 61.845454545454544}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 31.078736203518304, "episode_reward_min": 4.524048818848433, "episode_reward_mean": 12.225983557737218, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.212872896274163, 30.870336609982623, 6.175083890683181, 15.794469432961137, 20.52938577119435, 14.109690591654985, 11.353515881550232, 9.15889338145349, 10.757742687829191, 8.918879990097686, 8.54897561231544, 6.128308412242066, 31.078736203518304, 10.315508913041542, 10.733499695842212, 9.593600739558928, 7.780311721840176, 6.909166774149304, 5.319854742840186, 11.591176832694071, 5.4367928691489595, 8.002123719328381, 9.604137141254474, 4.524048818848433, 20.575190571756973, 9.707591699000158, 12.1420967799855, 12.472530180252793, 17.235516007489004, 12.935757852064674, 8.409945212027393, 10.553044363858508, 17.134222250842306, 10.074456199939958, 22.40671862344006, 7.777714650135039, 8.989951455679666, 16.498755949136946, 16.33989295731021, 7.035706076383656, 10.014047014127055, 9.807369618259854, 11.544150615586272, 22.6874349452313, 13.433980899038446, 10.125358168559433, 18.002809443654296, 11.495855907323476], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19435520393950456, "mean_inference_ms": 1.022295491698939, "mean_action_processing_ms": 0.04351949751103416, "mean_env_wait_ms": 0.9442853286067606, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 332800, "timers": {"sample_time_ms": 3922.302, "sample_throughput": 3263.39, "learn_time_ms": 3833.273, "learn_throughput": 3339.183, "update_time_ms": 1.555}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.23257531091570854, "policy_loss": -0.04045606506988406, "vf_loss": 0.2586124753206968, "vf_explained_var": 0.8782689571380615, "kl": 0.014418900543823839, "entropy": -3.789537069797516, "entropy_coeff": 0.0}}, "num_steps_sampled": 332800, "num_steps_trained": 332800}, "done": false, "episodes_total": 320, "training_iteration": 26, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-03-50", "timestamp": 1617649430, "time_this_iter_s": 7.588589191436768, "time_total_s": 193.0484275817871, "pid": 21910, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.050278425216675, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.25454545454546, "ram_util_percent": 61.945454545454545}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 31.078736203518304, "episode_reward_min": 4.524048818848433, "episode_reward_mean": 12.829717853598058, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.082685224369861, 8.23404382722943, 17.74239827303519, 16.477999510071086, 23.073098139744513, 13.944702493512315, 10.218541411746184, 6.889595037827825, 28.48579022700957, 18.235227210967093, 16.601656851544355, 14.286292140829435, 8.745270214759234, 14.458943527097876, 8.70718793764386, 13.071299831501507, 7.780311721840176, 6.909166774149304, 5.319854742840186, 11.591176832694071, 5.4367928691489595, 8.002123719328381, 9.604137141254474, 4.524048818848433, 20.575190571756973, 9.707591699000158, 12.1420967799855, 12.472530180252793, 17.235516007489004, 12.935757852064674, 8.409945212027393, 10.553044363858508, 17.134222250842306, 10.074456199939958, 22.40671862344006, 7.777714650135039, 8.989951455679666, 16.498755949136946, 16.33989295731021, 7.035706076383656, 10.014047014127055, 9.807369618259854, 11.544150615586272, 22.6874349452313, 13.433980899038446, 10.125358168559433, 18.002809443654296, 11.495855907323476, 6.212872896274163, 30.870336609982623, 6.175083890683181, 15.794469432961137, 20.52938577119435, 14.109690591654985, 11.353515881550232, 9.15889338145349, 10.757742687829191, 8.918879990097686, 8.54897561231544, 6.128308412242066, 31.078736203518304, 10.315508913041542, 10.733499695842212, 9.593600739558928], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19639978603346636, "mean_inference_ms": 1.0194515340103079, "mean_action_processing_ms": 0.04324867162426119, "mean_env_wait_ms": 0.9354804317945568, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 345600, "timers": {"sample_time_ms": 3902.117, "sample_throughput": 3280.27, "learn_time_ms": 3801.448, "learn_throughput": 3367.138, "update_time_ms": 1.539}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.23706489115953444, "policy_loss": -0.04209277910646051, "vf_loss": 0.26339055605232714, "vf_explained_var": 0.9105678796768188, "kl": 0.01576711505651474, "entropy": -3.8555232739448546, "entropy_coeff": 0.0}}, "num_steps_sampled": 345600, "num_steps_trained": 345600}, "done": false, "episodes_total": 336, "training_iteration": 27, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-03-58", "timestamp": 1617649438, "time_this_iter_s": 7.502836227416992, "time_total_s": 200.5512638092041, "pid": 21910, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.55311465263367, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.290909090909096, "ram_util_percent": 62.054545454545455}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 36.406425136008096, "episode_reward_min": 4.524048818848433, "episode_reward_mean": 13.148812149532198, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.031068414294467, 9.969960219179182, 5.864349178822953, 36.406425136008096, 13.181875768353997, 11.323324779185405, 16.909797589613916, 11.925731050584423, 7.780311721840176, 6.909166774149304, 5.319854742840186, 11.591176832694071, 5.4367928691489595, 8.002123719328381, 9.604137141254474, 4.524048818848433, 20.575190571756973, 9.707591699000158, 12.1420967799855, 12.472530180252793, 17.235516007489004, 12.935757852064674, 8.409945212027393, 10.553044363858508, 17.134222250842306, 10.074456199939958, 22.40671862344006, 7.777714650135039, 8.989951455679666, 16.498755949136946, 16.33989295731021, 7.035706076383656, 10.014047014127055, 9.807369618259854, 11.544150615586272, 22.6874349452313, 13.433980899038446, 10.125358168559433, 18.002809443654296, 11.495855907323476, 6.212872896274163, 30.870336609982623, 6.175083890683181, 15.794469432961137, 20.52938577119435, 14.109690591654985, 11.353515881550232, 9.15889338145349, 10.757742687829191, 8.918879990097686, 8.54897561231544, 6.128308412242066, 31.078736203518304, 10.315508913041542, 10.733499695842212, 9.593600739558928, 15.082685224369861, 8.23404382722943, 17.74239827303519, 16.477999510071086, 23.073098139744513, 13.944702493512315, 10.218541411746184, 6.889595037827825, 28.48579022700957, 18.235227210967093, 16.601656851544355, 14.286292140829435, 8.745270214759234, 14.458943527097876, 8.70718793764386, 13.071299831501507], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.196580451233917, "mean_inference_ms": 1.018429362189977, "mean_action_processing_ms": 0.04317226647984267, "mean_env_wait_ms": 0.9326430247051645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 358400, "timers": {"sample_time_ms": 3887.734, "sample_throughput": 3292.406, "learn_time_ms": 3784.0, "learn_throughput": 3382.664, "update_time_ms": 1.545}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.11154678693972528, "policy_loss": -0.047659807363525035, "vf_loss": 0.1443739176541567, "vf_explained_var": 0.9191629886627197, "kl": 0.0148326766025275, "entropy": -3.7980573391914367, "entropy_coeff": 0.0}}, "num_steps_sampled": 358400, "num_steps_trained": 358400}, "done": false, "episodes_total": 344, "training_iteration": 28, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-04-05", "timestamp": 1617649445, "time_this_iter_s": 7.520034074783325, "time_total_s": 208.07129788398743, "pid": 21910, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.07314872741699, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 45.269999999999996, "ram_util_percent": 62.06}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 36.406425136008096, "episode_reward_min": 4.524048818848433, "episode_reward_mean": 13.767663827910155, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.072853814087205, 14.735180779684882, 27.44789868815346, 12.816541330969724, 22.102914055811084, 13.742053559043162, 25.569475629958887, 21.467133660663926, 12.38414895224362, 15.256761807959183, 5.341515866984945, 16.58468263528959, 11.652270493170505, 14.165113506816894, 26.976647619651146, 14.524749689287166, 7.780311721840176, 6.909166774149304, 5.319854742840186, 11.591176832694071, 5.4367928691489595, 8.002123719328381, 9.604137141254474, 4.524048818848433, 20.575190571756973, 9.707591699000158, 12.1420967799855, 12.472530180252793, 17.235516007489004, 12.935757852064674, 8.409945212027393, 10.553044363858508, 17.134222250842306, 10.074456199939958, 22.40671862344006, 7.777714650135039, 8.989951455679666, 16.498755949136946, 16.33989295731021, 7.035706076383656, 10.014047014127055, 9.807369618259854, 11.544150615586272, 22.6874349452313, 13.433980899038446, 10.125358168559433, 18.002809443654296, 11.495855907323476, 6.212872896274163, 30.870336609982623, 6.175083890683181, 15.794469432961137, 20.52938577119435, 14.109690591654985, 11.353515881550232, 9.15889338145349, 10.757742687829191, 8.918879990097686, 8.54897561231544, 6.128308412242066, 31.078736203518304, 10.315508913041542, 10.733499695842212, 9.593600739558928, 15.082685224369861, 8.23404382722943, 17.74239827303519, 16.477999510071086, 23.073098139744513, 13.944702493512315, 10.218541411746184, 6.889595037827825, 28.48579022700957, 18.235227210967093, 16.601656851544355, 14.286292140829435, 8.745270214759234, 14.458943527097876, 8.70718793764386, 13.071299831501507, 20.031068414294467, 9.969960219179182, 5.864349178822953, 36.406425136008096, 13.181875768353997, 11.323324779185405, 16.909797589613916, 11.925731050584423], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19750032690941846, "mean_inference_ms": 1.0178712052577326, "mean_action_processing_ms": 0.04311606147549569, "mean_env_wait_ms": 0.9297680490426707, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 371200, "timers": {"sample_time_ms": 3901.777, "sample_throughput": 3280.557, "learn_time_ms": 3746.527, "learn_throughput": 3416.498, "update_time_ms": 1.557}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.2175548217818141, "policy_loss": -0.04080511638894677, "vf_loss": 0.24203993663191795, "vf_explained_var": 0.9302855134010315, "kl": 0.016320003867149352, "entropy": -3.8713354086875915, "entropy_coeff": 0.0}}, "num_steps_sampled": 371200, "num_steps_trained": 371200}, "done": false, "episodes_total": 360, "training_iteration": 29, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-04-13", "timestamp": 1617649453, "time_this_iter_s": 7.5164501667022705, "time_total_s": 215.5877480506897, "pid": 21910, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.58959889411926, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 46.40909090909091, "ram_util_percent": 62.07272727272727}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 34.40530090536846, "episode_reward_min": 9.547424917190162, "episode_reward_mean": 21.378605438222927, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.40530090536846, 15.471426065593032, 23.251700576799248, 19.695350111646725, 19.0678664827171, 9.547424917190162, 21.70835419346318, 27.88142025300549], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17904110955566557, "mean_inference_ms": 0.9351728820264673, "mean_action_processing_ms": 0.04058642583962606, "mean_env_wait_ms": 0.8904479541754737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 384000, "timers": {"sample_time_ms": 3972.948, "sample_throughput": 3221.789, "learn_time_ms": 4249.645, "learn_throughput": 3012.016, "update_time_ms": 1.425}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.14015885991975666, "policy_loss": -0.03889173088595271, "vf_loss": 0.1642660405486822, "vf_explained_var": 0.9323867559432983, "kl": 0.014784549782052635, "entropy": -3.8677939105033876, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 368, "training_iteration": 30, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-05-35", "timestamp": 1617649535, "time_this_iter_s": 8.227783679962158, "time_total_s": 223.81553173065186, "pid": 22794, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.227783679962158, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 50.44166666666666, "ram_util_percent": 58.833333333333336}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 34.40530090536846, "episode_reward_min": 9.547424917190162, "episode_reward_mean": 18.763273758940098, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.598349295268893, 13.379870063793824, 11.727042794497644, 20.143801134110397, 14.20197631879979, 23.8899389658014, 16.42110659323123, 21.224425951301395, 19.69530971792175, 20.09225629005766, 23.768450166970634, 14.95265291069162, 14.562754778901985, 23.715269384767808, 13.036279538389678, 11.880242804273294, 34.40530090536846, 15.471426065593032, 23.251700576799248, 19.695350111646725, 19.0678664827171, 9.547424917190162, 21.70835419346318, 27.88142025300549], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2052523102710666, "mean_inference_ms": 1.0179590548434239, "mean_action_processing_ms": 0.044203755910720954, "mean_env_wait_ms": 0.9589523332258768, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 396800, "timers": {"sample_time_ms": 4266.149, "sample_throughput": 3000.364, "learn_time_ms": 4061.421, "learn_throughput": 3151.606, "update_time_ms": 1.403}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.17873055041767658, "policy_loss": -0.041907828440889715, "vf_loss": 0.20389848127961158, "vf_explained_var": 0.9556453824043274, "kl": 0.016739897886291145, "entropy": -3.915120453834534, "entropy_coeff": 0.0}}, "num_steps_sampled": 396800, "num_steps_trained": 396800}, "done": false, "episodes_total": 384, "training_iteration": 31, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-05-44", "timestamp": 1617649544, "time_this_iter_s": 8.43947458267212, "time_total_s": 232.25500631332397, "pid": 22794, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.667258262634277, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 53.208333333333336, "ram_util_percent": 61.81666666666666}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 34.40530090536846, "episode_reward_min": 7.756139231979084, "episode_reward_mean": 18.404304170399623, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.933969481042528, 7.756139231979084, 22.49260136366046, 14.159993684154239, 23.59711146309773, 14.355252954608805, 26.311735839684445, 9.012359219998247, 34.40530090536846, 15.471426065593032, 23.251700576799248, 19.695350111646725, 19.0678664827171, 9.547424917190162, 21.70835419346318, 27.88142025300549, 16.598349295268893, 13.379870063793824, 11.727042794497644, 20.143801134110397, 14.20197631879979, 23.8899389658014, 16.42110659323123, 21.224425951301395, 19.69530971792175, 20.09225629005766, 23.768450166970634, 14.95265291069162, 14.562754778901985, 23.715269384767808, 13.036279538389678, 11.880242804273294], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20579811049632582, "mean_inference_ms": 1.0325949004375914, "mean_action_processing_ms": 0.044790755735319245, "mean_env_wait_ms": 0.9698749476792319, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 409600, "timers": {"sample_time_ms": 4240.527, "sample_throughput": 3018.493, "learn_time_ms": 3986.719, "learn_throughput": 3210.66, "update_time_ms": 1.552}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.15322785526514054, "policy_loss": -0.045665278756059705, "vf_loss": 0.182411504983902, "vf_explained_var": 0.9478023648262024, "kl": 0.016481629656627774, "entropy": -3.902207126617432, "entropy_coeff": 0.0}}, "num_steps_sampled": 409600, "num_steps_trained": 409600}, "done": false, "episodes_total": 392, "training_iteration": 32, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-05-52", "timestamp": 1617649552, "time_this_iter_s": 8.035358428955078, "time_total_s": 240.29036474227905, "pid": 22794, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.702616691589355, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.29166666666668, "ram_util_percent": 61.949999999999996}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 42.7614694109433, "episode_reward_min": 7.756139231979084, "episode_reward_mean": 19.97964353699936, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.239572473883694, 14.549497195571705, 15.870917033294756, 16.989436876264712, 10.96100266821373, 26.725077581288286, 38.3708179556274, 30.82355424267989, 28.09922312040407, 12.70242478998471, 16.68164970113068, 42.7614694109433, 21.49250495145801, 28.610700032531327, 15.489346342959262, 30.717961946945934, 34.40530090536846, 15.471426065593032, 23.251700576799248, 19.695350111646725, 19.0678664827171, 9.547424917190162, 21.70835419346318, 27.88142025300549, 16.598349295268893, 13.379870063793824, 11.727042794497644, 20.143801134110397, 14.20197631879979, 23.8899389658014, 16.42110659323123, 21.224425951301395, 19.69530971792175, 20.09225629005766, 23.768450166970634, 14.95265291069162, 14.562754778901985, 23.715269384767808, 13.036279538389678, 11.880242804273294, 20.933969481042528, 7.756139231979084, 22.49260136366046, 14.159993684154239, 23.59711146309773, 14.355252954608805, 26.311735839684445, 9.012359219998247], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2098412159597578, "mean_inference_ms": 1.0612030060620488, "mean_action_processing_ms": 0.045450299953994654, "mean_env_wait_ms": 0.982292667865719, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 422400, "timers": {"sample_time_ms": 4318.119, "sample_throughput": 2964.253, "learn_time_ms": 3919.381, "learn_throughput": 3265.822, "update_time_ms": 1.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.3486818164587021, "policy_loss": -0.040090036345645785, "vf_loss": 0.372846624404192, "vf_explained_var": 0.9210227727890015, "kl": 0.015925229368731378, "entropy": -3.951165707111359, "entropy_coeff": 0.0}}, "num_steps_sampled": 422400, "num_steps_trained": 422400}, "done": false, "episodes_total": 408, "training_iteration": 33, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-06-00", "timestamp": 1617649560, "time_this_iter_s": 8.275023698806763, "time_total_s": 248.56538844108582, "pid": 22794, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.97764039039612, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 50.0, "ram_util_percent": 62.116666666666674}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 48.99696701728295, "episode_reward_min": 7.756139231979084, "episode_reward_mean": 22.59825114687755, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.893800084496515, 31.579871612019808, 24.537853164834114, 43.579552602109686, 27.923209112789447, 40.18176433777417, 17.492103948303644, 22.377743790663498, 48.99696701728295, 38.82779786253882, 25.99787051399453, 23.82267112786241, 17.610322383218033, 26.475858443715865, 34.62151332338271, 41.34628429920774, 34.40530090536846, 15.471426065593032, 23.251700576799248, 19.695350111646725, 19.0678664827171, 9.547424917190162, 21.70835419346318, 27.88142025300549, 16.598349295268893, 13.379870063793824, 11.727042794497644, 20.143801134110397, 14.20197631879979, 23.8899389658014, 16.42110659323123, 21.224425951301395, 19.69530971792175, 20.09225629005766, 23.768450166970634, 14.95265291069162, 14.562754778901985, 23.715269384767808, 13.036279538389678, 11.880242804273294, 20.933969481042528, 7.756139231979084, 22.49260136366046, 14.159993684154239, 23.59711146309773, 14.355252954608805, 26.311735839684445, 9.012359219998247, 19.239572473883694, 14.549497195571705, 15.870917033294756, 16.989436876264712, 10.96100266821373, 26.725077581288286, 38.3708179556274, 30.82355424267989, 28.09922312040407, 12.70242478998471, 16.68164970113068, 42.7614694109433, 21.49250495145801, 28.610700032531327, 15.489346342959262, 30.717961946945934], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21310394765996243, "mean_inference_ms": 1.0764211983487126, "mean_action_processing_ms": 0.04590683956235073, "mean_env_wait_ms": 0.9905419668157416, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 435200, "timers": {"sample_time_ms": 4335.171, "sample_throughput": 2952.594, "learn_time_ms": 3866.424, "learn_throughput": 3310.552, "update_time_ms": 1.54}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.4941453818976879, "policy_loss": -0.03834547820035368, "vf_loss": 0.5133826318383217, "vf_explained_var": 0.9172449707984924, "kl": 0.019108229149132967, "entropy": -4.030564396381378, "entropy_coeff": 0.0}}, "num_steps_sampled": 435200, "num_steps_trained": 435200}, "done": false, "episodes_total": 424, "training_iteration": 34, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-06-08", "timestamp": 1617649568, "time_this_iter_s": 8.065679788589478, "time_total_s": 256.6310682296753, "pid": 22794, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.043320178985596, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 50.83636363636363, "ram_util_percent": 62.2090909090909}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 49.271053820350275, "episode_reward_min": 7.756139231979084, "episode_reward_mean": 23.434358426681733, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.915924075993047, 32.79782769383073, 38.173943648080254, 49.271053820350275, 22.103495963031175, 33.863883198212136, 25.52020900674269, 22.339395914681212, 34.40530090536846, 15.471426065593032, 23.251700576799248, 19.695350111646725, 19.0678664827171, 9.547424917190162, 21.70835419346318, 27.88142025300549, 16.598349295268893, 13.379870063793824, 11.727042794497644, 20.143801134110397, 14.20197631879979, 23.8899389658014, 16.42110659323123, 21.224425951301395, 19.69530971792175, 20.09225629005766, 23.768450166970634, 14.95265291069162, 14.562754778901985, 23.715269384767808, 13.036279538389678, 11.880242804273294, 20.933969481042528, 7.756139231979084, 22.49260136366046, 14.159993684154239, 23.59711146309773, 14.355252954608805, 26.311735839684445, 9.012359219998247, 19.239572473883694, 14.549497195571705, 15.870917033294756, 16.989436876264712, 10.96100266821373, 26.725077581288286, 38.3708179556274, 30.82355424267989, 28.09922312040407, 12.70242478998471, 16.68164970113068, 42.7614694109433, 21.49250495145801, 28.610700032531327, 15.489346342959262, 30.717961946945934, 21.893800084496515, 31.579871612019808, 24.537853164834114, 43.579552602109686, 27.923209112789447, 40.18176433777417, 17.492103948303644, 22.377743790663498, 48.99696701728295, 38.82779786253882, 25.99787051399453, 23.82267112786241, 17.610322383218033, 26.475858443715865, 34.62151332338271, 41.34628429920774], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21374274632174786, "mean_inference_ms": 1.0815221030036684, "mean_action_processing_ms": 0.04607246269622719, "mean_env_wait_ms": 0.993639386021404, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 448000, "timers": {"sample_time_ms": 4326.562, "sample_throughput": 2958.469, "learn_time_ms": 3906.324, "learn_throughput": 3276.738, "update_time_ms": 1.634}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.27746573138982056, "policy_loss": -0.03608940724283457, "vf_loss": 0.2971556513011456, "vf_explained_var": 0.9380499124526978, "kl": 0.016399489464238286, "entropy": -3.933860893249512, "entropy_coeff": 0.0}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 432, "training_iteration": 35, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-06-16", "timestamp": 1617649576, "time_this_iter_s": 8.398569583892822, "time_total_s": 265.0296378135681, "pid": 22794, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.44188976287842, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 49.783333333333324, "ram_util_percent": 62.116666666666674}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 49.271053820350275, "episode_reward_min": 7.756139231979084, "episode_reward_mean": 23.946992814296166, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.07756398380678, 36.47091580954794, 12.347353712376824, 29.503039787545152, 31.912749053390634, 25.963570731444488, 40.50579070081856, 30.665879715902598, 19.622069930427035, 39.01167136831045, 18.046190320202445, 23.53171299809613, 28.310025847447385, 21.29093794059214, 24.959815779827796, 13.842273257241335, 34.40530090536846, 15.471426065593032, 23.251700576799248, 19.695350111646725, 19.0678664827171, 9.547424917190162, 21.70835419346318, 27.88142025300549, 16.598349295268893, 13.379870063793824, 11.727042794497644, 20.143801134110397, 14.20197631879979, 23.8899389658014, 16.42110659323123, 21.224425951301395, 19.69530971792175, 20.09225629005766, 23.768450166970634, 14.95265291069162, 14.562754778901985, 23.715269384767808, 13.036279538389678, 11.880242804273294, 20.933969481042528, 7.756139231979084, 22.49260136366046, 14.159993684154239, 23.59711146309773, 14.355252954608805, 26.311735839684445, 9.012359219998247, 19.239572473883694, 14.549497195571705, 15.870917033294756, 16.989436876264712, 10.96100266821373, 26.725077581288286, 38.3708179556274, 30.82355424267989, 28.09922312040407, 12.70242478998471, 16.68164970113068, 42.7614694109433, 21.49250495145801, 28.610700032531327, 15.489346342959262, 30.717961946945934, 21.893800084496515, 31.579871612019808, 24.537853164834114, 43.579552602109686, 27.923209112789447, 40.18176433777417, 17.492103948303644, 22.377743790663498, 48.99696701728295, 38.82779786253882, 25.99787051399453, 23.82267112786241, 17.610322383218033, 26.475858443715865, 34.62151332338271, 41.34628429920774, 16.915924075993047, 32.79782769383073, 38.173943648080254, 49.271053820350275, 22.103495963031175, 33.863883198212136, 25.52020900674269, 22.339395914681212], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21571955079557076, "mean_inference_ms": 1.0903185440511887, "mean_action_processing_ms": 0.04639218671035259, "mean_env_wait_ms": 0.999884899566468, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 460800, "timers": {"sample_time_ms": 4358.812, "sample_throughput": 2936.58, "learn_time_ms": 3862.171, "learn_throughput": 3314.198, "update_time_ms": 1.626}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.4664719881117344, "policy_loss": -0.04071457281708717, "vf_loss": 0.48959550485014913, "vf_explained_var": 0.9409509301185608, "kl": 0.01759106225334108, "entropy": -4.030005934238434, "entropy_coeff": 0.0}}, "num_steps_sampled": 460800, "num_steps_trained": 460800}, "done": false, "episodes_total": 448, "training_iteration": 36, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-06-25", "timestamp": 1617649585, "time_this_iter_s": 8.15694785118103, "time_total_s": 273.18658566474915, "pid": 22794, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 57.59883761405945, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 51.15, "ram_util_percent": 62.07500000000001}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 42.0171881745623, "episode_reward_min": 11.985094606748511, "episode_reward_mean": 26.80782754106241, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.7866525268168, 20.589474675250234, 29.605995033300207, 11.985094606748511, 25.324961548224326, 42.0171881745623, 21.20830485779242, 34.94494890580446], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20021170396346138, "mean_inference_ms": 1.2598443336594036, "mean_action_processing_ms": 0.052646463323875486, "mean_env_wait_ms": 1.2047636106861597, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 473600, "timers": {"sample_time_ms": 4962.373, "sample_throughput": 2579.411, "learn_time_ms": 3818.092, "learn_throughput": 3352.46, "update_time_ms": 1.743}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.15329031383153052, "policy_loss": -0.03656434720847756, "vf_loss": 0.17346609108150005, "vf_explained_var": 0.9639263153076172, "kl": 0.016388569558039308, "entropy": -3.9827181625366213, "entropy_coeff": 0.0}}, "num_steps_sampled": 473600, "num_steps_trained": 473600}, "done": false, "episodes_total": 456, "training_iteration": 37, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-07-48", "timestamp": 1617649668, "time_this_iter_s": 8.785313129425049, "time_total_s": 281.9718987941742, "pid": 23702, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.785313129425049, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 60.01538461538462, "ram_util_percent": 61.538461538461554}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 76.76323789097209, "episode_reward_min": 11.985094606748511, "episode_reward_mean": 33.87887426020496, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.912647396163337, 36.431477022544705, 39.73893483646009, 76.76323789097209, 24.58373557499206, 25.763236849956076, 38.91387462228857, 49.190653512198715, 30.949007458696357, 46.57674883697444, 50.828167125845724, 49.4309710491835, 17.086720709838612, 22.5032230517283, 47.62319903274685, 14.334526945830344, 28.7866525268168, 20.589474675250234, 29.605995033300207, 11.985094606748511, 25.324961548224326, 42.0171881745623, 21.20830485779242, 34.94494890580446], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1931660041316807, "mean_inference_ms": 1.1215863440832483, "mean_action_processing_ms": 0.04713999172947511, "mean_env_wait_ms": 1.0521257805094015, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 486400, "timers": {"sample_time_ms": 4114.593, "sample_throughput": 3110.878, "learn_time_ms": 3965.657, "learn_throughput": 3227.712, "update_time_ms": 1.691}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 1.0240405213832855, "policy_loss": -0.033351322170346975, "vf_loss": 1.0390535113215447, "vf_explained_var": 0.8933127522468567, "kl": 0.018338332744315268, "entropy": -4.071917724609375, "entropy_coeff": 0.0}}, "num_steps_sampled": 486400, "num_steps_trained": 486400}, "done": false, "episodes_total": 472, "training_iteration": 38, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-07-55", "timestamp": 1617649675, "time_this_iter_s": 7.386824131011963, "time_total_s": 289.35872292518616, "pid": 23702, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.17213726043701, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.95454545454545, "ram_util_percent": 61.90909090909091}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 76.76323789097209, "episode_reward_min": 11.985094606748511, "episode_reward_mean": 35.145497475128664, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.38986914922898, 39.65256935351341, 40.60588835847051, 22.73440938194378, 33.58931658454616, 37.83380664891514, 49.10817153119417, 52.648905951386084, 28.7866525268168, 20.589474675250234, 29.605995033300207, 11.985094606748511, 25.324961548224326, 42.0171881745623, 21.20830485779242, 34.94494890580446, 27.912647396163337, 36.431477022544705, 39.73893483646009, 76.76323789097209, 24.58373557499206, 25.763236849956076, 38.91387462228857, 49.190653512198715, 30.949007458696357, 46.57674883697444, 50.828167125845724, 49.4309710491835, 17.086720709838612, 22.5032230517283, 47.62319903274685, 14.334526945830344], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1875758413976757, "mean_inference_ms": 1.0829622282019697, "mean_action_processing_ms": 0.04557270388816546, "mean_env_wait_ms": 1.0099715474855453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 499200, "timers": {"sample_time_ms": 3717.552, "sample_throughput": 3443.126, "learn_time_ms": 4010.433, "learn_throughput": 3191.676, "update_time_ms": 1.669}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.2750696047395468, "policy_loss": -0.039890012703835964, "vf_loss": 0.29741126209497454, "vf_explained_var": 0.9627770781517029, "kl": 0.017548354538157583, "entropy": -4.015920441150666, "entropy_coeff": 0.0}}, "num_steps_sampled": 499200, "num_steps_trained": 499200}, "done": false, "episodes_total": 480, "training_iteration": 39, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-02", "timestamp": 1617649682, "time_this_iter_s": 7.0299272537231445, "time_total_s": 296.3886501789093, "pid": 23702, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.202064514160156, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.349999999999994, "ram_util_percent": 61.9}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 79.50764877400795, "episode_reward_min": 11.985094606748511, "episode_reward_mean": 36.92658006525769, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.798607157728746, 38.65259901766505, 41.08153496401615, 38.80463141507356, 38.86454729833564, 35.29581248284322, 60.82515598497451, 50.38636326119915, 35.68557814333093, 79.50764877400795, 27.310189630193072, 23.69924846954437, 43.772106759111225, 50.735279676932635, 23.918641242011347, 17.481979651284245, 28.7866525268168, 20.589474675250234, 29.605995033300207, 11.985094606748511, 25.324961548224326, 42.0171881745623, 21.20830485779242, 34.94494890580446, 27.912647396163337, 36.431477022544705, 39.73893483646009, 76.76323789097209, 24.58373557499206, 25.763236849956076, 38.91387462228857, 49.190653512198715, 30.949007458696357, 46.57674883697444, 50.828167125845724, 49.4309710491835, 17.086720709838612, 22.5032230517283, 47.62319903274685, 14.334526945830344, 35.38986914922898, 39.65256935351341, 40.60588835847051, 22.73440938194378, 33.58931658454616, 37.83380664891514, 49.10817153119417, 52.648905951386084], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18218105113882518, "mean_inference_ms": 1.0396321876212502, "mean_action_processing_ms": 0.04345616197040949, "mean_env_wait_ms": 0.9534791830928365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 512000, "timers": {"sample_time_ms": 3624.836, "sample_throughput": 3531.194, "learn_time_ms": 3972.704, "learn_throughput": 3221.987, "update_time_ms": 1.63}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.8498751863837242, "policy_loss": -0.028263124907389282, "vf_loss": 0.8603989601135253, "vf_explained_var": 0.9361335635185242, "kl": 0.017739346921443938, "entropy": -4.119985394477844, "entropy_coeff": 0.0}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 496, "training_iteration": 40, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-09", "timestamp": 1617649689, "time_this_iter_s": 7.212775230407715, "time_total_s": 303.601425409317, "pid": 23702, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.41483974456787, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 37.13, "ram_util_percent": 61.989999999999995}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 79.50764877400795, "episode_reward_min": 11.985094606748511, "episode_reward_mean": 37.224859442937905, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.037361870442936, 25.33217468547002, 30.696616389995523, 45.14653798487993, 58.237154752430584, 36.20098456963346, 30.513641908862258, 46.21199809532222, 23.15210338914749, 53.667832690700756, 38.03667980606656, 20.20467019000072, 38.64186630030304, 29.10860847981799, 63.812800279564684, 29.914129823018666, 28.7866525268168, 20.589474675250234, 29.605995033300207, 11.985094606748511, 25.324961548224326, 42.0171881745623, 21.20830485779242, 34.94494890580446, 27.912647396163337, 36.431477022544705, 39.73893483646009, 76.76323789097209, 24.58373557499206, 25.763236849956076, 38.91387462228857, 49.190653512198715, 30.949007458696357, 46.57674883697444, 50.828167125845724, 49.4309710491835, 17.086720709838612, 22.5032230517283, 47.62319903274685, 14.334526945830344, 35.38986914922898, 39.65256935351341, 40.60588835847051, 22.73440938194378, 33.58931658454616, 37.83380664891514, 49.10817153119417, 52.648905951386084, 41.798607157728746, 38.65259901766505, 41.08153496401615, 38.80463141507356, 38.86454729833564, 35.29581248284322, 60.82515598497451, 50.38636326119915, 35.68557814333093, 79.50764877400795, 27.310189630193072, 23.69924846954437, 43.772106759111225, 50.735279676932635, 23.918641242011347, 17.481979651284245], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17958850282736266, "mean_inference_ms": 1.0101215342566978, "mean_action_processing_ms": 0.04212595834740106, "mean_env_wait_ms": 0.9182196314489457, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 524800, "timers": {"sample_time_ms": 3500.349, "sample_throughput": 3656.778, "learn_time_ms": 3964.659, "learn_throughput": 3228.524, "update_time_ms": 1.619}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.7658370412886143, "policy_loss": -0.035095331789925695, "vf_loss": 0.7823268440365791, "vf_explained_var": 0.9461259245872498, "kl": 0.018605526238679886, "entropy": -4.1841362905502315, "entropy_coeff": 0.0}}, "num_steps_sampled": 524800, "num_steps_trained": 524800}, "done": false, "episodes_total": 512, "training_iteration": 41, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-16", "timestamp": 1617649696, "time_this_iter_s": 6.941446781158447, "time_total_s": 310.54287219047546, "pid": 23702, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.35628652572632, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 36.83, "ram_util_percent": 61.9}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 79.50764877400795, "episode_reward_min": 11.985094606748511, "episode_reward_mean": 37.743086759326665, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.4639209820764, 37.105828710670366, 59.72824538973236, 41.548461745519134, 53.02470548907386, 37.01414086083579, 42.08850821475726, 34.1374309308289, 28.7866525268168, 20.589474675250234, 29.605995033300207, 11.985094606748511, 25.324961548224326, 42.0171881745623, 21.20830485779242, 34.94494890580446, 27.912647396163337, 36.431477022544705, 39.73893483646009, 76.76323789097209, 24.58373557499206, 25.763236849956076, 38.91387462228857, 49.190653512198715, 30.949007458696357, 46.57674883697444, 50.828167125845724, 49.4309710491835, 17.086720709838612, 22.5032230517283, 47.62319903274685, 14.334526945830344, 35.38986914922898, 39.65256935351341, 40.60588835847051, 22.73440938194378, 33.58931658454616, 37.83380664891514, 49.10817153119417, 52.648905951386084, 41.798607157728746, 38.65259901766505, 41.08153496401615, 38.80463141507356, 38.86454729833564, 35.29581248284322, 60.82515598497451, 50.38636326119915, 35.68557814333093, 79.50764877400795, 27.310189630193072, 23.69924846954437, 43.772106759111225, 50.735279676932635, 23.918641242011347, 17.481979651284245, 41.037361870442936, 25.33217468547002, 30.696616389995523, 45.14653798487993, 58.237154752430584, 36.20098456963346, 30.513641908862258, 46.21199809532222, 23.15210338914749, 53.667832690700756, 38.03667980606656, 20.20467019000072, 38.64186630030304, 29.10860847981799, 63.812800279564684, 29.914129823018666], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17799250223243077, "mean_inference_ms": 0.9981122117663206, "mean_action_processing_ms": 0.04160581246813085, "mean_env_wait_ms": 0.9045067617120731, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 537600, "timers": {"sample_time_ms": 3429.132, "sample_throughput": 3732.723, "learn_time_ms": 3944.076, "learn_throughput": 3245.373, "update_time_ms": 1.651}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.29558260485529897, "policy_loss": -0.03598290133289993, "vf_loss": 0.3146303345263004, "vf_explained_var": 0.9690612554550171, "kl": 0.016935174707323312, "entropy": -4.072770383358002, "entropy_coeff": 0.0}}, "num_steps_sampled": 537600, "num_steps_trained": 537600}, "done": false, "episodes_total": 520, "training_iteration": 42, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-23", "timestamp": 1617649703, "time_this_iter_s": 6.920641899108887, "time_total_s": 317.46351408958435, "pid": 23702, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.276928424835205, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.730000000000004, "ram_util_percent": 61.9}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 144.79661889142906, "episode_reward_min": 11.985094606748511, "episode_reward_mean": 39.94590335242541, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.395107014634554, 31.94965258071776, 62.37416377203768, 25.976077334381106, 40.390400487433894, 35.98621335600834, 98.05187418271755, 35.17193284279403, 37.70692504889287, 144.79661889142906, 25.880353437211614, 52.52906980808025, 39.914778806722005, 33.74301967513047, 48.521430447295536, 36.3496306564295, 28.7866525268168, 20.589474675250234, 29.605995033300207, 11.985094606748511, 25.324961548224326, 42.0171881745623, 21.20830485779242, 34.94494890580446, 27.912647396163337, 36.431477022544705, 39.73893483646009, 76.76323789097209, 24.58373557499206, 25.763236849956076, 38.91387462228857, 49.190653512198715, 30.949007458696357, 46.57674883697444, 50.828167125845724, 49.4309710491835, 17.086720709838612, 22.5032230517283, 47.62319903274685, 14.334526945830344, 35.38986914922898, 39.65256935351341, 40.60588835847051, 22.73440938194378, 33.58931658454616, 37.83380664891514, 49.10817153119417, 52.648905951386084, 41.798607157728746, 38.65259901766505, 41.08153496401615, 38.80463141507356, 38.86454729833564, 35.29581248284322, 60.82515598497451, 50.38636326119915, 35.68557814333093, 79.50764877400795, 27.310189630193072, 23.69924846954437, 43.772106759111225, 50.735279676932635, 23.918641242011347, 17.481979651284245, 41.037361870442936, 25.33217468547002, 30.696616389995523, 45.14653798487993, 58.237154752430584, 36.20098456963346, 30.513641908862258, 46.21199809532222, 23.15210338914749, 53.667832690700756, 38.03667980606656, 20.20467019000072, 38.64186630030304, 29.10860847981799, 63.812800279564684, 29.914129823018666, 30.4639209820764, 37.105828710670366, 59.72824538973236, 41.548461745519134, 53.02470548907386, 37.01414086083579, 42.08850821475726, 34.1374309308289], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17580619231992822, "mean_inference_ms": 0.9775303751792056, "mean_action_processing_ms": 0.04074078372863396, "mean_env_wait_ms": 0.8816990215988021, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 550400, "timers": {"sample_time_ms": 3353.246, "sample_throughput": 3817.197, "learn_time_ms": 3922.364, "learn_throughput": 3263.338, "update_time_ms": 1.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 3.2059602880477907, "policy_loss": -0.023145955577492713, "vf_loss": 3.20328631401062, "vf_explained_var": 0.8697447776794434, "kl": 0.02581991730257869, "entropy": -4.171211085319519, "entropy_coeff": 0.0}}, "num_steps_sampled": 550400, "num_steps_trained": 550400}, "done": false, "episodes_total": 536, "training_iteration": 43, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-30", "timestamp": 1617649710, "time_this_iter_s": 6.696207523345947, "time_total_s": 324.1597216129303, "pid": 23702, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.97313594818115, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.21111111111111, "ram_util_percent": 61.900000000000006}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 59.299998948896956, "episode_reward_min": 16.432233022520492, "episode_reward_mean": 32.39734129717413, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.16166820637856, 21.795723189707832, 16.432233022520492, 33.3890746560748, 25.485808665819796, 36.2395997250547, 43.37462396293992, 59.299998948896956], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19487509647062015, "mean_inference_ms": 1.1153137922138068, "mean_action_processing_ms": 0.0482009657467253, "mean_env_wait_ms": 1.0793815360524965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 563200, "timers": {"sample_time_ms": 4657.159, "sample_throughput": 2748.457, "learn_time_ms": 4084.608, "learn_throughput": 3133.715, "update_time_ms": 1.332}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.35341194266453385, "policy_loss": -0.03479792626108974, "vf_loss": 0.3712776157259941, "vf_explained_var": 0.9694314002990723, "kl": 0.01693225374445319, "entropy": -4.104966485500336, "entropy_coeff": 0.0}}, "num_steps_sampled": 563200, "num_steps_trained": 563200}, "done": false, "episodes_total": 544, "training_iteration": 44, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-09-48", "timestamp": 1617649788, "time_this_iter_s": 8.746063947677612, "time_total_s": 332.9057855606079, "pid": 25157, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.746063947677612, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 55.92307692307691, "ram_util_percent": 59.17692307692307}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 74.62039025801114, "episode_reward_min": 16.432233022520492, "episode_reward_mean": 39.17918468090226, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.531733923936144, 33.89690413872066, 36.41443505310885, 74.62039025801114, 69.6463111947658, 49.065694460708706, 52.109896291586566, 48.21959025717936, 30.94483990225402, 44.869329389811284, 27.32538306759733, 21.710934636602648, 42.02885022110081, 45.469012398065686, 43.44381899207472, 29.824577778737403, 23.16166820637856, 21.795723189707832, 16.432233022520492, 33.3890746560748, 25.485808665819796, 36.2395997250547, 43.37462396293992, 59.299998948896956], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1906305662533566, "mean_inference_ms": 1.0236234744588488, "mean_action_processing_ms": 0.04411761841144273, "mean_env_wait_ms": 0.9703880533135214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 576000, "timers": {"sample_time_ms": 3952.391, "sample_throughput": 3238.546, "learn_time_ms": 4128.631, "learn_throughput": 3100.301, "update_time_ms": 1.486}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 1.4394076359272003, "policy_loss": -0.025649229353293775, "vf_loss": 1.4458629977703095, "vf_explained_var": 0.9329918622970581, "kl": 0.019193858336657287, "entropy": -4.232673892974853, "entropy_coeff": 0.0}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 560, "training_iteration": 45, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-09-55", "timestamp": 1617649795, "time_this_iter_s": 7.429518461227417, "time_total_s": 340.3353040218353, "pid": 25157, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.17558240890503, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.56363636363636, "ram_util_percent": 59.76363636363637}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 80.58476710326855, "episode_reward_min": 16.432233022520492, "episode_reward_mean": 40.69921563101478, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.266480872313174, 80.58476710326855, 39.98676478132603, 50.887202002449975, 25.09151957901022, 34.26700867912569, 38.01389016690356, 45.97683466642161, 23.16166820637856, 21.795723189707832, 16.432233022520492, 33.3890746560748, 25.485808665819796, 36.2395997250547, 43.37462396293992, 59.299998948896956, 31.531733923936144, 33.89690413872066, 36.41443505310885, 74.62039025801114, 69.6463111947658, 49.065694460708706, 52.109896291586566, 48.21959025717936, 30.94483990225402, 44.869329389811284, 27.32538306759733, 21.710934636602648, 42.02885022110081, 45.469012398065686, 43.44381899207472, 29.824577778737403], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19029518880693672, "mean_inference_ms": 1.0228165373370632, "mean_action_processing_ms": 0.044036144425259986, "mean_env_wait_ms": 0.9659380197403153, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 588800, "timers": {"sample_time_ms": 4021.972, "sample_throughput": 3182.518, "learn_time_ms": 3992.851, "learn_throughput": 3205.73, "update_time_ms": 1.531}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 0.5200176377594471, "policy_loss": -0.03146096898708493, "vf_loss": 0.5331100776791573, "vf_explained_var": 0.9670634269714355, "kl": 0.018368527395650744, "entropy": -4.2047123336792, "entropy_coeff": 0.0}}, "num_steps_sampled": 588800, "num_steps_trained": 588800}, "done": false, "episodes_total": 568, "training_iteration": 46, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-10-03", "timestamp": 1617649803, "time_this_iter_s": 7.889405250549316, "time_total_s": 348.22470927238464, "pid": 25157, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24.064987659454346, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 49.218181818181826, "ram_util_percent": 62.40909090909091}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 110.79464975338632, "episode_reward_min": 16.432233022520492, "episode_reward_mean": 41.78910344568884, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.20109841907419, 110.79464975338632, 40.13762925079994, 36.52932889178206, 34.18982848561574, 31.5081897788698, 29.330887644688755, 36.691398666459854, 22.093608387100232, 65.87032300111602, 25.374924944412154, 39.73291515275344, 30.4001776353868, 34.015914241788714, 66.83544757351531, 29.795743373841624, 23.16166820637856, 21.795723189707832, 16.432233022520492, 33.3890746560748, 25.485808665819796, 36.2395997250547, 43.37462396293992, 59.299998948896956, 31.531733923936144, 33.89690413872066, 36.41443505310885, 74.62039025801114, 69.6463111947658, 49.065694460708706, 52.109896291586566, 48.21959025717936, 30.94483990225402, 44.869329389811284, 27.32538306759733, 21.710934636602648, 42.02885022110081, 45.469012398065686, 43.44381899207472, 29.824577778737403, 47.266480872313174, 80.58476710326855, 39.98676478132603, 50.887202002449975, 25.09151957901022, 34.26700867912569, 38.01389016690356, 45.97683466642161], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19370582680863388, "mean_inference_ms": 1.0362030693123176, "mean_action_processing_ms": 0.04416067133306805, "mean_env_wait_ms": 0.9655294429229188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 601600, "timers": {"sample_time_ms": 4122.678, "sample_throughput": 3104.778, "learn_time_ms": 3893.633, "learn_throughput": 3287.418, "update_time_ms": 1.598}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 1.5155797147750854, "policy_loss": -0.02869867192581296, "vf_loss": 1.5236947137117385, "vf_explained_var": 0.9312901496887207, "kl": 0.020583668304607273, "entropy": -4.263307461738586, "entropy_coeff": 0.0}}, "num_steps_sampled": 601600, "num_steps_trained": 601600}, "done": false, "episodes_total": 584, "training_iteration": 47, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-10-11", "timestamp": 1617649811, "time_this_iter_s": 8.027177095413208, "time_total_s": 356.25188636779785, "pid": 25157, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.092164754867554, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.40909090909091, "ram_util_percent": 62.690909090909095}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 110.79464975338632, "episode_reward_min": 16.432233022520492, "episode_reward_mean": 43.653780835478884, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.67341570545695, 57.45536905112019, 54.30631738683287, 60.05995206076678, 44.83775148873087, 71.0921909834938, 55.928319619713434, 31.326319523300462, 37.07086135896331, 43.8175072298236, 44.11587864804987, 69.07618762153886, 71.44846804694961, 27.380858701756466, 41.41082479247118, 45.96478585861643, 23.16166820637856, 21.795723189707832, 16.432233022520492, 33.3890746560748, 25.485808665819796, 36.2395997250547, 43.37462396293992, 59.299998948896956, 31.531733923936144, 33.89690413872066, 36.41443505310885, 74.62039025801114, 69.6463111947658, 49.065694460708706, 52.109896291586566, 48.21959025717936, 30.94483990225402, 44.869329389811284, 27.32538306759733, 21.710934636602648, 42.02885022110081, 45.469012398065686, 43.44381899207472, 29.824577778737403, 47.266480872313174, 80.58476710326855, 39.98676478132603, 50.887202002449975, 25.09151957901022, 34.26700867912569, 38.01389016690356, 45.97683466642161, 70.20109841907419, 110.79464975338632, 40.13762925079994, 36.52932889178206, 34.18982848561574, 31.5081897788698, 29.330887644688755, 36.691398666459854, 22.093608387100232, 65.87032300111602, 25.374924944412154, 39.73291515275344, 30.4001776353868, 34.015914241788714, 66.83544757351531, 29.795743373841624], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1971337563076943, "mean_inference_ms": 1.0425894762239434, "mean_action_processing_ms": 0.044263226249016456, "mean_env_wait_ms": 0.9658388509948124, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 614400, "timers": {"sample_time_ms": 4118.269, "sample_throughput": 3108.102, "learn_time_ms": 3834.47, "learn_throughput": 3338.141, "update_time_ms": 1.672}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005387588717195657, "total_loss": 1.0690041214227677, "policy_loss": -0.03052244899328798, "vf_loss": 1.0754336929321289, "vf_explained_var": 0.9548067450523376, "kl": 0.016061915969476103, "entropy": -4.3431572914123535, "entropy_coeff": 0.0}}, "num_steps_sampled": 614400, "num_steps_trained": 614400}, "done": false, "episodes_total": 600, "training_iteration": 48, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-10-19", "timestamp": 1617649819, "time_this_iter_s": 7.705436944961548, "time_total_s": 363.9573233127594, "pid": 25157, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.7976016998291, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 45.86363636363637, "ram_util_percent": 62.618181818181824}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 110.79464975338632, "episode_reward_min": 16.432233022520492, "episode_reward_mean": 44.05982335128177, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.847667042577143, 49.58503051504878, 74.30052142173155, 31.327323348347598, 47.679995344835014, 68.06481963824017, 56.23813969124311, 19.421810819615555, 23.16166820637856, 21.795723189707832, 16.432233022520492, 33.3890746560748, 25.485808665819796, 36.2395997250547, 43.37462396293992, 59.299998948896956, 31.531733923936144, 33.89690413872066, 36.41443505310885, 74.62039025801114, 69.6463111947658, 49.065694460708706, 52.109896291586566, 48.21959025717936, 30.94483990225402, 44.869329389811284, 27.32538306759733, 21.710934636602648, 42.02885022110081, 45.469012398065686, 43.44381899207472, 29.824577778737403, 47.266480872313174, 80.58476710326855, 39.98676478132603, 50.887202002449975, 25.09151957901022, 34.26700867912569, 38.01389016690356, 45.97683466642161, 70.20109841907419, 110.79464975338632, 40.13762925079994, 36.52932889178206, 34.18982848561574, 31.5081897788698, 29.330887644688755, 36.691398666459854, 22.093608387100232, 65.87032300111602, 25.374924944412154, 39.73291515275344, 30.4001776353868, 34.015914241788714, 66.83544757351531, 29.795743373841624, 32.67341570545695, 57.45536905112019, 54.30631738683287, 60.05995206076678, 44.83775148873087, 71.0921909834938, 55.928319619713434, 31.326319523300462, 37.07086135896331, 43.8175072298236, 44.11587864804987, 69.07618762153886, 71.44846804694961, 27.380858701756466, 41.41082479247118, 45.96478585861643], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19768871831375603, "mean_inference_ms": 1.0434504121092694, "mean_action_processing_ms": 0.044256476445310465, "mean_env_wait_ms": 0.964852982816574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 627200, "timers": {"sample_time_ms": 4064.572, "sample_throughput": 3149.163, "learn_time_ms": 3815.433, "learn_throughput": 3354.796, "update_time_ms": 1.649}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005387588717195657, "total_loss": 0.6343423096835613, "policy_loss": -0.025158667666837574, "vf_loss": 0.6379611060023308, "vf_explained_var": 0.9603508710861206, "kl": 0.014359910609200596, "entropy": -4.203119888305664, "entropy_coeff": 0.0}}, "num_steps_sampled": 627200, "num_steps_trained": 627200}, "done": false, "episodes_total": 608, "training_iteration": 49, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-10-26", "timestamp": 1617649826, "time_this_iter_s": 7.523233413696289, "time_total_s": 371.4805567264557, "pid": 25157, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.32083511352539, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.53636363636364, "ram_util_percent": 62.618181818181824}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 114.51137979929806, "episode_reward_min": 16.432233022520492, "episode_reward_mean": 47.47979897872299, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.35767172162967, 36.82326874286089, 114.51137979929806, 71.87306263642287, 53.67479147193835, 97.11136288373646, 45.0160320962614, 55.67383125154986, 39.1165066939613, 29.67792739378611, 34.46034057935887, 49.48085279054363, 71.2445034633713, 67.63250462328426, 106.5349928806085, 61.72599980672501, 23.16166820637856, 21.795723189707832, 16.432233022520492, 33.3890746560748, 25.485808665819796, 36.2395997250547, 43.37462396293992, 59.299998948896956, 31.531733923936144, 33.89690413872066, 36.41443505310885, 74.62039025801114, 69.6463111947658, 49.065694460708706, 52.109896291586566, 48.21959025717936, 30.94483990225402, 44.869329389811284, 27.32538306759733, 21.710934636602648, 42.02885022110081, 45.469012398065686, 43.44381899207472, 29.824577778737403, 47.266480872313174, 80.58476710326855, 39.98676478132603, 50.887202002449975, 25.09151957901022, 34.26700867912569, 38.01389016690356, 45.97683466642161, 70.20109841907419, 110.79464975338632, 40.13762925079994, 36.52932889178206, 34.18982848561574, 31.5081897788698, 29.330887644688755, 36.691398666459854, 22.093608387100232, 65.87032300111602, 25.374924944412154, 39.73291515275344, 30.4001776353868, 34.015914241788714, 66.83544757351531, 29.795743373841624, 32.67341570545695, 57.45536905112019, 54.30631738683287, 60.05995206076678, 44.83775148873087, 71.0921909834938, 55.928319619713434, 31.326319523300462, 37.07086135896331, 43.8175072298236, 44.11587864804987, 69.07618762153886, 71.44846804694961, 27.380858701756466, 41.41082479247118, 45.96478585861643, 31.847667042577143, 49.58503051504878, 74.30052142173155, 31.327323348347598, 47.679995344835014, 68.06481963824017, 56.23813969124311, 19.421810819615555], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19877308345947353, "mean_inference_ms": 1.043452620259841, "mean_action_processing_ms": 0.04421146956600352, "mean_env_wait_ms": 0.9623486556861544, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 640000, "timers": {"sample_time_ms": 4033.327, "sample_throughput": 3173.559, "learn_time_ms": 3794.019, "learn_throughput": 3373.731, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.0005387588717195657, "total_loss": 2.29647657930851, "policy_loss": -0.022815070413053036, "vf_loss": 2.289414278268814, "vf_explained_var": 0.9322667121887207, "kl": 0.01991824695840478, "entropy": -4.30319149017334, "entropy_coeff": 0.0}}, "num_steps_sampled": 640000, "num_steps_trained": 640000}, "done": false, "episodes_total": 624, "training_iteration": 50, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-10-34", "timestamp": 1617649834, "time_this_iter_s": 7.5179524421691895, "time_total_s": 378.9985091686249, "pid": 25157, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 54.83878755569458, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.81818181818182, "ram_util_percent": 62.70000000000002}, "trial_id": "9a1ab_00002"}
{"episode_reward_max": 105.09022670327737, "episode_reward_min": 22.063429123807552, "episode_reward_mean": 67.42485460520479, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.36656557423389, 76.22235136319178, 105.09022670327737, 54.58219323540262, 67.47286643147368, 52.566619494912096, 63.03458491533925, 22.063429123807552], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1729103008856407, "mean_inference_ms": 1.0238607401850817, "mean_action_processing_ms": 0.04392004176871915, "mean_env_wait_ms": 0.996401520686772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 652800, "timers": {"sample_time_ms": 4260.541, "sample_throughput": 3004.313, "learn_time_ms": 3714.107, "learn_throughput": 3446.32, "update_time_ms": 1.67}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0005387588717195657, "total_loss": 1.1301329749822617, "policy_loss": -0.022664744867943228, "vf_loss": 1.1326017606258392, "vf_explained_var": 0.95452880859375, "kl": 0.02019594148732722, "entropy": -4.239183692932129, "entropy_coeff": 0.0}}, "num_steps_sampled": 652800, "num_steps_trained": 652800}, "done": true, "episodes_total": 632, "training_iteration": 51, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-05", "timestamp": 1617649865, "time_this_iter_s": 7.979852914810181, "time_total_s": 386.97836208343506, "pid": 26223, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 11672, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.000538758871719566, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9725796238473201, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.28227854820441545, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.979852914810181, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 47.583333333333336, "ram_util_percent": 62.349999999999994}, "trial_id": "9a1ab_00002"}
