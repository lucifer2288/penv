{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 4800, "timers": {"sample_time_ms": 2169.036, "sample_throughput": 2212.965, "learn_time_ms": 1468.972, "learn_throughput": 3267.59, "update_time_ms": 1.908}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0049701588425032665, "total_loss": 0.022715340147873287, "policy_loss": 0.0014266833712003734, "vf_loss": 0.006877035637827296, "vf_explained_var": 0.4242483377456665, "kl": 0.014411619080132559, "entropy": -3.2760284950858667, "entropy_coeff": 0.0}}, "num_steps_sampled": 4800, "num_steps_trained": 4800}, "done": false, "episodes_total": 0, "training_iteration": 1, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-27", "timestamp": 1617648987, "time_this_iter_s": 3.6451573371887207, "time_total_s": 3.6451573371887207, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3.6451573371887207, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.76666666666667, "ram_util_percent": 61.133333333333326}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.3098807172842206, "episode_reward_min": -0.5511407726463327, "episode_reward_mean": -0.18929502540246332, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1980840018349424, "mean_inference_ms": 1.0234951774444707, "mean_action_processing_ms": 0.04294740468834361, "mean_env_wait_ms": 1.0540862067553722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 9600, "timers": {"sample_time_ms": 1772.032, "sample_throughput": 2708.754, "learn_time_ms": 1325.537, "learn_throughput": 3621.173, "update_time_ms": 1.856}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0049701588425032665, "total_loss": 0.023776963990377754, "policy_loss": 0.004888584788300489, "vf_loss": 0.009889924580133274, "vf_explained_var": 0.25833263993263245, "kl": 0.008998456974758914, "entropy": -3.2919062313280607, "entropy_coeff": 0.0}}, "num_steps_sampled": 9600, "num_steps_trained": 9600}, "done": false, "episodes_total": 8, "training_iteration": 2, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-29", "timestamp": 1617648989, "time_this_iter_s": 2.5628061294555664, "time_total_s": 6.207963466644287, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.207963466644287, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.800000000000004, "ram_util_percent": 61.53333333333333}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.3098807172842206, "episode_reward_min": -0.5511407726463327, "episode_reward_mean": -0.18929502540246332, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1980840018349424, "mean_inference_ms": 1.0234951774444707, "mean_action_processing_ms": 0.04294740468834361, "mean_env_wait_ms": 1.0540862067553722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 14400, "timers": {"sample_time_ms": 1549.228, "sample_throughput": 3098.318, "learn_time_ms": 1339.542, "learn_throughput": 3583.315, "update_time_ms": 1.79}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0049701588425032665, "total_loss": 0.015083000639845667, "policy_loss": -0.0008700574919777481, "vf_loss": 0.009005535210139658, "vf_explained_var": 0.3272133767604828, "kl": 0.006947524392193085, "entropy": -3.3456059443323234, "entropy_coeff": 0.0}}, "num_steps_sampled": 14400, "num_steps_trained": 14400}, "done": false, "episodes_total": 8, "training_iteration": 3, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-32", "timestamp": 1617648992, "time_this_iter_s": 2.4763195514678955, "time_total_s": 8.684283018112183, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.684283018112183, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.849999999999994, "ram_util_percent": 61.625}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.4768254822996445, "episode_reward_min": -0.7322339258560593, "episode_reward_mean": -0.30412226921624425, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19988287545197647, "mean_inference_ms": 1.0054698044080659, "mean_action_processing_ms": 0.0422012175648139, "mean_env_wait_ms": 1.016027382839459, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 19200, "timers": {"sample_time_ms": 1584.888, "sample_throughput": 3028.604, "learn_time_ms": 1332.292, "learn_throughput": 3602.813, "update_time_ms": 1.711}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0049701588425032665, "total_loss": -0.0005012036203161666, "policy_loss": -0.008868615020458636, "vf_loss": 0.005961084003119092, "vf_explained_var": 0.4723339080810547, "kl": 0.0024063288338335327, "entropy": -3.311379263275548, "entropy_coeff": 0.0}}, "num_steps_sampled": 19200, "num_steps_trained": 19200}, "done": false, "episodes_total": 16, "training_iteration": 4, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-35", "timestamp": 1617648995, "time_this_iter_s": 3.0085718631744385, "time_total_s": 11.692854881286621, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.692854881286621, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 61.699999999999996, "ram_util_percent": 61.7}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7322339258560593, "episode_reward_mean": -0.2866908512599194, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20226209249008234, "mean_inference_ms": 0.9880442196428764, "mean_action_processing_ms": 0.041477097951559204, "mean_env_wait_ms": 0.98861798731524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 24000, "timers": {"sample_time_ms": 1508.52, "sample_throughput": 3181.927, "learn_time_ms": 1315.303, "learn_throughput": 3649.351, "update_time_ms": 1.665}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.0049701588425032665, "total_loss": 0.0038075437524208895, "policy_loss": -0.0042037816081, "vf_loss": 0.007039753573113366, "vf_explained_var": 0.2080819457769394, "kl": 0.0019431374323750404, "entropy": -3.303589620088276, "entropy_coeff": 0.0}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 24, "training_iteration": 5, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-37", "timestamp": 1617648997, "time_this_iter_s": 2.456529378890991, "time_total_s": 14.149384260177612, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.149384260177612, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 26.650000000000002, "ram_util_percent": 61.7}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7322339258560593, "episode_reward_mean": -0.28669085125991933, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20226209249008234, "mean_inference_ms": 0.9880442196428761, "mean_action_processing_ms": 0.041477097951559204, "mean_env_wait_ms": 0.9886179873152402, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 28800, "timers": {"sample_time_ms": 1530.873, "sample_throughput": 3135.466, "learn_time_ms": 1332.018, "learn_throughput": 3603.555, "update_time_ms": 1.633}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.0049701588425032665, "total_loss": -0.0015721574523731281, "policy_loss": -0.008725129460033617, "vf_loss": 0.0061918516324735, "vf_explained_var": 0.654370903968811, "kl": 0.003844483026401385, "entropy": -3.3451185100956966, "entropy_coeff": 0.0}}, "num_steps_sampled": 28800, "num_steps_trained": 28800}, "done": false, "episodes_total": 24, "training_iteration": 6, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-40", "timestamp": 1617649000, "time_this_iter_s": 3.0643837451934814, "time_total_s": 17.213768005371094, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.213768005371094, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 60.325, "ram_util_percent": 61.75}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7322339258560593, "episode_reward_mean": -0.2700127954513677, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372, -0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2032496974884899, "mean_inference_ms": 0.98568343888551, "mean_action_processing_ms": 0.041357945975064786, "mean_env_wait_ms": 0.9797010245585959, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 33600, "timers": {"sample_time_ms": 1516.201, "sample_throughput": 3165.808, "learn_time_ms": 1314.558, "learn_throughput": 3651.418, "update_time_ms": 1.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0049701588425032665, "total_loss": 0.004793804482017693, "policy_loss": -0.002960874552005216, "vf_loss": 0.007275946842702596, "vf_explained_var": 0.37506523728370667, "kl": 0.0038298611271832335, "entropy": -3.3400758065675435, "entropy_coeff": 0.0}}, "num_steps_sampled": 33600, "num_steps_trained": 33600}, "done": false, "episodes_total": 32, "training_iteration": 7, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-43", "timestamp": 1617649003, "time_this_iter_s": 2.6432416439056396, "time_total_s": 19.857009649276733, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.857009649276733, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.475, "ram_util_percent": 61.650000000000006}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7322339258560593, "episode_reward_mean": -0.2700127954513677, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20324969748848992, "mean_inference_ms": 0.9856834388855099, "mean_action_processing_ms": 0.041357945975064786, "mean_env_wait_ms": 0.979701024558596, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 38400, "timers": {"sample_time_ms": 1484.274, "sample_throughput": 3233.905, "learn_time_ms": 1329.364, "learn_throughput": 3610.749, "update_time_ms": 1.627}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0049701588425032665, "total_loss": -0.0042304440744613345, "policy_loss": -0.0103805348228075, "vf_loss": 0.005788201306897558, "vf_explained_var": 0.5883650779724121, "kl": 0.005790208729817287, "entropy": -3.453431568647686, "entropy_coeff": 0.0}}, "num_steps_sampled": 38400, "num_steps_trained": 38400}, "done": false, "episodes_total": 32, "training_iteration": 8, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-46", "timestamp": 1617649006, "time_this_iter_s": 2.699951410293579, "time_total_s": 22.556961059570312, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.556961059570312, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 38.400000000000006, "ram_util_percent": 61.7}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7552083922931461, "episode_reward_mean": -0.25073866349760016, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.40105127564905196, 0.01689719218538266, -0.41526200829542526, -0.5258369141403965, -0.10764847485024565, 0.046318539008712856, 0.7526542485739312, -0.7552083922931461, -0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20436864258780457, "mean_inference_ms": 0.9828812714282444, "mean_action_processing_ms": 0.04122111173647153, "mean_env_wait_ms": 0.9718688109934595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 43200, "timers": {"sample_time_ms": 1506.0, "sample_throughput": 3187.25, "learn_time_ms": 1333.591, "learn_throughput": 3599.305, "update_time_ms": 1.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0049701588425032665, "total_loss": 0.0015306516464701609, "policy_loss": -0.006927728187292814, "vf_loss": 0.008167725607850835, "vf_explained_var": 0.5595645904541016, "kl": 0.0046504521436107, "entropy": -3.39314824029019, "entropy_coeff": 0.0}}, "num_steps_sampled": 43200, "num_steps_trained": 43200}, "done": false, "episodes_total": 40, "training_iteration": 9, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-49", "timestamp": 1617649009, "time_this_iter_s": 3.053410053253174, "time_total_s": 25.610371112823486, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.610371112823486, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 58.724999999999994, "ram_util_percent": 61.650000000000006}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7552083922931461, "episode_reward_mean": -0.26114583707789524, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3831046170334623, 0.0038881851852934357, -0.1157367708742314, 0.01970634468914656, -0.3886493118966229, -0.6290068677283811, -0.5552333475089406, -0.45731725466776807, -0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372, -0.40105127564905196, 0.01689719218538266, -0.41526200829542526, -0.5258369141403965, -0.10764847485024565, 0.046318539008712856, 0.7526542485739312, -0.7552083922931461], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20539687667849824, "mean_inference_ms": 0.978976029317144, "mean_action_processing_ms": 0.04102502022287954, "mean_env_wait_ms": 0.9638727483286966, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 48000, "timers": {"sample_time_ms": 1480.952, "sample_throughput": 3241.159, "learn_time_ms": 1332.564, "learn_throughput": 3602.079, "update_time_ms": 1.62}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 0.0049701588425032665, "total_loss": 0.002913249117371283, "policy_loss": -0.0035688436443084164, "vf_loss": 0.006352132247564824, "vf_explained_var": 0.2797779440879822, "kl": 0.004158731935986955, "entropy": -3.3885579109191895, "entropy_coeff": 0.0}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 10, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-51", "timestamp": 1617649011, "time_this_iter_s": 2.584746837615967, "time_total_s": 28.195117950439453, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.195117950439453, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.275, "ram_util_percent": 61.7}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7552083922931461, "episode_reward_mean": -0.26114583707789524, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372, -0.40105127564905196, 0.01689719218538266, -0.41526200829542526, -0.5258369141403965, -0.10764847485024565, 0.046318539008712856, 0.7526542485739312, -0.7552083922931461, -0.3831046170334623, 0.0038881851852934357, -0.1157367708742314, 0.01970634468914656, -0.3886493118966229, -0.6290068677283811, -0.5552333475089406, -0.45731725466776807], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20539687667849818, "mean_inference_ms": 0.978976029317144, "mean_action_processing_ms": 0.04102502022287954, "mean_env_wait_ms": 0.9638727483286965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 52800, "timers": {"sample_time_ms": 1425.406, "sample_throughput": 3367.461, "learn_time_ms": 1338.074, "learn_throughput": 3587.244, "update_time_ms": 1.606}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 0.0049701588425032665, "total_loss": 0.000681419048066202, "policy_loss": -0.005509001582762913, "vf_loss": 0.006118365281604622, "vf_explained_var": 0.5954079031944275, "kl": 0.004611613872264953, "entropy": -3.498689281313043, "entropy_coeff": 0.0}}, "num_steps_sampled": 52800, "num_steps_trained": 52800}, "done": false, "episodes_total": 48, "training_iteration": 11, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-54", "timestamp": 1617649014, "time_this_iter_s": 3.143282175064087, "time_total_s": 31.33840012550354, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.33840012550354, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 60.300000000000004, "ram_util_percent": 61.75}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7552083922931461, "episode_reward_mean": -0.2701446343710798, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.08743572190872351, -0.42904626895756026, -0.3173043379163805, -0.11363551987114273, -0.18131820284848998, -0.5499544128486584, -0.48710362911256644, -0.4273012515779734, -0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372, -0.40105127564905196, 0.01689719218538266, -0.41526200829542526, -0.5258369141403965, -0.10764847485024565, 0.046318539008712856, 0.7526542485739312, -0.7552083922931461, -0.3831046170334623, 0.0038881851852934357, -0.1157367708742314, 0.01970634468914656, -0.3886493118966229, -0.6290068677283811, -0.5552333475089406, -0.45731725466776807], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20584467195776496, "mean_inference_ms": 0.978102624956055, "mean_action_processing_ms": 0.04096322175712585, "mean_env_wait_ms": 0.9598751500158816, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 57600, "timers": {"sample_time_ms": 1421.655, "sample_throughput": 3376.347, "learn_time_ms": 1347.063, "learn_throughput": 3563.306, "update_time_ms": 1.605}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 0.0049701588425032665, "total_loss": 0.0001078457816650993, "policy_loss": -0.004942357000943862, "vf_loss": 0.005025489298675798, "vf_explained_var": 0.31316572427749634, "kl": 0.00316332629269087, "entropy": -3.386506664125543, "entropy_coeff": 0.0}}, "num_steps_sampled": 57600, "num_steps_trained": 57600}, "done": false, "episodes_total": 56, "training_iteration": 12, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-56-57", "timestamp": 1617649017, "time_this_iter_s": 2.615696430206299, "time_total_s": 33.95409655570984, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.95409655570984, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.300000000000004, "ram_util_percent": 61.8}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7552083922931461, "episode_reward_mean": -0.2701446343710798, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372, -0.40105127564905196, 0.01689719218538266, -0.41526200829542526, -0.5258369141403965, -0.10764847485024565, 0.046318539008712856, 0.7526542485739312, -0.7552083922931461, -0.3831046170334623, 0.0038881851852934357, -0.1157367708742314, 0.01970634468914656, -0.3886493118966229, -0.6290068677283811, -0.5552333475089406, -0.45731725466776807, -0.08743572190872351, -0.42904626895756026, -0.3173043379163805, -0.11363551987114273, -0.18131820284848998, -0.5499544128486584, -0.48710362911256644, -0.4273012515779734], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20584467195776496, "mean_inference_ms": 0.978102624956055, "mean_action_processing_ms": 0.04096322175712585, "mean_env_wait_ms": 0.9598751500158816, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 62400, "timers": {"sample_time_ms": 1434.234, "sample_throughput": 3346.734, "learn_time_ms": 1363.379, "learn_throughput": 3520.666, "update_time_ms": 1.607}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 0.0049701588425032665, "total_loss": 0.0020353032986780532, "policy_loss": -0.00437860122244609, "vf_loss": 0.006392889104685501, "vf_explained_var": 0.5983442664146423, "kl": 0.005380236690765933, "entropy": -3.5481020902332507, "entropy_coeff": 0.0}}, "num_steps_sampled": 62400, "num_steps_trained": 62400}, "done": false, "episodes_total": 56, "training_iteration": 13, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-57-00", "timestamp": 1617649020, "time_this_iter_s": 2.76568865776062, "time_total_s": 36.71978521347046, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 36.71978521347046, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.575, "ram_util_percent": 61.724999999999994}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7552083922931461, "episode_reward_mean": -0.23731241398065067, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.052035770427790395, 0.5131255911133561, -0.3186920540278537, -0.35916940578339884, -0.027495172362741904, -0.16211162338546647, 0.4543637782604397, -0.10788031336771908, -0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372, -0.40105127564905196, 0.01689719218538266, -0.41526200829542526, -0.5258369141403965, -0.10764847485024565, 0.046318539008712856, 0.7526542485739312, -0.7552083922931461, -0.3831046170334623, 0.0038881851852934357, -0.1157367708742314, 0.01970634468914656, -0.3886493118966229, -0.6290068677283811, -0.5552333475089406, -0.45731725466776807, -0.08743572190872351, -0.42904626895756026, -0.3173043379163805, -0.11363551987114273, -0.18131820284848998, -0.5499544128486584, -0.48710362911256644, -0.4273012515779734], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20618782799714436, "mean_inference_ms": 0.9776875337727762, "mean_action_processing_ms": 0.04092467417505097, "mean_env_wait_ms": 0.9569595780842964, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 67200, "timers": {"sample_time_ms": 1438.613, "sample_throughput": 3336.546, "learn_time_ms": 1366.065, "learn_throughput": 3513.742, "update_time_ms": 1.614}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 0.0049701588425032665, "total_loss": 0.006473806539648457, "policy_loss": -0.0014208068728054826, "vf_loss": 0.007871581204725723, "vf_explained_var": 0.5943503379821777, "kl": 0.005896142414329867, "entropy": -3.4965262538508366, "entropy_coeff": 0.0}}, "num_steps_sampled": 67200, "num_steps_trained": 67200}, "done": false, "episodes_total": 64, "training_iteration": 14, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-57-03", "timestamp": 1617649023, "time_this_iter_s": 3.0784974098205566, "time_total_s": 39.798282623291016, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.798282623291016, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 50.419999999999995, "ram_util_percent": 61.779999999999994}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7552083922931461, "episode_reward_mean": -0.23007856350913458, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.18208216052893722, 0.06911691120839647, 0.012006789137642082, -0.35406020966897345, -0.43687115298948503, -0.37172819822283243, 0.1519408377716993, -0.265984894603557, -0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372, -0.40105127564905196, 0.01689719218538266, -0.41526200829542526, -0.5258369141403965, -0.10764847485024565, 0.046318539008712856, 0.7526542485739312, -0.7552083922931461, -0.3831046170334623, 0.0038881851852934357, -0.1157367708742314, 0.01970634468914656, -0.3886493118966229, -0.6290068677283811, -0.5552333475089406, -0.45731725466776807, -0.08743572190872351, -0.42904626895756026, -0.3173043379163805, -0.11363551987114273, -0.18131820284848998, -0.5499544128486584, -0.48710362911256644, -0.4273012515779734, -0.052035770427790395, 0.5131255911133561, -0.3186920540278537, -0.35916940578339884, -0.027495172362741904, -0.16211162338546647, 0.4543637782604397, -0.10788031336771908], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20662121760839047, "mean_inference_ms": 0.9763121550410234, "mean_action_processing_ms": 0.04085089771836931, "mean_env_wait_ms": 0.9535080928597104, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 72000, "timers": {"sample_time_ms": 1442.569, "sample_throughput": 3327.396, "learn_time_ms": 1378.864, "learn_throughput": 3481.128, "update_time_ms": 1.616}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 0.0049701588425032665, "total_loss": 0.004711603402699295, "policy_loss": -0.0010093376775713342, "vf_loss": 0.005706400867845667, "vf_explained_var": 0.22621440887451172, "kl": 0.0037219820813717028, "entropy": -3.409393969335054, "entropy_coeff": 0.0}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 72, "training_iteration": 15, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-57-06", "timestamp": 1617649026, "time_this_iter_s": 2.623687267303467, "time_total_s": 42.42196989059448, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.42196989059448, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 31.666666666666668, "ram_util_percent": 61.73333333333333}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7552083922931461, "episode_reward_mean": -0.23007856350913455, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372, -0.40105127564905196, 0.01689719218538266, -0.41526200829542526, -0.5258369141403965, -0.10764847485024565, 0.046318539008712856, 0.7526542485739312, -0.7552083922931461, -0.3831046170334623, 0.0038881851852934357, -0.1157367708742314, 0.01970634468914656, -0.3886493118966229, -0.6290068677283811, -0.5552333475089406, -0.45731725466776807, -0.08743572190872351, -0.42904626895756026, -0.3173043379163805, -0.11363551987114273, -0.18131820284848998, -0.5499544128486584, -0.48710362911256644, -0.4273012515779734, -0.052035770427790395, 0.5131255911133561, -0.3186920540278537, -0.35916940578339884, -0.027495172362741904, -0.16211162338546647, 0.4543637782604397, -0.10788031336771908, -0.18208216052893722, 0.06911691120839647, 0.012006789137642082, -0.35406020966897345, -0.43687115298948503, -0.37172819822283243, 0.1519408377716993, -0.265984894603557], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20662121760839047, "mean_inference_ms": 0.9763121550410232, "mean_action_processing_ms": 0.04085089771836931, "mean_env_wait_ms": 0.9535080928597104, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 76800, "timers": {"sample_time_ms": 1445.972, "sample_throughput": 3319.566, "learn_time_ms": 1386.703, "learn_throughput": 3461.449, "update_time_ms": 1.636}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 0.0049701588425032665, "total_loss": 0.00335076588549112, "policy_loss": -0.002304665009049993, "vf_loss": 0.005645196161870109, "vf_explained_var": 0.4977136552333832, "kl": 0.005240045745219839, "entropy": -3.481302581335369, "entropy_coeff": 0.0}}, "num_steps_sampled": 76800, "num_steps_trained": 76800}, "done": false, "episodes_total": 72, "training_iteration": 16, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-57-09", "timestamp": 1617649029, "time_this_iter_s": 3.1764485836029053, "time_total_s": 45.59841847419739, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.59841847419739, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 58.52, "ram_util_percent": 61.75999999999999}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7552083922931461, "episode_reward_mean": -0.21047297421018724, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2633049312293585, 0.11475904629751055, 0.02406868075247215, 0.28510060233668, 0.0681812470262586, -0.40602641796235933, -0.4435253147167655, -0.17804413912044437, -0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372, -0.40105127564905196, 0.01689719218538266, -0.41526200829542526, -0.5258369141403965, -0.10764847485024565, 0.046318539008712856, 0.7526542485739312, -0.7552083922931461, -0.3831046170334623, 0.0038881851852934357, -0.1157367708742314, 0.01970634468914656, -0.3886493118966229, -0.6290068677283811, -0.5552333475089406, -0.45731725466776807, -0.08743572190872351, -0.42904626895756026, -0.3173043379163805, -0.11363551987114273, -0.18131820284848998, -0.5499544128486584, -0.48710362911256644, -0.4273012515779734, -0.052035770427790395, 0.5131255911133561, -0.3186920540278537, -0.35916940578339884, -0.027495172362741904, -0.16211162338546647, 0.4543637782604397, -0.10788031336771908, -0.18208216052893722, 0.06911691120839647, 0.012006789137642082, -0.35406020966897345, -0.43687115298948503, -0.37172819822283243, 0.1519408377716993, -0.265984894603557], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20671507972131642, "mean_inference_ms": 0.975426281450888, "mean_action_processing_ms": 0.040800849870324576, "mean_env_wait_ms": 0.950886895328589, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 81600, "timers": {"sample_time_ms": 1421.874, "sample_throughput": 3375.826, "learn_time_ms": 1393.897, "learn_throughput": 3443.582, "update_time_ms": 1.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 0.0049701588425032665, "total_loss": 0.005207124129427891, "policy_loss": -0.002448858631970851, "vf_loss": 0.0076473520235403585, "vf_explained_var": 0.2180769294500351, "kl": 0.004418695051419108, "entropy": -3.532203793525696, "entropy_coeff": 0.0}}, "num_steps_sampled": 81600, "num_steps_trained": 81600}, "done": false, "episodes_total": 80, "training_iteration": 17, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-57-11", "timestamp": 1617649031, "time_this_iter_s": 2.4744045734405518, "time_total_s": 48.07282304763794, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.07282304763794, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 28.025000000000002, "ram_util_percent": 61.7}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.0680498293307035, "episode_reward_min": -0.7552083922931461, "episode_reward_mean": -0.21047297421018724, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3650659540691953, 0.3098807172842206, -0.3609109848641364, -0.5511407726463327, 0.12715836940451153, 0.13054555477836405, -0.3510349004549255, -0.4537922326522128, -0.6681517559807947, 0.4768254822996445, -0.7278051070279814, -0.7322339258560593, -0.5753264666747464, -0.2963330533694982, -0.39397400287983586, -0.4345972747509302, -0.47385078791854707, 1.0680498293307035, -0.5336331557169365, -0.28454737491556914, -0.4593713061351772, -0.28066212018393366, -0.5295776027818695, -0.5210316044568267, -0.2919349877092742, -0.6465301704639702, 0.13572822168510323, 0.1136191446017667, -0.39230394648849315, -0.5874377357275388, -0.15904790946122993, 0.06807835935793372, -0.40105127564905196, 0.01689719218538266, -0.41526200829542526, -0.5258369141403965, -0.10764847485024565, 0.046318539008712856, 0.7526542485739312, -0.7552083922931461, -0.3831046170334623, 0.0038881851852934357, -0.1157367708742314, 0.01970634468914656, -0.3886493118966229, -0.6290068677283811, -0.5552333475089406, -0.45731725466776807, -0.08743572190872351, -0.42904626895756026, -0.3173043379163805, -0.11363551987114273, -0.18131820284848998, -0.5499544128486584, -0.48710362911256644, -0.4273012515779734, -0.052035770427790395, 0.5131255911133561, -0.3186920540278537, -0.35916940578339884, -0.027495172362741904, -0.16211162338546647, 0.4543637782604397, -0.10788031336771908, -0.18208216052893722, 0.06911691120839647, 0.012006789137642082, -0.35406020966897345, -0.43687115298948503, -0.37172819822283243, 0.1519408377716993, -0.265984894603557, 0.2633049312293585, 0.11475904629751055, 0.02406868075247215, 0.28510060233668, 0.0681812470262586, -0.40602641796235933, -0.4435253147167655, -0.17804413912044437], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20671507972131642, "mean_inference_ms": 0.975426281450888, "mean_action_processing_ms": 0.040800849870324576, "mean_env_wait_ms": 0.950886895328589, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 86400, "timers": {"sample_time_ms": 1467.13, "sample_throughput": 3271.695, "learn_time_ms": 1408.042, "learn_throughput": 3408.988, "update_time_ms": 1.604}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 0.0049701588425032665, "total_loss": 0.008239343308990723, "policy_loss": -0.0015819854666724016, "vf_loss": 0.009797426001904043, "vf_explained_var": 0.306163489818573, "kl": 0.02447675597412806, "entropy": -3.765736724201002, "entropy_coeff": 0.0}}, "num_steps_sampled": 86400, "num_steps_trained": 86400}, "done": false, "episodes_total": 80, "training_iteration": 18, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-57-15", "timestamp": 1617649035, "time_this_iter_s": 3.292991876602173, "time_total_s": 51.36581492424011, "pid": 18563, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.36581492424011, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 57.1, "ram_util_percent": 61.724999999999994}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 91200, "timers": {"sample_time_ms": 1941.483, "sample_throughput": 2472.337, "learn_time_ms": 1823.799, "learn_throughput": 2631.869, "update_time_ms": 1.909}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0049701588425032665, "total_loss": 0.0001202839867849099, "policy_loss": -0.008752931546615926, "vf_loss": 0.006432052934542298, "vf_explained_var": 0.35682958364486694, "kl": 0.002441162865388354, "entropy": -3.5278738235172473, "entropy_coeff": 0.0}}, "num_steps_sampled": 91200, "num_steps_trained": 91200}, "done": false, "episodes_total": 80, "training_iteration": 19, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-27", "timestamp": 1617649107, "time_this_iter_s": 3.7711563110351562, "time_total_s": 55.13697123527527, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3.7711563110351562, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 57.26666666666667, "ram_util_percent": 56.85}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.041130879140503, "episode_reward_min": -0.5105577362550204, "episode_reward_mean": -0.059200761304497765, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23036527693222006, "mean_inference_ms": 1.1271657445448622, "mean_action_processing_ms": 0.04783595332892907, "mean_env_wait_ms": 1.147169380958233, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 96000, "timers": {"sample_time_ms": 1822.808, "sample_throughput": 2633.299, "learn_time_ms": 1867.603, "learn_throughput": 2570.139, "update_time_ms": 1.85}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.0049701588425032665, "total_loss": 0.005346476394487054, "policy_loss": -0.004948288398353677, "vf_loss": 0.009125246323252978, "vf_explained_var": 0.20822012424468994, "kl": 0.0023390343290214475, "entropy": -3.6067879450948617, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 88, "training_iteration": 20, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-30", "timestamp": 1617649110, "time_this_iter_s": 3.622222900390625, "time_total_s": 58.759194135665894, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.393379211425781, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 61.56}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.041130879140503, "episode_reward_min": -0.5105577362550204, "episode_reward_mean": -0.059200761304497765, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23036527693222006, "mean_inference_ms": 1.1271657445448622, "mean_action_processing_ms": 0.04783595332892907, "mean_env_wait_ms": 1.147169380958233, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 100800, "timers": {"sample_time_ms": 1760.63, "sample_throughput": 2726.297, "learn_time_ms": 1772.054, "learn_throughput": 2708.721, "update_time_ms": 1.882}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.0049701588425032665, "total_loss": 0.007301901148534135, "policy_loss": -0.002748201135545969, "vf_loss": 0.00892960924753233, "vf_explained_var": 0.21959340572357178, "kl": 0.004481968338184647, "entropy": -3.8507300803535864, "entropy_coeff": 0.0}}, "num_steps_sampled": 100800, "num_steps_trained": 100800}, "done": false, "episodes_total": 88, "training_iteration": 21, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-34", "timestamp": 1617649114, "time_this_iter_s": 3.2226037979125977, "time_total_s": 61.98179793357849, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.615983009338379, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.7, "ram_util_percent": 61.720000000000006}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.042887731511616, "episode_reward_min": -0.5105577362550204, "episode_reward_mean": 0.03137166130988338, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, -0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22020315528151801, "mean_inference_ms": 1.0926287094888858, "mean_action_processing_ms": 0.04638549569891416, "mean_env_wait_ms": 1.0955038999566218, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 105600, "timers": {"sample_time_ms": 1632.305, "sample_throughput": 2940.627, "learn_time_ms": 1711.733, "learn_throughput": 2804.175, "update_time_ms": 1.819}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0049701588425032665, "total_loss": 0.007729542392649148, "policy_loss": -0.004325025665916894, "vf_loss": 0.011595209361985326, "vf_explained_var": 0.19078657031059265, "kl": 0.003674851451681829, "entropy": -3.5595786571502686, "entropy_coeff": 0.0}}, "num_steps_sampled": 105600, "num_steps_trained": 105600}, "done": false, "episodes_total": 96, "training_iteration": 22, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-36", "timestamp": 1617649116, "time_this_iter_s": 2.783404588699341, "time_total_s": 64.76520252227783, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.39938759803772, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.525000000000006, "ram_util_percent": 61.9}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.042887731511616, "episode_reward_min": -0.5326877251575863, "episode_reward_mean": -0.0255314830589768, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437, -0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21798217488620575, "mean_inference_ms": 1.0658277330850312, "mean_action_processing_ms": 0.04527256674047642, "mean_env_wait_ms": 1.0601091671000888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 110400, "timers": {"sample_time_ms": 1556.001, "sample_throughput": 3084.832, "learn_time_ms": 1714.105, "learn_throughput": 2800.296, "update_time_ms": 1.75}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0049701588425032665, "total_loss": 0.0022324321203325923, "policy_loss": -0.004676879285589645, "vf_loss": 0.006618981249630451, "vf_explained_var": 0.15084132552146912, "kl": 0.0046453154400775305, "entropy": -3.649190827419883, "entropy_coeff": 0.0}}, "num_steps_sampled": 110400, "num_steps_trained": 110400}, "done": false, "episodes_total": 104, "training_iteration": 23, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-39", "timestamp": 1617649119, "time_this_iter_s": 2.980004072189331, "time_total_s": 67.74520659446716, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.37939167022705, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 34.475, "ram_util_percent": 61.85}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.042887731511616, "episode_reward_min": -0.5326877251575863, "episode_reward_mean": -0.025531483058976793, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21798217488620575, "mean_inference_ms": 1.0658277330850312, "mean_action_processing_ms": 0.04527256674047642, "mean_env_wait_ms": 1.0601091671000888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 115200, "timers": {"sample_time_ms": 1573.65, "sample_throughput": 3050.234, "learn_time_ms": 1734.186, "learn_throughput": 2767.868, "update_time_ms": 1.747}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 0.0049701588425032665, "total_loss": 0.006188605519893922, "policy_loss": -0.0046827543379836965, "vf_loss": 0.010738042599864696, "vf_explained_var": 0.18275506794452667, "kl": 0.004266175711037297, "entropy": -3.545813566760013, "entropy_coeff": 0.0}}, "num_steps_sampled": 115200, "num_steps_trained": 115200}, "done": false, "episodes_total": 104, "training_iteration": 24, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-43", "timestamp": 1617649123, "time_this_iter_s": 3.502373456954956, "time_total_s": 71.24758005142212, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.881765127182007, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 58.42, "ram_util_percent": 61.9}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.042887731511616, "episode_reward_min": -0.5326877251575863, "episode_reward_mean": -0.07077607841542, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3398930419349806, -0.16849675691589572, 0.11646293097611249, -0.3716753459895684, -0.45965241324972483, 0.05781530552710934, -0.2631561061615161, -0.22348348812953345, -0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21839899392224835, "mean_inference_ms": 1.0610072396159653, "mean_action_processing_ms": 0.04508232563320305, "mean_env_wait_ms": 1.0499212041865076, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 120000, "timers": {"sample_time_ms": 1589.521, "sample_throughput": 3019.778, "learn_time_ms": 1721.947, "learn_throughput": 2787.543, "update_time_ms": 1.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 0.0049701588425032665, "total_loss": 0.0026693704881166156, "policy_loss": -0.0029801126863611372, "vf_loss": 0.0055831197012019785, "vf_explained_var": 0.2839733064174652, "kl": 0.004247249275642006, "entropy": -3.6678406439329447, "entropy_coeff": 0.0}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 112, "training_iteration": 25, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-46", "timestamp": 1617649126, "time_this_iter_s": 3.338402032852173, "time_total_s": 74.58598208427429, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23.22016716003418, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 42.62, "ram_util_percent": 62.08}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.042887731511616, "episode_reward_min": -0.5326877251575863, "episode_reward_mean": -0.07077607841542001, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437, -0.3398930419349806, -0.16849675691589572, 0.11646293097611249, -0.3716753459895684, -0.45965241324972483, 0.05781530552710934, -0.2631561061615161, -0.22348348812953345], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21839899392224835, "mean_inference_ms": 1.0610072396159653, "mean_action_processing_ms": 0.04508232563320305, "mean_env_wait_ms": 1.0499212041865076, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 124800, "timers": {"sample_time_ms": 1555.294, "sample_throughput": 3086.232, "learn_time_ms": 1700.39, "learn_throughput": 2822.881, "update_time_ms": 1.737}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 0.0049701588425032665, "total_loss": 0.0024025748165226297, "policy_loss": -0.0056368265251972175, "vf_loss": 0.008008492387537109, "vf_explained_var": 0.2298942655324936, "kl": 0.003956406898061304, "entropy": -3.7579045985874378, "entropy_coeff": 0.0}}, "num_steps_sampled": 124800, "num_steps_trained": 124800}, "done": false, "episodes_total": 112, "training_iteration": 26, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-49", "timestamp": 1617649129, "time_this_iter_s": 2.8710896968841553, "time_total_s": 77.45707178115845, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.091256856918335, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.175, "ram_util_percent": 62.1}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.042887731511616, "episode_reward_min": -0.5326877251575863, "episode_reward_mean": -0.08977351979211759, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.1650253504841186, -0.2960957849299364, 0.10293305124828178, -0.387426904242938, -0.1711852669772671, -0.2287591601046013, -0.03477841710064833, -0.14576844980003556, -0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437, -0.3398930419349806, -0.16849675691589572, 0.11646293097611249, -0.3716753459895684, -0.45965241324972483, 0.05781530552710934, -0.2631561061615161, -0.22348348812953345], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21662783226565993, "mean_inference_ms": 1.0565220072346775, "mean_action_processing_ms": 0.04463347805572766, "mean_env_wait_ms": 1.0346559054864173, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 129600, "timers": {"sample_time_ms": 1545.917, "sample_throughput": 3104.954, "learn_time_ms": 1710.563, "learn_throughput": 2806.094, "update_time_ms": 1.726}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 0.0049701588425032665, "total_loss": 0.005349937850903524, "policy_loss": -0.005417941260690752, "vf_loss": 0.010753545652780878, "vf_explained_var": 0.29089251160621643, "kl": 0.0036689697176610168, "entropy": -3.5037964958893624, "entropy_coeff": 0.0}}, "num_steps_sampled": 129600, "num_steps_trained": 129600}, "done": false, "episodes_total": 120, "training_iteration": 27, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-52", "timestamp": 1617649132, "time_this_iter_s": 3.2695796489715576, "time_total_s": 80.72665143013, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.360836505889893, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 44.24, "ram_util_percent": 62.08}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.149197225599667, "episode_reward_min": -0.7067436655081387, "episode_reward_mean": -0.07069571345808592, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.44348055392742025, 0.4174574544194325, -0.033482994017315804, -0.18491200263533492, 0.34014607503671535, -0.7067436655081387, -0.34063499327102587, 1.149197225599667, -0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437, -0.3398930419349806, -0.16849675691589572, 0.11646293097611249, -0.3716753459895684, -0.45965241324972483, 0.05781530552710934, -0.2631561061615161, -0.22348348812953345, -0.1650253504841186, -0.2960957849299364, 0.10293305124828178, -0.387426904242938, -0.1711852669772671, -0.2287591601046013, -0.03477841710064833, -0.14576844980003556], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21701895813483282, "mean_inference_ms": 1.0561870666712347, "mean_action_processing_ms": 0.04446478390192565, "mean_env_wait_ms": 1.027650517557169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 134400, "timers": {"sample_time_ms": 1567.216, "sample_throughput": 3062.756, "learn_time_ms": 1723.39, "learn_throughput": 2785.209, "update_time_ms": 1.725}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 0.0049701588425032665, "total_loss": 0.009451667091956264, "policy_loss": -0.0008448233313270306, "vf_loss": 0.01028884890930433, "vf_explained_var": 0.2759470045566559, "kl": 0.003912189485211121, "entropy": -3.6184694641514827, "entropy_coeff": 0.0}}, "num_steps_sampled": 134400, "num_steps_trained": 134400}, "done": false, "episodes_total": 128, "training_iteration": 28, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-56", "timestamp": 1617649136, "time_this_iter_s": 3.603506326675415, "time_total_s": 84.33015775680542, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.96434283256531, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 59.019999999999996, "ram_util_percent": 62.14}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.149197225599667, "episode_reward_min": -0.7067436655081387, "episode_reward_mean": -0.07069571345808592, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437, -0.3398930419349806, -0.16849675691589572, 0.11646293097611249, -0.3716753459895684, -0.45965241324972483, 0.05781530552710934, -0.2631561061615161, -0.22348348812953345, -0.1650253504841186, -0.2960957849299364, 0.10293305124828178, -0.387426904242938, -0.1711852669772671, -0.2287591601046013, -0.03477841710064833, -0.14576844980003556, -0.44348055392742025, 0.4174574544194325, -0.033482994017315804, -0.18491200263533492, 0.34014607503671535, -0.7067436655081387, -0.34063499327102587, 1.149197225599667], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21701895813483282, "mean_inference_ms": 1.0561870666712345, "mean_action_processing_ms": 0.04446478390192565, "mean_env_wait_ms": 1.027650517557169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 139200, "timers": {"sample_time_ms": 1487.172, "sample_throughput": 3227.603, "learn_time_ms": 1698.212, "learn_throughput": 2826.503, "update_time_ms": 1.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 0.0049701588425032665, "total_loss": -0.0012955511675069207, "policy_loss": -0.008624189153411671, "vf_loss": 0.007324191300492538, "vf_explained_var": 0.3699350357055664, "kl": 0.004556164016800099, "entropy": -3.5685210541674963, "entropy_coeff": 0.0}}, "num_steps_sampled": 139200, "num_steps_trained": 139200}, "done": false, "episodes_total": 128, "training_iteration": 29, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-58-59", "timestamp": 1617649139, "time_this_iter_s": 2.718540668487549, "time_total_s": 87.04869842529297, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.682883501052856, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.724999999999998, "ram_util_percent": 62.025}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.149197225599667, "episode_reward_min": -0.7067436655081387, "episode_reward_mean": -0.06257022835312237, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.14041945016668267, -0.007812949019061155, -0.3045546278836119, -0.07671742642508805, 0.02010477413026468, 0.2700117015101764, -0.37435858209279427, 0.5032080181600691, -0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437, -0.3398930419349806, -0.16849675691589572, 0.11646293097611249, -0.3716753459895684, -0.45965241324972483, 0.05781530552710934, -0.2631561061615161, -0.22348348812953345, -0.1650253504841186, -0.2960957849299364, 0.10293305124828178, -0.387426904242938, -0.1711852669772671, -0.2287591601046013, -0.03477841710064833, -0.14576844980003556, -0.44348055392742025, 0.4174574544194325, -0.033482994017315804, -0.18491200263533492, 0.34014607503671535, -0.7067436655081387, -0.34063499327102587, 1.149197225599667], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2160026191622826, "mean_inference_ms": 1.0506235566091249, "mean_action_processing_ms": 0.04414985193578921, "mean_env_wait_ms": 1.0174337887145655, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 144000, "timers": {"sample_time_ms": 1441.437, "sample_throughput": 3330.01, "learn_time_ms": 1664.687, "learn_throughput": 2883.424, "update_time_ms": 1.71}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00048828125, "cur_lr": 0.0049701588425032665, "total_loss": 0.0039590039645860855, "policy_loss": -0.0034627898498193212, "vf_loss": 0.0074195324590331626, "vf_explained_var": 0.25084400177001953, "kl": 0.004630044323245161, "entropy": -3.641659197054411, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 136, "training_iteration": 30, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-59-02", "timestamp": 1617649142, "time_this_iter_s": 2.829047918319702, "time_total_s": 89.87774634361267, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.51193141937256, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.474999999999998, "ram_util_percent": 62.1}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.149197225599667, "episode_reward_min": -0.7067436655081387, "episode_reward_mean": -0.06257022835312236, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437, -0.3398930419349806, -0.16849675691589572, 0.11646293097611249, -0.3716753459895684, -0.45965241324972483, 0.05781530552710934, -0.2631561061615161, -0.22348348812953345, -0.1650253504841186, -0.2960957849299364, 0.10293305124828178, -0.387426904242938, -0.1711852669772671, -0.2287591601046013, -0.03477841710064833, -0.14576844980003556, -0.44348055392742025, 0.4174574544194325, -0.033482994017315804, -0.18491200263533492, 0.34014607503671535, -0.7067436655081387, -0.34063499327102587, 1.149197225599667, -0.14041945016668267, -0.007812949019061155, -0.3045546278836119, -0.07671742642508805, 0.02010477413026468, 0.2700117015101764, -0.37435858209279427, 0.5032080181600691], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21600261916228258, "mean_inference_ms": 1.0506235566091249, "mean_action_processing_ms": 0.04414985193578921, "mean_env_wait_ms": 1.0174337887145652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 148800, "timers": {"sample_time_ms": 1448.37, "sample_throughput": 3314.07, "learn_time_ms": 1691.21, "learn_throughput": 2838.204, "update_time_ms": 1.66}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000244140625, "cur_lr": 0.0049701588425032665, "total_loss": 0.0026671507052685086, "policy_loss": -0.005196729478867431, "vf_loss": 0.007861962995344871, "vf_explained_var": 0.25415539741516113, "kl": 0.007842524173228364, "entropy": -3.8048053917131925, "entropy_coeff": 0.0}}, "num_steps_sampled": 148800, "num_steps_trained": 148800}, "done": false, "episodes_total": 136, "training_iteration": 31, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-59-05", "timestamp": 1617649145, "time_this_iter_s": 3.557854652404785, "time_total_s": 93.43560099601746, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.069786071777344, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 57.81999999999999, "ram_util_percent": 61.86}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.149197225599667, "episode_reward_min": -0.7067436655081387, "episode_reward_mean": -0.03258068980693972, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.13113710588016314, 0.4177439332073982, -0.08378931605584788, -0.2980047972233928, -0.1497718247564933, 0.4723644787981369, 0.8482897447210811, 0.3430735273199905, -0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437, -0.3398930419349806, -0.16849675691589572, 0.11646293097611249, -0.3716753459895684, -0.45965241324972483, 0.05781530552710934, -0.2631561061615161, -0.22348348812953345, -0.1650253504841186, -0.2960957849299364, 0.10293305124828178, -0.387426904242938, -0.1711852669772671, -0.2287591601046013, -0.03477841710064833, -0.14576844980003556, -0.44348055392742025, 0.4174574544194325, -0.033482994017315804, -0.18491200263533492, 0.34014607503671535, -0.7067436655081387, -0.34063499327102587, 1.149197225599667, -0.14041945016668267, -0.007812949019061155, -0.3045546278836119, -0.07671742642508805, 0.02010477413026468, 0.2700117015101764, -0.37435858209279427, 0.5032080181600691], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21553415958562192, "mean_inference_ms": 1.0491828030230712, "mean_action_processing_ms": 0.04404233452293853, "mean_env_wait_ms": 1.0128704803343385, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 153600, "timers": {"sample_time_ms": 1496.077, "sample_throughput": 3208.392, "learn_time_ms": 1706.564, "learn_throughput": 2812.67, "update_time_ms": 1.661}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000244140625, "cur_lr": 0.0049701588425032665, "total_loss": 0.014046693024666686, "policy_loss": -0.0004895708866809544, "vf_loss": 0.014535094807414632, "vf_explained_var": 0.18174999952316284, "kl": 0.004783293079143684, "entropy": -3.6039004702317086, "entropy_coeff": 0.0}}, "num_steps_sampled": 153600, "num_steps_trained": 153600}, "done": false, "episodes_total": 144, "training_iteration": 32, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-59-09", "timestamp": 1617649149, "time_this_iter_s": 3.4145007133483887, "time_total_s": 96.85010170936584, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.48428678512573, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 48.82000000000001, "ram_util_percent": 61.98}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.149197225599667, "episode_reward_min": -0.7067436655081387, "episode_reward_mean": -0.011529727042914986, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.31445026843691226, 0.21826626276113115, 0.5420950307907755, -0.0903572351671692, 0.9722876430766021, 0.033454390458567795, -0.27265183743993887, 0.16637981451120742, -0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437, -0.3398930419349806, -0.16849675691589572, 0.11646293097611249, -0.3716753459895684, -0.45965241324972483, 0.05781530552710934, -0.2631561061615161, -0.22348348812953345, -0.1650253504841186, -0.2960957849299364, 0.10293305124828178, -0.387426904242938, -0.1711852669772671, -0.2287591601046013, -0.03477841710064833, -0.14576844980003556, -0.44348055392742025, 0.4174574544194325, -0.033482994017315804, -0.18491200263533492, 0.34014607503671535, -0.7067436655081387, -0.34063499327102587, 1.149197225599667, -0.14041945016668267, -0.007812949019061155, -0.3045546278836119, -0.07671742642508805, 0.02010477413026468, 0.2700117015101764, -0.37435858209279427, 0.5032080181600691, -0.13113710588016314, 0.4177439332073982, -0.08378931605584788, -0.2980047972233928, -0.1497718247564933, 0.4723644787981369, 0.8482897447210811, 0.3430735273199905], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2152879576372828, "mean_inference_ms": 1.0464723596621348, "mean_action_processing_ms": 0.043898116694384495, "mean_env_wait_ms": 1.0077063064339815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 158400, "timers": {"sample_time_ms": 1491.394, "sample_throughput": 3218.465, "learn_time_ms": 1687.797, "learn_throughput": 2843.943, "update_time_ms": 1.693}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001220703125, "cur_lr": 0.0049701588425032665, "total_loss": 0.011073420020310502, "policy_loss": -0.0030400702288668406, "vf_loss": 0.014113087109044978, "vf_explained_var": 0.1026994064450264, "kl": 0.003336930108305655, "entropy": -3.6433036703812447, "entropy_coeff": 0.0}}, "num_steps_sampled": 158400, "num_steps_trained": 158400}, "done": false, "episodes_total": 152, "training_iteration": 33, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-59-11", "timestamp": 1617649151, "time_this_iter_s": 2.7453954219818115, "time_total_s": 99.59549713134766, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.229682207107544, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 27.175, "ram_util_percent": 62.0}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.149197225599667, "episode_reward_min": -0.7067436655081387, "episode_reward_mean": -0.011529727042914982, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.08624117566407041, -0.1091276223534442, -0.3983380125625282, 0.4200070546125547, -0.43039305487049595, -0.4000864224834806, -0.5105577362550204, 1.041130879140503, -0.4354455653960439, 0.03280252408576945, -0.4030436840205469, 0.5665137866977916, 1.042887731511616, -0.19820548391854997, 0.1360584088228194, 0.23398495361126037, 0.6535356955490248, -0.38409220136632816, -0.28573540324754076, -0.03565817218541878, -0.1600706097643898, -0.5326877251575863, 0.03615315346437642, -0.40614691166571437, -0.3398930419349806, -0.16849675691589572, 0.11646293097611249, -0.3716753459895684, -0.45965241324972483, 0.05781530552710934, -0.2631561061615161, -0.22348348812953345, -0.1650253504841186, -0.2960957849299364, 0.10293305124828178, -0.387426904242938, -0.1711852669772671, -0.2287591601046013, -0.03477841710064833, -0.14576844980003556, -0.44348055392742025, 0.4174574544194325, -0.033482994017315804, -0.18491200263533492, 0.34014607503671535, -0.7067436655081387, -0.34063499327102587, 1.149197225599667, -0.14041945016668267, -0.007812949019061155, -0.3045546278836119, -0.07671742642508805, 0.02010477413026468, 0.2700117015101764, -0.37435858209279427, 0.5032080181600691, -0.13113710588016314, 0.4177439332073982, -0.08378931605584788, -0.2980047972233928, -0.1497718247564933, 0.4723644787981369, 0.8482897447210811, 0.3430735273199905, -0.31445026843691226, 0.21826626276113115, 0.5420950307907755, -0.0903572351671692, 0.9722876430766021, 0.033454390458567795, -0.27265183743993887, 0.16637981451120742], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2152879576372828, "mean_inference_ms": 1.046472359662135, "mean_action_processing_ms": 0.043898116694384495, "mean_env_wait_ms": 1.0077063064339815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 163200, "timers": {"sample_time_ms": 1443.773, "sample_throughput": 3324.622, "learn_time_ms": 1677.557, "learn_throughput": 2861.303, "update_time_ms": 1.671}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-05, "cur_lr": 0.0049701588425032665, "total_loss": 0.0040729536527865816, "policy_loss": -0.005742525681853294, "vf_loss": 0.009815269762552098, "vf_explained_var": 0.35373154282569885, "kl": 0.003459522270867111, "entropy": -3.6265257596969604, "entropy_coeff": 0.0}}, "num_steps_sampled": 163200, "num_steps_trained": 163200}, "done": false, "episodes_total": 152, "training_iteration": 34, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_11-59-14", "timestamp": 1617649154, "time_this_iter_s": 2.9227569103240967, "time_total_s": 102.51825404167175, "pid": 19201, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.15243911743164, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 36.474999999999994, "ram_util_percent": 62.175}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 168000, "timers": {"sample_time_ms": 1599.991, "sample_throughput": 3000.016, "learn_time_ms": 1485.916, "learn_throughput": 3230.33, "update_time_ms": 1.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0049701588425032665, "total_loss": 0.004273907820645131, "policy_loss": -0.004861283508178435, "vf_loss": 0.006924639002567059, "vf_explained_var": 0.5092151761054993, "kl": 0.0022105486162840144, "entropy": -3.6767218928588066, "entropy_coeff": 0.0}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 152, "training_iteration": 35, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-23", "timestamp": 1617649223, "time_this_iter_s": 3.0903871059417725, "time_total_s": 105.60864114761353, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3.0903871059417725, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.78, "ram_util_percent": 61.68000000000001}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.7410912900931348, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": -0.0682749674218329, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17349720993804296, "mean_inference_ms": 0.8781387794027717, "mean_action_processing_ms": 0.037616957832037855, "mean_env_wait_ms": 0.9062091178639942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 172800, "timers": {"sample_time_ms": 1380.826, "sample_throughput": 3476.181, "learn_time_ms": 1492.257, "learn_throughput": 3216.603, "update_time_ms": 1.624}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.0049701588425032665, "total_loss": 0.00031740451231598854, "policy_loss": -0.008252342010995275, "vf_loss": 0.007184524248403154, "vf_explained_var": 0.25978317856788635, "kl": 0.0027704476286951256, "entropy": -3.670564657763431, "entropy_coeff": 0.0}}, "num_steps_sampled": 172800, "num_steps_trained": 172800}, "done": false, "episodes_total": 160, "training_iteration": 36, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-25", "timestamp": 1617649225, "time_this_iter_s": 2.6653945446014404, "time_total_s": 108.27403569221497, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.755781650543213, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 27.875, "ram_util_percent": 61.849999999999994}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.7410912900931348, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": -0.0682749674218329, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17349720993804296, "mean_inference_ms": 0.8781387794027717, "mean_action_processing_ms": 0.037616957832037855, "mean_env_wait_ms": 0.9062091178639942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 177600, "timers": {"sample_time_ms": 1476.266, "sample_throughput": 3251.446, "learn_time_ms": 1630.215, "learn_throughput": 2944.396, "update_time_ms": 1.591}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.0049701588425032665, "total_loss": 0.004540475379479558, "policy_loss": -0.004733572603742543, "vf_loss": 0.008184329863931788, "vf_explained_var": 0.30633991956710815, "kl": 0.004358880950971262, "entropy": -3.8440640725587545, "entropy_coeff": 0.0}}, "num_steps_sampled": 177600, "num_steps_trained": 177600}, "done": false, "episodes_total": 160, "training_iteration": 37, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-29", "timestamp": 1617649229, "time_this_iter_s": 3.5790257453918457, "time_total_s": 111.85306143760681, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9.334807395935059, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 54.04, "ram_util_percent": 56.720000000000006}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.7410912900931348, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": -0.07851975897951774, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19647560482859106, "mean_inference_ms": 0.9654196496808691, "mean_action_processing_ms": 0.04150392179255271, "mean_env_wait_ms": 0.9777574953498718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 182400, "timers": {"sample_time_ms": 1582.072, "sample_throughput": 3033.997, "learn_time_ms": 1699.702, "learn_throughput": 2824.024, "update_time_ms": 1.557}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.0049701588425032665, "total_loss": 0.005274319335034019, "policy_loss": -0.005634089735777755, "vf_loss": 0.010353621524317484, "vf_explained_var": 0.3318885564804077, "kl": 0.004438282529774465, "entropy": -3.657273813297874, "entropy_coeff": 0.0}}, "num_steps_sampled": 182400, "num_steps_trained": 182400}, "done": false, "episodes_total": 168, "training_iteration": 38, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-33", "timestamp": 1617649233, "time_this_iter_s": 3.8135342597961426, "time_total_s": 115.66659569740295, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.148341655731201, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 65.2, "ram_util_percent": 60.4}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.7410912900931348, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": -0.04650201841891923, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984, -0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20910432290888784, "mean_inference_ms": 0.9978905392531825, "mean_action_processing_ms": 0.04289246503931876, "mean_env_wait_ms": 1.0025104765335173, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 187200, "timers": {"sample_time_ms": 1608.809, "sample_throughput": 2983.573, "learn_time_ms": 1685.732, "learn_throughput": 2847.428, "update_time_ms": 1.557}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.0049701588425032665, "total_loss": 0.007307135647064761, "policy_loss": -0.0020180139200467813, "vf_loss": 0.009129486169273915, "vf_explained_var": 0.19390924274921417, "kl": 0.0031306354610837603, "entropy": -3.677447143353914, "entropy_coeff": 0.0}}, "num_steps_sampled": 187200, "num_steps_trained": 187200}, "done": false, "episodes_total": 176, "training_iteration": 39, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-36", "timestamp": 1617649236, "time_this_iter_s": 3.3504297733306885, "time_total_s": 119.01702547073364, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.49877142906189, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 52.86, "ram_util_percent": 61.64}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.7410912900931348, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": -0.04650201841891923, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20910432290888784, "mean_inference_ms": 0.9978905392531825, "mean_action_processing_ms": 0.04289246503931876, "mean_env_wait_ms": 1.0025104765335173, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 192000, "timers": {"sample_time_ms": 1542.117, "sample_throughput": 3112.605, "learn_time_ms": 1663.631, "learn_throughput": 2885.256, "update_time_ms": 1.56}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 0.0049701588425032665, "total_loss": 0.0019377608244356356, "policy_loss": -0.005075401013815089, "vf_loss": 0.006849563888911354, "vf_explained_var": 0.3839225769042969, "kl": 0.005235109913260921, "entropy": -3.6920163066763627, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 176, "training_iteration": 40, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-39", "timestamp": 1617649239, "time_this_iter_s": 2.767148971557617, "time_total_s": 121.78417444229126, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.265920400619507, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.775000000000002, "ram_util_percent": 61.7}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.7410912900931348, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": -0.054867357639104365, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.17645984412730809, 0.31658021831339545, -0.3263254855940799, -0.054774753334842496, -0.5123844696705693, -0.13021399290175206, 0.10665444603583896, 0.13721687888203893, -0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2140356870359718, "mean_inference_ms": 1.0095930325260432, "mean_action_processing_ms": 0.04334526933358862, "mean_env_wait_ms": 1.007684644849753, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 196800, "timers": {"sample_time_ms": 1572.372, "sample_throughput": 3052.712, "learn_time_ms": 1701.415, "learn_throughput": 2821.181, "update_time_ms": 1.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 0.0049701588425032665, "total_loss": 0.0020217871244408584, "policy_loss": -0.006299429033931933, "vf_loss": 0.008198885957857496, "vf_explained_var": 0.18463607132434845, "kl": 0.003914596604820537, "entropy": -3.727318889216373, "entropy_coeff": 0.0}}, "num_steps_sampled": 196800, "num_steps_trained": 196800}, "done": false, "episodes_total": 184, "training_iteration": 41, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-43", "timestamp": 1617649243, "time_this_iter_s": 3.686995267868042, "time_total_s": 125.4711697101593, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.95291566848755, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 61.720000000000006}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.7410912900931348, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": -0.05486735763910438, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984, -0.17645984412730809, 0.31658021831339545, -0.3263254855940799, -0.054774753334842496, -0.5123844696705693, -0.13021399290175206, 0.10665444603583896, 0.13721687888203893], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2140356870359718, "mean_inference_ms": 1.0095930325260432, "mean_action_processing_ms": 0.04334526933358862, "mean_env_wait_ms": 1.007684644849753, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 201600, "timers": {"sample_time_ms": 1547.996, "sample_throughput": 3100.783, "learn_time_ms": 1681.897, "learn_throughput": 2853.92, "update_time_ms": 1.574}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 0.0049701588425032665, "total_loss": 0.010911294173351243, "policy_loss": 9.175463530578112e-06, "vf_loss": 0.010681702975967997, "vf_explained_var": 0.3082766830921173, "kl": 0.014106744575608326, "entropy": -3.954058785187571, "entropy_coeff": 0.0}}, "num_steps_sampled": 201600, "num_steps_trained": 201600}, "done": false, "episodes_total": 184, "training_iteration": 42, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-46", "timestamp": 1617649246, "time_this_iter_s": 2.9276890754699707, "time_total_s": 128.39885878562927, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.88060474395752, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.1, "ram_util_percent": 61.8}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.8002048071533538, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": -0.009004488211217304, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.146191191862155, -0.3239418562422586, 0.48391332373695506, 0.8002048071533538, -0.5382246759384659, 0.6494391751553543, 0.14162294938038777, 0.03637100089516654, -0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984, -0.17645984412730809, 0.31658021831339545, -0.3263254855940799, -0.054774753334842496, -0.5123844696705693, -0.13021399290175206, 0.10665444603583896, 0.13721687888203893], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21493456531645405, "mean_inference_ms": 1.0176342758271133, "mean_action_processing_ms": 0.043391599783699344, "mean_env_wait_ms": 1.0047103906132078, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 206400, "timers": {"sample_time_ms": 1554.357, "sample_throughput": 3088.093, "learn_time_ms": 1705.983, "learn_throughput": 2813.627, "update_time_ms": 1.607}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 0.0049701588425032665, "total_loss": 0.007908010009774253, "policy_loss": -0.005529057724695457, "vf_loss": 0.0132918450001039, "vf_explained_var": 0.30989784002304077, "kl": 0.009294328212394919, "entropy": -3.732412212773373, "entropy_coeff": 0.0}}, "num_steps_sampled": 206400, "num_steps_trained": 206400}, "done": false, "episodes_total": 192, "training_iteration": 43, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-49", "timestamp": 1617649249, "time_this_iter_s": 3.509275197982788, "time_total_s": 131.90813398361206, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.389879941940308, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 53.0, "ram_util_percent": 61.760000000000005}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.8002048071533538, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": -0.003495846282597165, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.48172026500280873, 0.48664410216113474, 0.34399156254572283, -0.2978850589325257, -0.19324510103139458, 0.2604068797939125, -0.6228146962331702, -0.2664390464224601, -0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984, -0.17645984412730809, 0.31658021831339545, -0.3263254855940799, -0.054774753334842496, -0.5123844696705693, -0.13021399290175206, 0.10665444603583896, 0.13721687888203893, 0.146191191862155, -0.3239418562422586, 0.48391332373695506, 0.8002048071533538, -0.5382246759384659, 0.6494391751553543, 0.14162294938038777, 0.03637100089516654], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21581398168674634, "mean_inference_ms": 1.0212851705741528, "mean_action_processing_ms": 0.0433667894402297, "mean_env_wait_ms": 1.001129314241434, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 211200, "timers": {"sample_time_ms": 1540.386, "sample_throughput": 3116.103, "learn_time_ms": 1694.271, "learn_throughput": 2833.077, "update_time_ms": 1.6}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 0.0049701588425032665, "total_loss": 0.004198790981287235, "policy_loss": -0.004652189924136589, "vf_loss": 0.00879565354338602, "vf_explained_var": 0.09626312553882599, "kl": 0.003540901467204094, "entropy": -3.595634146740562, "entropy_coeff": 0.0}}, "num_steps_sampled": 211200, "num_steps_trained": 211200}, "done": false, "episodes_total": 200, "training_iteration": 44, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-52", "timestamp": 1617649252, "time_this_iter_s": 3.0089879035949707, "time_total_s": 134.91712188720703, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.39886784553528, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 36.85, "ram_util_percent": 61.849999999999994}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 0.8002048071533538, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": -0.003495846282597165, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984, -0.17645984412730809, 0.31658021831339545, -0.3263254855940799, -0.054774753334842496, -0.5123844696705693, -0.13021399290175206, 0.10665444603583896, 0.13721687888203893, 0.146191191862155, -0.3239418562422586, 0.48391332373695506, 0.8002048071533538, -0.5382246759384659, 0.6494391751553543, 0.14162294938038777, 0.03637100089516654, 0.48172026500280873, 0.48664410216113474, 0.34399156254572283, -0.2978850589325257, -0.19324510103139458, 0.2604068797939125, -0.6228146962331702, -0.2664390464224601], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21581398168674637, "mean_inference_ms": 1.0212851705741528, "mean_action_processing_ms": 0.04336678944022971, "mean_env_wait_ms": 1.0011293142414341, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 216000, "timers": {"sample_time_ms": 1493.208, "sample_throughput": 3214.556, "learn_time_ms": 1720.156, "learn_throughput": 2790.444, "update_time_ms": 1.583}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 0.0049701588425032665, "total_loss": 0.0023171700610730207, "policy_loss": -0.0062946702451690244, "vf_loss": 0.008578712917178086, "vf_explained_var": 0.42792531847953796, "kl": 0.0042406705293902445, "entropy": -3.7252766333128275, "entropy_coeff": 0.0}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 200, "training_iteration": 45, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-55", "timestamp": 1617649255, "time_this_iter_s": 2.8780455589294434, "time_total_s": 137.79516744613647, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.27691340446472, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 37.525, "ram_util_percent": 61.975}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.297930726508317, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": 0.005364002546646184, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.051102892708713155, 1.297930726508317, 0.7924614458881631, -0.3498238645896199, -0.1875609850237192, -0.6067300577100714, -0.21796304363942742, -0.31123234996550675, -0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984, -0.17645984412730809, 0.31658021831339545, -0.3263254855940799, -0.054774753334842496, -0.5123844696705693, -0.13021399290175206, 0.10665444603583896, 0.13721687888203893, 0.146191191862155, -0.3239418562422586, 0.48391332373695506, 0.8002048071533538, -0.5382246759384659, 0.6494391751553543, 0.14162294938038777, 0.03637100089516654, 0.48172026500280873, 0.48664410216113474, 0.34399156254572283, -0.2978850589325257, -0.19324510103139458, 0.2604068797939125, -0.6228146962331702, -0.2664390464224601], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21594984328788475, "mean_inference_ms": 1.0228099110798092, "mean_action_processing_ms": 0.04332517919922781, "mean_env_wait_ms": 0.9975546549972002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 220800, "timers": {"sample_time_ms": 1552.573, "sample_throughput": 3091.643, "learn_time_ms": 1740.835, "learn_throughput": 2757.297, "update_time_ms": 1.569}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 0.0049701588425032665, "total_loss": 0.0014844838113180902, "policy_loss": -0.008157966830032436, "vf_loss": 0.00960655748157909, "vf_explained_var": 0.09139683097600937, "kl": 0.009189386723416024, "entropy": -3.6471909849267257, "entropy_coeff": 0.0}}, "num_steps_sampled": 220800, "num_steps_trained": 220800}, "done": false, "episodes_total": 208, "training_iteration": 46, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-00-59", "timestamp": 1617649259, "time_this_iter_s": 3.466038942337036, "time_total_s": 141.2612063884735, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.74295234680176, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 55.09999999999999, "ram_util_percent": 61.92}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.297930726508317, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": 0.005364002546646152, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984, -0.17645984412730809, 0.31658021831339545, -0.3263254855940799, -0.054774753334842496, -0.5123844696705693, -0.13021399290175206, 0.10665444603583896, 0.13721687888203893, 0.146191191862155, -0.3239418562422586, 0.48391332373695506, 0.8002048071533538, -0.5382246759384659, 0.6494391751553543, 0.14162294938038777, 0.03637100089516654, 0.48172026500280873, 0.48664410216113474, 0.34399156254572283, -0.2978850589325257, -0.19324510103139458, 0.2604068797939125, -0.6228146962331702, -0.2664390464224601, 0.051102892708713155, 1.297930726508317, 0.7924614458881631, -0.3498238645896199, -0.1875609850237192, -0.6067300577100714, -0.21796304363942742, -0.31123234996550675], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21594984328788477, "mean_inference_ms": 1.0228099110798092, "mean_action_processing_ms": 0.043325179199227834, "mean_env_wait_ms": 0.9975546549972003, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 225600, "timers": {"sample_time_ms": 1507.578, "sample_throughput": 3183.915, "learn_time_ms": 1712.145, "learn_throughput": 2803.5, "update_time_ms": 1.581}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 0.0049701588425032665, "total_loss": 0.004409239419098748, "policy_loss": -0.005223104093027742, "vf_loss": 0.009610423279043875, "vf_explained_var": 0.36483898758888245, "kl": 0.005611158386608095, "entropy": -3.8544156174910698, "entropy_coeff": 0.0}}, "num_steps_sampled": 225600, "num_steps_trained": 225600}, "done": false, "episodes_total": 208, "training_iteration": 47, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-01-02", "timestamp": 1617649262, "time_this_iter_s": 2.8424570560455322, "time_total_s": 144.10366344451904, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 41.58540940284729, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.6, "ram_util_percent": 61.9}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.297930726508317, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": 0.005192455124774557, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.12570635276851316, -0.16004083767073685, -0.19568808684359373, 0.2703043075258933, -0.13114885409836385, 0.2541409190867614, 0.1777689283827384, -0.3091097437778251, -0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984, -0.17645984412730809, 0.31658021831339545, -0.3263254855940799, -0.054774753334842496, -0.5123844696705693, -0.13021399290175206, 0.10665444603583896, 0.13721687888203893, 0.146191191862155, -0.3239418562422586, 0.48391332373695506, 0.8002048071533538, -0.5382246759384659, 0.6494391751553543, 0.14162294938038777, 0.03637100089516654, 0.48172026500280873, 0.48664410216113474, 0.34399156254572283, -0.2978850589325257, -0.19324510103139458, 0.2604068797939125, -0.6228146962331702, -0.2664390464224601, 0.051102892708713155, 1.297930726508317, 0.7924614458881631, -0.3498238645896199, -0.1875609850237192, -0.6067300577100714, -0.21796304363942742, -0.31123234996550675], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21597775726223892, "mean_inference_ms": 1.023251201699908, "mean_action_processing_ms": 0.04327210691677997, "mean_env_wait_ms": 0.9942809531536868, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 230400, "timers": {"sample_time_ms": 1490.57, "sample_throughput": 3220.245, "learn_time_ms": 1700.64, "learn_throughput": 2822.467, "update_time_ms": 1.613}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 0.0049701588425032665, "total_loss": 0.013936595893219897, "policy_loss": 0.0019927439034769408, "vf_loss": 0.011928131803870201, "vf_explained_var": 0.37316426634788513, "kl": 0.004023800683697979, "entropy": -3.739948818558141, "entropy_coeff": 0.0}}, "num_steps_sampled": 230400, "num_steps_trained": 230400}, "done": false, "episodes_total": 216, "training_iteration": 48, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-01-05", "timestamp": 1617649265, "time_this_iter_s": 3.5282046794891357, "time_total_s": 147.63186812400818, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.113614082336426, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 57.220000000000006, "ram_util_percent": 61.839999999999996}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.297930726508317, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": 0.0022624271193696305, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6101529352668815, 0.16564862121795576, -0.530507173810772, -0.5030713660173856, -0.3212383241966994, 0.036772061656852706, -0.2736716199240836, 0.6464924904162925, -0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984, -0.17645984412730809, 0.31658021831339545, -0.3263254855940799, -0.054774753334842496, -0.5123844696705693, -0.13021399290175206, 0.10665444603583896, 0.13721687888203893, 0.146191191862155, -0.3239418562422586, 0.48391332373695506, 0.8002048071533538, -0.5382246759384659, 0.6494391751553543, 0.14162294938038777, 0.03637100089516654, 0.48172026500280873, 0.48664410216113474, 0.34399156254572283, -0.2978850589325257, -0.19324510103139458, 0.2604068797939125, -0.6228146962331702, -0.2664390464224601, 0.051102892708713155, 1.297930726508317, 0.7924614458881631, -0.3498238645896199, -0.1875609850237192, -0.6067300577100714, -0.21796304363942742, -0.31123234996550675, 0.12570635276851316, -0.16004083767073685, -0.19568808684359373, 0.2703043075258933, -0.13114885409836385, 0.2541409190867614, 0.1777689283827384, -0.3091097437778251], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2160081563973562, "mean_inference_ms": 1.022079992610069, "mean_action_processing_ms": 0.04317283879738475, "mean_env_wait_ms": 0.990177653854859, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 235200, "timers": {"sample_time_ms": 1440.376, "sample_throughput": 3332.464, "learn_time_ms": 1692.902, "learn_throughput": 2835.368, "update_time_ms": 1.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 0.0049701588425032665, "total_loss": 0.0025317170412132613, "policy_loss": -0.005869460782330287, "vf_loss": 0.008393685002566167, "vf_explained_var": 0.07979568839073181, "kl": 0.00383545093753032, "entropy": -3.6092879458477625, "entropy_coeff": 0.0}}, "num_steps_sampled": 235200, "num_steps_trained": 235200}, "done": false, "episodes_total": 224, "training_iteration": 49, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-01-08", "timestamp": 1617649268, "time_this_iter_s": 2.7717440128326416, "time_total_s": 150.40361213684082, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 47.88535809516907, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 31.950000000000003, "ram_util_percent": 61.925}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 1.297930726508317, "episode_reward_min": -0.6393486435874105, "episode_reward_mean": 0.0022624271193696366, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4396598607051205, 0.014122073304482008, -0.2979109682782132, 0.7410912900931348, 0.017232945318643278, -0.6393486435874105, 0.35547543056776365, -0.29720200608794284, -0.17809539030385135, 0.41414786513536717, -0.35239521858140976, 0.00926546672045725, -0.3673072273226315, 0.252023709409003, -0.4441657096988563, -0.04358989965569915, -0.2842426295764734, 0.2896988216801224, 0.4116214084450722, 0.017669602973133136, 0.6609150234732057, -0.3733003197473679, -0.36142970548906994, -0.22066450014039984, -0.17645984412730809, 0.31658021831339545, -0.3263254855940799, -0.054774753334842496, -0.5123844696705693, -0.13021399290175206, 0.10665444603583896, 0.13721687888203893, 0.146191191862155, -0.3239418562422586, 0.48391332373695506, 0.8002048071533538, -0.5382246759384659, 0.6494391751553543, 0.14162294938038777, 0.03637100089516654, 0.48172026500280873, 0.48664410216113474, 0.34399156254572283, -0.2978850589325257, -0.19324510103139458, 0.2604068797939125, -0.6228146962331702, -0.2664390464224601, 0.051102892708713155, 1.297930726508317, 0.7924614458881631, -0.3498238645896199, -0.1875609850237192, -0.6067300577100714, -0.21796304363942742, -0.31123234996550675, 0.12570635276851316, -0.16004083767073685, -0.19568808684359373, 0.2703043075258933, -0.13114885409836385, 0.2541409190867614, 0.1777689283827384, -0.3091097437778251, 0.6101529352668815, 0.16564862121795576, -0.530507173810772, -0.5030713660173856, -0.3212383241966994, 0.036772061656852706, -0.2736716199240836, 0.6464924904162925], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2160081563973562, "mean_inference_ms": 1.0220799926100692, "mean_action_processing_ms": 0.043172838797384754, "mean_env_wait_ms": 0.990177653854859, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 240000, "timers": {"sample_time_ms": 1434.141, "sample_throughput": 3346.952, "learn_time_ms": 1720.809, "learn_throughput": 2789.386, "update_time_ms": 1.64}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 0.0049701588425032665, "total_loss": 0.00735202287078688, "policy_loss": -0.0003331976354514298, "vf_loss": 0.007679271413699577, "vf_explained_var": 0.37252339720726013, "kl": 0.006091828053621085, "entropy": -3.76472985117059, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 224, "training_iteration": 50, "experiment_id": "b2bddb7d6b1c49a09f1817cc0dbcdfb3", "date": "2021-04-05_12-01-11", "timestamp": 1617649271, "time_this_iter_s": 2.9839487075805664, "time_total_s": 153.3875608444214, "pid": 19993, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4012, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 48, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0049701588425032665, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9772672979358612, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.12053323925756039, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.869306802749634, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 39.800000000000004, "ram_util_percent": 62.0}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 6.791194918754086, "episode_reward_min": 2.634456766669619, "episode_reward_mean": 3.8102826861536156, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8280296750385983, 4.983607673472723, 2.974370966227983, 3.1706606755375653, 6.791194918754086, 2.634456766669619, 2.939666374484257, 3.1602744390440938], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1470558748554925, "mean_inference_ms": 0.8000861000359604, "mean_action_processing_ms": 0.03401095126689621, "mean_env_wait_ms": 0.7772758590688713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 201600, "timers": {"sample_time_ms": 7253.434, "sample_throughput": 1323.511, "learn_time_ms": 2845.925, "learn_throughput": 3373.244, "update_time_ms": 1.464}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": -0.039448839612305164, "policy_loss": -0.06437611152957144, "vf_loss": 0.0056858070562348555, "vf_explained_var": 0.959770143032074, "kl": 0.019241465186994326, "entropy": -3.566038703918457, "entropy_coeff": 0.0}}, "num_steps_sampled": 201600, "num_steps_trained": 201600}, "done": false, "episodes_total": 192, "training_iteration": 16, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-01-28", "timestamp": 1617649288, "time_this_iter_s": 10.103801965713501, "time_total_s": 117.09954762458801, "pid": 20439, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.103801965713501, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.53333333333334, "ram_util_percent": 61.72666666666666}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 7.978969988420252, "episode_reward_min": 1.2152270357375525, "episode_reward_mean": 4.521275066649515, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2152270357375525, 4.992962206598409, 4.4701863733748075, 5.493460674053593, 6.997624900318605, 6.432709592214192, 4.276998806445916, 7.978969988420252, 3.8280296750385983, 4.983607673472723, 2.974370966227983, 3.1706606755375653, 6.791194918754086, 2.634456766669619, 2.939666374484257, 3.1602744390440938], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15221365875206158, "mean_inference_ms": 0.8327887086891261, "mean_action_processing_ms": 0.03536164575549859, "mean_env_wait_ms": 0.7935353411656627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 211200, "timers": {"sample_time_ms": 4955.026, "sample_throughput": 1937.427, "learn_time_ms": 3038.013, "learn_throughput": 3159.96, "update_time_ms": 1.395}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.289328509294673, "policy_loss": 0.07205328927130292, "vf_loss": 0.031495418115273906, "vf_explained_var": 0.8152311444282532, "kl": 0.18577980446188072, "entropy": -3.4692690046210037, "entropy_coeff": 0.0}}, "num_steps_sampled": 211200, "num_steps_trained": 211200}, "done": false, "episodes_total": 200, "training_iteration": 17, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-01-34", "timestamp": 1617649294, "time_this_iter_s": 5.892359495162964, "time_total_s": 122.99190711975098, "pid": 20439, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.996161460876465, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 52.7375, "ram_util_percent": 57.0375}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 7.978969988420252, "episode_reward_min": 0.7225228753380355, "episode_reward_mean": 4.006565121520839, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0043635010977745, 1.950742208978725, 4.11838818761113, 0.7225228753380355, 4.21479537322977, 4.091938049846432, 1.2083487582128676, 3.506062895793158, 3.8280296750385983, 4.983607673472723, 2.974370966227983, 3.1706606755375653, 6.791194918754086, 2.634456766669619, 2.939666374484257, 3.1602744390440938, 1.2152270357375525, 4.992962206598409, 4.4701863733748075, 5.493460674053593, 6.997624900318605, 6.432709592214192, 4.276998806445916, 7.978969988420252], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1600984386164082, "mean_inference_ms": 0.8742517964944193, "mean_action_processing_ms": 0.03716107010023351, "mean_env_wait_ms": 0.8268849671196458, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 220800, "timers": {"sample_time_ms": 4389.351, "sample_throughput": 2187.112, "learn_time_ms": 2909.636, "learn_throughput": 3299.382, "update_time_ms": 1.433}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.03593534042409278, "policy_loss": -0.022178952038321816, "vf_loss": 0.014428290254191348, "vf_explained_var": 0.9003744721412659, "kl": 0.02912400264881159, "entropy": -3.443466033433613, "entropy_coeff": 0.0}}, "num_steps_sampled": 220800, "num_steps_trained": 220800}, "done": false, "episodes_total": 208, "training_iteration": 18, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-01-40", "timestamp": 1617649300, "time_this_iter_s": 5.916595697402954, "time_total_s": 128.90850281715393, "pid": 20439, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21.91275715827942, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.65555555555556, "ram_util_percent": 61.64444444444445}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 7.978969988420252, "episode_reward_min": 0.4684915831884646, "episode_reward_mean": 3.3857055088510695, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.9515947688310624, 1.2745437568042317, 1.6227078448185788, 2.104019083948618, 0.4684915831884646, 1.5655269751203424, 0.7117942855631898, 2.4863350684596015, 3.8280296750385983, 4.983607673472723, 2.974370966227983, 3.1706606755375653, 6.791194918754086, 2.634456766669619, 2.939666374484257, 3.1602744390440938, 1.2152270357375525, 4.992962206598409, 4.4701863733748075, 5.493460674053593, 6.997624900318605, 6.432709592214192, 4.276998806445916, 7.978969988420252, 4.0043635010977745, 1.950742208978725, 4.11838818761113, 0.7225228753380355, 4.21479537322977, 4.091938049846432, 1.2083487582128676, 3.506062895793158], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16414436391821266, "mean_inference_ms": 0.89926962820262, "mean_action_processing_ms": 0.038262390067155136, "mean_env_wait_ms": 0.8468448186815156, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 230400, "timers": {"sample_time_ms": 4017.718, "sample_throughput": 2389.416, "learn_time_ms": 2927.746, "learn_throughput": 3278.972, "update_time_ms": 1.504}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.02352095702908149, "policy_loss": -0.02692192665877213, "vf_loss": 0.009421324087797027, "vf_explained_var": 0.9416505694389343, "kl": 0.018231805139466335, "entropy": -3.421022804159867, "entropy_coeff": 0.0}}, "num_steps_sampled": 230400, "num_steps_trained": 230400}, "done": false, "episodes_total": 216, "training_iteration": 19, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-01-45", "timestamp": 1617649305, "time_this_iter_s": 5.891554594039917, "time_total_s": 134.80005741119385, "pid": 20439, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.804311752319336, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 51.85, "ram_util_percent": 61.8625}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 7.978969988420252, "episode_reward_min": 0.027507613383611407, "episode_reward_mean": 2.623430135909386, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.22729027201475271, 0.8869599645505839, 1.8995785806778978, 1.4598084872455792, 3.6412643387617347, 0.39279769315338764, 0.9016350720709583, 0.761381981409617, 1.007890851964504, 0.027507613383611407, 1.2605209375475384, 1.2065805470571522, 0.7805421882777084, 1.2649895934930555, 1.2395426956673243, 0.6237794231408795, 3.8280296750385983, 4.983607673472723, 2.974370966227983, 3.1706606755375653, 6.791194918754086, 2.634456766669619, 2.939666374484257, 3.1602744390440938, 1.2152270357375525, 4.992962206598409, 4.4701863733748075, 5.493460674053593, 6.997624900318605, 6.432709592214192, 4.276998806445916, 7.978969988420252, 4.0043635010977745, 1.950742208978725, 4.11838818761113, 0.7225228753380355, 4.21479537322977, 4.091938049846432, 1.2083487582128676, 3.506062895793158, 1.9515947688310624, 1.2745437568042317, 1.6227078448185788, 2.104019083948618, 0.4684915831884646, 1.5655269751203424, 0.7117942855631898, 2.4863350684596015], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1703586916819391, "mean_inference_ms": 0.9247643106677872, "mean_action_processing_ms": 0.038988658465699266, "mean_env_wait_ms": 0.8567524550090294, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 240000, "timers": {"sample_time_ms": 3750.61, "sample_throughput": 2559.584, "learn_time_ms": 2960.281, "learn_throughput": 3242.935, "update_time_ms": 1.514}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.037417706518700515, "policy_loss": -0.01962008406101775, "vf_loss": 0.011362788311548922, "vf_explained_var": 0.9341715574264526, "kl": 0.02030000159222829, "entropy": -3.393730374386436, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 232, "training_iteration": 20, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-01-51", "timestamp": 1617649311, "time_this_iter_s": 5.779523849487305, "time_total_s": 140.57958126068115, "pid": 20439, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.58383560180664, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.166666666666664, "ram_util_percent": 61.94444444444444}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 7.978969988420252, "episode_reward_min": 0.027507613383611407, "episode_reward_mean": 2.48086122345564, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.224179427328326, 2.2879997709665334, 2.691705116030247, 0.7591867031403157, 1.6877173383584458, 1.0733728457088163, 0.9469938003454419, 2.3324269879872044, 3.8280296750385983, 4.983607673472723, 2.974370966227983, 3.1706606755375653, 6.791194918754086, 2.634456766669619, 2.939666374484257, 3.1602744390440938, 1.2152270357375525, 4.992962206598409, 4.4701863733748075, 5.493460674053593, 6.997624900318605, 6.432709592214192, 4.276998806445916, 7.978969988420252, 4.0043635010977745, 1.950742208978725, 4.11838818761113, 0.7225228753380355, 4.21479537322977, 4.091938049846432, 1.2083487582128676, 3.506062895793158, 1.9515947688310624, 1.2745437568042317, 1.6227078448185788, 2.104019083948618, 0.4684915831884646, 1.5655269751203424, 0.7117942855631898, 2.4863350684596015, 0.22729027201475271, 0.8869599645505839, 1.8995785806778978, 1.4598084872455792, 3.6412643387617347, 0.39279769315338764, 0.9016350720709583, 0.761381981409617, 1.007890851964504, 0.027507613383611407, 1.2605209375475384, 1.2065805470571522, 0.7805421882777084, 1.2649895934930555, 1.2395426956673243, 0.6237794231408795], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17157831829681144, "mean_inference_ms": 0.9298628789835115, "mean_action_processing_ms": 0.03912669989701213, "mean_env_wait_ms": 0.8576892081030838, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 249600, "timers": {"sample_time_ms": 3567.038, "sample_throughput": 2691.309, "learn_time_ms": 2914.081, "learn_throughput": 3294.349, "update_time_ms": 1.5}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.045428574537417214, "policy_loss": -0.01466150398758289, "vf_loss": 0.008266543028386015, "vf_explained_var": 0.9158350229263306, "kl": 0.015355121305114345, "entropy": -3.3936312600185996, "entropy_coeff": 0.0}}, "num_steps_sampled": 249600, "num_steps_trained": 249600}, "done": false, "episodes_total": 240, "training_iteration": 21, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-01-57", "timestamp": 1617649317, "time_this_iter_s": 5.338330268859863, "time_total_s": 145.91791152954102, "pid": 20439, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 38.922165870666504, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.55714285714286, "ram_util_percent": 61.98571428571428}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 7.978969988420252, "episode_reward_min": 0.027507613383611407, "episode_reward_mean": 2.3407632815744144, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.043510716159887, 1.2455696202490145, 1.3424260803910606, 0.895151870087683, 1.214480066591086, 2.172588549596614, 0.3830020779416574, 1.5838925262297003, 3.8280296750385983, 4.983607673472723, 2.974370966227983, 3.1706606755375653, 6.791194918754086, 2.634456766669619, 2.939666374484257, 3.1602744390440938, 1.2152270357375525, 4.992962206598409, 4.4701863733748075, 5.493460674053593, 6.997624900318605, 6.432709592214192, 4.276998806445916, 7.978969988420252, 4.0043635010977745, 1.950742208978725, 4.11838818761113, 0.7225228753380355, 4.21479537322977, 4.091938049846432, 1.2083487582128676, 3.506062895793158, 1.9515947688310624, 1.2745437568042317, 1.6227078448185788, 2.104019083948618, 0.4684915831884646, 1.5655269751203424, 0.7117942855631898, 2.4863350684596015, 0.22729027201475271, 0.8869599645505839, 1.8995785806778978, 1.4598084872455792, 3.6412643387617347, 0.39279769315338764, 0.9016350720709583, 0.761381981409617, 1.007890851964504, 0.027507613383611407, 1.2605209375475384, 1.2065805470571522, 0.7805421882777084, 1.2649895934930555, 1.2395426956673243, 0.6237794231408795, 1.224179427328326, 2.2879997709665334, 2.691705116030247, 0.7591867031403157, 1.6877173383584458, 1.0733728457088163, 0.9469938003454419, 2.3324269879872044], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17314232760444265, "mean_inference_ms": 0.936226901239058, "mean_action_processing_ms": 0.03936609843044321, "mean_env_wait_ms": 0.8612821782532996, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 259200, "timers": {"sample_time_ms": 3517.906, "sample_throughput": 2728.896, "learn_time_ms": 2884.427, "learn_throughput": 3328.218, "update_time_ms": 1.513}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.03702379718136064, "policy_loss": -0.0138875669995813, "vf_loss": 0.006941506180814222, "vf_explained_var": 0.9440543055534363, "kl": 0.013028106353196659, "entropy": -3.4093039211473966, "entropy_coeff": 0.0}}, "num_steps_sampled": 259200, "num_steps_trained": 259200}, "done": false, "episodes_total": 248, "training_iteration": 22, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-02-03", "timestamp": 1617649323, "time_this_iter_s": 5.936063289642334, "time_total_s": 151.85397481918335, "pid": 20439, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 44.85822916030884, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 49.06666666666667, "ram_util_percent": 61.92222222222222}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 7.978969988420252, "episode_reward_min": 0.027507613383611407, "episode_reward_mean": 2.273500215722634, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.4411687930955503, 1.2377447139801898, 2.162929648122919, 2.5194775733609998, 0.9442773435509193, 1.2291698326179632, 1.5209790097435567, 1.827418596794971, 3.8280296750385983, 4.983607673472723, 2.974370966227983, 3.1706606755375653, 6.791194918754086, 2.634456766669619, 2.939666374484257, 3.1602744390440938, 1.2152270357375525, 4.992962206598409, 4.4701863733748075, 5.493460674053593, 6.997624900318605, 6.432709592214192, 4.276998806445916, 7.978969988420252, 4.0043635010977745, 1.950742208978725, 4.11838818761113, 0.7225228753380355, 4.21479537322977, 4.091938049846432, 1.2083487582128676, 3.506062895793158, 1.9515947688310624, 1.2745437568042317, 1.6227078448185788, 2.104019083948618, 0.4684915831884646, 1.5655269751203424, 0.7117942855631898, 2.4863350684596015, 0.22729027201475271, 0.8869599645505839, 1.8995785806778978, 1.4598084872455792, 3.6412643387617347, 0.39279769315338764, 0.9016350720709583, 0.761381981409617, 1.007890851964504, 0.027507613383611407, 1.2605209375475384, 1.2065805470571522, 0.7805421882777084, 1.2649895934930555, 1.2395426956673243, 0.6237794231408795, 1.224179427328326, 2.2879997709665334, 2.691705116030247, 0.7591867031403157, 1.6877173383584458, 1.0733728457088163, 0.9469938003454419, 2.3324269879872044, 2.043510716159887, 1.2455696202490145, 1.3424260803910606, 0.895151870087683, 1.214480066591086, 2.172588549596614, 0.3830020779416574, 1.5838925262297003], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17414171844384668, "mean_inference_ms": 0.9400264699705622, "mean_action_processing_ms": 0.03951631001040588, "mean_env_wait_ms": 0.8630360554103115, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 268800, "timers": {"sample_time_ms": 3395.453, "sample_throughput": 2827.31, "learn_time_ms": 2915.552, "learn_throughput": 3292.686, "update_time_ms": 1.535}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.034793587974242035, "policy_loss": -0.02306117632695915, "vf_loss": 0.007531313495220323, "vf_explained_var": 0.9330785870552063, "kl": 0.014910652566897241, "entropy": -3.45953712212412, "entropy_coeff": 0.0}}, "num_steps_sampled": 268800, "num_steps_trained": 268800}, "done": false, "episodes_total": 256, "training_iteration": 23, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-02-08", "timestamp": 1617649328, "time_this_iter_s": 5.678100347518921, "time_total_s": 157.53207516670227, "pid": 20439, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.53632950782776, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 48.462500000000006, "ram_util_percent": 61.875}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 2.4511279442741567, "episode_reward_min": 0.66733369177463, "episode_reward_mean": 1.4217983976170498, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9972976644064333, 1.5952253975580795, 1.4961023025375857, 1.489968509093651, 1.0542293763102597, 1.6231022949816039, 2.4511279442741567, 0.66733369177463], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14842635983729935, "mean_inference_ms": 0.7983844395382615, "mean_action_processing_ms": 0.033931916798282724, "mean_env_wait_ms": 0.7844986417311415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 278400, "timers": {"sample_time_ms": 2562.69, "sample_throughput": 3746.063, "learn_time_ms": 2739.564, "learn_throughput": 3504.207, "update_time_ms": 1.366}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.033335321281399384, "policy_loss": -0.013552139297519859, "vf_loss": 0.009530640868960242, "vf_explained_var": 0.9035265445709229, "kl": 0.037356820741766376, "entropy": -3.429063892364502, "entropy_coeff": 0.0}}, "num_steps_sampled": 278400, "num_steps_trained": 278400}, "done": false, "episodes_total": 264, "training_iteration": 24, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-02-40", "timestamp": 1617649360, "time_this_iter_s": 5.30812668800354, "time_total_s": 162.8402018547058, "pid": 21660, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.30812668800354, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.4125, "ram_util_percent": 61.925}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 2.4511279442741567, "episode_reward_min": 0.22571476645287314, "episode_reward_mean": 1.3892905403363562, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4102485449832716, 2.2649862965447483, 0.8576635270819748, 1.9084500553395687, 1.8390449441148284, 0.7838445292363561, 1.5643088006916779, 0.22571476645287314, 0.9972976644064333, 1.5952253975580795, 1.4961023025375857, 1.489968509093651, 1.0542293763102597, 1.6231022949816039, 2.4511279442741567, 0.66733369177463], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16479887175516447, "mean_inference_ms": 0.8795838045186029, "mean_action_processing_ms": 0.03746355137124181, "mean_env_wait_ms": 0.8516687842027584, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 288000, "timers": {"sample_time_ms": 2898.065, "sample_throughput": 3312.555, "learn_time_ms": 2776.293, "learn_throughput": 3457.848, "update_time_ms": 1.417}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.025089981317471123, "policy_loss": -0.018076772260553153, "vf_loss": 0.0068537150362604545, "vf_explained_var": 0.9215313792228699, "kl": 0.024208692324004674, "entropy": -3.4408614861337763, "entropy_coeff": 0.0}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 272, "training_iteration": 25, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-02-46", "timestamp": 1617649366, "time_this_iter_s": 6.053201913833618, "time_total_s": 168.89340376853943, "pid": 21660, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.361328601837158, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 52.2, "ram_util_percent": 62.03333333333333}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 2.4511279442741567, "episode_reward_min": 0.1571315311141066, "episode_reward_mean": 1.1699817617972776, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5780268548826091, 0.4179736424442715, 0.1571315311141066, 1.5283780546020824, 0.8900945967825911, 0.3779664117890311, 0.6408555741471715, 1.2604869719911007, 0.9972976644064333, 1.5952253975580795, 1.4961023025375857, 1.489968509093651, 1.0542293763102597, 1.6231022949816039, 2.4511279442741567, 0.66733369177463, 1.4102485449832716, 2.2649862965447483, 0.8576635270819748, 1.9084500553395687, 1.8390449441148284, 0.7838445292363561, 1.5643088006916779, 0.22571476645287314], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1685680010627256, "mean_inference_ms": 0.8959049947029843, "mean_action_processing_ms": 0.03817914493644959, "mean_env_wait_ms": 0.858964693521472, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 297600, "timers": {"sample_time_ms": 2790.094, "sample_throughput": 3440.744, "learn_time_ms": 2780.477, "learn_throughput": 3452.644, "update_time_ms": 1.385}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.03520060756188621, "policy_loss": -0.01570683562588927, "vf_loss": 0.006637827167287469, "vf_explained_var": 0.9201810956001282, "kl": 0.01967538470696462, "entropy": -3.507482435828761, "entropy_coeff": 0.0}}, "num_steps_sampled": 297600, "num_steps_trained": 297600}, "done": false, "episodes_total": 280, "training_iteration": 26, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-02-51", "timestamp": 1617649371, "time_this_iter_s": 5.368776798248291, "time_total_s": 174.26218056678772, "pid": 21660, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.73010540008545, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 33.88571428571429, "ram_util_percent": 62.1}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 2.6912587151395617, "episode_reward_min": 0.1571315311141066, "episode_reward_mean": 1.2305486267881156, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4299704721806679, 1.0905163798435091, 2.6912587151395617, 0.6935427634835374, 1.2166348100661803, 0.8274592499910021, 2.306704786655008, 1.0419065967255676, 0.9972976644064333, 1.5952253975580795, 1.4961023025375857, 1.489968509093651, 1.0542293763102597, 1.6231022949816039, 2.4511279442741567, 0.66733369177463, 1.4102485449832716, 2.2649862965447483, 0.8576635270819748, 1.9084500553395687, 1.8390449441148284, 0.7838445292363561, 1.5643088006916779, 0.22571476645287314, 0.5780268548826091, 0.4179736424442715, 0.1571315311141066, 1.5283780546020824, 0.8900945967825911, 0.3779664117890311, 0.6408555741471715, 1.2604869719911007], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17384426737530217, "mean_inference_ms": 0.9184342762489275, "mean_action_processing_ms": 0.03916754291892134, "mean_env_wait_ms": 0.8760026030337159, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 307200, "timers": {"sample_time_ms": 2916.094, "sample_throughput": 3292.075, "learn_time_ms": 2827.289, "learn_throughput": 3395.478, "update_time_ms": 1.397}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.04853055167109951, "policy_loss": -0.00950154726957216, "vf_loss": 0.009564074388656177, "vf_explained_var": 0.9139748811721802, "kl": 0.021541343697983967, "entropy": -3.449137933630692, "entropy_coeff": 0.0}}, "num_steps_sampled": 307200, "num_steps_trained": 307200}, "done": false, "episodes_total": 288, "training_iteration": 27, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-02-57", "timestamp": 1617649377, "time_this_iter_s": 6.26753568649292, "time_total_s": 180.52971625328064, "pid": 21660, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.99764108657837, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 56.03333333333333, "ram_util_percent": 62.044444444444444}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 4.9461912174596465, "episode_reward_min": 0.1571315311141066, "episode_reward_mean": 1.3206651591904661, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1791139898527434, 4.9461912174596465, 0.9802136288128913, 1.8462936377492856, 0.3885982479252015, 0.8843140340244569, 1.5770703246962707, 1.6376205618922337, 1.9526877152509505, 0.8481786566192078, 1.2098356072910321, 0.723339167069565, 2.1891130852354372, 1.3306857502417477, 1.369044524966856, 0.9520714348351507, 0.9972976644064333, 1.5952253975580795, 1.4961023025375857, 1.489968509093651, 1.0542293763102597, 1.6231022949816039, 2.4511279442741567, 0.66733369177463, 1.4102485449832716, 2.2649862965447483, 0.8576635270819748, 1.9084500553395687, 1.8390449441148284, 0.7838445292363561, 1.5643088006916779, 0.22571476645287314, 0.5780268548826091, 0.4179736424442715, 0.1571315311141066, 1.5283780546020824, 0.8900945967825911, 0.3779664117890311, 0.6408555741471715, 1.2604869719911007, 1.4299704721806679, 1.0905163798435091, 2.6912587151395617, 0.6935427634835374, 1.2166348100661803, 0.8274592499910021, 2.306704786655008, 1.0419065967255676], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18067015445376944, "mean_inference_ms": 0.9409203257263418, "mean_action_processing_ms": 0.039708651025062464, "mean_env_wait_ms": 0.8814042836147337, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 316800, "timers": {"sample_time_ms": 2866.464, "sample_throughput": 3349.074, "learn_time_ms": 2875.358, "learn_throughput": 3338.715, "update_time_ms": 1.441}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.026100509133385984, "policy_loss": -0.016683687257433407, "vf_loss": 0.0069983548950403925, "vf_explained_var": 0.936522901058197, "kl": 0.010603212540675151, "entropy": -3.493093954889398, "entropy_coeff": 0.0}}, "num_steps_sampled": 316800, "num_steps_trained": 316800}, "done": false, "episodes_total": 304, "training_iteration": 28, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-03-03", "timestamp": 1617649383, "time_this_iter_s": 5.742340803146362, "time_total_s": 186.272057056427, "pid": 21660, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.73998188972473, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.111111111111114, "ram_util_percent": 62.111111111111114}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 4.9461912174596465, "episode_reward_min": 0.1571315311141066, "episode_reward_mean": 1.3567265008157163, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.52835108440303, 1.4269337622515375, 0.3166804982892275, 1.9045606628802632, 1.2263315114767623, 1.4295775484368471, 0.7240707012862697, 2.0282506355138117, 0.9972976644064333, 1.5952253975580795, 1.4961023025375857, 1.489968509093651, 1.0542293763102597, 1.6231022949816039, 2.4511279442741567, 0.66733369177463, 1.4102485449832716, 2.2649862965447483, 0.8576635270819748, 1.9084500553395687, 1.8390449441148284, 0.7838445292363561, 1.5643088006916779, 0.22571476645287314, 0.5780268548826091, 0.4179736424442715, 0.1571315311141066, 1.5283780546020824, 0.8900945967825911, 0.3779664117890311, 0.6408555741471715, 1.2604869719911007, 1.4299704721806679, 1.0905163798435091, 2.6912587151395617, 0.6935427634835374, 1.2166348100661803, 0.8274592499910021, 2.306704786655008, 1.0419065967255676, 1.1791139898527434, 4.9461912174596465, 0.9802136288128913, 1.8462936377492856, 0.3885982479252015, 0.8843140340244569, 1.5770703246962707, 1.6376205618922337, 1.9526877152509505, 0.8481786566192078, 1.2098356072910321, 0.723339167069565, 2.1891130852354372, 1.3306857502417477, 1.369044524966856, 0.9520714348351507], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1831187811518337, "mean_inference_ms": 0.9514392057499388, "mean_action_processing_ms": 0.04006964463298971, "mean_env_wait_ms": 0.8875909732230551, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 326400, "timers": {"sample_time_ms": 2936.788, "sample_throughput": 3268.877, "learn_time_ms": 2856.022, "learn_throughput": 3361.319, "update_time_ms": 1.433}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.026210062693835905, "policy_loss": -0.01719432854534764, "vf_loss": 0.0056865522490912365, "vf_explained_var": 0.9197924733161926, "kl": 0.01117565631866455, "entropy": -3.519140474419845, "entropy_coeff": 0.0}}, "num_steps_sampled": 326400, "num_steps_trained": 326400}, "done": false, "episodes_total": 312, "training_iteration": 29, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-03-09", "timestamp": 1617649389, "time_this_iter_s": 6.053814649581909, "time_total_s": 192.3258717060089, "pid": 21660, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.79379653930664, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 54.737500000000004, "ram_util_percent": 62.1375}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 4.9461912174596465, "episode_reward_min": -0.011206318582421049, "episode_reward_mean": 1.3876958566841915, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.3174498759517554, 0.8961678157798689, 2.5305174990906933, 1.4950612892073636, 1.829491461431898, 2.1512473721643524, 1.6271217870646222, -0.011206318582421049, 0.9972976644064333, 1.5952253975580795, 1.4961023025375857, 1.489968509093651, 1.0542293763102597, 1.6231022949816039, 2.4511279442741567, 0.66733369177463, 1.4102485449832716, 2.2649862965447483, 0.8576635270819748, 1.9084500553395687, 1.8390449441148284, 0.7838445292363561, 1.5643088006916779, 0.22571476645287314, 0.5780268548826091, 0.4179736424442715, 0.1571315311141066, 1.5283780546020824, 0.8900945967825911, 0.3779664117890311, 0.6408555741471715, 1.2604869719911007, 1.4299704721806679, 1.0905163798435091, 2.6912587151395617, 0.6935427634835374, 1.2166348100661803, 0.8274592499910021, 2.306704786655008, 1.0419065967255676, 1.1791139898527434, 4.9461912174596465, 0.9802136288128913, 1.8462936377492856, 0.3885982479252015, 0.8843140340244569, 1.5770703246962707, 1.6376205618922337, 1.9526877152509505, 0.8481786566192078, 1.2098356072910321, 0.723339167069565, 2.1891130852354372, 1.3306857502417477, 1.369044524966856, 0.9520714348351507, 3.52835108440303, 1.4269337622515375, 0.3166804982892275, 1.9045606628802632, 1.2263315114767623, 1.4295775484368471, 0.7240707012862697, 2.0282506355138117], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1840891797453642, "mean_inference_ms": 0.9555622999794269, "mean_action_processing_ms": 0.040198586189381116, "mean_env_wait_ms": 0.8885680388543064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 336000, "timers": {"sample_time_ms": 2835.267, "sample_throughput": 3385.925, "learn_time_ms": 2876.592, "learn_throughput": 3337.283, "update_time_ms": 1.457}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.03496923987036816, "policy_loss": -0.011850895067848461, "vf_loss": 0.006239440635238823, "vf_explained_var": 0.9098587036132812, "kl": 0.012023908806670654, "entropy": -3.5162991322969135, "entropy_coeff": 0.0}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 320, "training_iteration": 30, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-03-14", "timestamp": 1617649394, "time_this_iter_s": 5.232345342636108, "time_total_s": 197.55821704864502, "pid": 21660, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.02614188194275, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 34.7625, "ram_util_percent": 61.3125}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 4.9461912174596465, "episode_reward_min": -0.011206318582421049, "episode_reward_mean": 1.4583549069366188, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.625579075444743, 4.1798795523431975, 2.3302206238445535, 0.4368300405185166, 2.085978605770153, 2.0771314512863146, 1.5681407040749176, 1.885258418365904, 0.9972976644064333, 1.5952253975580795, 1.4961023025375857, 1.489968509093651, 1.0542293763102597, 1.6231022949816039, 2.4511279442741567, 0.66733369177463, 1.4102485449832716, 2.2649862965447483, 0.8576635270819748, 1.9084500553395687, 1.8390449441148284, 0.7838445292363561, 1.5643088006916779, 0.22571476645287314, 0.5780268548826091, 0.4179736424442715, 0.1571315311141066, 1.5283780546020824, 0.8900945967825911, 0.3779664117890311, 0.6408555741471715, 1.2604869719911007, 1.4299704721806679, 1.0905163798435091, 2.6912587151395617, 0.6935427634835374, 1.2166348100661803, 0.8274592499910021, 2.306704786655008, 1.0419065967255676, 1.1791139898527434, 4.9461912174596465, 0.9802136288128913, 1.8462936377492856, 0.3885982479252015, 0.8843140340244569, 1.5770703246962707, 1.6376205618922337, 1.9526877152509505, 0.8481786566192078, 1.2098356072910321, 0.723339167069565, 2.1891130852354372, 1.3306857502417477, 1.369044524966856, 0.9520714348351507, 3.52835108440303, 1.4269337622515375, 0.3166804982892275, 1.9045606628802632, 1.2263315114767623, 1.4295775484368471, 0.7240707012862697, 2.0282506355138117, 2.3174498759517554, 0.8961678157798689, 2.5305174990906933, 1.4950612892073636, 1.829491461431898, 2.1512473721643524, 1.6271217870646222, -0.011206318582421049], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18460150435827904, "mean_inference_ms": 0.9587162504765772, "mean_action_processing_ms": 0.04031250583559465, "mean_env_wait_ms": 0.889374334848378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 345600, "timers": {"sample_time_ms": 2835.683, "sample_throughput": 3385.427, "learn_time_ms": 2932.752, "learn_throughput": 3273.376, "update_time_ms": 1.457}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.023471619680180755, "policy_loss": -0.018832464368039693, "vf_loss": 0.006837652640809354, "vf_explained_var": 0.8861549496650696, "kl": 0.010508572849396028, "entropy": -3.5927392357274104, "entropy_coeff": 0.0}}, "num_steps_sampled": 345600, "num_steps_trained": 345600}, "done": false, "episodes_total": 328, "training_iteration": 31, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-03-21", "timestamp": 1617649401, "time_this_iter_s": 6.171831130981445, "time_total_s": 203.73004817962646, "pid": 21660, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.197973012924194, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 53.077777777777776, "ram_util_percent": 57.94444444444444}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 5.9624905182557955, "episode_reward_min": -0.011206318582421049, "episode_reward_mean": 1.5346304665124708, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.787142307210254, 1.5074197537001721, 1.6287016411337745, 1.0838541308354595, 5.9624905182557955, 1.481240221262492, 1.2930279488854985, 1.025007500277678, 0.9972976644064333, 1.5952253975580795, 1.4961023025375857, 1.489968509093651, 1.0542293763102597, 1.6231022949816039, 2.4511279442741567, 0.66733369177463, 1.4102485449832716, 2.2649862965447483, 0.8576635270819748, 1.9084500553395687, 1.8390449441148284, 0.7838445292363561, 1.5643088006916779, 0.22571476645287314, 0.5780268548826091, 0.4179736424442715, 0.1571315311141066, 1.5283780546020824, 0.8900945967825911, 0.3779664117890311, 0.6408555741471715, 1.2604869719911007, 1.4299704721806679, 1.0905163798435091, 2.6912587151395617, 0.6935427634835374, 1.2166348100661803, 0.8274592499910021, 2.306704786655008, 1.0419065967255676, 1.1791139898527434, 4.9461912174596465, 0.9802136288128913, 1.8462936377492856, 0.3885982479252015, 0.8843140340244569, 1.5770703246962707, 1.6376205618922337, 1.9526877152509505, 0.8481786566192078, 1.2098356072910321, 0.723339167069565, 2.1891130852354372, 1.3306857502417477, 1.369044524966856, 0.9520714348351507, 3.52835108440303, 1.4269337622515375, 0.3166804982892275, 1.9045606628802632, 1.2263315114767623, 1.4295775484368471, 0.7240707012862697, 2.0282506355138117, 2.3174498759517554, 0.8961678157798689, 2.5305174990906933, 1.4950612892073636, 1.829491461431898, 2.1512473721643524, 1.6271217870646222, -0.011206318582421049, 1.625579075444743, 4.1798795523431975, 2.3302206238445535, 0.4368300405185166, 2.085978605770153, 2.0771314512863146, 1.5681407040749176, 1.885258418365904], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18535274352349967, "mean_inference_ms": 0.9631670531065927, "mean_action_processing_ms": 0.04049475151797103, "mean_env_wait_ms": 0.8920325479372693, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 355200, "timers": {"sample_time_ms": 2887.412, "sample_throughput": 3324.776, "learn_time_ms": 2897.556, "learn_throughput": 3313.137, "update_time_ms": 1.49}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.375, "cur_lr": 0.01, "total_loss": 0.024178082290056503, "policy_loss": -0.012915214727093515, "vf_loss": 0.00686748366508829, "vf_explained_var": 0.9086223244667053, "kl": 0.008955795401217121, "entropy": -3.51114239692688, "entropy_coeff": 0.0}}, "num_steps_sampled": 355200, "num_steps_trained": 355200}, "done": false, "episodes_total": 336, "training_iteration": 32, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-03-27", "timestamp": 1617649407, "time_this_iter_s": 5.924384593963623, "time_total_s": 209.6544327735901, "pid": 21660, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.12235760688782, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 51.2125, "ram_util_percent": 61.85}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 2.594746087280816, "episode_reward_min": 1.313504099989855, "episode_reward_mean": 1.9149071040421926, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.048709013826526, 2.291944476750003, 1.9823062543147416, 1.36161851116305, 1.995114530437247, 1.731313858575302, 2.594746087280816, 1.313504099989855], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1929504835635399, "mean_inference_ms": 1.0865315807352056, "mean_action_processing_ms": 0.046672645357625865, "mean_env_wait_ms": 1.0929549117568726, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 364800, "timers": {"sample_time_ms": 3448.55, "sample_throughput": 2783.778, "learn_time_ms": 2576.178, "learn_throughput": 3726.45, "update_time_ms": 1.519}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.014403005336460314, "policy_loss": -0.0175007172400671, "vf_loss": 0.007019755334936474, "vf_explained_var": 0.8742361664772034, "kl": 0.02488396691256448, "entropy": -3.53327239940041, "entropy_coeff": 0.0}}, "num_steps_sampled": 364800, "num_steps_trained": 364800}, "done": false, "episodes_total": 344, "training_iteration": 33, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-04-42", "timestamp": 1617649482, "time_this_iter_s": 6.029203176498413, "time_total_s": 215.6836359500885, "pid": 22576, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.029203176498413, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.04444444444445, "ram_util_percent": 62.01111111111111}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 4.377699167883544, "episode_reward_min": 1.3084699611153265, "episode_reward_mean": 2.0606576465139406, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.921431788694378, 2.2707136177054443, 2.567706632865415, 1.3084699611153265, 1.59297641021606, 2.2486879689781145, 4.377699167883544, 1.3635799644272266, 2.048709013826526, 2.291944476750003, 1.9823062543147416, 1.36161851116305, 1.995114530437247, 1.731313858575302, 2.594746087280816, 1.313504099989855], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.182000825724617, "mean_inference_ms": 1.0135806029483805, "mean_action_processing_ms": 0.04336842968963801, "mean_env_wait_ms": 0.9958594138719497, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 374400, "timers": {"sample_time_ms": 2832.095, "sample_throughput": 3389.717, "learn_time_ms": 2815.06, "learn_throughput": 3410.229, "update_time_ms": 1.411}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.013210300613795162, "policy_loss": -0.02173722898465042, "vf_loss": 0.006154092754188337, "vf_explained_var": 0.8979621529579163, "kl": 0.019195624107592985, "entropy": -3.5471183023954693, "entropy_coeff": 0.0}}, "num_steps_sampled": 374400, "num_steps_trained": 374400}, "done": false, "episodes_total": 352, "training_iteration": 34, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-04-47", "timestamp": 1617649487, "time_this_iter_s": 5.275582313537598, "time_total_s": 220.9592182636261, "pid": 22576, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.30478549003601, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 38.3, "ram_util_percent": 62.25}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 4.377699167883544, "episode_reward_min": 0.5714755521533723, "episode_reward_mean": 1.98559426598418, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.017137571043468, 2.12494178032157, 0.5714755521533723, 3.3769165065594917, 2.202437683279065, 2.223246304085292, 2.194544563834196, 0.9730400781208108, 2.048709013826526, 2.291944476750003, 1.9823062543147416, 1.36161851116305, 1.995114530437247, 1.731313858575302, 2.594746087280816, 1.313504099989855, 1.921431788694378, 2.2707136177054443, 2.567706632865415, 1.3084699611153265, 1.59297641021606, 2.2486879689781145, 4.377699167883544, 1.3635799644272266], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.182957268335729, "mean_inference_ms": 1.011567250335589, "mean_action_processing_ms": 0.04317918206539523, "mean_env_wait_ms": 0.9816079211246005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 384000, "timers": {"sample_time_ms": 2977.46, "sample_throughput": 3224.225, "learn_time_ms": 2784.877, "learn_throughput": 3447.19, "update_time_ms": 1.475}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.015931959590249647, "policy_loss": -0.02024397697655092, "vf_loss": 0.0066923612630680985, "vf_explained_var": 0.8712323904037476, "kl": 0.01965571888967564, "entropy": -3.657979089335391, "entropy_coeff": 0.0}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 360, "training_iteration": 35, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-04-53", "timestamp": 1617649493, "time_this_iter_s": 5.9993321895599365, "time_total_s": 226.95855045318604, "pid": 22576, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.304117679595947, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.900000000000006, "ram_util_percent": 62.324999999999996}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 7.510512227218346, "episode_reward_min": 0.5714755521533723, "episode_reward_mean": 2.3492357190786937, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.517168410576299, 1.344445650790266, 1.3590064675792632, 4.621443896947791, 5.936007318952188, 3.2662032608677043, 7.510512227218346, 0.9664933939660145, 2.048709013826526, 2.291944476750003, 1.9823062543147416, 1.36161851116305, 1.995114530437247, 1.731313858575302, 2.594746087280816, 1.313504099989855, 1.921431788694378, 2.2707136177054443, 2.567706632865415, 1.3084699611153265, 1.59297641021606, 2.2486879689781145, 4.377699167883544, 1.3635799644272266, 1.017137571043468, 2.12494178032157, 0.5714755521533723, 3.3769165065594917, 2.202437683279065, 2.223246304085292, 2.194544563834196, 0.9730400781208108], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18111778085151056, "mean_inference_ms": 0.9973930394884839, "mean_action_processing_ms": 0.042506544224251805, "mean_env_wait_ms": 0.959094547440228, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 393600, "timers": {"sample_time_ms": 2780.374, "sample_throughput": 3452.773, "learn_time_ms": 2850.811, "learn_throughput": 3367.462, "update_time_ms": 1.45}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.02218686619307846, "policy_loss": -0.013927833383020602, "vf_loss": 0.008033358540974166, "vf_explained_var": 0.8988277316093445, "kl": 0.018720894424538864, "entropy": -3.57758385507684, "entropy_coeff": 0.0}}, "num_steps_sampled": 393600, "num_steps_trained": 393600}, "done": false, "episodes_total": 368, "training_iteration": 36, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-04-59", "timestamp": 1617649499, "time_this_iter_s": 5.244882822036743, "time_total_s": 232.20343327522278, "pid": 22576, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.54900050163269, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.1625, "ram_util_percent": 62.225}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 7.581731880009107, "episode_reward_min": 0.5714755521533723, "episode_reward_mean": 2.587834656802652, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.342036292515306, 7.581731880009107, 2.23584659926554, 3.0995177053099203, 5.652322721785142, 3.488060650868392, 2.069524420639224, 2.029229916065948, 1.5883627235255569, 3.0166121824617225, 2.4652501961314037, 3.469402904599767, 2.9827763406614642, 2.802580523472286, 3.514419253048737, 1.7028462056495774, 2.048709013826526, 2.291944476750003, 1.9823062543147416, 1.36161851116305, 1.995114530437247, 1.731313858575302, 2.594746087280816, 1.313504099989855, 1.921431788694378, 2.2707136177054443, 2.567706632865415, 1.3084699611153265, 1.59297641021606, 2.2486879689781145, 4.377699167883544, 1.3635799644272266, 1.017137571043468, 2.12494178032157, 0.5714755521533723, 3.3769165065594917, 2.202437683279065, 2.223246304085292, 2.194544563834196, 0.9730400781208108, 2.517168410576299, 1.344445650790266, 1.3590064675792632, 4.621443896947791, 5.936007318952188, 3.2662032608677043, 7.510512227218346, 0.9664933939660145], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1876576865814578, "mean_inference_ms": 1.005461283717715, "mean_action_processing_ms": 0.04234474959731846, "mean_env_wait_ms": 0.9480353621395374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 403200, "timers": {"sample_time_ms": 2945.01, "sample_throughput": 3259.751, "learn_time_ms": 2804.979, "learn_throughput": 3422.486, "update_time_ms": 1.485}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.015890571433364562, "policy_loss": -0.017796160094439982, "vf_loss": 0.0090677281204415, "vf_explained_var": 0.8981804847717285, "kl": 0.016412671518168952, "entropy": -3.564878340771324, "entropy_coeff": 0.0}}, "num_steps_sampled": 403200, "num_steps_trained": 403200}, "done": false, "episodes_total": 384, "training_iteration": 37, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-05-05", "timestamp": 1617649505, "time_this_iter_s": 6.231605529785156, "time_total_s": 238.43503880500793, "pid": 22576, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.780606031417847, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.111111111111114, "ram_util_percent": 62.17777777777778}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 8.376827176443815, "episode_reward_min": 0.5714755521533723, "episode_reward_mean": 2.8502182638688365, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.376827176443815, 5.231908124502213, 5.627682406558196, 1.782330670216929, 3.7983970413411434, 2.350845073618364, 4.0963847011912815, 4.131784056255631, 2.048709013826526, 2.291944476750003, 1.9823062543147416, 1.36161851116305, 1.995114530437247, 1.731313858575302, 2.594746087280816, 1.313504099989855, 1.921431788694378, 2.2707136177054443, 2.567706632865415, 1.3084699611153265, 1.59297641021606, 2.2486879689781145, 4.377699167883544, 1.3635799644272266, 1.017137571043468, 2.12494178032157, 0.5714755521533723, 3.3769165065594917, 2.202437683279065, 2.223246304085292, 2.194544563834196, 0.9730400781208108, 2.517168410576299, 1.344445650790266, 1.3590064675792632, 4.621443896947791, 5.936007318952188, 3.2662032608677043, 7.510512227218346, 0.9664933939660145, 1.342036292515306, 7.581731880009107, 2.23584659926554, 3.0995177053099203, 5.652322721785142, 3.488060650868392, 2.069524420639224, 2.029229916065948, 1.5883627235255569, 3.0166121824617225, 2.4652501961314037, 3.469402904599767, 2.9827763406614642, 2.802580523472286, 3.514419253048737, 1.7028462056495774], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18840029116894005, "mean_inference_ms": 1.003310978757456, "mean_action_processing_ms": 0.042133221629616475, "mean_env_wait_ms": 0.940613089785168, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 412800, "timers": {"sample_time_ms": 2850.951, "sample_throughput": 3367.298, "learn_time_ms": 2834.959, "learn_throughput": 3386.292, "update_time_ms": 1.458}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.02617008074172956, "policy_loss": -0.009502000467067487, "vf_loss": 0.010273276051310332, "vf_explained_var": 0.8814341425895691, "kl": 0.01693253737727278, "entropy": -3.5923608528940303, "entropy_coeff": 0.0}}, "num_steps_sampled": 412800, "num_steps_trained": 412800}, "done": false, "episodes_total": 392, "training_iteration": 38, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-05-10", "timestamp": 1617649510, "time_this_iter_s": 5.371286153793335, "time_total_s": 243.80632495880127, "pid": 22576, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.15189218521118, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.31428571428571, "ram_util_percent": 62.199999999999996}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 8.376827176443815, "episode_reward_min": 0.5092297700053026, "episode_reward_mean": 2.7415904955345773, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5092297700053026, 4.347483970289148, 2.189365435426444, 1.3457176678824356, 2.1564070549838408, 3.041789584787044, 1.0209942057096937, 1.2385812484741807, 2.048709013826526, 2.291944476750003, 1.9823062543147416, 1.36161851116305, 1.995114530437247, 1.731313858575302, 2.594746087280816, 1.313504099989855, 1.921431788694378, 2.2707136177054443, 2.567706632865415, 1.3084699611153265, 1.59297641021606, 2.2486879689781145, 4.377699167883544, 1.3635799644272266, 1.017137571043468, 2.12494178032157, 0.5714755521533723, 3.3769165065594917, 2.202437683279065, 2.223246304085292, 2.194544563834196, 0.9730400781208108, 2.517168410576299, 1.344445650790266, 1.3590064675792632, 4.621443896947791, 5.936007318952188, 3.2662032608677043, 7.510512227218346, 0.9664933939660145, 1.342036292515306, 7.581731880009107, 2.23584659926554, 3.0995177053099203, 5.652322721785142, 3.488060650868392, 2.069524420639224, 2.029229916065948, 1.5883627235255569, 3.0166121824617225, 2.4652501961314037, 3.469402904599767, 2.9827763406614642, 2.802580523472286, 3.514419253048737, 1.7028462056495774, 8.376827176443815, 5.231908124502213, 5.627682406558196, 1.782330670216929, 3.7983970413411434, 2.350845073618364, 4.0963847011912815, 4.131784056255631], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1893708529482912, "mean_inference_ms": 1.0049708890824218, "mean_action_processing_ms": 0.04213493113688369, "mean_env_wait_ms": 0.9385283437250498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 422400, "timers": {"sample_time_ms": 2916.043, "sample_throughput": 3292.133, "learn_time_ms": 2832.087, "learn_throughput": 3389.726, "update_time_ms": 1.495}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.028477973392306778, "policy_loss": -0.008546693380738265, "vf_loss": 0.007215420382195397, "vf_explained_var": 0.9221055507659912, "kl": 0.019872830474847242, "entropy": -3.562858102196141, "entropy_coeff": 0.0}}, "num_steps_sampled": 422400, "num_steps_trained": 422400}, "done": false, "episodes_total": 400, "training_iteration": 39, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-05-16", "timestamp": 1617649516, "time_this_iter_s": 6.127676963806152, "time_total_s": 249.93400192260742, "pid": 22576, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.279569149017334, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 55.03333333333333, "ram_util_percent": 62.14444444444445}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 8.376827176443815, "episode_reward_min": 0.5092297700053026, "episode_reward_mean": 2.7397375435816014, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2508457192105369, 3.307437239459408, 1.3285735575403148, 2.683138629748982, 2.8531944491973418, 4.331099730528299, 0.6728710134521216, 5.372151084525357, 2.048709013826526, 2.291944476750003, 1.9823062543147416, 1.36161851116305, 1.995114530437247, 1.731313858575302, 2.594746087280816, 1.313504099989855, 1.921431788694378, 2.2707136177054443, 2.567706632865415, 1.3084699611153265, 1.59297641021606, 2.2486879689781145, 4.377699167883544, 1.3635799644272266, 1.017137571043468, 2.12494178032157, 0.5714755521533723, 3.3769165065594917, 2.202437683279065, 2.223246304085292, 2.194544563834196, 0.9730400781208108, 2.517168410576299, 1.344445650790266, 1.3590064675792632, 4.621443896947791, 5.936007318952188, 3.2662032608677043, 7.510512227218346, 0.9664933939660145, 1.342036292515306, 7.581731880009107, 2.23584659926554, 3.0995177053099203, 5.652322721785142, 3.488060650868392, 2.069524420639224, 2.029229916065948, 1.5883627235255569, 3.0166121824617225, 2.4652501961314037, 3.469402904599767, 2.9827763406614642, 2.802580523472286, 3.514419253048737, 1.7028462056495774, 8.376827176443815, 5.231908124502213, 5.627682406558196, 1.782330670216929, 3.7983970413411434, 2.350845073618364, 4.0963847011912815, 4.131784056255631, 0.5092297700053026, 4.347483970289148, 2.189365435426444, 1.3457176678824356, 2.1564070549838408, 3.041789584787044, 1.0209942057096937, 1.2385812484741807], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1895226507359069, "mean_inference_ms": 1.0035407408270223, "mean_action_processing_ms": 0.042031864760718914, "mean_env_wait_ms": 0.9342414162860317, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 432000, "timers": {"sample_time_ms": 2854.001, "sample_throughput": 3363.699, "learn_time_ms": 2882.355, "learn_throughput": 3330.61, "update_time_ms": 1.493}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.01841596142928067, "policy_loss": -0.014234625264438555, "vf_loss": 0.008406846695824673, "vf_explained_var": 0.9004692435264587, "kl": 0.01616249376123673, "entropy": -3.6259153265702095, "entropy_coeff": 0.0}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 408, "training_iteration": 40, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-05-22", "timestamp": 1617649522, "time_this_iter_s": 5.660415887832642, "time_total_s": 255.59441781044006, "pid": 22576, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.939985036849976, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.0625, "ram_util_percent": 62.1375}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 8.376827176443815, "episode_reward_min": 0.5092297700053026, "episode_reward_mean": 2.7220893450443446, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.206092693693419, 2.002518312995952, 3.227844824319911, 1.314253689329647, 2.952204029651324, 2.715223798344974, 3.714101075543497, 1.373806041793555, 2.048709013826526, 2.291944476750003, 1.9823062543147416, 1.36161851116305, 1.995114530437247, 1.731313858575302, 2.594746087280816, 1.313504099989855, 1.921431788694378, 2.2707136177054443, 2.567706632865415, 1.3084699611153265, 1.59297641021606, 2.2486879689781145, 4.377699167883544, 1.3635799644272266, 1.017137571043468, 2.12494178032157, 0.5714755521533723, 3.3769165065594917, 2.202437683279065, 2.223246304085292, 2.194544563834196, 0.9730400781208108, 2.517168410576299, 1.344445650790266, 1.3590064675792632, 4.621443896947791, 5.936007318952188, 3.2662032608677043, 7.510512227218346, 0.9664933939660145, 1.342036292515306, 7.581731880009107, 2.23584659926554, 3.0995177053099203, 5.652322721785142, 3.488060650868392, 2.069524420639224, 2.029229916065948, 1.5883627235255569, 3.0166121824617225, 2.4652501961314037, 3.469402904599767, 2.9827763406614642, 2.802580523472286, 3.514419253048737, 1.7028462056495774, 8.376827176443815, 5.231908124502213, 5.627682406558196, 1.782330670216929, 3.7983970413411434, 2.350845073618364, 4.0963847011912815, 4.131784056255631, 0.5092297700053026, 4.347483970289148, 2.189365435426444, 1.3457176678824356, 2.1564070549838408, 3.041789584787044, 1.0209942057096937, 1.2385812484741807, 1.2508457192105369, 3.307437239459408, 1.3285735575403148, 2.683138629748982, 2.8531944491973418, 4.331099730528299, 0.6728710134521216, 5.372151084525357], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18956402709607087, "mean_inference_ms": 1.0032831248863274, "mean_action_processing_ms": 0.04198867688480394, "mean_env_wait_ms": 0.9316104416206137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 441600, "timers": {"sample_time_ms": 2869.915, "sample_throughput": 3345.047, "learn_time_ms": 2926.511, "learn_throughput": 3280.357, "update_time_ms": 1.48}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.014117721882403681, "policy_loss": -0.02256586076140306, "vf_loss": 0.009181265062407443, "vf_explained_var": 0.9219900965690613, "kl": 0.018334880074192036, "entropy": -3.589371550710578, "entropy_coeff": 0.0}}, "num_steps_sampled": 441600, "num_steps_trained": 441600}, "done": false, "episodes_total": 416, "training_iteration": 41, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-05-28", "timestamp": 1617649528, "time_this_iter_s": 6.283766508102417, "time_total_s": 261.8781843185425, "pid": 22576, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.22375154495239, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 57.333333333333336, "ram_util_percent": 57.62222222222223}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 9.60449696577414, "episode_reward_min": 0.5036386461279485, "episode_reward_mean": 3.336702267738687, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5730145687538395, 0.5036386461279485, 2.8180986894408595, 4.212263853462142, 9.60449696577414, 5.564011649326319, 1.543276323628345, 1.8748174453959012], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16096115211563045, "mean_inference_ms": 0.8437337228201707, "mean_action_processing_ms": 0.036578492062177184, "mean_env_wait_ms": 0.8235181698096383, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 451200, "timers": {"sample_time_ms": 2521.236, "sample_throughput": 3807.657, "learn_time_ms": 2904.879, "learn_throughput": 3304.785, "update_time_ms": 1.585}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.02273205208690151, "policy_loss": -0.015902611311685178, "vf_loss": 0.011521052726005253, "vf_explained_var": 0.8740784525871277, "kl": 0.027113611300132776, "entropy": -3.6029826063858836, "entropy_coeff": 0.0}}, "num_steps_sampled": 451200, "num_steps_trained": 451200}, "done": false, "episodes_total": 424, "training_iteration": 42, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-06-46", "timestamp": 1617649606, "time_this_iter_s": 5.433040380477905, "time_total_s": 267.3112246990204, "pid": 23461, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.433040380477905, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.5125, "ram_util_percent": 61.95}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 9.60449696577414, "episode_reward_min": 0.5036386461279485, "episode_reward_mean": 3.638822922973325, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0079798376397444, 3.802167205242611, 4.423540395091698, 1.590849063600075, 3.657322779717412, 6.720231641254091, 5.688946670818351, 4.636511032299727, 0.5730145687538395, 0.5036386461279485, 2.8180986894408595, 4.212263853462142, 9.60449696577414, 5.564011649326319, 1.543276323628345, 1.8748174453959012], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17485166554229734, "mean_inference_ms": 0.9149763855359914, "mean_action_processing_ms": 0.039652583435466, "mean_env_wait_ms": 0.8811937918342433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 460800, "timers": {"sample_time_ms": 2877.984, "sample_throughput": 3335.669, "learn_time_ms": 2910.051, "learn_throughput": 3298.912, "update_time_ms": 1.523}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.03541363471273431, "policy_loss": -0.004549244151597745, "vf_loss": 0.010589858914088262, "vf_explained_var": 0.8939846754074097, "kl": 0.019582012903533483, "entropy": -3.6012212928972747, "entropy_coeff": 0.0}}, "num_steps_sampled": 460800, "num_steps_trained": 460800}, "done": false, "episodes_total": 432, "training_iteration": 43, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-06-52", "timestamp": 1617649612, "time_this_iter_s": 6.1555564403533936, "time_total_s": 273.4667811393738, "pid": 23461, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.588596820831299, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 53.93333333333333, "ram_util_percent": 62.099999999999994}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 9.60449696577414, "episode_reward_min": 0.5036386461279485, "episode_reward_mean": 3.6884734437643214, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.4132532187243365, 2.8271583887902754, 1.6859141065373011, 2.5360164462586816, 5.644192569969419, 3.7852705653524614, 7.40982948433977, 4.00056110279828, 0.5730145687538395, 0.5036386461279485, 2.8180986894408595, 4.212263853462142, 9.60449696577414, 5.564011649326319, 1.543276323628345, 1.8748174453959012, 1.0079798376397444, 3.802167205242611, 4.423540395091698, 1.590849063600075, 3.657322779717412, 6.720231641254091, 5.688946670818351, 4.636511032299727], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17513898220443544, "mean_inference_ms": 0.9190035805903353, "mean_action_processing_ms": 0.039794043878384984, "mean_env_wait_ms": 0.876550983513605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 470400, "timers": {"sample_time_ms": 2680.56, "sample_throughput": 3581.342, "learn_time_ms": 2877.473, "learn_throughput": 3336.261, "update_time_ms": 1.452}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.02557678437105527, "policy_loss": -0.009740235344016631, "vf_loss": 0.00978310299841197, "vf_explained_var": 0.8846977353096008, "kl": 0.017022611514518136, "entropy": -3.7396702741321763, "entropy_coeff": 0.0}}, "num_steps_sampled": 470400, "num_steps_trained": 470400}, "done": false, "episodes_total": 440, "training_iteration": 44, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-06-57", "timestamp": 1617649617, "time_this_iter_s": 5.105300426483154, "time_total_s": 278.57208156585693, "pid": 23461, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.693897247314453, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 33.18571428571429, "ram_util_percent": 62.25714285714286}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 10.154426217573262, "episode_reward_min": 0.5036386461279485, "episode_reward_mean": 3.9030057260916085, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.154426217573262, 3.0169090686850524, 5.2762621789096205, 1.5337922993530713, 2.0249745859145776, 5.835375063750456, 6.430028627029314, 2.1010525433723766, 0.5730145687538395, 0.5036386461279485, 2.8180986894408595, 4.212263853462142, 9.60449696577414, 5.564011649326319, 1.543276323628345, 1.8748174453959012, 1.0079798376397444, 3.802167205242611, 4.423540395091698, 1.590849063600075, 3.657322779717412, 6.720231641254091, 5.688946670818351, 4.636511032299727, 2.4132532187243365, 2.8271583887902754, 1.6859141065373011, 2.5360164462586816, 5.644192569969419, 3.7852705653524614, 7.40982948433977, 4.00056110279828], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1776185679856741, "mean_inference_ms": 0.9335563727851053, "mean_action_processing_ms": 0.04040483062666521, "mean_env_wait_ms": 0.8860360941224652, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 480000, "timers": {"sample_time_ms": 2825.831, "sample_throughput": 3397.23, "learn_time_ms": 2862.93, "learn_throughput": 3353.208, "update_time_ms": 1.579}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.03154093053093866, "policy_loss": -0.010981130573016248, "vf_loss": 0.012587225662642403, "vf_explained_var": 0.9017483592033386, "kl": 0.01995655714877342, "entropy": -3.738160464638158, "entropy_coeff": 0.0}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 448, "training_iteration": 45, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-07-03", "timestamp": 1617649623, "time_this_iter_s": 6.087852478027344, "time_total_s": 284.6599340438843, "pid": 23461, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.781749725341797, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 54.544444444444444, "ram_util_percent": 62.22222222222222}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 10.154426217573262, "episode_reward_min": 0.5036386461279485, "episode_reward_mean": 3.9673779204079573, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.395149500155731, 4.122239733524839, 3.814425319131261, 0.9256004801419173, 1.9830412088813345, 3.0795409961258917, 5.248057874744354, 5.008980631755015, 4.032293701237592, 3.301121731417461, 4.825022352841041, 8.172044993792978, 2.1814369302894336, 5.318679471656998, 3.538457630827965, 4.591864388126712, 0.5730145687538395, 0.5036386461279485, 2.8180986894408595, 4.212263853462142, 9.60449696577414, 5.564011649326319, 1.543276323628345, 1.8748174453959012, 1.0079798376397444, 3.802167205242611, 4.423540395091698, 1.590849063600075, 3.657322779717412, 6.720231641254091, 5.688946670818351, 4.636511032299727, 2.4132532187243365, 2.8271583887902754, 1.6859141065373011, 2.5360164462586816, 5.644192569969419, 3.7852705653524614, 7.40982948433977, 4.00056110279828, 10.154426217573262, 3.0169090686850524, 5.2762621789096205, 1.5337922993530713, 2.0249745859145776, 5.835375063750456, 6.430028627029314, 2.1010525433723766], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18163877122912417, "mean_inference_ms": 0.945399981033375, "mean_action_processing_ms": 0.040480008343903424, "mean_env_wait_ms": 0.8825325943915298, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 489600, "timers": {"sample_time_ms": 2781.774, "sample_throughput": 3451.035, "learn_time_ms": 2842.968, "learn_throughput": 3376.753, "update_time_ms": 1.573}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.030877366111809877, "policy_loss": -0.006319568904214784, "vf_loss": 0.014069715813782654, "vf_explained_var": 0.9186708927154541, "kl": 0.015418146094797473, "entropy": -3.6773001294387013, "entropy_coeff": 0.0}}, "num_steps_sampled": 489600, "num_steps_trained": 489600}, "done": false, "episodes_total": 464, "training_iteration": 46, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-07-09", "timestamp": 1617649629, "time_this_iter_s": 5.375009059906006, "time_total_s": 290.0349431037903, "pid": 23461, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.156758785247803, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 31.7875, "ram_util_percent": 62.150000000000006}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 10.154426217573262, "episode_reward_min": 0.5036386461279485, "episode_reward_mean": 4.025377297086852, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.399518193450742, 4.265828727832969, 3.52393173473542, 3.914810425435168, 1.8216434411498623, 4.989626705178199, 4.617259553842909, 6.454369675656425, 0.5730145687538395, 0.5036386461279485, 2.8180986894408595, 4.212263853462142, 9.60449696577414, 5.564011649326319, 1.543276323628345, 1.8748174453959012, 1.0079798376397444, 3.802167205242611, 4.423540395091698, 1.590849063600075, 3.657322779717412, 6.720231641254091, 5.688946670818351, 4.636511032299727, 2.4132532187243365, 2.8271583887902754, 1.6859141065373011, 2.5360164462586816, 5.644192569969419, 3.7852705653524614, 7.40982948433977, 4.00056110279828, 10.154426217573262, 3.0169090686850524, 5.2762621789096205, 1.5337922993530713, 2.0249745859145776, 5.835375063750456, 6.430028627029314, 2.1010525433723766, 5.395149500155731, 4.122239733524839, 3.814425319131261, 0.9256004801419173, 1.9830412088813345, 3.0795409961258917, 5.248057874744354, 5.008980631755015, 4.032293701237592, 3.301121731417461, 4.825022352841041, 8.172044993792978, 2.1814369302894336, 5.318679471656998, 3.538457630827965, 4.591864388126712], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18334305911607812, "mean_inference_ms": 0.9523266209521272, "mean_action_processing_ms": 0.04067827810806938, "mean_env_wait_ms": 0.8855189533797311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 499200, "timers": {"sample_time_ms": 2858.779, "sample_throughput": 3358.077, "learn_time_ms": 2832.774, "learn_throughput": 3388.904, "update_time_ms": 1.595}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.020540048922779726, "policy_loss": -0.011695078545936237, "vf_loss": 0.010227641326032186, "vf_explained_var": 0.9177759885787964, "kl": 0.01467165866572606, "entropy": -3.692730918683504, "entropy_coeff": 0.0}}, "num_steps_sampled": 499200, "num_steps_trained": 499200}, "done": false, "episodes_total": 472, "training_iteration": 47, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-07-15", "timestamp": 1617649635, "time_this_iter_s": 6.032395362854004, "time_total_s": 296.0673384666443, "pid": 23461, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.18915414810181, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 57.9875, "ram_util_percent": 62.0375}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 10.154426217573262, "episode_reward_min": 0.5036386461279485, "episode_reward_mean": 3.9933795189794354, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.6679821122774943, 2.924024282381866, 2.489858946262668, 5.426687446538718, 4.344955668760856, 4.460410971319075, 2.8437455942600502, 3.9974955560194667, 0.5730145687538395, 0.5036386461279485, 2.8180986894408595, 4.212263853462142, 9.60449696577414, 5.564011649326319, 1.543276323628345, 1.8748174453959012, 1.0079798376397444, 3.802167205242611, 4.423540395091698, 1.590849063600075, 3.657322779717412, 6.720231641254091, 5.688946670818351, 4.636511032299727, 2.4132532187243365, 2.8271583887902754, 1.6859141065373011, 2.5360164462586816, 5.644192569969419, 3.7852705653524614, 7.40982948433977, 4.00056110279828, 10.154426217573262, 3.0169090686850524, 5.2762621789096205, 1.5337922993530713, 2.0249745859145776, 5.835375063750456, 6.430028627029314, 2.1010525433723766, 5.395149500155731, 4.122239733524839, 3.814425319131261, 0.9256004801419173, 1.9830412088813345, 3.0795409961258917, 5.248057874744354, 5.008980631755015, 4.032293701237592, 3.301121731417461, 4.825022352841041, 8.172044993792978, 2.1814369302894336, 5.318679471656998, 3.538457630827965, 4.591864388126712, 5.399518193450742, 4.265828727832969, 3.52393173473542, 3.914810425435168, 1.8216434411498623, 4.989626705178199, 4.617259553842909, 6.454369675656425], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1838260473558539, "mean_inference_ms": 0.9540412096142628, "mean_action_processing_ms": 0.04069033699984805, "mean_env_wait_ms": 0.8843654444279803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 508800, "timers": {"sample_time_ms": 2773.616, "sample_throughput": 3461.185, "learn_time_ms": 2810.826, "learn_throughput": 3415.366, "update_time_ms": 1.589}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.02205970943660328, "policy_loss": -0.011735693660356398, "vf_loss": 0.01058574516424223, "vf_explained_var": 0.9076513051986694, "kl": 0.01547310462613639, "entropy": -3.6724775715878137, "entropy_coeff": 0.0}}, "num_steps_sampled": 508800, "num_steps_trained": 508800}, "done": false, "episodes_total": 480, "training_iteration": 48, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-07-20", "timestamp": 1617649640, "time_this_iter_s": 4.9484336376190186, "time_total_s": 301.0157721042633, "pid": 23461, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.137587785720825, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.9625, "ram_util_percent": 62.1125}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 12.943999876001929, "episode_reward_min": 0.5036386461279485, "episode_reward_mean": 4.201068089731013, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.230142857372595, 4.273685437811777, 4.217400274336025, 5.833937528734956, 5.432424983364115, 7.028179215008045, 1.940843073319685, 12.943999876001929, 0.5730145687538395, 0.5036386461279485, 2.8180986894408595, 4.212263853462142, 9.60449696577414, 5.564011649326319, 1.543276323628345, 1.8748174453959012, 1.0079798376397444, 3.802167205242611, 4.423540395091698, 1.590849063600075, 3.657322779717412, 6.720231641254091, 5.688946670818351, 4.636511032299727, 2.4132532187243365, 2.8271583887902754, 1.6859141065373011, 2.5360164462586816, 5.644192569969419, 3.7852705653524614, 7.40982948433977, 4.00056110279828, 10.154426217573262, 3.0169090686850524, 5.2762621789096205, 1.5337922993530713, 2.0249745859145776, 5.835375063750456, 6.430028627029314, 2.1010525433723766, 5.395149500155731, 4.122239733524839, 3.814425319131261, 0.9256004801419173, 1.9830412088813345, 3.0795409961258917, 5.248057874744354, 5.008980631755015, 4.032293701237592, 3.301121731417461, 4.825022352841041, 8.172044993792978, 2.1814369302894336, 5.318679471656998, 3.538457630827965, 4.591864388126712, 5.399518193450742, 4.265828727832969, 3.52393173473542, 3.914810425435168, 1.8216434411498623, 4.989626705178199, 4.617259553842909, 6.454369675656425, 3.6679821122774943, 2.924024282381866, 2.489858946262668, 5.426687446538718, 4.344955668760856, 4.460410971319075, 2.8437455942600502, 3.9974955560194667], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18439547875781326, "mean_inference_ms": 0.9572794444902638, "mean_action_processing_ms": 0.04079270616413174, "mean_env_wait_ms": 0.8856029804433376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 518400, "timers": {"sample_time_ms": 2834.205, "sample_throughput": 3387.193, "learn_time_ms": 2817.044, "learn_throughput": 3407.828, "update_time_ms": 1.586}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.03572928767504269, "policy_loss": -0.005001075472682715, "vf_loss": 0.01583361488914019, "vf_explained_var": 0.8826248049736023, "kl": 0.016597834003991202, "entropy": -3.7926782206485146, "entropy_coeff": 0.0}}, "num_steps_sampled": 518400, "num_steps_trained": 518400}, "done": false, "episodes_total": 488, "training_iteration": 49, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-07-26", "timestamp": 1617649646, "time_this_iter_s": 6.125717878341675, "time_total_s": 307.141489982605, "pid": 23461, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.2633056640625, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.8, "ram_util_percent": 62.1125}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 12.943999876001929, "episode_reward_min": 0.5036386461279485, "episode_reward_mean": 4.165993181328186, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.424767247885983, 4.505436545655095, 2.705659052658939, 3.7475835543972655, 3.7671557723321394, 5.5547280083684845, 3.051099059415206, 3.0461228049087756, 0.5730145687538395, 0.5036386461279485, 2.8180986894408595, 4.212263853462142, 9.60449696577414, 5.564011649326319, 1.543276323628345, 1.8748174453959012, 1.0079798376397444, 3.802167205242611, 4.423540395091698, 1.590849063600075, 3.657322779717412, 6.720231641254091, 5.688946670818351, 4.636511032299727, 2.4132532187243365, 2.8271583887902754, 1.6859141065373011, 2.5360164462586816, 5.644192569969419, 3.7852705653524614, 7.40982948433977, 4.00056110279828, 10.154426217573262, 3.0169090686850524, 5.2762621789096205, 1.5337922993530713, 2.0249745859145776, 5.835375063750456, 6.430028627029314, 2.1010525433723766, 5.395149500155731, 4.122239733524839, 3.814425319131261, 0.9256004801419173, 1.9830412088813345, 3.0795409961258917, 5.248057874744354, 5.008980631755015, 4.032293701237592, 3.301121731417461, 4.825022352841041, 8.172044993792978, 2.1814369302894336, 5.318679471656998, 3.538457630827965, 4.591864388126712, 5.399518193450742, 4.265828727832969, 3.52393173473542, 3.914810425435168, 1.8216434411498623, 4.989626705178199, 4.617259553842909, 6.454369675656425, 3.6679821122774943, 2.924024282381866, 2.489858946262668, 5.426687446538718, 4.344955668760856, 4.460410971319075, 2.8437455942600502, 3.9974955560194667, 5.230142857372595, 4.273685437811777, 4.217400274336025, 5.833937528734956, 5.432424983364115, 7.028179215008045, 1.940843073319685, 12.943999876001929], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1843798979295934, "mean_inference_ms": 0.9577883675997843, "mean_action_processing_ms": 0.040788839810164165, "mean_env_wait_ms": 0.8845780810992212, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 528000, "timers": {"sample_time_ms": 2772.164, "sample_throughput": 3462.998, "learn_time_ms": 2798.396, "learn_throughput": 3430.537, "update_time_ms": 1.582}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.02854660639943751, "policy_loss": -0.010054370405544575, "vf_loss": 0.011555090340736665, "vf_explained_var": 0.9326329827308655, "kl": 0.018030592054128648, "entropy": -3.7421790449242844, "entropy_coeff": 0.0}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 496, "training_iteration": 50, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-07-31", "timestamp": 1617649651, "time_this_iter_s": 4.931662082672119, "time_total_s": 312.0731520652771, "pid": 23461, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.19496774673462, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.599999999999998, "ram_util_percent": 62.10000000000001}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 7.05750848994361, "episode_reward_min": 1.5601019311969644, "episode_reward_mean": 3.885966100274832, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5601019311969644, 7.05750848994361, 2.270895983947113, 2.8203500473291276, 5.026873499616378, 5.381965948651103, 3.9341208979410345, 3.0359120035733262], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21223300799640588, "mean_inference_ms": 1.0942095126041662, "mean_action_processing_ms": 0.04668609486531457, "mean_env_wait_ms": 1.0680501705204617, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 537600, "timers": {"sample_time_ms": 7382.676, "sample_throughput": 1300.341, "learn_time_ms": 2741.965, "learn_throughput": 3501.138, "update_time_ms": 1.907}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.02206407248189575, "policy_loss": -0.014420889876170183, "vf_loss": 0.01297296875793683, "vf_explained_var": 0.9131499528884888, "kl": 0.023511991600849127, "entropy": -3.8198113140306975, "entropy_coeff": 0.0}}, "num_steps_sampled": 537600, "num_steps_trained": 537600}, "done": false, "episodes_total": 504, "training_iteration": 51, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-52", "timestamp": 1617649732, "time_this_iter_s": 10.129408121109009, "time_total_s": 322.2025601863861, "pid": 24629, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.129408121109009, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.50666666666667, "ram_util_percent": 62.05999999999998}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 11.354849286293028, "episode_reward_min": 1.5601019311969644, "episode_reward_mean": 4.478567974788749, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.397552532929917, 11.354849286293028, 4.219810442907753, 3.895557119614491, 5.946920456822989, 1.6319968896901922, 2.7269999534794898, 4.395672112683475, 1.5601019311969644, 7.05750848994361, 2.270895983947113, 2.8203500473291276, 5.026873499616378, 5.381965948651103, 3.9341208979410345, 3.0359120035733262], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1962719612668539, "mean_inference_ms": 1.020522349363585, "mean_action_processing_ms": 0.04350390891667169, "mean_env_wait_ms": 0.9782225314549824, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 547200, "timers": {"sample_time_ms": 4781.367, "sample_throughput": 2007.794, "learn_time_ms": 2916.661, "learn_throughput": 3291.435, "update_time_ms": 1.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.027542883745933833, "policy_loss": -0.008890770066921648, "vf_loss": 0.016019485949685698, "vf_explained_var": 0.8993992209434509, "kl": 0.013609445987171249, "entropy": -3.7677470508374666, "entropy_coeff": 0.0}}, "num_steps_sampled": 547200, "num_steps_trained": 547200}, "done": false, "episodes_total": 512, "training_iteration": 52, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-08-57", "timestamp": 1617649737, "time_this_iter_s": 5.277097940444946, "time_total_s": 327.47965812683105, "pid": 24629, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.406506061553955, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.075, "ram_util_percent": 62.0125}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 11.354849286293028, "episode_reward_min": 1.5601019311969644, "episode_reward_mean": 4.473461326957787, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.144464535949189, 7.079963411205647, 5.736549240710177, 4.0999469071963475, 3.817882085095131, 2.281670781777168, 6.9391391982174815, 1.6063680902157622, 1.5601019311969644, 7.05750848994361, 2.270895983947113, 2.8203500473291276, 5.026873499616378, 5.381965948651103, 3.9341208979410345, 3.0359120035733262, 6.397552532929917, 11.354849286293028, 4.219810442907753, 3.895557119614491, 5.946920456822989, 1.6319968896901922, 2.7269999534794898, 4.395672112683475], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18734584753785044, "mean_inference_ms": 0.9794059805574024, "mean_action_processing_ms": 0.04171207571451543, "mean_env_wait_ms": 0.9283241668315086, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 556800, "timers": {"sample_time_ms": 3927.176, "sample_throughput": 2444.505, "learn_time_ms": 2931.688, "learn_throughput": 3274.564, "update_time_ms": 1.578}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.032273523951880635, "policy_loss": -0.005737528387506149, "vf_loss": 0.012322328303401407, "vf_explained_var": 0.913576066493988, "kl": 0.017125815045284598, "entropy": -3.8900895595550535, "entropy_coeff": 0.0}}, "num_steps_sampled": 556800, "num_steps_trained": 556800}, "done": false, "episodes_total": 520, "training_iteration": 53, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-09-03", "timestamp": 1617649743, "time_this_iter_s": 5.187723875045776, "time_total_s": 332.66738200187683, "pid": 24629, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.59422993659973, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 34.042857142857144, "ram_util_percent": 62.114285714285714}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 11.354849286293028, "episode_reward_min": 1.2631152051526255, "episode_reward_mean": 4.3575294541148235, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4006301781842447, 1.2631152051526255, 7.00442727113068, 2.6209488081423933, 5.315332917831977, 2.837051243762176, 4.76714660694843, 6.869218453534942, 1.5601019311969644, 7.05750848994361, 2.270895983947113, 2.8203500473291276, 5.026873499616378, 5.381965948651103, 3.9341208979410345, 3.0359120035733262, 6.397552532929917, 11.354849286293028, 4.219810442907753, 3.895557119614491, 5.946920456822989, 1.6319968896901922, 2.7269999534794898, 4.395672112683475, 4.144464535949189, 7.079963411205647, 5.736549240710177, 4.0999469071963475, 3.817882085095131, 2.281670781777168, 6.9391391982174815, 1.6063680902157622], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18526852589448675, "mean_inference_ms": 0.9713174821942336, "mean_action_processing_ms": 0.041319647436126816, "mean_env_wait_ms": 0.913921427887233, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 566400, "timers": {"sample_time_ms": 3736.266, "sample_throughput": 2569.41, "learn_time_ms": 2902.084, "learn_throughput": 3307.967, "update_time_ms": 1.648}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.02642349798085266, "policy_loss": -0.008790672124412499, "vf_loss": 0.013641841219444024, "vf_explained_var": 0.9217041730880737, "kl": 0.014381551958228413, "entropy": -3.8215179342972605, "entropy_coeff": 0.0}}, "num_steps_sampled": 566400, "num_steps_trained": 566400}, "done": false, "episodes_total": 528, "training_iteration": 54, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-09-09", "timestamp": 1617649749, "time_this_iter_s": 5.983221769332886, "time_total_s": 338.6506037712097, "pid": 24629, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.577451705932617, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 49.8875, "ram_util_percent": 62.125}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 11.805039973194775, "episode_reward_min": 1.2631152051526255, "episode_reward_mean": 4.388532842505797, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.805039973194775, 4.42563697291603, 4.610053364212538, 3.1343263468303117, 4.813728450029542, 6.635337372687392, 2.0413296656028845, 3.2751750214251665, 3.149670464495383, 4.980141971625062, 2.4387892667929174, 5.567895518929985, 3.14573037389685, 4.837834123251379, 3.4668420213085227, 2.8811030014051506, 1.5601019311969644, 7.05750848994361, 2.270895983947113, 2.8203500473291276, 5.026873499616378, 5.381965948651103, 3.9341208979410345, 3.0359120035733262, 6.397552532929917, 11.354849286293028, 4.219810442907753, 3.895557119614491, 5.946920456822989, 1.6319968896901922, 2.7269999534794898, 4.395672112683475, 4.144464535949189, 7.079963411205647, 5.736549240710177, 4.0999469071963475, 3.817882085095131, 2.281670781777168, 6.9391391982174815, 1.6063680902157622, 1.4006301781842447, 1.2631152051526255, 7.00442727113068, 2.6209488081423933, 5.315332917831977, 2.837051243762176, 4.76714660694843, 6.869218453534942], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18703332148675553, "mean_inference_ms": 0.9728573227401246, "mean_action_processing_ms": 0.0410343224246797, "mean_env_wait_ms": 0.9010018760543493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 576000, "timers": {"sample_time_ms": 3606.366, "sample_throughput": 2661.96, "learn_time_ms": 2881.448, "learn_throughput": 3331.658, "update_time_ms": 1.606}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.027791673262407512, "policy_loss": -0.010938987574589096, "vf_loss": 0.01743729938998034, "vf_explained_var": 0.9121480584144592, "kl": 0.014195573731864754, "entropy": -3.7926891427291065, "entropy_coeff": 0.0}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 544, "training_iteration": 55, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-09-14", "timestamp": 1617649754, "time_this_iter_s": 5.891613721847534, "time_total_s": 344.54221749305725, "pid": 24629, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.46906542778015, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 45.888888888888886, "ram_util_percent": 62.03333333333333}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 11.805039973194775, "episode_reward_min": 1.2631152051526255, "episode_reward_mean": 4.61229382009776, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.488403040693189, 6.994326429001851, 6.3893632334441355, 3.578811509741115, 7.518849782272733, 6.819903920941759, 6.180155657005571, 3.6690639120959565, 1.5601019311969644, 7.05750848994361, 2.270895983947113, 2.8203500473291276, 5.026873499616378, 5.381965948651103, 3.9341208979410345, 3.0359120035733262, 6.397552532929917, 11.354849286293028, 4.219810442907753, 3.895557119614491, 5.946920456822989, 1.6319968896901922, 2.7269999534794898, 4.395672112683475, 4.144464535949189, 7.079963411205647, 5.736549240710177, 4.0999469071963475, 3.817882085095131, 2.281670781777168, 6.9391391982174815, 1.6063680902157622, 1.4006301781842447, 1.2631152051526255, 7.00442727113068, 2.6209488081423933, 5.315332917831977, 2.837051243762176, 4.76714660694843, 6.869218453534942, 11.805039973194775, 4.42563697291603, 4.610053364212538, 3.1343263468303117, 4.813728450029542, 6.635337372687392, 2.0413296656028845, 3.2751750214251665, 3.149670464495383, 4.980141971625062, 2.4387892667929174, 5.567895518929985, 3.14573037389685, 4.837834123251379, 3.4668420213085227, 2.8811030014051506], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18641814197799822, "mean_inference_ms": 0.9685771856354111, "mean_action_processing_ms": 0.04077255352175785, "mean_env_wait_ms": 0.89282982874034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 585600, "timers": {"sample_time_ms": 3363.43, "sample_throughput": 2854.229, "learn_time_ms": 2914.449, "learn_throughput": 3293.933, "update_time_ms": 1.577}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.030916302167124262, "policy_loss": -0.008725181593265581, "vf_loss": 0.016921747078824986, "vf_explained_var": 0.8935144543647766, "kl": 0.01514649131384335, "entropy": -3.876656695416099, "entropy_coeff": 0.0}}, "num_steps_sampled": 585600, "num_steps_trained": 585600}, "done": false, "episodes_total": 552, "training_iteration": 56, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-09-20", "timestamp": 1617649760, "time_this_iter_s": 5.234996795654297, "time_total_s": 349.77721428871155, "pid": 24629, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.70406222343445, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.8, "ram_util_percent": 62.02857142857143}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 11.805039973194775, "episode_reward_min": 1.2631152051526255, "episode_reward_mean": 4.819376415346472, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.481607414201017, 8.79065127840724, 5.364867308177151, 6.619433024030086, 3.101913091099626, 5.762297888399605, 6.412697458253443, 8.618169194131466, 1.5601019311969644, 7.05750848994361, 2.270895983947113, 2.8203500473291276, 5.026873499616378, 5.381965948651103, 3.9341208979410345, 3.0359120035733262, 6.397552532929917, 11.354849286293028, 4.219810442907753, 3.895557119614491, 5.946920456822989, 1.6319968896901922, 2.7269999534794898, 4.395672112683475, 4.144464535949189, 7.079963411205647, 5.736549240710177, 4.0999469071963475, 3.817882085095131, 2.281670781777168, 6.9391391982174815, 1.6063680902157622, 1.4006301781842447, 1.2631152051526255, 7.00442727113068, 2.6209488081423933, 5.315332917831977, 2.837051243762176, 4.76714660694843, 6.869218453534942, 11.805039973194775, 4.42563697291603, 4.610053364212538, 3.1343263468303117, 4.813728450029542, 6.635337372687392, 2.0413296656028845, 3.2751750214251665, 3.149670464495383, 4.980141971625062, 2.4387892667929174, 5.567895518929985, 3.14573037389685, 4.837834123251379, 3.4668420213085227, 2.8811030014051506, 6.488403040693189, 6.994326429001851, 6.3893632334441355, 3.578811509741115, 7.518849782272733, 6.819903920941759, 6.180155657005571, 3.6690639120959565], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18543201313700935, "mean_inference_ms": 0.9638592704390423, "mean_action_processing_ms": 0.04052224024433136, "mean_env_wait_ms": 0.8853439229743945, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 595200, "timers": {"sample_time_ms": 3228.059, "sample_throughput": 2973.923, "learn_time_ms": 2896.036, "learn_throughput": 3314.876, "update_time_ms": 1.554}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.039834781900342356, "policy_loss": -0.0013744915039033481, "vf_loss": 0.016841331232143077, "vf_explained_var": 0.9111603498458862, "kl": 0.016245295857324413, "entropy": -3.8189350881074606, "entropy_coeff": 0.0}}, "num_steps_sampled": 595200, "num_steps_trained": 595200}, "done": false, "episodes_total": 560, "training_iteration": 57, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-09-25", "timestamp": 1617649765, "time_this_iter_s": 5.207924842834473, "time_total_s": 354.985139131546, "pid": 24629, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.91198706626892, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.4125, "ram_util_percent": 62.1}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 11.805039973194775, "episode_reward_min": 1.2631152051526255, "episode_reward_mean": 4.891118564223444, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.306553324337438, 8.595132377209207, 5.501161024493966, 6.0586445763522825, 5.654958494889567, 8.064824806380175, 2.369180237856346, 4.169991200394782, 1.5601019311969644, 7.05750848994361, 2.270895983947113, 2.8203500473291276, 5.026873499616378, 5.381965948651103, 3.9341208979410345, 3.0359120035733262, 6.397552532929917, 11.354849286293028, 4.219810442907753, 3.895557119614491, 5.946920456822989, 1.6319968896901922, 2.7269999534794898, 4.395672112683475, 4.144464535949189, 7.079963411205647, 5.736549240710177, 4.0999469071963475, 3.817882085095131, 2.281670781777168, 6.9391391982174815, 1.6063680902157622, 1.4006301781842447, 1.2631152051526255, 7.00442727113068, 2.6209488081423933, 5.315332917831977, 2.837051243762176, 4.76714660694843, 6.869218453534942, 11.805039973194775, 4.42563697291603, 4.610053364212538, 3.1343263468303117, 4.813728450029542, 6.635337372687392, 2.0413296656028845, 3.2751750214251665, 3.149670464495383, 4.980141971625062, 2.4387892667929174, 5.567895518929985, 3.14573037389685, 4.837834123251379, 3.4668420213085227, 2.8811030014051506, 6.488403040693189, 6.994326429001851, 6.3893632334441355, 3.578811509741115, 7.518849782272733, 6.819903920941759, 6.180155657005571, 3.6690639120959565, 5.481607414201017, 8.79065127840724, 5.364867308177151, 6.619433024030086, 3.101913091099626, 5.762297888399605, 6.412697458253443, 8.618169194131466], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18511198420097077, "mean_inference_ms": 0.9627278171984526, "mean_action_processing_ms": 0.04044829715848535, "mean_env_wait_ms": 0.882250951108484, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 604800, "timers": {"sample_time_ms": 3224.985, "sample_throughput": 2976.758, "learn_time_ms": 2869.908, "learn_throughput": 3345.055, "update_time_ms": 1.6}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.034969540877806904, "policy_loss": -0.006933371869442788, "vf_loss": 0.015851223449173727, "vf_explained_var": 0.9113273024559021, "kl": 0.01736779381570063, "entropy": -3.9848672540564287, "entropy_coeff": 0.0}}, "num_steps_sampled": 604800, "num_steps_trained": 604800}, "done": false, "episodes_total": 568, "training_iteration": 58, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-09-31", "timestamp": 1617649771, "time_this_iter_s": 5.897334337234497, "time_total_s": 360.8824734687805, "pid": 24629, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.80932140350342, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 51.137499999999996, "ram_util_percent": 62.1375}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 11.805039973194775, "episode_reward_min": 1.2631152051526255, "episode_reward_mean": 4.9695504750102275, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.320747882668393, 4.022378284782225, 4.247780761402652, 7.751394551302063, 4.973205853592541, 7.456060493608785, 6.288654314686981, 6.343279234686533, 1.5601019311969644, 7.05750848994361, 2.270895983947113, 2.8203500473291276, 5.026873499616378, 5.381965948651103, 3.9341208979410345, 3.0359120035733262, 6.397552532929917, 11.354849286293028, 4.219810442907753, 3.895557119614491, 5.946920456822989, 1.6319968896901922, 2.7269999534794898, 4.395672112683475, 4.144464535949189, 7.079963411205647, 5.736549240710177, 4.0999469071963475, 3.817882085095131, 2.281670781777168, 6.9391391982174815, 1.6063680902157622, 1.4006301781842447, 1.2631152051526255, 7.00442727113068, 2.6209488081423933, 5.315332917831977, 2.837051243762176, 4.76714660694843, 6.869218453534942, 11.805039973194775, 4.42563697291603, 4.610053364212538, 3.1343263468303117, 4.813728450029542, 6.635337372687392, 2.0413296656028845, 3.2751750214251665, 3.149670464495383, 4.980141971625062, 2.4387892667929174, 5.567895518929985, 3.14573037389685, 4.837834123251379, 3.4668420213085227, 2.8811030014051506, 6.488403040693189, 6.994326429001851, 6.3893632334441355, 3.578811509741115, 7.518849782272733, 6.819903920941759, 6.180155657005571, 3.6690639120959565, 5.481607414201017, 8.79065127840724, 5.364867308177151, 6.619433024030086, 3.101913091099626, 5.762297888399605, 6.412697458253443, 8.618169194131466, 3.306553324337438, 8.595132377209207, 5.501161024493966, 6.0586445763522825, 5.654958494889567, 8.064824806380175, 2.369180237856346, 4.169991200394782], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18478945271843483, "mean_inference_ms": 0.9621751488122424, "mean_action_processing_ms": 0.04042617117761825, "mean_env_wait_ms": 0.8803076486059173, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 614400, "timers": {"sample_time_ms": 3186.861, "sample_throughput": 3012.368, "learn_time_ms": 2882.444, "learn_throughput": 3330.507, "update_time_ms": 1.585}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.03202229625496425, "policy_loss": -0.00868895612044358, "vf_loss": 0.01639117329920593, "vf_explained_var": 0.9360804557800293, "kl": 0.01621338591273678, "entropy": -3.980847534380461, "entropy_coeff": 0.0}}, "num_steps_sampled": 614400, "num_steps_trained": 614400}, "done": false, "episodes_total": 576, "training_iteration": 59, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-09-37", "timestamp": 1617649777, "time_this_iter_s": 5.871881723403931, "time_total_s": 366.75435519218445, "pid": 24629, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 54.68120312690735, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 44.17777777777778, "ram_util_percent": 58.17777777777778}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 10.286463447447193, "episode_reward_min": 2.1540717624206756, "episode_reward_mean": 6.162811060477184, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.1540717624206756, 4.22652148462815, 2.590264879044036, 7.585720050769147, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14609572393114023, "mean_inference_ms": 0.7959523864034609, "mean_action_processing_ms": 0.033796329879443116, "mean_env_wait_ms": 0.7621679923417268, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 624000, "timers": {"sample_time_ms": 2501.476, "sample_throughput": 3837.734, "learn_time_ms": 2964.315, "learn_throughput": 3238.522, "update_time_ms": 1.353}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.021861426556470658, "policy_loss": -0.012738564338437036, "vf_loss": 0.01890630712242503, "vf_explained_var": 0.9199445843696594, "kl": 0.015693683392907443, "entropy": -3.983928138331363, "entropy_coeff": 0.0}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 584, "training_iteration": 60, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-10-46", "timestamp": 1617649846, "time_this_iter_s": 5.471304655075073, "time_total_s": 372.2256598472595, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.471304655075073, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.6375, "ram_util_percent": 62.4875}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 10.286463447447193, "episode_reward_min": 1.86529546858254, "episode_reward_mean": 5.920095669725448, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.656663811089914, 1.86529546858254, 6.479722628402071, 2.839134117402478, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514, 2.1540717624206756, 4.22652148462815, 2.590264879044036, 7.585720050769147, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14813761223165517, "mean_inference_ms": 0.8083765397376638, "mean_action_processing_ms": 0.03435582793480857, "mean_env_wait_ms": 0.761043945273428, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 633600, "timers": {"sample_time_ms": 2413.323, "sample_throughput": 3977.917, "learn_time_ms": 2805.339, "learn_throughput": 3422.046, "update_time_ms": 1.566}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.024454047836096785, "policy_loss": -0.009386895131319762, "vf_loss": 0.01566635207518151, "vf_explained_var": 0.9281301498413086, "kl": 0.018174591474235058, "entropy": -3.919817839170757, "entropy_coeff": 0.0}}, "num_steps_sampled": 633600, "num_steps_trained": 633600}, "done": false, "episodes_total": 592, "training_iteration": 61, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-10-51", "timestamp": 1617649851, "time_this_iter_s": 4.978781223297119, "time_total_s": 377.20444107055664, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.450085878372192, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 34.54285714285714, "ram_util_percent": 62.74285714285715}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 15.175230628673944, "episode_reward_min": 1.86529546858254, "episode_reward_mean": 6.424051383451432, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.96927985522761, 4.326807224175258, 6.55693965598715, 11.201397710501425, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083, 2.1540717624206756, 4.22652148462815, 2.590264879044036, 7.585720050769147, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078, 4.656663811089914, 1.86529546858254, 6.479722628402071, 2.839134117402478, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15143769171178945, "mean_inference_ms": 0.8269450393422849, "mean_action_processing_ms": 0.035307348135147576, "mean_env_wait_ms": 0.7737830774558258, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 643200, "timers": {"sample_time_ms": 2509.884, "sample_throughput": 3824.879, "learn_time_ms": 3019.393, "learn_throughput": 3179.447, "update_time_ms": 1.48}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.01, "total_loss": 0.04185380905278419, "policy_loss": -0.0038090839026201713, "vf_loss": 0.022818284560191002, "vf_explained_var": 0.8888506293296814, "kl": 0.0228446070987143, "entropy": -4.121846495176617, "entropy_coeff": 0.0}}, "num_steps_sampled": 643200, "num_steps_trained": 643200}, "done": false, "episodes_total": 600, "training_iteration": 62, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-10-57", "timestamp": 1617649857, "time_this_iter_s": 6.156216382980347, "time_total_s": 383.360657453537, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.60630226135254, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.43333333333333, "ram_util_percent": 58.46666666666667}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 15.175230628673944, "episode_reward_min": 1.86529546858254, "episode_reward_mean": 6.98212737232007, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.792850354879379, 9.47681480587736, 9.87727490713292, 8.817846669592157, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374, 2.1540717624206756, 4.22652148462815, 2.590264879044036, 7.585720050769147, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078, 4.656663811089914, 1.86529546858254, 6.479722628402071, 2.839134117402478, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514, 4.96927985522761, 4.326807224175258, 6.55693965598715, 11.201397710501425, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15569832523067076, "mean_inference_ms": 0.8515543491025108, "mean_action_processing_ms": 0.0364023023191551, "mean_env_wait_ms": 0.7939711560585074, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 652800, "timers": {"sample_time_ms": 2679.101, "sample_throughput": 3583.291, "learn_time_ms": 2958.681, "learn_throughput": 3244.689, "update_time_ms": 1.544}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.04214273680577447, "policy_loss": -0.010529316983057039, "vf_loss": 0.026751424381999594, "vf_explained_var": 0.912156343460083, "kl": 0.017280418817934236, "entropy": -4.074871063232422, "entropy_coeff": 0.0}}, "num_steps_sampled": 652800, "num_steps_trained": 652800}, "done": false, "episodes_total": 608, "training_iteration": 63, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-03", "timestamp": 1617649863, "time_this_iter_s": 5.969215154647827, "time_total_s": 389.3298726081848, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.575517416000366, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 49.63333333333334, "ram_util_percent": 62.400000000000006}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 15.175230628673944, "episode_reward_min": 1.86529546858254, "episode_reward_mean": 7.024076013717777, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.467838889623463, 3.3422982726969934, 9.566318726328603, 7.180332197681606, 7.188927826260702, 8.792128534013418, 4.358379762637738, 5.503398098021415, 5.887196888117902, 4.939583775977286, 8.294494254329775, 8.10255986654196, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274, 2.1540717624206756, 4.22652148462815, 2.590264879044036, 7.585720050769147, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078, 4.656663811089914, 1.86529546858254, 6.479722628402071, 2.839134117402478, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514, 4.96927985522761, 4.326807224175258, 6.55693965598715, 11.201397710501425, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083, 9.792850354879379, 9.47681480587736, 9.87727490713292, 8.817846669592157, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16414986429769443, "mean_inference_ms": 0.8795318740652593, "mean_action_processing_ms": 0.03729266399876818, "mean_env_wait_ms": 0.8079473638680401, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 662400, "timers": {"sample_time_ms": 2675.628, "sample_throughput": 3587.943, "learn_time_ms": 3033.984, "learn_throughput": 3164.157, "update_time_ms": 1.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.040391065863475795, "policy_loss": -0.008139119133518665, "vf_loss": 0.030399238857391632, "vf_explained_var": 0.9201180934906006, "kl": 0.012087298758131894, "entropy": -4.030922681406925, "entropy_coeff": 0.0}}, "num_steps_sampled": 662400, "num_steps_trained": 662400}, "done": false, "episodes_total": 624, "training_iteration": 64, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-09", "timestamp": 1617649869, "time_this_iter_s": 6.003844738006592, "time_total_s": 395.3337173461914, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.579362154006958, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.9375, "ram_util_percent": 58.962500000000006}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 19.705596201410756, "episode_reward_min": 1.86529546858254, "episode_reward_mean": 7.59611316268339, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.370629203467213, 11.988884848043504, 17.43897033779972, 19.705596201410756, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187, 2.1540717624206756, 4.22652148462815, 2.590264879044036, 7.585720050769147, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078, 4.656663811089914, 1.86529546858254, 6.479722628402071, 2.839134117402478, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514, 4.96927985522761, 4.326807224175258, 6.55693965598715, 11.201397710501425, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083, 9.792850354879379, 9.47681480587736, 9.87727490713292, 8.817846669592157, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374, 9.467838889623463, 3.3422982726969934, 9.566318726328603, 7.180332197681606, 7.188927826260702, 8.792128534013418, 4.358379762637738, 5.503398098021415, 5.887196888117902, 4.939583775977286, 8.294494254329775, 8.10255986654196, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16736254881972526, "mean_inference_ms": 0.8921068312318986, "mean_action_processing_ms": 0.037769735715073936, "mean_env_wait_ms": 0.8169194602109405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 672000, "timers": {"sample_time_ms": 2767.818, "sample_throughput": 3468.436, "learn_time_ms": 3027.919, "learn_throughput": 3170.494, "update_time_ms": 1.509}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.05194515848385268, "policy_loss": -0.008655288237098015, "vf_loss": 0.04067240117705966, "vf_explained_var": 0.8887892961502075, "kl": 0.013285365695820043, "entropy": -4.117726115176552, "entropy_coeff": 0.0}}, "num_steps_sampled": 672000, "num_steps_trained": 672000}, "done": false, "episodes_total": 632, "training_iteration": 65, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-16", "timestamp": 1617649876, "time_this_iter_s": 6.2321937084198, "time_total_s": 401.5659110546112, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.81155586242676, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 59.6888888888889, "ram_util_percent": 61.67777777777778}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 19.705596201410756, "episode_reward_min": 1.86529546858254, "episode_reward_mean": 7.938638144332833, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.397065235625584, 13.791429466112273, 10.620256987473605, 10.932309749450754, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346, 2.1540717624206756, 4.22652148462815, 2.590264879044036, 7.585720050769147, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078, 4.656663811089914, 1.86529546858254, 6.479722628402071, 2.839134117402478, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514, 4.96927985522761, 4.326807224175258, 6.55693965598715, 11.201397710501425, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083, 9.792850354879379, 9.47681480587736, 9.87727490713292, 8.817846669592157, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374, 9.467838889623463, 3.3422982726969934, 9.566318726328603, 7.180332197681606, 7.188927826260702, 8.792128534013418, 4.358379762637738, 5.503398098021415, 5.887196888117902, 4.939583775977286, 8.294494254329775, 8.10255986654196, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274, 4.370629203467213, 11.988884848043504, 17.43897033779972, 19.705596201410756, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16907697700409846, "mean_inference_ms": 0.8984227186538456, "mean_action_processing_ms": 0.03800516316091172, "mean_env_wait_ms": 0.820631761225047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 681600, "timers": {"sample_time_ms": 2687.411, "sample_throughput": 3572.212, "learn_time_ms": 3023.871, "learn_throughput": 3174.739, "update_time_ms": 1.506}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 0.01, "total_loss": 0.060893854267258, "policy_loss": -0.002739858121219042, "vf_loss": 0.027405138166719363, "vf_explained_var": 0.9328727126121521, "kl": 0.024152381580911184, "entropy": -4.0474632413763745, "entropy_coeff": 0.0}}, "num_steps_sampled": 681600, "num_steps_trained": 681600}, "done": false, "episodes_total": 640, "training_iteration": 66, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-21", "timestamp": 1617649881, "time_this_iter_s": 5.211328744888306, "time_total_s": 406.7772397994995, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.02288460731506, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.4, "ram_util_percent": 62.587500000000006}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 21.85132884105995, "episode_reward_min": 1.86529546858254, "episode_reward_mean": 8.18094150980601, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.789387145587407, 4.78898956604222, 9.700983794277489, 6.298036855331103, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235, 2.1540717624206756, 4.22652148462815, 2.590264879044036, 7.585720050769147, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078, 4.656663811089914, 1.86529546858254, 6.479722628402071, 2.839134117402478, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514, 4.96927985522761, 4.326807224175258, 6.55693965598715, 11.201397710501425, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083, 9.792850354879379, 9.47681480587736, 9.87727490713292, 8.817846669592157, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374, 9.467838889623463, 3.3422982726969934, 9.566318726328603, 7.180332197681606, 7.188927826260702, 8.792128534013418, 4.358379762637738, 5.503398098021415, 5.887196888117902, 4.939583775977286, 8.294494254329775, 8.10255986654196, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274, 4.370629203467213, 11.988884848043504, 17.43897033779972, 19.705596201410756, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187, 9.397065235625584, 13.791429466112273, 10.620256987473605, 10.932309749450754, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1702694800570942, "mean_inference_ms": 0.9034199062723999, "mean_action_processing_ms": 0.038195166561748144, "mean_env_wait_ms": 0.823678201852774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 691200, "timers": {"sample_time_ms": 2689.593, "sample_throughput": 3569.313, "learn_time_ms": 2970.745, "learn_throughput": 3231.513, "update_time_ms": 1.49}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.045050156208124366, "policy_loss": -0.006444618034047859, "vf_loss": 0.027461205903244645, "vf_explained_var": 0.9147646427154541, "kl": 0.01068158533522173, "entropy": -4.223131327880056, "entropy_coeff": 0.0}}, "num_steps_sampled": 691200, "num_steps_trained": 691200}, "done": false, "episodes_total": 648, "training_iteration": 67, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-26", "timestamp": 1617649886, "time_this_iter_s": 5.310436010360718, "time_total_s": 412.08767580986023, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.33332061767578, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 40.0, "ram_util_percent": 62.60000000000001}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 25.54361062002385, "episode_reward_min": 1.86529546858254, "episode_reward_mean": 8.423722012683156, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.131136029687951, 5.386776138409526, 6.382209170780144, 25.54361062002385, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364, 2.1540717624206756, 4.22652148462815, 2.590264879044036, 7.585720050769147, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078, 4.656663811089914, 1.86529546858254, 6.479722628402071, 2.839134117402478, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514, 4.96927985522761, 4.326807224175258, 6.55693965598715, 11.201397710501425, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083, 9.792850354879379, 9.47681480587736, 9.87727490713292, 8.817846669592157, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374, 9.467838889623463, 3.3422982726969934, 9.566318726328603, 7.180332197681606, 7.188927826260702, 8.792128534013418, 4.358379762637738, 5.503398098021415, 5.887196888117902, 4.939583775977286, 8.294494254329775, 8.10255986654196, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274, 4.370629203467213, 11.988884848043504, 17.43897033779972, 19.705596201410756, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187, 9.397065235625584, 13.791429466112273, 10.620256987473605, 10.932309749450754, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346, 8.789387145587407, 4.78898956604222, 9.700983794277489, 6.298036855331103, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1715787197949603, "mean_inference_ms": 0.9091716277577746, "mean_action_processing_ms": 0.038427807749528385, "mean_env_wait_ms": 0.8279891193569695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 700800, "timers": {"sample_time_ms": 2745.059, "sample_throughput": 3497.192, "learn_time_ms": 2948.661, "learn_throughput": 3255.716, "update_time_ms": 1.525}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.06532221601932849, "policy_loss": -0.005525002683096222, "vf_loss": 0.04379404553849446, "vf_explained_var": 0.9290105700492859, "kl": 0.012023632414638996, "entropy": -4.191588273801302, "entropy_coeff": 0.0}}, "num_steps_sampled": 700800, "num_steps_trained": 700800}, "done": false, "episodes_total": 656, "training_iteration": 68, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-32", "timestamp": 1617649892, "time_this_iter_s": 5.968134880065918, "time_total_s": 418.05581068992615, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.3014554977417, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 48.45555555555555, "ram_util_percent": 62.599999999999994}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 25.54361062002385, "episode_reward_min": 1.86529546858254, "episode_reward_mean": 8.774987169937287, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.305625254867456, 4.353434463249639, 10.622963048142422, 7.922567697849351, 12.651196083892978, 6.403816325277014, 17.525487996313743, 7.029753015423015, 10.043692411221215, 9.899612989708038, 16.423377483419497, 11.157175440534703, 21.496395401739143, 5.37592971811322, 9.677606948229622, 10.612373021346048, 2.1540717624206756, 4.22652148462815, 2.590264879044036, 7.585720050769147, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078, 4.656663811089914, 1.86529546858254, 6.479722628402071, 2.839134117402478, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514, 4.96927985522761, 4.326807224175258, 6.55693965598715, 11.201397710501425, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083, 9.792850354879379, 9.47681480587736, 9.87727490713292, 8.817846669592157, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374, 9.467838889623463, 3.3422982726969934, 9.566318726328603, 7.180332197681606, 7.188927826260702, 8.792128534013418, 4.358379762637738, 5.503398098021415, 5.887196888117902, 4.939583775977286, 8.294494254329775, 8.10255986654196, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274, 4.370629203467213, 11.988884848043504, 17.43897033779972, 19.705596201410756, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187, 9.397065235625584, 13.791429466112273, 10.620256987473605, 10.932309749450754, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346, 8.789387145587407, 4.78898956604222, 9.700983794277489, 6.298036855331103, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235, 11.131136029687951, 5.386776138409526, 6.382209170780144, 25.54361062002385, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1742151872743022, "mean_inference_ms": 0.9153175070588618, "mean_action_processing_ms": 0.03867787451962828, "mean_env_wait_ms": 0.8320141000432901, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 710400, "timers": {"sample_time_ms": 2710.152, "sample_throughput": 3542.237, "learn_time_ms": 2959.529, "learn_throughput": 3243.76, "update_time_ms": 1.542}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.06129302680369859, "policy_loss": -0.0026677855094404596, "vf_loss": 0.04368963512150865, "vf_explained_var": 0.9416783452033997, "kl": 0.009009412514339937, "entropy": -4.1041527371657525, "entropy_coeff": 0.0}}, "num_steps_sampled": 710400, "num_steps_trained": 710400}, "done": false, "episodes_total": 672, "training_iteration": 69, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-38", "timestamp": 1617649898, "time_this_iter_s": 5.460017919540405, "time_total_s": 423.51582860946655, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 56.761473417282104, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.2625, "ram_util_percent": 62.625}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 25.54361062002385, "episode_reward_min": 1.86529546858254, "episode_reward_mean": 9.110297770499447, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.801439245946474, 9.57531315441907, 14.651537548364063, 7.294442011441534, 13.544949826488446, 13.859741568245074, 7.599469964997004, 5.860693592925513, 10.286463447447193, 6.22447856725686, 8.65052486441533, 7.584443427836078, 4.656663811089914, 1.86529546858254, 6.479722628402071, 2.839134117402478, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514, 4.96927985522761, 4.326807224175258, 6.55693965598715, 11.201397710501425, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083, 9.792850354879379, 9.47681480587736, 9.87727490713292, 8.817846669592157, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374, 9.467838889623463, 3.3422982726969934, 9.566318726328603, 7.180332197681606, 7.188927826260702, 8.792128534013418, 4.358379762637738, 5.503398098021415, 5.887196888117902, 4.939583775977286, 8.294494254329775, 8.10255986654196, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274, 4.370629203467213, 11.988884848043504, 17.43897033779972, 19.705596201410756, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187, 9.397065235625584, 13.791429466112273, 10.620256987473605, 10.932309749450754, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346, 8.789387145587407, 4.78898956604222, 9.700983794277489, 6.298036855331103, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235, 11.131136029687951, 5.386776138409526, 6.382209170780144, 25.54361062002385, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364, 7.305625254867456, 4.353434463249639, 10.622963048142422, 7.922567697849351, 12.651196083892978, 6.403816325277014, 17.525487996313743, 7.029753015423015, 10.043692411221215, 9.899612989708038, 16.423377483419497, 11.157175440534703, 21.496395401739143, 5.37592971811322, 9.677606948229622, 10.612373021346048], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1761242115711603, "mean_inference_ms": 0.9212858590995049, "mean_action_processing_ms": 0.03892529982519531, "mean_env_wait_ms": 0.8349897913066487, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 720000, "timers": {"sample_time_ms": 2682.704, "sample_throughput": 3578.479, "learn_time_ms": 2959.551, "learn_throughput": 3243.735, "update_time_ms": 1.549}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.04298198427514811, "policy_loss": -0.008988247854325126, "vf_loss": 0.029700479254518686, "vf_explained_var": 0.9508301019668579, "kl": 0.009897667625428815, "entropy": -4.189659550315455, "entropy_coeff": 0.0}}, "num_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 680, "training_iteration": 70, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-43", "timestamp": 1617649903, "time_this_iter_s": 5.19819712638855, "time_total_s": 428.7140257358551, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 61.959670543670654, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 33.67142857142857, "ram_util_percent": 62.699999999999996}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 25.54361062002385, "episode_reward_min": 1.9957794176647083, "episode_reward_mean": 9.83058437658523, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.573221374864117, 10.114289217508638, 15.139032352179754, 17.22741881631864, 19.521632768553914, 19.080614179792367, 18.552507382915493, 16.40667084887803, 5.130009048846364, 9.964778591086024, 7.469904219390802, 7.013534346989514, 4.96927985522761, 4.326807224175258, 6.55693965598715, 11.201397710501425, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083, 9.792850354879379, 9.47681480587736, 9.87727490713292, 8.817846669592157, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374, 9.467838889623463, 3.3422982726969934, 9.566318726328603, 7.180332197681606, 7.188927826260702, 8.792128534013418, 4.358379762637738, 5.503398098021415, 5.887196888117902, 4.939583775977286, 8.294494254329775, 8.10255986654196, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274, 4.370629203467213, 11.988884848043504, 17.43897033779972, 19.705596201410756, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187, 9.397065235625584, 13.791429466112273, 10.620256987473605, 10.932309749450754, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346, 8.789387145587407, 4.78898956604222, 9.700983794277489, 6.298036855331103, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235, 11.131136029687951, 5.386776138409526, 6.382209170780144, 25.54361062002385, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364, 7.305625254867456, 4.353434463249639, 10.622963048142422, 7.922567697849351, 12.651196083892978, 6.403816325277014, 17.525487996313743, 7.029753015423015, 10.043692411221215, 9.899612989708038, 16.423377483419497, 11.157175440534703, 21.496395401739143, 5.37592971811322, 9.677606948229622, 10.612373021346048, 12.801439245946474, 9.57531315441907, 14.651537548364063, 7.294442011441534, 13.544949826488446, 13.859741568245074, 7.599469964997004, 5.860693592925513], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17900569429289626, "mean_inference_ms": 0.9317754786501038, "mean_action_processing_ms": 0.03935200651524258, "mean_env_wait_ms": 0.8419066479804187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 729600, "timers": {"sample_time_ms": 2733.231, "sample_throughput": 3512.327, "learn_time_ms": 2958.139, "learn_throughput": 3245.283, "update_time_ms": 1.509}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.06603444570332373, "policy_loss": -0.0011587961919997869, "vf_loss": 0.04452992771801196, "vf_explained_var": 0.9375934600830078, "kl": 0.010072583621857981, "entropy": -4.141655244325337, "entropy_coeff": 0.0}}, "num_steps_sampled": 729600, "num_steps_trained": 729600}, "done": false, "episodes_total": 688, "training_iteration": 71, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-48", "timestamp": 1617649908, "time_this_iter_s": 5.468462705612183, "time_total_s": 434.1824884414673, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 67.42813324928284, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.074999999999996, "ram_util_percent": 62.7}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 25.54361062002385, "episode_reward_min": 1.9957794176647083, "episode_reward_mean": 10.121738921177213, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.563313906709659, 6.744486956958647, 22.630361653236363, 13.08102029020474, 10.203286597134008, 11.503831208329345, 6.466326790953986, 7.555477707875632, 10.513344890395862, 4.716923104601235, 15.175230628673944, 1.9957794176647083, 9.792850354879379, 9.47681480587736, 9.87727490713292, 8.817846669592157, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374, 9.467838889623463, 3.3422982726969934, 9.566318726328603, 7.180332197681606, 7.188927826260702, 8.792128534013418, 4.358379762637738, 5.503398098021415, 5.887196888117902, 4.939583775977286, 8.294494254329775, 8.10255986654196, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274, 4.370629203467213, 11.988884848043504, 17.43897033779972, 19.705596201410756, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187, 9.397065235625584, 13.791429466112273, 10.620256987473605, 10.932309749450754, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346, 8.789387145587407, 4.78898956604222, 9.700983794277489, 6.298036855331103, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235, 11.131136029687951, 5.386776138409526, 6.382209170780144, 25.54361062002385, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364, 7.305625254867456, 4.353434463249639, 10.622963048142422, 7.922567697849351, 12.651196083892978, 6.403816325277014, 17.525487996313743, 7.029753015423015, 10.043692411221215, 9.899612989708038, 16.423377483419497, 11.157175440534703, 21.496395401739143, 5.37592971811322, 9.677606948229622, 10.612373021346048, 12.801439245946474, 9.57531315441907, 14.651537548364063, 7.294442011441534, 13.544949826488446, 13.859741568245074, 7.599469964997004, 5.860693592925513, 4.573221374864117, 10.114289217508638, 15.139032352179754, 17.22741881631864, 19.521632768553914, 19.080614179792367, 18.552507382915493, 16.40667084887803], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18150942362752714, "mean_inference_ms": 0.9404180028914308, "mean_action_processing_ms": 0.0396811425145828, "mean_env_wait_ms": 0.848220716886756, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 739200, "timers": {"sample_time_ms": 2770.176, "sample_throughput": 3465.484, "learn_time_ms": 2897.733, "learn_throughput": 3312.935, "update_time_ms": 1.549}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.05797922918818107, "policy_loss": -0.007020314746095162, "vf_loss": 0.03676690718061046, "vf_explained_var": 0.9503490924835205, "kl": 0.012547839638826094, "entropy": -4.356906002446225, "entropy_coeff": 0.0}}, "num_steps_sampled": 739200, "num_steps_trained": 739200}, "done": false, "episodes_total": 696, "training_iteration": 72, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-11-54", "timestamp": 1617649914, "time_this_iter_s": 5.92246413230896, "time_total_s": 440.10495257377625, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 73.3505973815918, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 51.325, "ram_util_percent": 62.7}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 25.54361062002385, "episode_reward_min": 3.3422982726969934, "episode_reward_mean": 10.276438314429608, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.685547544434673, 5.5903931196076755, 8.651378390567286, 10.262557053578186, 13.909458703660205, 13.556784680626976, 12.238069928930107, 10.94181468265201, 4.050408039902747, 11.165432816473519, 5.753452507652408, 10.316762609897374, 9.467838889623463, 3.3422982726969934, 9.566318726328603, 7.180332197681606, 7.188927826260702, 8.792128534013418, 4.358379762637738, 5.503398098021415, 5.887196888117902, 4.939583775977286, 8.294494254329775, 8.10255986654196, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274, 4.370629203467213, 11.988884848043504, 17.43897033779972, 19.705596201410756, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187, 9.397065235625584, 13.791429466112273, 10.620256987473605, 10.932309749450754, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346, 8.789387145587407, 4.78898956604222, 9.700983794277489, 6.298036855331103, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235, 11.131136029687951, 5.386776138409526, 6.382209170780144, 25.54361062002385, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364, 7.305625254867456, 4.353434463249639, 10.622963048142422, 7.922567697849351, 12.651196083892978, 6.403816325277014, 17.525487996313743, 7.029753015423015, 10.043692411221215, 9.899612989708038, 16.423377483419497, 11.157175440534703, 21.496395401739143, 5.37592971811322, 9.677606948229622, 10.612373021346048, 12.801439245946474, 9.57531315441907, 14.651537548364063, 7.294442011441534, 13.544949826488446, 13.859741568245074, 7.599469964997004, 5.860693592925513, 4.573221374864117, 10.114289217508638, 15.139032352179754, 17.22741881631864, 19.521632768553914, 19.080614179792367, 18.552507382915493, 16.40667084887803, 7.563313906709659, 6.744486956958647, 22.630361653236363, 13.08102029020474, 10.203286597134008, 11.503831208329345, 6.466326790953986, 7.555477707875632], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18298399664672413, "mean_inference_ms": 0.9438501502891533, "mean_action_processing_ms": 0.03977807976279426, "mean_env_wait_ms": 0.8496947624951489, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 748800, "timers": {"sample_time_ms": 2676.121, "sample_throughput": 3587.281, "learn_time_ms": 2928.232, "learn_throughput": 3278.429, "update_time_ms": 1.519}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.06262910829268788, "policy_loss": -0.006444682330383282, "vf_loss": 0.04167461908961597, "vf_explained_var": 0.9639875888824463, "kl": 0.012177409226761053, "entropy": -4.328690890262002, "entropy_coeff": 0.0}}, "num_steps_sampled": 748800, "num_steps_trained": 748800}, "done": false, "episodes_total": 704, "training_iteration": 73, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-12-00", "timestamp": 1617649920, "time_this_iter_s": 5.3342249393463135, "time_total_s": 445.43917751312256, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 78.68482232093811, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 39.4125, "ram_util_percent": 62.7375}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 25.54361062002385, "episode_reward_min": 4.254287841438904, "episode_reward_mean": 11.055701448224967, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.55694642055132, 16.228064566351605, 10.445759352179829, 12.49922137085454, 8.068552520669108, 11.833046986662964, 7.931655311878432, 8.764231429595556, 9.6068256047368, 10.436690314028846, 22.222096923215855, 22.495099530407202, 8.367049656024234, 14.072299447322287, 9.44826925684852, 6.860017754365609, 7.984522977541671, 9.060585635141297, 4.254287841438904, 9.804719197858274, 4.370629203467213, 11.988884848043504, 17.43897033779972, 19.705596201410756, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187, 9.397065235625584, 13.791429466112273, 10.620256987473605, 10.932309749450754, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346, 8.789387145587407, 4.78898956604222, 9.700983794277489, 6.298036855331103, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235, 11.131136029687951, 5.386776138409526, 6.382209170780144, 25.54361062002385, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364, 7.305625254867456, 4.353434463249639, 10.622963048142422, 7.922567697849351, 12.651196083892978, 6.403816325277014, 17.525487996313743, 7.029753015423015, 10.043692411221215, 9.899612989708038, 16.423377483419497, 11.157175440534703, 21.496395401739143, 5.37592971811322, 9.677606948229622, 10.612373021346048, 12.801439245946474, 9.57531315441907, 14.651537548364063, 7.294442011441534, 13.544949826488446, 13.859741568245074, 7.599469964997004, 5.860693592925513, 4.573221374864117, 10.114289217508638, 15.139032352179754, 17.22741881631864, 19.521632768553914, 19.080614179792367, 18.552507382915493, 16.40667084887803, 7.563313906709659, 6.744486956958647, 22.630361653236363, 13.08102029020474, 10.203286597134008, 11.503831208329345, 6.466326790953986, 7.555477707875632, 10.685547544434673, 5.5903931196076755, 8.651378390567286, 10.262557053578186, 13.909458703660205, 13.556784680626976, 12.238069928930107, 10.94181468265201], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18415133814183846, "mean_inference_ms": 0.9442462990478769, "mean_action_processing_ms": 0.03983316971023399, "mean_env_wait_ms": 0.8499182220579219, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 758400, "timers": {"sample_time_ms": 2658.59, "sample_throughput": 3610.937, "learn_time_ms": 2874.058, "learn_throughput": 3340.225, "update_time_ms": 1.528}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.0736690718521315, "policy_loss": -0.0026974477878722704, "vf_loss": 0.049494967697874495, "vf_explained_var": 0.9581961631774902, "kl": 0.011942912564661942, "entropy": -4.126078216653121, "entropy_coeff": 0.0}}, "num_steps_sampled": 758400, "num_steps_trained": 758400}, "done": false, "episodes_total": 720, "training_iteration": 74, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-12-05", "timestamp": 1617649925, "time_this_iter_s": 5.286675453186035, "time_total_s": 450.7258529663086, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 83.97149777412415, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 35.2625, "ram_util_percent": 62.725}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 25.54361062002385, "episode_reward_min": 4.353434463249639, "episode_reward_mean": 11.214058768610068, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.616604444630552, 16.005047033455167, 9.731264018419933, 17.59584305003437, 5.944042294313388, 7.931753761058928, 21.883421367877126, 7.735952311421892, 6.437694907562747, 15.948958419578872, 6.008418709584664, 6.327535824369187, 9.397065235625584, 13.791429466112273, 10.620256987473605, 10.932309749450754, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346, 8.789387145587407, 4.78898956604222, 9.700983794277489, 6.298036855331103, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235, 11.131136029687951, 5.386776138409526, 6.382209170780144, 25.54361062002385, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364, 7.305625254867456, 4.353434463249639, 10.622963048142422, 7.922567697849351, 12.651196083892978, 6.403816325277014, 17.525487996313743, 7.029753015423015, 10.043692411221215, 9.899612989708038, 16.423377483419497, 11.157175440534703, 21.496395401739143, 5.37592971811322, 9.677606948229622, 10.612373021346048, 12.801439245946474, 9.57531315441907, 14.651537548364063, 7.294442011441534, 13.544949826488446, 13.859741568245074, 7.599469964997004, 5.860693592925513, 4.573221374864117, 10.114289217508638, 15.139032352179754, 17.22741881631864, 19.521632768553914, 19.080614179792367, 18.552507382915493, 16.40667084887803, 7.563313906709659, 6.744486956958647, 22.630361653236363, 13.08102029020474, 10.203286597134008, 11.503831208329345, 6.466326790953986, 7.555477707875632, 10.685547544434673, 5.5903931196076755, 8.651378390567286, 10.262557053578186, 13.909458703660205, 13.556784680626976, 12.238069928930107, 10.94181468265201, 12.55694642055132, 16.228064566351605, 10.445759352179829, 12.49922137085454, 8.068552520669108, 11.833046986662964, 7.931655311878432, 8.764231429595556, 9.6068256047368, 10.436690314028846, 22.222096923215855, 22.495099530407202, 8.367049656024234, 14.072299447322287, 9.44826925684852, 6.860017754365609], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18417072577318452, "mean_inference_ms": 0.9426890764065391, "mean_action_processing_ms": 0.03980660949381039, "mean_env_wait_ms": 0.8490388787213858, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 768000, "timers": {"sample_time_ms": 2636.879, "sample_throughput": 3640.667, "learn_time_ms": 2830.009, "learn_throughput": 3392.215, "update_time_ms": 1.51}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.06134350686579158, "policy_loss": -0.002477363282263181, "vf_loss": 0.03916785890530599, "vf_explained_var": 0.9598469138145447, "kl": 0.010956895008291069, "entropy": -4.218088069714998, "entropy_coeff": 0.0}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 728, "training_iteration": 75, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-12-11", "timestamp": 1617649931, "time_this_iter_s": 5.574622869491577, "time_total_s": 456.30047583580017, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 89.54612064361572, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 44.137499999999996, "ram_util_percent": 62.787499999999994}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 25.54361062002385, "episode_reward_min": 4.353434463249639, "episode_reward_mean": 11.473294808159535, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.302074107188258, 10.451307282269637, 11.725890227378898, 15.337012109125595, 8.697104071630587, 6.872968221776708, 17.837907003561913, 18.163010231772645, 12.478672521594342, 12.969609793823762, 6.747096192907632, 5.75406418004346, 8.789387145587407, 4.78898956604222, 9.700983794277489, 6.298036855331103, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235, 11.131136029687951, 5.386776138409526, 6.382209170780144, 25.54361062002385, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364, 7.305625254867456, 4.353434463249639, 10.622963048142422, 7.922567697849351, 12.651196083892978, 6.403816325277014, 17.525487996313743, 7.029753015423015, 10.043692411221215, 9.899612989708038, 16.423377483419497, 11.157175440534703, 21.496395401739143, 5.37592971811322, 9.677606948229622, 10.612373021346048, 12.801439245946474, 9.57531315441907, 14.651537548364063, 7.294442011441534, 13.544949826488446, 13.859741568245074, 7.599469964997004, 5.860693592925513, 4.573221374864117, 10.114289217508638, 15.139032352179754, 17.22741881631864, 19.521632768553914, 19.080614179792367, 18.552507382915493, 16.40667084887803, 7.563313906709659, 6.744486956958647, 22.630361653236363, 13.08102029020474, 10.203286597134008, 11.503831208329345, 6.466326790953986, 7.555477707875632, 10.685547544434673, 5.5903931196076755, 8.651378390567286, 10.262557053578186, 13.909458703660205, 13.556784680626976, 12.238069928930107, 10.94181468265201, 12.55694642055132, 16.228064566351605, 10.445759352179829, 12.49922137085454, 8.068552520669108, 11.833046986662964, 7.931655311878432, 8.764231429595556, 9.6068256047368, 10.436690314028846, 22.222096923215855, 22.495099530407202, 8.367049656024234, 14.072299447322287, 9.44826925684852, 6.860017754365609, 13.616604444630552, 16.005047033455167, 9.731264018419933, 17.59584305003437, 5.944042294313388, 7.931753761058928, 21.883421367877126, 7.735952311421892], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18429976894575475, "mean_inference_ms": 0.9417949775337904, "mean_action_processing_ms": 0.039794255663760374, "mean_env_wait_ms": 0.848521110046673, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 777600, "timers": {"sample_time_ms": 2709.162, "sample_throughput": 3543.531, "learn_time_ms": 2809.397, "learn_throughput": 3417.103, "update_time_ms": 1.536}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.06428877351021296, "policy_loss": -0.0029274026771370126, "vf_loss": 0.0342323726337207, "vf_explained_var": 0.9649689793586731, "kl": 0.014659467388532663, "entropy": -4.16433108982287, "entropy_coeff": 0.0}}, "num_steps_sampled": 777600, "num_steps_trained": 777600}, "done": false, "episodes_total": 736, "training_iteration": 76, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-12-16", "timestamp": 1617649936, "time_this_iter_s": 5.727922439575195, "time_total_s": 462.02839827537537, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 95.27404308319092, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 48.875, "ram_util_percent": 62.7}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 26.19827605094061, "episode_reward_min": 4.353434463249639, "episode_reward_mean": 12.160837606234226, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.532786541277915, 7.0121539668977135, 24.91457811449434, 26.19827605094061, 10.29286046478025, 16.4543604172598, 18.33509566213534, 12.541008639290787, 21.85132884105995, 8.243642686052636, 11.340344115120194, 9.942234465260235, 11.131136029687951, 5.386776138409526, 6.382209170780144, 25.54361062002385, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364, 7.305625254867456, 4.353434463249639, 10.622963048142422, 7.922567697849351, 12.651196083892978, 6.403816325277014, 17.525487996313743, 7.029753015423015, 10.043692411221215, 9.899612989708038, 16.423377483419497, 11.157175440534703, 21.496395401739143, 5.37592971811322, 9.677606948229622, 10.612373021346048, 12.801439245946474, 9.57531315441907, 14.651537548364063, 7.294442011441534, 13.544949826488446, 13.859741568245074, 7.599469964997004, 5.860693592925513, 4.573221374864117, 10.114289217508638, 15.139032352179754, 17.22741881631864, 19.521632768553914, 19.080614179792367, 18.552507382915493, 16.40667084887803, 7.563313906709659, 6.744486956958647, 22.630361653236363, 13.08102029020474, 10.203286597134008, 11.503831208329345, 6.466326790953986, 7.555477707875632, 10.685547544434673, 5.5903931196076755, 8.651378390567286, 10.262557053578186, 13.909458703660205, 13.556784680626976, 12.238069928930107, 10.94181468265201, 12.55694642055132, 16.228064566351605, 10.445759352179829, 12.49922137085454, 8.068552520669108, 11.833046986662964, 7.931655311878432, 8.764231429595556, 9.6068256047368, 10.436690314028846, 22.222096923215855, 22.495099530407202, 8.367049656024234, 14.072299447322287, 9.44826925684852, 6.860017754365609, 13.616604444630552, 16.005047033455167, 9.731264018419933, 17.59584305003437, 5.944042294313388, 7.931753761058928, 21.883421367877126, 7.735952311421892, 16.302074107188258, 10.451307282269637, 11.725890227378898, 15.337012109125595, 8.697104071630587, 6.872968221776708, 17.837907003561913, 18.163010231772645], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18456759203616704, "mean_inference_ms": 0.9411532702740469, "mean_action_processing_ms": 0.0397893018889099, "mean_env_wait_ms": 0.8481987267436643, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 787200, "timers": {"sample_time_ms": 2659.116, "sample_throughput": 3610.222, "learn_time_ms": 2852.632, "learn_throughput": 3365.313, "update_time_ms": 1.543}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.06611307347315903, "policy_loss": -0.005182488531021303, "vf_loss": 0.05008376985788345, "vf_explained_var": 0.955470860004425, "kl": 0.009427462523116877, "entropy": -4.411481606332879, "entropy_coeff": 0.0}}, "num_steps_sampled": 787200, "num_steps_trained": 787200}, "done": false, "episodes_total": 744, "training_iteration": 77, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-12-22", "timestamp": 1617649942, "time_this_iter_s": 5.242467880249023, "time_total_s": 467.2708661556244, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 100.51651096343994, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.3, "ram_util_percent": 62.657142857142865}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 26.19827605094061, "episode_reward_min": 4.353434463249639, "episode_reward_mean": 11.870826463337462, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.442298644311476, 8.260082571482082, 7.865933831422167, 6.880844968860874, 6.392466876152218, 14.200632742217874, 9.681623316338701, 9.09628482593275, 7.658019563561586, 9.529154896729, 8.223978452326493, 11.015087437101364, 7.305625254867456, 4.353434463249639, 10.622963048142422, 7.922567697849351, 12.651196083892978, 6.403816325277014, 17.525487996313743, 7.029753015423015, 10.043692411221215, 9.899612989708038, 16.423377483419497, 11.157175440534703, 21.496395401739143, 5.37592971811322, 9.677606948229622, 10.612373021346048, 12.801439245946474, 9.57531315441907, 14.651537548364063, 7.294442011441534, 13.544949826488446, 13.859741568245074, 7.599469964997004, 5.860693592925513, 4.573221374864117, 10.114289217508638, 15.139032352179754, 17.22741881631864, 19.521632768553914, 19.080614179792367, 18.552507382915493, 16.40667084887803, 7.563313906709659, 6.744486956958647, 22.630361653236363, 13.08102029020474, 10.203286597134008, 11.503831208329345, 6.466326790953986, 7.555477707875632, 10.685547544434673, 5.5903931196076755, 8.651378390567286, 10.262557053578186, 13.909458703660205, 13.556784680626976, 12.238069928930107, 10.94181468265201, 12.55694642055132, 16.228064566351605, 10.445759352179829, 12.49922137085454, 8.068552520669108, 11.833046986662964, 7.931655311878432, 8.764231429595556, 9.6068256047368, 10.436690314028846, 22.222096923215855, 22.495099530407202, 8.367049656024234, 14.072299447322287, 9.44826925684852, 6.860017754365609, 13.616604444630552, 16.005047033455167, 9.731264018419933, 17.59584305003437, 5.944042294313388, 7.931753761058928, 21.883421367877126, 7.735952311421892, 16.302074107188258, 10.451307282269637, 11.725890227378898, 15.337012109125595, 8.697104071630587, 6.872968221776708, 17.837907003561913, 18.163010231772645, 20.532786541277915, 7.0121539668977135, 24.91457811449434, 26.19827605094061, 10.29286046478025, 16.4543604172598, 18.33509566213534, 12.541008639290787], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1845788247268858, "mean_inference_ms": 0.9394299777008913, "mean_action_processing_ms": 0.039735546151454144, "mean_env_wait_ms": 0.8467447158481716, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 796800, "timers": {"sample_time_ms": 2573.796, "sample_throughput": 3729.9, "learn_time_ms": 2848.393, "learn_throughput": 3370.321, "update_time_ms": 1.537}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.25, "cur_lr": 0.01, "total_loss": 0.053727938885812794, "policy_loss": -0.007419409089427637, "vf_loss": 0.035131949593165984, "vf_explained_var": 0.9769250750541687, "kl": 0.011562399252464897, "entropy": -4.4278639291462145, "entropy_coeff": 0.0}}, "num_steps_sampled": 796800, "num_steps_trained": 796800}, "done": false, "episodes_total": 752, "training_iteration": 78, "experiment_id": "71cc1f3112f641b8bf4ec1257d35413a", "date": "2021-04-05_12-12-27", "timestamp": 1617649947, "time_this_iter_s": 5.072247505187988, "time_total_s": 472.3431136608124, "pid": 25983, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9337, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 10, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.01, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7780636990778561, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.33873425784529854, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 105.58875846862793, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 35.875, "ram_util_percent": 62.6875}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 51.46199874977428, "episode_reward_min": 5.206528943594461, "episode_reward_mean": 16.76004077924104, "episode_len_mean": 1000.0, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.41260699331387, 21.752457664067343, 36.13424078530576, 9.243764328225177, 12.706329705486274, 21.39968270753896, 24.12878423957605, 23.630712274324573, 12.500283033452265, 20.299587103190788, 12.197273694592509, 9.530073503435757, 9.835924606953384, 6.159314463741925, 23.130048322168946, 19.408859140276466, 6.851954593464275, 26.390732161728312, 16.606845251865018, 15.91954075809074, 13.20624593009579, 19.94862867611133, 9.269818529634566, 5.843652333739678, 25.294379238251516, 22.902652824646076, 6.4984324406249385, 11.631738417388924, 25.26830165212015, 10.437266451005636, 21.601894179670076, 11.41966267292459, 25.43294052579113, 15.615978895132098, 14.509805754174382, 20.34509710861396, 13.079179246832538, 12.9621095815381, 20.284021383332774, 18.40438463767787, 24.199223964193745, 8.722638414214721, 14.229525562276653, 27.80229076685987, 9.072734179022154, 9.194017051422119, 11.117816319793553, 18.730925540878687, 11.447320113243093, 10.631321237279726, 7.307495153400611, 24.982653226789406, 8.412685338153558, 11.466109140848085, 11.006762208686709, 29.182093285916437, 34.27853546351247, 14.748867586602293, 17.316394072599866, 14.547983043740103, 51.46199874977428, 8.410770317706175, 12.80659839766181, 24.362844073446983, 15.576477148898164, 16.454450047501254, 8.872812845563883, 13.642616714644985, 20.80310612680585, 15.76676670428834, 13.274316490891165, 17.887477388026387, 9.959522354183811, 30.921646264309942, 14.126827853279318, 20.651817681306998, 23.198616317894466, 24.83739373717769, 20.781375131083006, 22.83697672755926, 10.609304414779132, 27.8022614561958, 20.28446768457064, 14.362471572238302, 12.275136216043423, 10.842398208532659, 17.014671551246476, 10.223291303312651, 24.713289852137464, 12.92092989185752, 18.70621492427296, 21.23484980741816, 21.637476956009777, 12.896365433363437, 18.035330486938033, 16.934984845591668, 12.789630918538922, 10.53728568832685, 12.36361795602672, 9.537990741243384, 14.185333832143597, 13.938720830245291, 15.876774137048933, 16.954933663037316, 18.173643524297738, 11.596266610512373, 16.45280849865736, 18.22027829297666, 16.30079626434791, 5.206528943594461, 10.102173838585912, 25.1673303793628], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18775093217982075, "mean_inference_ms": 0.940881273358442, "mean_action_processing_ms": 0.03925477698899372, "mean_env_wait_ms": 0.859615565328918, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 848000, "timers": {"sample_time_ms": 33949.966, "sample_throughput": 3487.485, "learn_time_ms": 33867.01, "learn_throughput": 3496.028, "update_time_ms": 1.804}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 5.000000000000001e-05, "total_loss": 1.6089888119379966e+23, "policy_loss": 0.04380627609780974, "vf_loss": 1.6089888119379966e+23, "vf_explained_var": -1.0267811600961352e-10, "kl": 0.3741270154072846, "entropy": -3.794962649505576, "entropy_coeff": 0.0}}, "num_steps_sampled": 848000, "num_steps_trained": 848000}, "done": false, "episodes_total": 824, "training_iteration": 58, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-13-41", "timestamp": 1617650021, "time_this_iter_s": 67.82517671585083, "time_total_s": 507.88195538520813, "pid": 26647, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 118179, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.1736998939402141, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15522515826421804, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 67.82517671585083, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.649484536082475, "ram_util_percent": 63.02783505154638}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 23.6735404773962, "episode_reward_min": 1.0940265096411728, "episode_reward_mean": 4.884344277435522, "episode_len_mean": 1000.0, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.003104243694697, 5.358713903122666, 7.108056555836354, 1.650241083029948, 1.8383624119275495, 6.304993858843379, 2.196261325923571, 2.4005743415851963, 3.033100376284679, 6.072923740772745, 8.652470863988839, 3.1893212036492287, 1.8597595667821323, 2.929065984452802, 3.0739735306564393, 9.342245841919187, 2.0626420456450854, 6.0524944423581815, 2.7005474651393753, 3.0391928313888172, 4.311016221352076, 3.3082709401415915, 1.9240473149559683, 1.7657023834624366, 3.7495390011490066, 2.234647843900057, 3.872103309039816, 3.8027829702759925, 4.345617944585056, 2.590005215283324, 8.31425586349613, 4.4480967201482216, 4.37072153260569, 6.7828962917939295, 5.048014382235812, 1.0940265096411728, 4.526840534471858, 3.394396801832542, 3.391366076651666, 6.576885953658196, 3.114676514611036, 8.517681709420597, 3.978274494059307, 6.140152850417254, 6.776161321452222, 23.6735404773962, 7.198887529815165, 1.2058893300204843, 6.384511770911535, 9.9039436321154, 2.0652010509165186, 10.206536252245009, 3.175812349410581, 5.689172582706327, 3.183053481142027, 6.623038742640138, 5.113679812221562, 3.6583080118131077, 1.81819663665887, 8.766991517835148, 7.947352858368154, 6.568574903374363, 10.235909498368446, 3.210716224712039, 3.0057980980672614, 5.174891831501717, 4.032860473621519, 2.1837215282793103, 4.059354827465159, 4.449496969293773, 6.8354550227460384, 7.9264365780423685, 2.1294166604557874, 3.3175671626019607, 4.541086939323602, 3.617492822870509, 5.478671716203242, 9.289252378291467, 4.919764307953703, 5.31387769767242, 8.52997620159674, 4.448029137760008, 7.835910578093493, 3.539473946173371, 2.256438147760985, 3.6789850722674755, 3.339768408193703, 4.8353783408558675, 6.730697864686066, 4.8943722923688595, 11.104691727978876, 6.6594178103452295, 3.285472303611404, 5.091092675458867, 8.710139924349885, 3.1130131987657155, 4.32009657612851, 2.454589795844913, 3.1018496124457826, 2.8049729181707588, 3.6893450931639187, 6.880815106328639, 5.235874625378091, 3.4698005990582974, 4.544763613727137, 6.993892866023984, 2.713437200234908, 1.5828213445724577, 4.046020371463117, 2.8083178940325735, 1.4590342244056802, 1.853838546873245, 5.3082608681937185, 3.3972643728947096, 6.605715492708923, 4.839706304319688, 7.723398922480717, 4.419697730026514, 3.3956924773526183, 4.2685611114645], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19081801197213993, "mean_inference_ms": 0.9471213534483937, "mean_action_processing_ms": 0.03983860507027039, "mean_env_wait_ms": 0.868520625221307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 966400, "timers": {"sample_time_ms": 34058.396, "sample_throughput": 3476.382, "learn_time_ms": 34784.251, "learn_throughput": 3403.839, "update_time_ms": 1.665}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5, "cur_lr": 5.000000000000001e-05, "total_loss": 2.026480117349057e+26, "policy_loss": 0.0058730179793323595, "vf_loss": 2.026480117349057e+26, "vf_explained_var": 0.0, "kl": 0.06374431001688262, "entropy": -3.7874819973642513, "entropy_coeff": 0.0}}, "num_steps_sampled": 966400, "num_steps_trained": 966400}, "done": false, "episodes_total": 944, "training_iteration": 59, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-14-51", "timestamp": 1617650091, "time_this_iter_s": 69.90329623222351, "time_total_s": 577.7852516174316, "pid": 26647, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 118179, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.1736998939402141, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15522515826421804, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 137.72847294807434, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.26000000000001, "ram_util_percent": 64.53299999999999}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 40.783147532162836, "episode_reward_min": 13.707680810441948, "episode_reward_mean": 24.478762587058036, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.89024734874771, 34.92804928942235, 24.993187597116002, 21.044862615333415, 30.112509501031393, 40.783147532162836, 23.736048060154488, 26.198391075493102, 19.596776084701983, 16.97610597201695, 17.138112455811832, 39.52634767640931, 15.070056311229216, 19.752826275786862, 17.205852787069222, 13.707680810441948], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17631147754960869, "mean_inference_ms": 0.922646375372075, "mean_action_processing_ms": 0.039251684129744516, "mean_env_wait_ms": 0.8947272737999667, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 937600, "timers": {"sample_time_ms": 5152.911, "sample_throughput": 3105.041, "learn_time_ms": 418.61, "learn_throughput": 38221.725, "update_time_ms": 1.722}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 1e-05, "total_loss": 0.2019619271159172, "policy_loss": -0.014645123621448874, "vf_loss": 0.21057043969631195, "vf_explained_var": 0.9726682901382446, "kl": 0.006036604521796107, "entropy": -4.233855247497559, "entropy_coeff": 0.0}}, "num_steps_sampled": 937600, "num_steps_trained": 937600}, "done": false, "episodes_total": 920, "training_iteration": 73, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-02", "timestamp": 1617650102, "time_this_iter_s": 5.576062917709351, "time_total_s": 559.3783922195435, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.576062917709351, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 58.400000000000006, "ram_util_percent": 63.587500000000006}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 56.06190842362657, "episode_reward_min": 13.204166038298338, "episode_reward_mean": 26.911753010839988, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.96960389369681, 16.671433110205566, 42.57794332897669, 13.204166038298338, 17.298527068823127, 20.653579348364314, 24.87172705017462, 20.714954391515004, 27.69642857713013, 56.06190842362657, 38.64675416078532, 24.24680800077977, 17.74421057579088, 31.659521993220423, 48.674243498425156, 17.82408549413834, 30.89024734874771, 34.92804928942235, 24.993187597116002, 21.044862615333415, 30.112509501031393, 40.783147532162836, 23.736048060154488, 26.198391075493102, 19.596776084701983, 16.97610597201695, 17.138112455811832, 39.52634767640931, 15.070056311229216, 19.752826275786862, 17.205852787069222, 13.707680810441948], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18602422659841272, "mean_inference_ms": 0.9301577742895639, "mean_action_processing_ms": 0.03957452301215863, "mean_env_wait_ms": 0.8906885863666382, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 953600, "timers": {"sample_time_ms": 4862.967, "sample_throughput": 3290.173, "learn_time_ms": 458.423, "learn_throughput": 34902.289, "update_time_ms": 1.534}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 1e-05, "total_loss": 0.3270573168992996, "policy_loss": -0.004654204240068793, "vf_loss": 0.3316973149776459, "vf_explained_var": 0.9587031602859497, "kl": 1.4238936273613945e-05, "entropy": -4.230114698410034, "entropy_coeff": 0.0}}, "num_steps_sampled": 953600, "num_steps_trained": 953600}, "done": false, "episodes_total": 936, "training_iteration": 74, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-07", "timestamp": 1617650107, "time_this_iter_s": 5.079290151596069, "time_total_s": 564.4576823711395, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.65535306930542, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 56.97500000000001, "ram_util_percent": 63.875}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 56.06190842362657, "episode_reward_min": 13.204166038298338, "episode_reward_mean": 27.13170255121101, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.51482905652621, 32.300268823359254, 21.537531782400535, 34.87861790472148, 25.602833016655403, 23.682780934673268, 41.86915899198772, 47.6056622123781, 13.549136238152107, 20.337997213993226, 17.474737812925184, 14.208860505415714, 49.812545582158, 15.788785116216655, 18.301508916879946, 30.68037200280607, 30.89024734874771, 34.92804928942235, 24.993187597116002, 21.044862615333415, 30.112509501031393, 40.783147532162836, 23.736048060154488, 26.198391075493102, 19.596776084701983, 16.97610597201695, 17.138112455811832, 39.52634767640931, 15.070056311229216, 19.752826275786862, 17.205852787069222, 13.707680810441948, 50.96960389369681, 16.671433110205566, 42.57794332897669, 13.204166038298338, 17.298527068823127, 20.653579348364314, 24.87172705017462, 20.714954391515004, 27.69642857713013, 56.06190842362657, 38.64675416078532, 24.24680800077977, 17.74421057579088, 31.659521993220423, 48.674243498425156, 17.82408549413834], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18612724183975474, "mean_inference_ms": 0.9283120140840039, "mean_action_processing_ms": 0.03910442047244427, "mean_env_wait_ms": 0.8732155836181991, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 969600, "timers": {"sample_time_ms": 4611.856, "sample_throughput": 3469.319, "learn_time_ms": 442.563, "learn_throughput": 36153.027, "update_time_ms": 1.507}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 1e-05, "total_loss": 0.31055548787117004, "policy_loss": -0.002621654188260436, "vf_loss": 0.31316356360912323, "vf_explained_var": 0.9604690074920654, "kl": 2.716345352382632e-05, "entropy": -4.227431535720825, "entropy_coeff": 0.0}}, "num_steps_sampled": 969600, "num_steps_trained": 969600}, "done": false, "episodes_total": 952, "training_iteration": 75, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-12", "timestamp": 1617650112, "time_this_iter_s": 4.528166770935059, "time_total_s": 568.9858491420746, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.183519840240479, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.68333333333334, "ram_util_percent": 63.98333333333333}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 56.06190842362657, "episode_reward_min": 13.204166038298338, "episode_reward_mean": 27.5744634282413, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.151736937930915, 17.22684379572361, 36.47795191353757, 21.500629531834136, 24.709196409500905, 39.2488655365856, 48.881635438555705, 22.308865040215263, 32.82990323876815, 35.39132600923114, 19.987970884811585, 28.226965274379218, 23.219717180712358, 42.163279725153494, 24.16997825493088, 31.94907177744441, 30.89024734874771, 34.92804928942235, 24.993187597116002, 21.044862615333415, 30.112509501031393, 40.783147532162836, 23.736048060154488, 26.198391075493102, 19.596776084701983, 16.97610597201695, 17.138112455811832, 39.52634767640931, 15.070056311229216, 19.752826275786862, 17.205852787069222, 13.707680810441948, 50.96960389369681, 16.671433110205566, 42.57794332897669, 13.204166038298338, 17.298527068823127, 20.653579348364314, 24.87172705017462, 20.714954391515004, 27.69642857713013, 56.06190842362657, 38.64675416078532, 24.24680800077977, 17.74421057579088, 31.659521993220423, 48.674243498425156, 17.82408549413834, 33.51482905652621, 32.300268823359254, 21.537531782400535, 34.87861790472148, 25.602833016655403, 23.682780934673268, 41.86915899198772, 47.6056622123781, 13.549136238152107, 20.337997213993226, 17.474737812925184, 14.208860505415714, 49.812545582158, 15.788785116216655, 18.301508916879946, 30.68037200280607], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18765090053523192, "mean_inference_ms": 0.9347372260625, "mean_action_processing_ms": 0.039255398728729005, "mean_env_wait_ms": 0.8727907518778009, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 985600, "timers": {"sample_time_ms": 4745.353, "sample_throughput": 3371.72, "learn_time_ms": 434.848, "learn_throughput": 36794.495, "update_time_ms": 1.542}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 1e-05, "total_loss": 0.32033534348011017, "policy_loss": -0.0006323716806946322, "vf_loss": 0.3209601491689682, "vf_explained_var": 0.958985447883606, "kl": 3.029815616173437e-05, "entropy": -4.2506020069122314, "entropy_coeff": 0.0}}, "num_steps_sampled": 985600, "num_steps_trained": 985600}, "done": false, "episodes_total": 968, "training_iteration": 76, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-17", "timestamp": 1617650117, "time_this_iter_s": 5.564772844314575, "time_total_s": 574.5506219863892, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.748292684555054, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 62.974999999999994, "ram_util_percent": 63.9}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 56.06190842362657, "episode_reward_min": 12.244990228268493, "episode_reward_mean": 27.139739581498826, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.939927541084696, 45.17923408927185, 16.49066797673272, 26.01242860255257, 21.702474652728885, 28.594311838409702, 40.938609745063054, 30.953278916435952, 12.244990228268493, 18.385060959050033, 23.092954030620277, 18.83476849849793, 22.08384385675995, 30.544864884110957, 21.166524960133394, 26.249566332742056, 30.89024734874771, 34.92804928942235, 24.993187597116002, 21.044862615333415, 30.112509501031393, 40.783147532162836, 23.736048060154488, 26.198391075493102, 19.596776084701983, 16.97610597201695, 17.138112455811832, 39.52634767640931, 15.070056311229216, 19.752826275786862, 17.205852787069222, 13.707680810441948, 50.96960389369681, 16.671433110205566, 42.57794332897669, 13.204166038298338, 17.298527068823127, 20.653579348364314, 24.87172705017462, 20.714954391515004, 27.69642857713013, 56.06190842362657, 38.64675416078532, 24.24680800077977, 17.74421057579088, 31.659521993220423, 48.674243498425156, 17.82408549413834, 33.51482905652621, 32.300268823359254, 21.537531782400535, 34.87861790472148, 25.602833016655403, 23.682780934673268, 41.86915899198772, 47.6056622123781, 13.549136238152107, 20.337997213993226, 17.474737812925184, 14.208860505415714, 49.812545582158, 15.788785116216655, 18.301508916879946, 30.68037200280607, 14.151736937930915, 17.22684379572361, 36.47795191353757, 21.500629531834136, 24.709196409500905, 39.2488655365856, 48.881635438555705, 22.308865040215263, 32.82990323876815, 35.39132600923114, 19.987970884811585, 28.226965274379218, 23.219717180712358, 42.163279725153494, 24.16997825493088, 31.94907177744441], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18824253886348372, "mean_inference_ms": 0.934511202535079, "mean_action_processing_ms": 0.03919671770541412, "mean_env_wait_ms": 0.8685927508320038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1001600, "timers": {"sample_time_ms": 4623.334, "sample_throughput": 3460.706, "learn_time_ms": 440.452, "learn_throughput": 36326.319, "update_time_ms": 1.536}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 1e-05, "total_loss": 0.2068667709827423, "policy_loss": -0.0027962070889770985, "vf_loss": 0.209657721221447, "vf_explained_var": 0.9717060327529907, "kl": 4.2065952584380284e-05, "entropy": -4.2369019985198975, "entropy_coeff": 0.0}}, "num_steps_sampled": 1001600, "num_steps_trained": 1001600}, "done": false, "episodes_total": 984, "training_iteration": 77, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-22", "timestamp": 1617650122, "time_this_iter_s": 4.606585264205933, "time_total_s": 579.1572072505951, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.354877948760986, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 46.91428571428571, "ram_util_percent": 64.02857142857142}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 63.26484080361047, "episode_reward_min": 11.305334714630442, "episode_reward_mean": 27.103117723351943, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.484260487308912, 24.6644340094271, 11.305334714630442, 63.26484080361047, 36.32387071895736, 12.690960796759049, 42.10482021541447, 36.82752287294265, 18.0417911284361, 18.701927474145926, 18.337926268460848, 44.04797777006195, 21.40979975386908, 21.45349481551182, 19.278589006080452, 15.782584086264592, 30.89024734874771, 34.92804928942235, 24.993187597116002, 21.044862615333415, 30.112509501031393, 40.783147532162836, 23.736048060154488, 26.198391075493102, 19.596776084701983, 16.97610597201695, 17.138112455811832, 39.52634767640931, 15.070056311229216, 19.752826275786862, 17.205852787069222, 13.707680810441948, 50.96960389369681, 16.671433110205566, 42.57794332897669, 13.204166038298338, 17.298527068823127, 20.653579348364314, 24.87172705017462, 20.714954391515004, 27.69642857713013, 56.06190842362657, 38.64675416078532, 24.24680800077977, 17.74421057579088, 31.659521993220423, 48.674243498425156, 17.82408549413834, 33.51482905652621, 32.300268823359254, 21.537531782400535, 34.87861790472148, 25.602833016655403, 23.682780934673268, 41.86915899198772, 47.6056622123781, 13.549136238152107, 20.337997213993226, 17.474737812925184, 14.208860505415714, 49.812545582158, 15.788785116216655, 18.301508916879946, 30.68037200280607, 14.151736937930915, 17.22684379572361, 36.47795191353757, 21.500629531834136, 24.709196409500905, 39.2488655365856, 48.881635438555705, 22.308865040215263, 32.82990323876815, 35.39132600923114, 19.987970884811585, 28.226965274379218, 23.219717180712358, 42.163279725153494, 24.16997825493088, 31.94907177744441, 23.939927541084696, 45.17923408927185, 16.49066797673272, 26.01242860255257, 21.702474652728885, 28.594311838409702, 40.938609745063054, 30.953278916435952, 12.244990228268493, 18.385060959050033, 23.092954030620277, 18.83476849849793, 22.08384385675995, 30.544864884110957, 21.166524960133394, 26.249566332742056], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1885998335496154, "mean_inference_ms": 0.9347590609677137, "mean_action_processing_ms": 0.03919464934409828, "mean_env_wait_ms": 0.8663464866187217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1017600, "timers": {"sample_time_ms": 4598.219, "sample_throughput": 3479.608, "learn_time_ms": 436.708, "learn_throughput": 36637.726, "update_time_ms": 1.579}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 1e-05, "total_loss": 0.29964207112789154, "policy_loss": -0.003518580924719572, "vf_loss": 0.30315734446048737, "vf_explained_var": 0.959487795829773, "kl": 5.2409439376788214e-05, "entropy": -4.240926742553711, "entropy_coeff": 0.0}}, "num_steps_sampled": 1017600, "num_steps_trained": 1017600}, "done": false, "episodes_total": 1000, "training_iteration": 78, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-27", "timestamp": 1617650127, "time_this_iter_s": 4.8984479904174805, "time_total_s": 584.0556552410126, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.253325939178467, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 58.52857142857142, "ram_util_percent": 63.971428571428575}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 63.26484080361047, "episode_reward_min": 11.305334714630442, "episode_reward_mean": 26.949473958800386, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.77827988300443, 22.531126518658727, 22.44016070423072, 19.42955772930998, 33.37014849929528, 19.296114307184443, 36.7074229762631, 30.901237385298028, 24.468739169989956, 21.96628194837852, 14.276215402340188, 32.10331093690333, 55.661315161117294, 29.269476506692616, 24.23450461333884, 15.537987904646855, 15.070056311229216, 19.752826275786862, 17.205852787069222, 13.707680810441948, 50.96960389369681, 16.671433110205566, 42.57794332897669, 13.204166038298338, 17.298527068823127, 20.653579348364314, 24.87172705017462, 20.714954391515004, 27.69642857713013, 56.06190842362657, 38.64675416078532, 24.24680800077977, 17.74421057579088, 31.659521993220423, 48.674243498425156, 17.82408549413834, 33.51482905652621, 32.300268823359254, 21.537531782400535, 34.87861790472148, 25.602833016655403, 23.682780934673268, 41.86915899198772, 47.6056622123781, 13.549136238152107, 20.337997213993226, 17.474737812925184, 14.208860505415714, 49.812545582158, 15.788785116216655, 18.301508916879946, 30.68037200280607, 14.151736937930915, 17.22684379572361, 36.47795191353757, 21.500629531834136, 24.709196409500905, 39.2488655365856, 48.881635438555705, 22.308865040215263, 32.82990323876815, 35.39132600923114, 19.987970884811585, 28.226965274379218, 23.219717180712358, 42.163279725153494, 24.16997825493088, 31.94907177744441, 23.939927541084696, 45.17923408927185, 16.49066797673272, 26.01242860255257, 21.702474652728885, 28.594311838409702, 40.938609745063054, 30.953278916435952, 12.244990228268493, 18.385060959050033, 23.092954030620277, 18.83476849849793, 22.08384385675995, 30.544864884110957, 21.166524960133394, 26.249566332742056, 26.484260487308912, 24.6644340094271, 11.305334714630442, 63.26484080361047, 36.32387071895736, 12.690960796759049, 42.10482021541447, 36.82752287294265, 18.0417911284361, 18.701927474145926, 18.337926268460848, 44.04797777006195, 21.40979975386908, 21.45349481551182, 19.278589006080452, 15.782584086264592], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19064087364866203, "mean_inference_ms": 0.9380300941634525, "mean_action_processing_ms": 0.03929068498125528, "mean_env_wait_ms": 0.8627135215477737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1033600, "timers": {"sample_time_ms": 4610.576, "sample_throughput": 3470.283, "learn_time_ms": 441.401, "learn_throughput": 36248.202, "update_time_ms": 1.571}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 1e-05, "total_loss": 0.23631256818771362, "policy_loss": -0.003084745490923524, "vf_loss": 0.23939544707536697, "vf_explained_var": 0.9697487354278564, "kl": 5.928237806074321e-05, "entropy": -4.243736028671265, "entropy_coeff": 0.0}}, "num_steps_sampled": 1033600, "num_steps_trained": 1033600}, "done": false, "episodes_total": 1016, "training_iteration": 79, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-32", "timestamp": 1617650132, "time_this_iter_s": 5.162923574447632, "time_total_s": 589.2185788154602, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.4162495136261, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 61.08571428571429, "ram_util_percent": 64.1857142857143}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 65.64052055579252, "episode_reward_min": 9.244753689383169, "episode_reward_mean": 27.274115149407034, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.244753689383169, 18.608449365615225, 26.390860712161917, 32.83071788590519, 18.479404518535997, 41.021782737900246, 19.600043045940115, 26.38860095108454, 28.58129082197975, 22.91062981957607, 45.04993406829579, 27.615995981777342, 24.188636575839894, 65.64052055579252, 13.734761662383965, 31.527986245397628, 17.74421057579088, 31.659521993220423, 48.674243498425156, 17.82408549413834, 33.51482905652621, 32.300268823359254, 21.537531782400535, 34.87861790472148, 25.602833016655403, 23.682780934673268, 41.86915899198772, 47.6056622123781, 13.549136238152107, 20.337997213993226, 17.474737812925184, 14.208860505415714, 49.812545582158, 15.788785116216655, 18.301508916879946, 30.68037200280607, 14.151736937930915, 17.22684379572361, 36.47795191353757, 21.500629531834136, 24.709196409500905, 39.2488655365856, 48.881635438555705, 22.308865040215263, 32.82990323876815, 35.39132600923114, 19.987970884811585, 28.226965274379218, 23.219717180712358, 42.163279725153494, 24.16997825493088, 31.94907177744441, 23.939927541084696, 45.17923408927185, 16.49066797673272, 26.01242860255257, 21.702474652728885, 28.594311838409702, 40.938609745063054, 30.953278916435952, 12.244990228268493, 18.385060959050033, 23.092954030620277, 18.83476849849793, 22.08384385675995, 30.544864884110957, 21.166524960133394, 26.249566332742056, 26.484260487308912, 24.6644340094271, 11.305334714630442, 63.26484080361047, 36.32387071895736, 12.690960796759049, 42.10482021541447, 36.82752287294265, 18.0417911284361, 18.701927474145926, 18.337926268460848, 44.04797777006195, 21.40979975386908, 21.45349481551182, 19.278589006080452, 15.782584086264592, 16.77827988300443, 22.531126518658727, 22.44016070423072, 19.42955772930998, 33.37014849929528, 19.296114307184443, 36.7074229762631, 30.901237385298028, 24.468739169989956, 21.96628194837852, 14.276215402340188, 32.10331093690333, 55.661315161117294, 29.269476506692616, 24.23450461333884, 15.537987904646855], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1902252012918042, "mean_inference_ms": 0.9377736695059639, "mean_action_processing_ms": 0.039210917815727185, "mean_env_wait_ms": 0.8569175615572427, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1049600, "timers": {"sample_time_ms": 4578.078, "sample_throughput": 3494.916, "learn_time_ms": 438.505, "learn_throughput": 36487.604, "update_time_ms": 1.582}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 1e-05, "total_loss": 0.4030146896839142, "policy_loss": 0.007132747210562229, "vf_loss": 0.39588120579719543, "vf_explained_var": 0.9489392042160034, "kl": 4.710203029389959e-05, "entropy": -4.23896861076355, "entropy_coeff": 0.0}}, "num_steps_sampled": 1049600, "num_steps_trained": 1049600}, "done": false, "episodes_total": 1032, "training_iteration": 80, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-37", "timestamp": 1617650137, "time_this_iter_s": 4.776148080825806, "time_total_s": 593.994726896286, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.192397594451904, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 52.214285714285715, "ram_util_percent": 64.07142857142857}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 65.64052055579252, "episode_reward_min": 9.244753689383169, "episode_reward_mean": 27.27146003439652, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.41027940017232, 42.53933511830581, 16.416892758090174, 17.60626305198872, 35.54140087591692, 55.92299773169763, 16.39157189783339, 27.22517105632765, 35.53892209434015, 14.41890794823036, 17.607604567706023, 34.64152906374654, 33.82982111953432, 21.440801926683513, 24.343545743686246, 16.323920199451077, 49.812545582158, 15.788785116216655, 18.301508916879946, 30.68037200280607, 14.151736937930915, 17.22684379572361, 36.47795191353757, 21.500629531834136, 24.709196409500905, 39.2488655365856, 48.881635438555705, 22.308865040215263, 32.82990323876815, 35.39132600923114, 19.987970884811585, 28.226965274379218, 23.219717180712358, 42.163279725153494, 24.16997825493088, 31.94907177744441, 23.939927541084696, 45.17923408927185, 16.49066797673272, 26.01242860255257, 21.702474652728885, 28.594311838409702, 40.938609745063054, 30.953278916435952, 12.244990228268493, 18.385060959050033, 23.092954030620277, 18.83476849849793, 22.08384385675995, 30.544864884110957, 21.166524960133394, 26.249566332742056, 26.484260487308912, 24.6644340094271, 11.305334714630442, 63.26484080361047, 36.32387071895736, 12.690960796759049, 42.10482021541447, 36.82752287294265, 18.0417911284361, 18.701927474145926, 18.337926268460848, 44.04797777006195, 21.40979975386908, 21.45349481551182, 19.278589006080452, 15.782584086264592, 16.77827988300443, 22.531126518658727, 22.44016070423072, 19.42955772930998, 33.37014849929528, 19.296114307184443, 36.7074229762631, 30.901237385298028, 24.468739169989956, 21.96628194837852, 14.276215402340188, 32.10331093690333, 55.661315161117294, 29.269476506692616, 24.23450461333884, 15.537987904646855, 9.244753689383169, 18.608449365615225, 26.390860712161917, 32.83071788590519, 18.479404518535997, 41.021782737900246, 19.600043045940115, 26.38860095108454, 28.58129082197975, 22.91062981957607, 45.04993406829579, 27.615995981777342, 24.188636575839894, 65.64052055579252, 13.734761662383965, 31.527986245397628], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.190667450174788, "mean_inference_ms": 0.9414655410207655, "mean_action_processing_ms": 0.03944078472256497, "mean_env_wait_ms": 0.8604330470718154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1065600, "timers": {"sample_time_ms": 4639.739, "sample_throughput": 3448.47, "learn_time_ms": 435.664, "learn_throughput": 36725.515, "update_time_ms": 1.594}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 1e-05, "total_loss": 0.27214086055755615, "policy_loss": -0.00249173870543018, "vf_loss": 0.2746322304010391, "vf_explained_var": 0.9638153314590454, "kl": 4.686777538154274e-05, "entropy": -4.2468225955963135, "entropy_coeff": 0.0}}, "num_steps_sampled": 1065600, "num_steps_trained": 1065600}, "done": false, "episodes_total": 1048, "training_iteration": 81, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-42", "timestamp": 1617650142, "time_this_iter_s": 5.555230140686035, "time_total_s": 599.549957036972, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.74762773513794, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 64.01249999999999, "ram_util_percent": 64.1125}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 70.79561315744499, "episode_reward_min": 9.244753689383169, "episode_reward_mean": 28.111202603385806, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.082257687485946, 18.152799663461593, 42.794816147897215, 37.64607831155355, 25.412134400326842, 42.138633425484215, 52.99483669477688, 49.32007311081401, 21.515487101503798, 17.810156243772994, 22.138147837985702, 19.10304963860062, 38.2336869497428, 21.038056286945256, 70.79561315744499, 31.323531870266514, 23.219717180712358, 42.163279725153494, 24.16997825493088, 31.94907177744441, 23.939927541084696, 45.17923408927185, 16.49066797673272, 26.01242860255257, 21.702474652728885, 28.594311838409702, 40.938609745063054, 30.953278916435952, 12.244990228268493, 18.385060959050033, 23.092954030620277, 18.83476849849793, 22.08384385675995, 30.544864884110957, 21.166524960133394, 26.249566332742056, 26.484260487308912, 24.6644340094271, 11.305334714630442, 63.26484080361047, 36.32387071895736, 12.690960796759049, 42.10482021541447, 36.82752287294265, 18.0417911284361, 18.701927474145926, 18.337926268460848, 44.04797777006195, 21.40979975386908, 21.45349481551182, 19.278589006080452, 15.782584086264592, 16.77827988300443, 22.531126518658727, 22.44016070423072, 19.42955772930998, 33.37014849929528, 19.296114307184443, 36.7074229762631, 30.901237385298028, 24.468739169989956, 21.96628194837852, 14.276215402340188, 32.10331093690333, 55.661315161117294, 29.269476506692616, 24.23450461333884, 15.537987904646855, 9.244753689383169, 18.608449365615225, 26.390860712161917, 32.83071788590519, 18.479404518535997, 41.021782737900246, 19.600043045940115, 26.38860095108454, 28.58129082197975, 22.91062981957607, 45.04993406829579, 27.615995981777342, 24.188636575839894, 65.64052055579252, 13.734761662383965, 31.527986245397628, 32.41027940017232, 42.53933511830581, 16.416892758090174, 17.60626305198872, 35.54140087591692, 55.92299773169763, 16.39157189783339, 27.22517105632765, 35.53892209434015, 14.41890794823036, 17.607604567706023, 34.64152906374654, 33.82982111953432, 21.440801926683513, 24.343545743686246, 16.323920199451077], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19057058175285013, "mean_inference_ms": 0.9398920649754844, "mean_action_processing_ms": 0.03946575483691467, "mean_env_wait_ms": 0.8595882791431653, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1081600, "timers": {"sample_time_ms": 4559.56, "sample_throughput": 3509.111, "learn_time_ms": 438.327, "learn_throughput": 36502.43, "update_time_ms": 1.58}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 1e-05, "total_loss": 0.5433582365512848, "policy_loss": -0.004074431257322431, "vf_loss": 0.5474324822425842, "vf_explained_var": 0.936301589012146, "kl": 5.393294486566447e-05, "entropy": -4.251861333847046, "entropy_coeff": 0.0}}, "num_steps_sampled": 1081600, "num_steps_trained": 1081600}, "done": false, "episodes_total": 1064, "training_iteration": 82, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-47", "timestamp": 1617650147, "time_this_iter_s": 4.309134244918823, "time_total_s": 603.8590912818909, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.05676198005676, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.050000000000004, "ram_util_percent": 64.0}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 70.79561315744499, "episode_reward_min": 9.244753689383169, "episode_reward_mean": 29.30617579839319, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.154745215197273, 44.22129139329872, 22.8068452764319, 57.51405407735951, 47.3955716973162, 55.703857125800376, 39.080180565107135, 30.381706419725642, 32.38094719225296, 24.726454614055932, 20.806900544947915, 25.35981586507406, 38.921169772684365, 31.432965275999628, 16.483775367435566, 31.997793115008733, 22.08384385675995, 30.544864884110957, 21.166524960133394, 26.249566332742056, 26.484260487308912, 24.6644340094271, 11.305334714630442, 63.26484080361047, 36.32387071895736, 12.690960796759049, 42.10482021541447, 36.82752287294265, 18.0417911284361, 18.701927474145926, 18.337926268460848, 44.04797777006195, 21.40979975386908, 21.45349481551182, 19.278589006080452, 15.782584086264592, 16.77827988300443, 22.531126518658727, 22.44016070423072, 19.42955772930998, 33.37014849929528, 19.296114307184443, 36.7074229762631, 30.901237385298028, 24.468739169989956, 21.96628194837852, 14.276215402340188, 32.10331093690333, 55.661315161117294, 29.269476506692616, 24.23450461333884, 15.537987904646855, 9.244753689383169, 18.608449365615225, 26.390860712161917, 32.83071788590519, 18.479404518535997, 41.021782737900246, 19.600043045940115, 26.38860095108454, 28.58129082197975, 22.91062981957607, 45.04993406829579, 27.615995981777342, 24.188636575839894, 65.64052055579252, 13.734761662383965, 31.527986245397628, 32.41027940017232, 42.53933511830581, 16.416892758090174, 17.60626305198872, 35.54140087591692, 55.92299773169763, 16.39157189783339, 27.22517105632765, 35.53892209434015, 14.41890794823036, 17.607604567706023, 34.64152906374654, 33.82982111953432, 21.440801926683513, 24.343545743686246, 16.323920199451077, 29.082257687485946, 18.152799663461593, 42.794816147897215, 37.64607831155355, 25.412134400326842, 42.138633425484215, 52.99483669477688, 49.32007311081401, 21.515487101503798, 17.810156243772994, 22.138147837985702, 19.10304963860062, 38.2336869497428, 21.038056286945256, 70.79561315744499, 31.323531870266514], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19064062888835678, "mean_inference_ms": 0.9403325711400887, "mean_action_processing_ms": 0.03955622643421994, "mean_env_wait_ms": 0.8606035298993499, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1097600, "timers": {"sample_time_ms": 4513.996, "sample_throughput": 3544.531, "learn_time_ms": 438.34, "learn_throughput": 36501.372, "update_time_ms": 1.567}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 1e-05, "total_loss": 0.4990779459476471, "policy_loss": -0.005738395033404231, "vf_loss": 0.5048162937164307, "vf_explained_var": 0.9454220533370972, "kl": 3.084808577114018e-05, "entropy": -4.253529787063599, "entropy_coeff": 0.0}}, "num_steps_sampled": 1097600, "num_steps_trained": 1097600}, "done": false, "episodes_total": 1080, "training_iteration": 83, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-52", "timestamp": 1617650152, "time_this_iter_s": 5.123358726501465, "time_total_s": 608.9824500083923, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 55.18012070655823, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 59.4375, "ram_util_percent": 64.0375}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 70.79561315744499, "episode_reward_min": 9.244753689383169, "episode_reward_mean": 30.76042011985551, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.837431946845758, 57.66852281557716, 38.95967828899659, 25.64271262172013, 37.9969361314003, 35.092995523093514, 39.93914420173503, 43.1850657512835, 41.97052165269512, 31.87234909019621, 55.571146994120234, 20.848381953835897, 34.289383060659816, 30.8763750077064, 48.93182588210571, 26.582428518162548, 21.40979975386908, 21.45349481551182, 19.278589006080452, 15.782584086264592, 16.77827988300443, 22.531126518658727, 22.44016070423072, 19.42955772930998, 33.37014849929528, 19.296114307184443, 36.7074229762631, 30.901237385298028, 24.468739169989956, 21.96628194837852, 14.276215402340188, 32.10331093690333, 55.661315161117294, 29.269476506692616, 24.23450461333884, 15.537987904646855, 9.244753689383169, 18.608449365615225, 26.390860712161917, 32.83071788590519, 18.479404518535997, 41.021782737900246, 19.600043045940115, 26.38860095108454, 28.58129082197975, 22.91062981957607, 45.04993406829579, 27.615995981777342, 24.188636575839894, 65.64052055579252, 13.734761662383965, 31.527986245397628, 32.41027940017232, 42.53933511830581, 16.416892758090174, 17.60626305198872, 35.54140087591692, 55.92299773169763, 16.39157189783339, 27.22517105632765, 35.53892209434015, 14.41890794823036, 17.607604567706023, 34.64152906374654, 33.82982111953432, 21.440801926683513, 24.343545743686246, 16.323920199451077, 29.082257687485946, 18.152799663461593, 42.794816147897215, 37.64607831155355, 25.412134400326842, 42.138633425484215, 52.99483669477688, 49.32007311081401, 21.515487101503798, 17.810156243772994, 22.138147837985702, 19.10304963860062, 38.2336869497428, 21.038056286945256, 70.79561315744499, 31.323531870266514, 28.154745215197273, 44.22129139329872, 22.8068452764319, 57.51405407735951, 47.3955716973162, 55.703857125800376, 39.080180565107135, 30.381706419725642, 32.38094719225296, 24.726454614055932, 20.806900544947915, 25.35981586507406, 38.921169772684365, 31.432965275999628, 16.483775367435566, 31.997793115008733], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19070575317751662, "mean_inference_ms": 0.941059792233486, "mean_action_processing_ms": 0.03964202343064795, "mean_env_wait_ms": 0.8617916444728609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1113600, "timers": {"sample_time_ms": 4489.637, "sample_throughput": 3563.762, "learn_time_ms": 436.148, "learn_throughput": 36684.799, "update_time_ms": 1.64}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 1e-05, "total_loss": 0.4394795447587967, "policy_loss": -0.004995329538360238, "vf_loss": 0.44447487592697144, "vf_explained_var": 0.9536138772964478, "kl": 3.6004261346533895e-05, "entropy": -4.264573335647583, "entropy_coeff": 0.0}}, "num_steps_sampled": 1113600, "num_steps_trained": 1113600}, "done": false, "episodes_total": 1096, "training_iteration": 84, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-15-57", "timestamp": 1617650157, "time_this_iter_s": 4.815743446350098, "time_total_s": 613.7981934547424, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 59.995864152908325, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 55.90000000000001, "ram_util_percent": 64.24285714285715}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 70.79561315744499, "episode_reward_min": 9.244753689383169, "episode_reward_mean": 31.910599535767247, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.920778553263467, 18.032786697600883, 28.121430925256565, 31.73476062985783, 34.45457111720069, 34.67745367997546, 26.329436197982282, 42.47014010300744, 31.073035716908187, 30.732230744920475, 39.01313714617544, 35.09097428825837, 30.759986400390257, 36.6184456906743, 23.341164913487777, 12.840671908796718, 55.661315161117294, 29.269476506692616, 24.23450461333884, 15.537987904646855, 9.244753689383169, 18.608449365615225, 26.390860712161917, 32.83071788590519, 18.479404518535997, 41.021782737900246, 19.600043045940115, 26.38860095108454, 28.58129082197975, 22.91062981957607, 45.04993406829579, 27.615995981777342, 24.188636575839894, 65.64052055579252, 13.734761662383965, 31.527986245397628, 32.41027940017232, 42.53933511830581, 16.416892758090174, 17.60626305198872, 35.54140087591692, 55.92299773169763, 16.39157189783339, 27.22517105632765, 35.53892209434015, 14.41890794823036, 17.607604567706023, 34.64152906374654, 33.82982111953432, 21.440801926683513, 24.343545743686246, 16.323920199451077, 29.082257687485946, 18.152799663461593, 42.794816147897215, 37.64607831155355, 25.412134400326842, 42.138633425484215, 52.99483669477688, 49.32007311081401, 21.515487101503798, 17.810156243772994, 22.138147837985702, 19.10304963860062, 38.2336869497428, 21.038056286945256, 70.79561315744499, 31.323531870266514, 28.154745215197273, 44.22129139329872, 22.8068452764319, 57.51405407735951, 47.3955716973162, 55.703857125800376, 39.080180565107135, 30.381706419725642, 32.38094719225296, 24.726454614055932, 20.806900544947915, 25.35981586507406, 38.921169772684365, 31.432965275999628, 16.483775367435566, 31.997793115008733, 28.837431946845758, 57.66852281557716, 38.95967828899659, 25.64271262172013, 37.9969361314003, 35.092995523093514, 39.93914420173503, 43.1850657512835, 41.97052165269512, 31.87234909019621, 55.571146994120234, 20.848381953835897, 34.289383060659816, 30.8763750077064, 48.93182588210571, 26.582428518162548], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19044516482379195, "mean_inference_ms": 0.9404917170203356, "mean_action_processing_ms": 0.03965522292434237, "mean_env_wait_ms": 0.8615517775547104, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1129600, "timers": {"sample_time_ms": 4506.902, "sample_throughput": 3550.11, "learn_time_ms": 435.86, "learn_throughput": 36709.042, "update_time_ms": 1.666}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00048828125, "cur_lr": 1e-05, "total_loss": 0.2907363623380661, "policy_loss": 0.003681799629703164, "vf_loss": 0.28705455362796783, "vf_explained_var": 0.9664770364761353, "kl": 3.278188160038553e-05, "entropy": -4.267487049102783, "entropy_coeff": 0.0}}, "num_steps_sampled": 1129600, "num_steps_trained": 1129600}, "done": false, "episodes_total": 1112, "training_iteration": 85, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-02", "timestamp": 1617650162, "time_this_iter_s": 4.698377847671509, "time_total_s": 618.4965713024139, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 64.69424200057983, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 54.88333333333333, "ram_util_percent": 64.05}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 70.79561315744499, "episode_reward_min": 12.483271118442072, "episode_reward_mean": 33.03100707141075, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.58976609511504, 25.239345630141738, 23.676498320086765, 55.64383847223361, 12.483271118442072, 56.123117151003285, 23.02285677580241, 40.49881645430447, 48.40532448870757, 38.94848087935539, 44.01811363265095, 26.62175127791722, 34.146116165273284, 49.21368079629647, 18.27332693348448, 28.562197157486498, 24.188636575839894, 65.64052055579252, 13.734761662383965, 31.527986245397628, 32.41027940017232, 42.53933511830581, 16.416892758090174, 17.60626305198872, 35.54140087591692, 55.92299773169763, 16.39157189783339, 27.22517105632765, 35.53892209434015, 14.41890794823036, 17.607604567706023, 34.64152906374654, 33.82982111953432, 21.440801926683513, 24.343545743686246, 16.323920199451077, 29.082257687485946, 18.152799663461593, 42.794816147897215, 37.64607831155355, 25.412134400326842, 42.138633425484215, 52.99483669477688, 49.32007311081401, 21.515487101503798, 17.810156243772994, 22.138147837985702, 19.10304963860062, 38.2336869497428, 21.038056286945256, 70.79561315744499, 31.323531870266514, 28.154745215197273, 44.22129139329872, 22.8068452764319, 57.51405407735951, 47.3955716973162, 55.703857125800376, 39.080180565107135, 30.381706419725642, 32.38094719225296, 24.726454614055932, 20.806900544947915, 25.35981586507406, 38.921169772684365, 31.432965275999628, 16.483775367435566, 31.997793115008733, 28.837431946845758, 57.66852281557716, 38.95967828899659, 25.64271262172013, 37.9969361314003, 35.092995523093514, 39.93914420173503, 43.1850657512835, 41.97052165269512, 31.87234909019621, 55.571146994120234, 20.848381953835897, 34.289383060659816, 30.8763750077064, 48.93182588210571, 26.582428518162548, 31.920778553263467, 18.032786697600883, 28.121430925256565, 31.73476062985783, 34.45457111720069, 34.67745367997546, 26.329436197982282, 42.47014010300744, 31.073035716908187, 30.732230744920475, 39.01313714617544, 35.09097428825837, 30.759986400390257, 36.6184456906743, 23.341164913487777, 12.840671908796718], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19075395430334388, "mean_inference_ms": 0.9409695834611149, "mean_action_processing_ms": 0.03970448954014964, "mean_env_wait_ms": 0.8623779582331474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1145600, "timers": {"sample_time_ms": 4495.46, "sample_throughput": 3559.147, "learn_time_ms": 438.137, "learn_throughput": 36518.22, "update_time_ms": 1.689}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000244140625, "cur_lr": 1e-05, "total_loss": 0.40851734578609467, "policy_loss": 0.004031676333397627, "vf_loss": 0.40448562800884247, "vf_explained_var": 0.956001877784729, "kl": 3.4700107789831236e-05, "entropy": -4.272608757019043, "entropy_coeff": 0.0}}, "num_steps_sampled": 1145600, "num_steps_trained": 1145600}, "done": false, "episodes_total": 1128, "training_iteration": 86, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-07", "timestamp": 1617650167, "time_this_iter_s": 5.473714351654053, "time_total_s": 623.970285654068, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 70.16795635223389, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 62.699999999999996, "ram_util_percent": 63.975}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 77.52196471530632, "episode_reward_min": 12.483271118442072, "episode_reward_mean": 34.07083391954845, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.171696154723016, 34.79485656633293, 25.83488132700595, 34.42750913744841, 47.46976859048272, 24.42913068788094, 26.174414279007067, 53.132578782930096, 18.489338024164443, 77.52196471530632, 17.60048001556735, 31.497266654450193, 59.060855168509555, 32.39282352107899, 50.34868253126869, 20.989219261383568, 33.82982111953432, 21.440801926683513, 24.343545743686246, 16.323920199451077, 29.082257687485946, 18.152799663461593, 42.794816147897215, 37.64607831155355, 25.412134400326842, 42.138633425484215, 52.99483669477688, 49.32007311081401, 21.515487101503798, 17.810156243772994, 22.138147837985702, 19.10304963860062, 38.2336869497428, 21.038056286945256, 70.79561315744499, 31.323531870266514, 28.154745215197273, 44.22129139329872, 22.8068452764319, 57.51405407735951, 47.3955716973162, 55.703857125800376, 39.080180565107135, 30.381706419725642, 32.38094719225296, 24.726454614055932, 20.806900544947915, 25.35981586507406, 38.921169772684365, 31.432965275999628, 16.483775367435566, 31.997793115008733, 28.837431946845758, 57.66852281557716, 38.95967828899659, 25.64271262172013, 37.9969361314003, 35.092995523093514, 39.93914420173503, 43.1850657512835, 41.97052165269512, 31.87234909019621, 55.571146994120234, 20.848381953835897, 34.289383060659816, 30.8763750077064, 48.93182588210571, 26.582428518162548, 31.920778553263467, 18.032786697600883, 28.121430925256565, 31.73476062985783, 34.45457111720069, 34.67745367997546, 26.329436197982282, 42.47014010300744, 31.073035716908187, 30.732230744920475, 39.01313714617544, 35.09097428825837, 30.759986400390257, 36.6184456906743, 23.341164913487777, 12.840671908796718, 28.58976609511504, 25.239345630141738, 23.676498320086765, 55.64383847223361, 12.483271118442072, 56.123117151003285, 23.02285677580241, 40.49881645430447, 48.40532448870757, 38.94848087935539, 44.01811363265095, 26.62175127791722, 34.146116165273284, 49.21368079629647, 18.27332693348448, 28.562197157486498], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19063561745549173, "mean_inference_ms": 0.9388436169435963, "mean_action_processing_ms": 0.03963382866768499, "mean_env_wait_ms": 0.8604312460297462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1161600, "timers": {"sample_time_ms": 4477.511, "sample_throughput": 3573.414, "learn_time_ms": 437.413, "learn_throughput": 36578.74, "update_time_ms": 1.672}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001220703125, "cur_lr": 1e-05, "total_loss": 0.6012064516544342, "policy_loss": 0.005127886775881052, "vf_loss": 0.5960785746574402, "vf_explained_var": 0.9379125237464905, "kl": 5.0614846259122714e-05, "entropy": -4.26544189453125, "entropy_coeff": 0.0}}, "num_steps_sampled": 1161600, "num_steps_trained": 1161600}, "done": false, "episodes_total": 1144, "training_iteration": 87, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-12", "timestamp": 1617650172, "time_this_iter_s": 4.419908285140991, "time_total_s": 628.390193939209, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 74.58786463737488, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 41.9, "ram_util_percent": 64.26666666666667}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 77.52196471530632, "episode_reward_min": 12.483271118442072, "episode_reward_mean": 35.293257936402306, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.763318904900295, 24.908113751579638, 57.68843075503363, 35.35030584265578, 44.22612587440132, 24.107907602420195, 37.88170991908981, 12.578789097180755, 47.007298367670195, 42.946137890752816, 39.54321219664009, 52.18474870022362, 22.22069173209904, 54.027268769853826, 41.042781883981945, 18.812119649920295, 38.2336869497428, 21.038056286945256, 70.79561315744499, 31.323531870266514, 28.154745215197273, 44.22129139329872, 22.8068452764319, 57.51405407735951, 47.3955716973162, 55.703857125800376, 39.080180565107135, 30.381706419725642, 32.38094719225296, 24.726454614055932, 20.806900544947915, 25.35981586507406, 38.921169772684365, 31.432965275999628, 16.483775367435566, 31.997793115008733, 28.837431946845758, 57.66852281557716, 38.95967828899659, 25.64271262172013, 37.9969361314003, 35.092995523093514, 39.93914420173503, 43.1850657512835, 41.97052165269512, 31.87234909019621, 55.571146994120234, 20.848381953835897, 34.289383060659816, 30.8763750077064, 48.93182588210571, 26.582428518162548, 31.920778553263467, 18.032786697600883, 28.121430925256565, 31.73476062985783, 34.45457111720069, 34.67745367997546, 26.329436197982282, 42.47014010300744, 31.073035716908187, 30.732230744920475, 39.01313714617544, 35.09097428825837, 30.759986400390257, 36.6184456906743, 23.341164913487777, 12.840671908796718, 28.58976609511504, 25.239345630141738, 23.676498320086765, 55.64383847223361, 12.483271118442072, 56.123117151003285, 23.02285677580241, 40.49881645430447, 48.40532448870757, 38.94848087935539, 44.01811363265095, 26.62175127791722, 34.146116165273284, 49.21368079629647, 18.27332693348448, 28.562197157486498, 31.171696154723016, 34.79485656633293, 25.83488132700595, 34.42750913744841, 47.46976859048272, 24.42913068788094, 26.174414279007067, 53.132578782930096, 18.489338024164443, 77.52196471530632, 17.60048001556735, 31.497266654450193, 59.060855168509555, 32.39282352107899, 50.34868253126869, 20.989219261383568], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19074648905446062, "mean_inference_ms": 0.9405556573324767, "mean_action_processing_ms": 0.039656631644707556, "mean_env_wait_ms": 0.8609286278000431, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1177600, "timers": {"sample_time_ms": 4575.748, "sample_throughput": 3496.696, "learn_time_ms": 438.345, "learn_throughput": 36500.898, "update_time_ms": 1.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-05, "cur_lr": 1e-05, "total_loss": 0.5004721730947495, "policy_loss": 0.002541885245591402, "vf_loss": 0.49793028831481934, "vf_explained_var": 0.9486570358276367, "kl": 5.3734078392153606e-05, "entropy": -4.280827283859253, "entropy_coeff": 0.0}}, "num_steps_sampled": 1177600, "num_steps_trained": 1177600}, "done": false, "episodes_total": 1160, "training_iteration": 88, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-17", "timestamp": 1617650177, "time_this_iter_s": 5.889917612075806, "time_total_s": 634.2801115512848, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 80.47778224945068, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 64.32222222222222, "ram_util_percent": 64.12222222222222}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 77.52196471530632, "episode_reward_min": 12.483271118442072, "episode_reward_mean": 35.37593492624916, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.652155851967397, 20.120759757709614, 44.96502960377023, 17.823653353429624, 28.349287250757023, 43.23809654328752, 48.08581401638529, 37.300499653493674, 75.98914491466321, 21.054555495217627, 34.600852374363015, 47.41907848023125, 49.156703874182746, 54.645410030246616, 25.42652688379946, 22.36338915214837, 38.921169772684365, 31.432965275999628, 16.483775367435566, 31.997793115008733, 28.837431946845758, 57.66852281557716, 38.95967828899659, 25.64271262172013, 37.9969361314003, 35.092995523093514, 39.93914420173503, 43.1850657512835, 41.97052165269512, 31.87234909019621, 55.571146994120234, 20.848381953835897, 34.289383060659816, 30.8763750077064, 48.93182588210571, 26.582428518162548, 31.920778553263467, 18.032786697600883, 28.121430925256565, 31.73476062985783, 34.45457111720069, 34.67745367997546, 26.329436197982282, 42.47014010300744, 31.073035716908187, 30.732230744920475, 39.01313714617544, 35.09097428825837, 30.759986400390257, 36.6184456906743, 23.341164913487777, 12.840671908796718, 28.58976609511504, 25.239345630141738, 23.676498320086765, 55.64383847223361, 12.483271118442072, 56.123117151003285, 23.02285677580241, 40.49881645430447, 48.40532448870757, 38.94848087935539, 44.01811363265095, 26.62175127791722, 34.146116165273284, 49.21368079629647, 18.27332693348448, 28.562197157486498, 31.171696154723016, 34.79485656633293, 25.83488132700595, 34.42750913744841, 47.46976859048272, 24.42913068788094, 26.174414279007067, 53.132578782930096, 18.489338024164443, 77.52196471530632, 17.60048001556735, 31.497266654450193, 59.060855168509555, 32.39282352107899, 50.34868253126869, 20.989219261383568, 41.763318904900295, 24.908113751579638, 57.68843075503363, 35.35030584265578, 44.22612587440132, 24.107907602420195, 37.88170991908981, 12.578789097180755, 47.007298367670195, 42.946137890752816, 39.54321219664009, 52.18474870022362, 22.22069173209904, 54.027268769853826, 41.042781883981945, 18.812119649920295], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1909617582762541, "mean_inference_ms": 0.9424105431689194, "mean_action_processing_ms": 0.03968870413698009, "mean_env_wait_ms": 0.8616019930567442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1193600, "timers": {"sample_time_ms": 4593.854, "sample_throughput": 3482.914, "learn_time_ms": 449.485, "learn_throughput": 35596.302, "update_time_ms": 1.657}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-05, "cur_lr": 1e-05, "total_loss": 0.5527719557285309, "policy_loss": -0.004240297479555011, "vf_loss": 0.5570122599601746, "vf_explained_var": 0.9422435760498047, "kl": 6.869418575661257e-05, "entropy": -4.281303882598877, "entropy_coeff": 0.0}}, "num_steps_sampled": 1193600, "num_steps_trained": 1193600}, "done": false, "episodes_total": 1176, "training_iteration": 89, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-23", "timestamp": 1617650183, "time_this_iter_s": 5.4559125900268555, "time_total_s": 639.7360241413116, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 85.93369483947754, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.9875, "ram_util_percent": 64.075}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 77.52196471530632, "episode_reward_min": 12.483271118442072, "episode_reward_mean": 34.5720065652898, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.09774133931191, 27.38353147237595, 18.33467499251148, 36.75677765215449, 42.02108692878178, 32.81559748856594, 50.09518975327774, 30.14053841812295, 23.06845985501386, 20.399899554675912, 34.429088550142225, 25.56706978765635, 22.23156810791861, 38.46467279764325, 29.745864741440734, 29.475992967098758, 34.289383060659816, 30.8763750077064, 48.93182588210571, 26.582428518162548, 31.920778553263467, 18.032786697600883, 28.121430925256565, 31.73476062985783, 34.45457111720069, 34.67745367997546, 26.329436197982282, 42.47014010300744, 31.073035716908187, 30.732230744920475, 39.01313714617544, 35.09097428825837, 30.759986400390257, 36.6184456906743, 23.341164913487777, 12.840671908796718, 28.58976609511504, 25.239345630141738, 23.676498320086765, 55.64383847223361, 12.483271118442072, 56.123117151003285, 23.02285677580241, 40.49881645430447, 48.40532448870757, 38.94848087935539, 44.01811363265095, 26.62175127791722, 34.146116165273284, 49.21368079629647, 18.27332693348448, 28.562197157486498, 31.171696154723016, 34.79485656633293, 25.83488132700595, 34.42750913744841, 47.46976859048272, 24.42913068788094, 26.174414279007067, 53.132578782930096, 18.489338024164443, 77.52196471530632, 17.60048001556735, 31.497266654450193, 59.060855168509555, 32.39282352107899, 50.34868253126869, 20.989219261383568, 41.763318904900295, 24.908113751579638, 57.68843075503363, 35.35030584265578, 44.22612587440132, 24.107907602420195, 37.88170991908981, 12.578789097180755, 47.007298367670195, 42.946137890752816, 39.54321219664009, 52.18474870022362, 22.22069173209904, 54.027268769853826, 41.042781883981945, 18.812119649920295, 27.652155851967397, 20.120759757709614, 44.96502960377023, 17.823653353429624, 28.349287250757023, 43.23809654328752, 48.08581401638529, 37.300499653493674, 75.98914491466321, 21.054555495217627, 34.600852374363015, 47.41907848023125, 49.156703874182746, 54.645410030246616, 25.42652688379946, 22.36338915214837], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910872298408055, "mean_inference_ms": 0.9443147698361494, "mean_action_processing_ms": 0.039726384472784, "mean_env_wait_ms": 0.8623330362466152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1209600, "timers": {"sample_time_ms": 4615.454, "sample_throughput": 3466.615, "learn_time_ms": 449.347, "learn_throughput": 35607.218, "update_time_ms": 1.654}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-05, "cur_lr": 1e-05, "total_loss": 0.2841227203607559, "policy_loss": 0.001010250998660922, "vf_loss": 0.28311245143413544, "vf_explained_var": 0.9682837128639221, "kl": 3.4401120501570404e-05, "entropy": -4.301461458206177, "entropy_coeff": 0.0}}, "num_steps_sampled": 1209600, "num_steps_trained": 1209600}, "done": false, "episodes_total": 1192, "training_iteration": 90, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-28", "timestamp": 1617650188, "time_this_iter_s": 4.990858793258667, "time_total_s": 644.7268829345703, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 90.9245536327362, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.42857142857143, "ram_util_percent": 63.7}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 77.52196471530632, "episode_reward_min": 12.483271118442072, "episode_reward_mean": 34.5881311257822, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.53061783684554, 24.507934395252015, 28.7154615448175, 29.27652488577976, 36.70518032535704, 42.917729349092696, 47.16653177817015, 34.16271897431998, 15.488365632065943, 37.356326111289654, 24.85648800058412, 24.448416327912007, 13.801237068925472, 72.40563772374671, 35.78087047963208, 28.82316388449076, 30.759986400390257, 36.6184456906743, 23.341164913487777, 12.840671908796718, 28.58976609511504, 25.239345630141738, 23.676498320086765, 55.64383847223361, 12.483271118442072, 56.123117151003285, 23.02285677580241, 40.49881645430447, 48.40532448870757, 38.94848087935539, 44.01811363265095, 26.62175127791722, 34.146116165273284, 49.21368079629647, 18.27332693348448, 28.562197157486498, 31.171696154723016, 34.79485656633293, 25.83488132700595, 34.42750913744841, 47.46976859048272, 24.42913068788094, 26.174414279007067, 53.132578782930096, 18.489338024164443, 77.52196471530632, 17.60048001556735, 31.497266654450193, 59.060855168509555, 32.39282352107899, 50.34868253126869, 20.989219261383568, 41.763318904900295, 24.908113751579638, 57.68843075503363, 35.35030584265578, 44.22612587440132, 24.107907602420195, 37.88170991908981, 12.578789097180755, 47.007298367670195, 42.946137890752816, 39.54321219664009, 52.18474870022362, 22.22069173209904, 54.027268769853826, 41.042781883981945, 18.812119649920295, 27.652155851967397, 20.120759757709614, 44.96502960377023, 17.823653353429624, 28.349287250757023, 43.23809654328752, 48.08581401638529, 37.300499653493674, 75.98914491466321, 21.054555495217627, 34.600852374363015, 47.41907848023125, 49.156703874182746, 54.645410030246616, 25.42652688379946, 22.36338915214837, 35.09774133931191, 27.38353147237595, 18.33467499251148, 36.75677765215449, 42.02108692878178, 32.81559748856594, 50.09518975327774, 30.14053841812295, 23.06845985501386, 20.399899554675912, 34.429088550142225, 25.56706978765635, 22.23156810791861, 38.46467279764325, 29.745864741440734, 29.475992967098758], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1916578644953744, "mean_inference_ms": 0.9476619491613454, "mean_action_processing_ms": 0.0398295744978323, "mean_env_wait_ms": 0.8646226715546735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1225600, "timers": {"sample_time_ms": 4628.805, "sample_throughput": 3456.616, "learn_time_ms": 450.575, "learn_throughput": 35510.148, "update_time_ms": 1.653}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-06, "cur_lr": 1e-05, "total_loss": 0.37046732008457184, "policy_loss": -0.00317357259336859, "vf_loss": 0.37364087998867035, "vf_explained_var": 0.9578101634979248, "kl": 3.0465613235719502e-05, "entropy": -4.292606353759766, "entropy_coeff": 0.0}}, "num_steps_sampled": 1225600, "num_steps_trained": 1225600}, "done": false, "episodes_total": 1208, "training_iteration": 91, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-34", "timestamp": 1617650194, "time_this_iter_s": 5.700289487838745, "time_total_s": 650.4271724224091, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 96.62484312057495, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 65.975, "ram_util_percent": 63.6}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 77.52196471530632, "episode_reward_min": 12.256394910574308, "episode_reward_mean": 34.85070368323849, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.460225603328986, 30.14778836137056, 35.537625784328455, 40.409137225136796, 50.405436265418615, 34.23031674784452, 50.36398081582413, 31.995815470073268, 12.256394910574308, 33.56405751247435, 30.310133917339062, 20.376537522680326, 28.249285350804684, 48.3398142040421, 18.042253633502245, 40.399901629996094, 34.146116165273284, 49.21368079629647, 18.27332693348448, 28.562197157486498, 31.171696154723016, 34.79485656633293, 25.83488132700595, 34.42750913744841, 47.46976859048272, 24.42913068788094, 26.174414279007067, 53.132578782930096, 18.489338024164443, 77.52196471530632, 17.60048001556735, 31.497266654450193, 59.060855168509555, 32.39282352107899, 50.34868253126869, 20.989219261383568, 41.763318904900295, 24.908113751579638, 57.68843075503363, 35.35030584265578, 44.22612587440132, 24.107907602420195, 37.88170991908981, 12.578789097180755, 47.007298367670195, 42.946137890752816, 39.54321219664009, 52.18474870022362, 22.22069173209904, 54.027268769853826, 41.042781883981945, 18.812119649920295, 27.652155851967397, 20.120759757709614, 44.96502960377023, 17.823653353429624, 28.349287250757023, 43.23809654328752, 48.08581401638529, 37.300499653493674, 75.98914491466321, 21.054555495217627, 34.600852374363015, 47.41907848023125, 49.156703874182746, 54.645410030246616, 25.42652688379946, 22.36338915214837, 35.09774133931191, 27.38353147237595, 18.33467499251148, 36.75677765215449, 42.02108692878178, 32.81559748856594, 50.09518975327774, 30.14053841812295, 23.06845985501386, 20.399899554675912, 34.429088550142225, 25.56706978765635, 22.23156810791861, 38.46467279764325, 29.745864741440734, 29.475992967098758, 29.53061783684554, 24.507934395252015, 28.7154615448175, 29.27652488577976, 36.70518032535704, 42.917729349092696, 47.16653177817015, 34.16271897431998, 15.488365632065943, 37.356326111289654, 24.85648800058412, 24.448416327912007, 13.801237068925472, 72.40563772374671, 35.78087047963208, 28.82316388449076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19201487336835257, "mean_inference_ms": 0.9500693075484137, "mean_action_processing_ms": 0.039894920032462915, "mean_env_wait_ms": 0.8659740751945912, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1241600, "timers": {"sample_time_ms": 4699.506, "sample_throughput": 3404.614, "learn_time_ms": 454.1, "learn_throughput": 35234.518, "update_time_ms": 1.66}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-06, "cur_lr": 1e-05, "total_loss": 0.35546526312828064, "policy_loss": -0.00399372261017561, "vf_loss": 0.3594589829444885, "vf_explained_var": 0.9612637758255005, "kl": 4.1492208765703253e-05, "entropy": -4.288348197937012, "entropy_coeff": 0.0}}, "num_steps_sampled": 1241600, "num_steps_trained": 1241600}, "done": false, "episodes_total": 1224, "training_iteration": 92, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-16-39", "timestamp": 1617650199, "time_this_iter_s": 5.051395416259766, "time_total_s": 655.4785678386688, "pid": 26901, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9500966064139446, "kl_coeff": 1.0, "sgd_minibatch_size": 11653, "shuffle_sequences": true, "num_sgd_iter": 8, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.23283773739632704, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 101.67623853683472, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 47.51428571428571, "ram_util_percent": 63.714285714285715}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 70.20260021296087, "episode_reward_min": 16.520758533213083, "episode_reward_mean": 33.11596180447813, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.618344231789468, 52.716786810242105, 24.31547692433838, 70.20260021296087, 28.431663543405882, 20.70314253689299, 37.2328577655545, 31.3418770351946, 47.4099472223745, 16.520758533213083, 32.57286356587519, 17.14750452775285, 36.48546691776359, 39.49839011233409, 23.12314767574007, 29.534561256217923], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23682398357610596, "mean_inference_ms": 1.2095407478098033, "mean_action_processing_ms": 0.050986292718470785, "mean_env_wait_ms": 1.1641896408477586, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1193600, "timers": {"sample_time_ms": 6142.87, "sample_throughput": 2604.646, "learn_time_ms": 8627.599, "learn_throughput": 1854.514, "update_time_ms": 1.544}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 9.999999999999999e-05, "total_loss": 0.08030679604745986, "policy_loss": -0.0290820221635684, "vf_loss": 0.0947535914030804, "vf_explained_var": 0.9899698495864868, "kl": 0.014635226831646862, "entropy": -4.31063672083958, "entropy_coeff": 0.0}}, "num_steps_sampled": 1193600, "num_steps_trained": 1193600}, "done": false, "episodes_total": 1176, "training_iteration": 93, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-00", "timestamp": 1617650220, "time_this_iter_s": 14.775008201599121, "time_total_s": 727.6311573982239, "pid": 27114, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7824665959601428, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 14, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15522515826421804, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.775008201599121, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 50.41818181818182, "ram_util_percent": 63.6590909090909}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 70.85149657314561, "episode_reward_min": 14.457194359402003, "episode_reward_mean": 32.69454091308529, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.78346493024309, 28.271946059718086, 32.99180924017029, 70.85149657314561, 14.457194359402003, 25.299146674025316, 43.53853259968969, 21.409612781080284, 40.05745501153275, 30.5973446945187, 23.32937526862672, 23.637625027641864, 44.27452972934026, 21.205954980495736, 25.69909177559728, 34.96534064185155, 22.618344231789468, 52.716786810242105, 24.31547692433838, 70.20260021296087, 28.431663543405882, 20.70314253689299, 37.2328577655545, 31.3418770351946, 47.4099472223745, 16.520758533213083, 32.57286356587519, 17.14750452775285, 36.48546691776359, 39.49839011233409, 23.12314767574007, 29.534561256217923], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.228406788355301, "mean_inference_ms": 1.1410537873349913, "mean_action_processing_ms": 0.048082945466265195, "mean_env_wait_ms": 1.0867585470763017, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1209600, "timers": {"sample_time_ms": 5302.636, "sample_throughput": 3017.367, "learn_time_ms": 8700.916, "learn_throughput": 1838.887, "update_time_ms": 1.709}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 9.999999999999999e-05, "total_loss": 0.07685714842941446, "policy_loss": -0.020062818989056833, "vf_loss": 0.09363759681582451, "vf_explained_var": 0.9901564121246338, "kl": 0.0032823687170151694, "entropy": -4.353053414897555, "entropy_coeff": 0.0}}, "num_steps_sampled": 1209600, "num_steps_trained": 1209600}, "done": false, "episodes_total": 1192, "training_iteration": 94, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-14", "timestamp": 1617650234, "time_this_iter_s": 13.2447350025177, "time_total_s": 740.8758924007416, "pid": 27114, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7824665959601428, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 14, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15522515826421804, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.01974320411682, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.26315789473684, "ram_util_percent": 63.62631578947368}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 84.1726492277938, "episode_reward_min": 14.457194359402003, "episode_reward_mean": 35.671563035406955, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.905596622364826, 20.754299442097164, 33.497810846213746, 19.887185309252146, 53.05848918653297, 43.08555039589706, 48.18423372905225, 84.1726492277938, 18.76266838552455, 81.92747711680967, 54.500333013568756, 40.65239849562251, 17.357477121206973, 28.910252637815567, 48.63556166978138, 50.717733281271116, 22.618344231789468, 52.716786810242105, 24.31547692433838, 70.20260021296087, 28.431663543405882, 20.70314253689299, 37.2328577655545, 31.3418770351946, 47.4099472223745, 16.520758533213083, 32.57286356587519, 17.14750452775285, 36.48546691776359, 39.49839011233409, 23.12314767574007, 29.534561256217923, 35.78346493024309, 28.271946059718086, 32.99180924017029, 70.85149657314561, 14.457194359402003, 25.299146674025316, 43.53853259968969, 21.409612781080284, 40.05745501153275, 30.5973446945187, 23.32937526862672, 23.637625027641864, 44.27452972934026, 21.205954980495736, 25.69909177559728, 34.96534064185155], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21947670719661785, "mean_inference_ms": 1.098295944133408, "mean_action_processing_ms": 0.045926322183632025, "mean_env_wait_ms": 1.02997799610285, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1225600, "timers": {"sample_time_ms": 4860.685, "sample_throughput": 3291.717, "learn_time_ms": 8674.054, "learn_throughput": 1844.582, "update_time_ms": 1.701}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 9.999999999999999e-05, "total_loss": 0.16624945299521943, "policy_loss": -0.019774409751207596, "vf_loss": 0.1839185495665119, "vf_explained_var": 0.9817142486572266, "kl": 0.004210632516866087, "entropy": -4.386220859114531, "entropy_coeff": 0.0}}, "num_steps_sampled": 1225600, "num_steps_trained": 1225600}, "done": false, "episodes_total": 1208, "training_iteration": 95, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-26", "timestamp": 1617650246, "time_this_iter_s": 12.604005098342896, "time_total_s": 753.4798974990845, "pid": 27114, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7824665959601428, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 14, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15522515826421804, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.62374830245972, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.72777777777778, "ram_util_percent": 63.699999999999996}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 91.96171372300084, "episode_reward_min": 14.457194359402003, "episode_reward_mean": 37.32332043526944, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.96171372300084, 36.573020719217844, 46.02289222280115, 49.32254252334126, 28.128558194828045, 48.81462825092626, 35.8028308123437, 35.854565673815934, 29.10915463838749, 26.903628597198708, 24.20593750668562, 36.04882531953326, 43.1717596893386, 65.56325368383146, 38.70045792469448, 40.27371267776533, 22.618344231789468, 52.716786810242105, 24.31547692433838, 70.20260021296087, 28.431663543405882, 20.70314253689299, 37.2328577655545, 31.3418770351946, 47.4099472223745, 16.520758533213083, 32.57286356587519, 17.14750452775285, 36.48546691776359, 39.49839011233409, 23.12314767574007, 29.534561256217923, 35.78346493024309, 28.271946059718086, 32.99180924017029, 70.85149657314561, 14.457194359402003, 25.299146674025316, 43.53853259968969, 21.409612781080284, 40.05745501153275, 30.5973446945187, 23.32937526862672, 23.637625027641864, 44.27452972934026, 21.205954980495736, 25.69909177559728, 34.96534064185155, 21.905596622364826, 20.754299442097164, 33.497810846213746, 19.887185309252146, 53.05848918653297, 43.08555039589706, 48.18423372905225, 84.1726492277938, 18.76266838552455, 81.92747711680967, 54.500333013568756, 40.65239849562251, 17.357477121206973, 28.910252637815567, 48.63556166978138, 50.717733281271116], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21358698608525722, "mean_inference_ms": 1.0705957551664307, "mean_action_processing_ms": 0.04464434808613224, "mean_env_wait_ms": 0.9961959877789738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1241600, "timers": {"sample_time_ms": 4746.937, "sample_throughput": 3370.595, "learn_time_ms": 8584.691, "learn_throughput": 1863.783, "update_time_ms": 1.61}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 9.999999999999999e-05, "total_loss": 0.13220387132494313, "policy_loss": -0.02089807786849019, "vf_loss": 0.15177100996492773, "vf_explained_var": 0.9851428270339966, "kl": 0.0053237612154572065, "entropy": -4.444787672370862, "entropy_coeff": 0.0}}, "num_steps_sampled": 1241600, "num_steps_trained": 1241600}, "done": false, "episodes_total": 1224, "training_iteration": 96, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-39", "timestamp": 1617650259, "time_this_iter_s": 12.729117155075073, "time_total_s": 766.2090146541595, "pid": 27114, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7824665959601428, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 14, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15522515826421804, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.35286545753479, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.02777777777777, "ram_util_percent": 63.594444444444434}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 117.4471294405357, "episode_reward_min": 14.457194359402003, "episode_reward_mean": 40.9043314734927, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.26462922885399, 117.4471294405357, 91.76995908881848, 39.775076780649876, 31.404621956730786, 46.797047571219935, 31.663884264456172, 52.7670256579708, 42.95588900078649, 29.7374402821975, 38.182770171719866, 97.24210773602634, 54.78609260597638, 57.726367721504744, 45.76045733209075, 51.37351118263438, 22.618344231789468, 52.716786810242105, 24.31547692433838, 70.20260021296087, 28.431663543405882, 20.70314253689299, 37.2328577655545, 31.3418770351946, 47.4099472223745, 16.520758533213083, 32.57286356587519, 17.14750452775285, 36.48546691776359, 39.49839011233409, 23.12314767574007, 29.534561256217923, 35.78346493024309, 28.271946059718086, 32.99180924017029, 70.85149657314561, 14.457194359402003, 25.299146674025316, 43.53853259968969, 21.409612781080284, 40.05745501153275, 30.5973446945187, 23.32937526862672, 23.637625027641864, 44.27452972934026, 21.205954980495736, 25.69909177559728, 34.96534064185155, 21.905596622364826, 20.754299442097164, 33.497810846213746, 19.887185309252146, 53.05848918653297, 43.08555039589706, 48.18423372905225, 84.1726492277938, 18.76266838552455, 81.92747711680967, 54.500333013568756, 40.65239849562251, 17.357477121206973, 28.910252637815567, 48.63556166978138, 50.717733281271116, 91.96171372300084, 36.573020719217844, 46.02289222280115, 49.32254252334126, 28.128558194828045, 48.81462825092626, 35.8028308123437, 35.854565673815934, 29.10915463838749, 26.903628597198708, 24.20593750668562, 36.04882531953326, 43.1717596893386, 65.56325368383146, 38.70045792469448, 40.27371267776533], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2090619804902496, "mean_inference_ms": 1.0490949592896257, "mean_action_processing_ms": 0.043713087979195, "mean_env_wait_ms": 0.9716644633653191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1257600, "timers": {"sample_time_ms": 4596.984, "sample_throughput": 3480.543, "learn_time_ms": 8379.665, "learn_throughput": 1909.384, "update_time_ms": 1.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 9.999999999999999e-05, "total_loss": 0.24003780505080133, "policy_loss": -0.01954470617677364, "vf_loss": 0.2581789750297358, "vf_explained_var": 0.9760503172874451, "kl": 0.005614148885913336, "entropy": -4.4546722029424775, "entropy_coeff": 0.0}}, "num_steps_sampled": 1257600, "num_steps_trained": 1257600}, "done": false, "episodes_total": 1240, "training_iteration": 97, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-17-51", "timestamp": 1617650271, "time_this_iter_s": 11.564822912216187, "time_total_s": 777.7738375663757, "pid": 27114, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7824665959601428, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 14, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15522515826421804, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 64.91768836975098, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 22.76875, "ram_util_percent": 55.3125}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 117.4471294405357, "episode_reward_min": 14.457194359402003, "episode_reward_mean": 42.40115474716874, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.92865980697611, 39.16931317048089, 49.37026211111213, 40.31571186256946, 35.36533161380697, 53.14693738228199, 40.63959317745499, 45.65863640741167, 35.26869907090901, 44.612116292314155, 66.70308524020484, 32.44750573043761, 60.738442823234934, 62.971808838079035, 80.33363917833563, 60.4945951431742, 22.618344231789468, 52.716786810242105, 24.31547692433838, 70.20260021296087, 28.431663543405882, 20.70314253689299, 37.2328577655545, 31.3418770351946, 47.4099472223745, 16.520758533213083, 32.57286356587519, 17.14750452775285, 36.48546691776359, 39.49839011233409, 23.12314767574007, 29.534561256217923, 35.78346493024309, 28.271946059718086, 32.99180924017029, 70.85149657314561, 14.457194359402003, 25.299146674025316, 43.53853259968969, 21.409612781080284, 40.05745501153275, 30.5973446945187, 23.32937526862672, 23.637625027641864, 44.27452972934026, 21.205954980495736, 25.69909177559728, 34.96534064185155, 21.905596622364826, 20.754299442097164, 33.497810846213746, 19.887185309252146, 53.05848918653297, 43.08555039589706, 48.18423372905225, 84.1726492277938, 18.76266838552455, 81.92747711680967, 54.500333013568756, 40.65239849562251, 17.357477121206973, 28.910252637815567, 48.63556166978138, 50.717733281271116, 91.96171372300084, 36.573020719217844, 46.02289222280115, 49.32254252334126, 28.128558194828045, 48.81462825092626, 35.8028308123437, 35.854565673815934, 29.10915463838749, 26.903628597198708, 24.20593750668562, 36.04882531953326, 43.1717596893386, 65.56325368383146, 38.70045792469448, 40.27371267776533, 54.26462922885399, 117.4471294405357, 91.76995908881848, 39.775076780649876, 31.404621956730786, 46.797047571219935, 31.663884264456172, 52.7670256579708, 42.95588900078649, 29.7374402821975, 38.182770171719866, 97.24210773602634, 54.78609260597638, 57.726367721504744, 45.76045733209075, 51.37351118263438], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2050308780127267, "mean_inference_ms": 1.0292004093933633, "mean_action_processing_ms": 0.04286471808869626, "mean_env_wait_ms": 0.9498785081056457, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1273600, "timers": {"sample_time_ms": 4411.186, "sample_throughput": 3627.142, "learn_time_ms": 8262.85, "learn_throughput": 1936.378, "update_time_ms": 1.725}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 9.999999999999999e-05, "total_loss": 0.15599579343114012, "policy_loss": -0.020548332200436052, "vf_loss": 0.17512083096299202, "vf_explained_var": 0.9842873215675354, "kl": 0.005693174527874987, "entropy": -4.498062519510841, "entropy_coeff": 0.0}}, "num_steps_sampled": 1273600, "num_steps_trained": 1273600}, "done": false, "episodes_total": 1256, "training_iteration": 98, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-18-02", "timestamp": 1617650282, "time_this_iter_s": 11.168205738067627, "time_total_s": 788.9420433044434, "pid": 27114, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7824665959601428, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 14, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15522515826421804, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 76.0858941078186, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.424999999999997, "ram_util_percent": 54.30625}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 117.4471294405357, "episode_reward_min": 14.457194359402003, "episode_reward_mean": 45.657025382836366, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.14994275273077, 41.60738500972996, 24.958171153080468, 36.43089197079021, 34.23732788317514, 84.9613040528361, 113.87662747578877, 72.09764283632082, 82.16862149066459, 62.84840229096629, 46.55491368982022, 58.774797924727416, 24.792152263966994, 23.88822440703339, 96.6701334446514, 43.38896681874823, 36.48546691776359, 39.49839011233409, 23.12314767574007, 29.534561256217923, 35.78346493024309, 28.271946059718086, 32.99180924017029, 70.85149657314561, 14.457194359402003, 25.299146674025316, 43.53853259968969, 21.409612781080284, 40.05745501153275, 30.5973446945187, 23.32937526862672, 23.637625027641864, 44.27452972934026, 21.205954980495736, 25.69909177559728, 34.96534064185155, 21.905596622364826, 20.754299442097164, 33.497810846213746, 19.887185309252146, 53.05848918653297, 43.08555039589706, 48.18423372905225, 84.1726492277938, 18.76266838552455, 81.92747711680967, 54.500333013568756, 40.65239849562251, 17.357477121206973, 28.910252637815567, 48.63556166978138, 50.717733281271116, 91.96171372300084, 36.573020719217844, 46.02289222280115, 49.32254252334126, 28.128558194828045, 48.81462825092626, 35.8028308123437, 35.854565673815934, 29.10915463838749, 26.903628597198708, 24.20593750668562, 36.04882531953326, 43.1717596893386, 65.56325368383146, 38.70045792469448, 40.27371267776533, 54.26462922885399, 117.4471294405357, 91.76995908881848, 39.775076780649876, 31.404621956730786, 46.797047571219935, 31.663884264456172, 52.7670256579708, 42.95588900078649, 29.7374402821975, 38.182770171719866, 97.24210773602634, 54.78609260597638, 57.726367721504744, 45.76045733209075, 51.37351118263438, 50.92865980697611, 39.16931317048089, 49.37026211111213, 40.31571186256946, 35.36533161380697, 53.14693738228199, 40.63959317745499, 45.65863640741167, 35.26869907090901, 44.612116292314155, 66.70308524020484, 32.44750573043761, 60.738442823234934, 62.971808838079035, 80.33363917833563, 60.4945951431742], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19722786165578113, "mean_inference_ms": 0.9865922422917839, "mean_action_processing_ms": 0.04104589576708256, "mean_env_wait_ms": 0.9010929464531796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1289600, "timers": {"sample_time_ms": 4279.187, "sample_throughput": 3739.028, "learn_time_ms": 8151.849, "learn_throughput": 1962.745, "update_time_ms": 1.711}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 9.999999999999999e-05, "total_loss": 0.25312956052411134, "policy_loss": -0.021195731315410336, "vf_loss": 0.2727425861985061, "vf_explained_var": 0.9778071045875549, "kl": 0.006330803137533604, "entropy": -4.548703494345307, "entropy_coeff": 0.0}}, "num_steps_sampled": 1289600, "num_steps_trained": 1289600}, "done": false, "episodes_total": 1272, "training_iteration": 99, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-18-13", "timestamp": 1617650293, "time_this_iter_s": 10.980519533157349, "time_total_s": 799.9225628376007, "pid": 27114, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7824665959601428, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 14, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15522515826421804, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 87.06641364097595, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.4, "ram_util_percent": 54.3}, "trial_id": "9a1ab_00001"}
{"episode_reward_max": 117.4471294405357, "episode_reward_min": 17.357477121206973, "episode_reward_mean": 50.05058909208044, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.28453235992925, 46.6475213683441, 46.68394383839731, 57.284191147164236, 32.21047053502704, 108.01907321854306, 51.59714841154214, 40.82696308359955, 91.61313461294539, 110.00537015896282, 46.11916002038745, 64.93952535449465, 35.55862992209355, 39.96391754718049, 78.98871124844331, 72.48064727920324, 44.27452972934026, 21.205954980495736, 25.69909177559728, 34.96534064185155, 21.905596622364826, 20.754299442097164, 33.497810846213746, 19.887185309252146, 53.05848918653297, 43.08555039589706, 48.18423372905225, 84.1726492277938, 18.76266838552455, 81.92747711680967, 54.500333013568756, 40.65239849562251, 17.357477121206973, 28.910252637815567, 48.63556166978138, 50.717733281271116, 91.96171372300084, 36.573020719217844, 46.02289222280115, 49.32254252334126, 28.128558194828045, 48.81462825092626, 35.8028308123437, 35.854565673815934, 29.10915463838749, 26.903628597198708, 24.20593750668562, 36.04882531953326, 43.1717596893386, 65.56325368383146, 38.70045792469448, 40.27371267776533, 54.26462922885399, 117.4471294405357, 91.76995908881848, 39.775076780649876, 31.404621956730786, 46.797047571219935, 31.663884264456172, 52.7670256579708, 42.95588900078649, 29.7374402821975, 38.182770171719866, 97.24210773602634, 54.78609260597638, 57.726367721504744, 45.76045733209075, 51.37351118263438, 50.92865980697611, 39.16931317048089, 49.37026211111213, 40.31571186256946, 35.36533161380697, 53.14693738228199, 40.63959317745499, 45.65863640741167, 35.26869907090901, 44.612116292314155, 66.70308524020484, 32.44750573043761, 60.738442823234934, 62.971808838079035, 80.33363917833563, 60.4945951431742, 49.14994275273077, 41.60738500972996, 24.958171153080468, 36.43089197079021, 34.23732788317514, 84.9613040528361, 113.87662747578877, 72.09764283632082, 82.16862149066459, 62.84840229096629, 46.55491368982022, 58.774797924727416, 24.792152263966994, 23.88822440703339, 96.6701334446514, 43.38896681874823], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18968126582218034, "mean_inference_ms": 0.9518999319535307, "mean_action_processing_ms": 0.03949252284306103, "mean_env_wait_ms": 0.8621298714615377, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 1305600, "timers": {"sample_time_ms": 4177.757, "sample_throughput": 3829.806, "learn_time_ms": 8110.213, "learn_throughput": 1972.821, "update_time_ms": 1.702}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 9.999999999999999e-05, "total_loss": 0.24683308823235856, "policy_loss": -0.02039436563392686, "vf_loss": 0.2656836427131276, "vf_explained_var": 0.9798840284347534, "kl": 0.006175243319457124, "entropy": -4.5891247615692725, "entropy_coeff": 0.0}}, "num_steps_sampled": 1305600, "num_steps_trained": 1305600}, "done": true, "episodes_total": 1288, "training_iteration": 100, "experiment_id": "080eae6c33424f37b3323047196827eb", "date": "2021-04-05_12-18-24", "timestamp": 1617650304, "time_this_iter_s": 11.294318199157715, "time_total_s": 811.2168810367584, "pid": 27114, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 15100, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 20, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.7824665959601428, "kl_coeff": 1.0, "sgd_minibatch_size": 102, "shuffle_sequences": true, "num_sgd_iter": 14, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15522515826421804, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 98.36073184013367, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.44375, "ram_util_percent": 54.26875}, "trial_id": "9a1ab_00001"}
