{"episode_reward_max": 0.893481242097186, "episode_reward_min": -0.2979373747641043, "episode_reward_mean": -0.019971607635243055, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.16471900510384818, 0.11086260997700892, -0.2979373747641043, -0.17524424993104137, -0.21011635500811088, -0.050441941434560156, -0.2656577869144745, 0.893481242097186], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16577875584388752, "mean_inference_ms": 0.8687629588537669, "mean_action_processing_ms": 0.03648146701593581, "mean_env_wait_ms": 0.868063634083134, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 9600, "timers": {"sample_time_ms": 3008.424, "sample_throughput": 3191.039, "learn_time_ms": 2573.632, "learn_throughput": 3730.136, "update_time_ms": 1.508}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.0020679401606321333, "policy_loss": -0.026238360702991487, "vf_loss": 0.0048711620612690845, "vf_explained_var": 0.198189839720726, "kl": 0.019299257745345435, "entropy": -3.298943926493327, "entropy_coeff": 0.0}}, "num_steps_sampled": 9600, "num_steps_trained": 9600}, "done": false, "episodes_total": 8, "training_iteration": 1, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-26-01", "timestamp": 1617996361, "time_this_iter_s": 5.587257623672485, "time_total_s": 5.587257623672485, "pid": 7723, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.587257623672485, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.150000000000006, "ram_util_percent": 79.175}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.893481242097186, "episode_reward_min": -0.5170154893436836, "episode_reward_mean": -0.010591780900934544, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5170154893436836, 0.6741833493449465, -0.5087253712622144, 0.21109943862140557, -0.4546611756557202, -0.1275641273479997, 0.16675708421190993, 0.5462306580983476, -0.16471900510384818, 0.11086260997700892, -0.2979373747641043, -0.17524424993104137, -0.21011635500811088, -0.050441941434560156, -0.2656577869144745, 0.893481242097186], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17441055981734796, "mean_inference_ms": 0.9000591263601565, "mean_action_processing_ms": 0.03776464948039356, "mean_env_wait_ms": 0.8838925547436598, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 19200, "timers": {"sample_time_ms": 3001.569, "sample_throughput": 3198.327, "learn_time_ms": 2524.732, "learn_throughput": 3802.384, "update_time_ms": 1.445}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.010151847222199042, "policy_loss": -0.023071414257089296, "vf_loss": 0.003289383631199598, "vf_explained_var": 0.2210334986448288, "kl": 0.009630183124293883, "entropy": -3.2786752541859943, "entropy_coeff": 0.0}}, "num_steps_sampled": 19200, "num_steps_trained": 19200}, "done": false, "episodes_total": 16, "training_iteration": 2, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-26-06", "timestamp": 1617996366, "time_this_iter_s": 5.476544141769409, "time_total_s": 11.063801765441895, "pid": 7723, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.063801765441895, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.6125, "ram_util_percent": 79.3625}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.893481242097186, "episode_reward_min": -0.5284570643006881, "episode_reward_mean": -0.11134678528349708, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.39100939589379213, -0.37194544956863174, -0.5284570643006881, -0.12649551936412473, -0.06249218976843596, -0.3511754172583091, -0.35768536091412517, -0.31359395532087, -0.16471900510384818, 0.11086260997700892, -0.2979373747641043, -0.17524424993104137, -0.21011635500811088, -0.050441941434560156, -0.2656577869144745, 0.893481242097186, -0.5170154893436836, 0.6741833493449465, -0.5087253712622144, 0.21109943862140557, -0.4546611756557202, -0.1275641273479997, 0.16675708421190993, 0.5462306580983476], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18015743569497034, "mean_inference_ms": 0.927833106278248, "mean_action_processing_ms": 0.03890630746090973, "mean_env_wait_ms": 0.9033405440756767, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 28800, "timers": {"sample_time_ms": 3056.502, "sample_throughput": 3140.845, "learn_time_ms": 2488.295, "learn_throughput": 3858.063, "update_time_ms": 1.458}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.006775223861138026, "policy_loss": -0.01729555118829012, "vf_loss": 0.002421462327862779, "vf_explained_var": 0.3255789279937744, "kl": 0.008098864791293939, "entropy": -3.2761795330047607, "entropy_coeff": 0.0}}, "num_steps_sampled": 28800, "num_steps_trained": 28800}, "done": false, "episodes_total": 24, "training_iteration": 3, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-26-12", "timestamp": 1617996372, "time_this_iter_s": 5.589159965515137, "time_total_s": 16.65296173095703, "pid": 7723, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.65296173095703, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.2125, "ram_util_percent": 79.5125}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.893481242097186, "episode_reward_min": -0.575787571258236, "episode_reward_mean": -0.16570787876059756, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.18837129820401266, -0.24779364703788176, -0.575787571258236, 0.25278322514065277, -0.37932339603061727, -0.5171920495199667, -0.5339385807216402, -0.4407059559034907, -0.16471900510384818, 0.11086260997700892, -0.2979373747641043, -0.17524424993104137, -0.21011635500811088, -0.050441941434560156, -0.2656577869144745, 0.893481242097186, -0.5170154893436836, 0.6741833493449465, -0.5087253712622144, 0.21109943862140557, -0.4546611756557202, -0.1275641273479997, 0.16675708421190993, 0.5462306580983476, -0.39100939589379213, -0.37194544956863174, -0.5284570643006881, -0.12649551936412473, -0.06249218976843596, -0.3511754172583091, -0.35768536091412517, -0.31359395532087], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18455531878136855, "mean_inference_ms": 0.9448365436876923, "mean_action_processing_ms": 0.039618310595693006, "mean_env_wait_ms": 0.9148671065490543, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 38400, "timers": {"sample_time_ms": 3043.702, "sample_throughput": 3154.054, "learn_time_ms": 2498.391, "learn_throughput": 3842.473, "update_time_ms": 1.462}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.010025856923311949, "policy_loss": -0.02078148261954387, "vf_loss": 0.0023008706839755177, "vf_explained_var": 0.3753768801689148, "kl": 0.008454755283892154, "entropy": -3.272911157608032, "entropy_coeff": 0.0}}, "num_steps_sampled": 38400, "num_steps_trained": 38400}, "done": false, "episodes_total": 32, "training_iteration": 4, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-26-18", "timestamp": 1617996378, "time_this_iter_s": 5.540812015533447, "time_total_s": 22.19377374649048, "pid": 7723, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.19377374649048, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 47.7875, "ram_util_percent": 79.475}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.893481242097186, "episode_reward_min": -0.575787571258236, "episode_reward_mean": -0.19236083615330027, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.46045978743391214, -0.38208746807840643, -0.030196451840504346, -0.4395806542741026, -0.09765455045611837, -0.12311717006767087, -0.42188997126078454, 0.020371652348915692, -0.24347287459546696, -0.1117540525461016, -0.307058631758109, -0.3726979958499053, -0.3819116856636925, -0.011404411415870563, -0.17769214199413985, -0.3900618201334224, -0.16471900510384818, 0.11086260997700892, -0.2979373747641043, -0.17524424993104137, -0.21011635500811088, -0.050441941434560156, -0.2656577869144745, 0.893481242097186, -0.5170154893436836, 0.6741833493449465, -0.5087253712622144, 0.21109943862140557, -0.4546611756557202, -0.1275641273479997, 0.16675708421190993, 0.5462306580983476, -0.39100939589379213, -0.37194544956863174, -0.5284570643006881, -0.12649551936412473, -0.06249218976843596, -0.3511754172583091, -0.35768536091412517, -0.31359395532087, -0.18837129820401266, -0.24779364703788176, -0.575787571258236, 0.25278322514065277, -0.37932339603061727, -0.5171920495199667, -0.5339385807216402, -0.4407059559034907], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1922955346222064, "mean_inference_ms": 0.9575761868016297, "mean_action_processing_ms": 0.04011465869365862, "mean_env_wait_ms": 0.9198185588141667, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 48000, "timers": {"sample_time_ms": 3020.027, "sample_throughput": 3178.78, "learn_time_ms": 2510.528, "learn_throughput": 3823.897, "update_time_ms": 1.464}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.01245678065965573, "policy_loss": -0.025344111695885657, "vf_loss": 0.0024305700495218237, "vf_explained_var": 0.4739852249622345, "kl": 0.010456760078668595, "entropy": -3.2907234160105387, "entropy_coeff": 0.0}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 5, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-26-23", "timestamp": 1617996383, "time_this_iter_s": 5.490663290023804, "time_total_s": 27.684437036514282, "pid": 7723, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 27.684437036514282, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 46.550000000000004, "ram_util_percent": 79.375}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.893481242097186, "episode_reward_min": -0.582543003581992, "episode_reward_mean": -0.20357324043191977, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.2055822999990189, -0.4107593889967668, -0.08123172829350789, -0.1379964280810605, -0.19112456280992907, -0.582543003581992, -0.4466937169544097, -0.11085020011240854, -0.16471900510384818, 0.11086260997700892, -0.2979373747641043, -0.17524424993104137, -0.21011635500811088, -0.050441941434560156, -0.2656577869144745, 0.893481242097186, -0.5170154893436836, 0.6741833493449465, -0.5087253712622144, 0.21109943862140557, -0.4546611756557202, -0.1275641273479997, 0.16675708421190993, 0.5462306580983476, -0.39100939589379213, -0.37194544956863174, -0.5284570643006881, -0.12649551936412473, -0.06249218976843596, -0.3511754172583091, -0.35768536091412517, -0.31359395532087, -0.18837129820401266, -0.24779364703788176, -0.575787571258236, 0.25278322514065277, -0.37932339603061727, -0.5171920495199667, -0.5339385807216402, -0.4407059559034907, -0.46045978743391214, -0.38208746807840643, -0.030196451840504346, -0.4395806542741026, -0.09765455045611837, -0.12311717006767087, -0.42188997126078454, 0.020371652348915692, -0.24347287459546696, -0.1117540525461016, -0.307058631758109, -0.3726979958499053, -0.3819116856636925, -0.011404411415870563, -0.17769214199413985, -0.3900618201334224], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19341007364239865, "mean_inference_ms": 0.9582533710739309, "mean_action_processing_ms": 0.04013570776797846, "mean_env_wait_ms": 0.9179281976088334, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 57600, "timers": {"sample_time_ms": 2927.376, "sample_throughput": 3279.388, "learn_time_ms": 2516.138, "learn_throughput": 3815.371, "update_time_ms": 1.445}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.013763388643662135, "policy_loss": -0.02566915061324835, "vf_loss": 0.002596940662090977, "vf_explained_var": 0.4478950500488281, "kl": 0.009308820112297932, "entropy": -3.289976053237915, "entropy_coeff": 0.0}}, "num_steps_sampled": 57600, "num_steps_trained": 57600}, "done": false, "episodes_total": 56, "training_iteration": 6, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-26-28", "timestamp": 1617996388, "time_this_iter_s": 5.013918161392212, "time_total_s": 32.698355197906494, "pid": 7723, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 32.698355197906494, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 42.528571428571425, "ram_util_percent": 79.47142857142856}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.893481242097186, "episode_reward_min": -0.582543003581992, "episode_reward_mean": -0.19391114320465544, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.406293242646488, 0.37307585125105214, -0.1335114841333046, 0.23822316082804917, -0.39182404476679666, -0.48568786312419227, -0.03876771883013497, -0.1654263594886266, -0.16471900510384818, 0.11086260997700892, -0.2979373747641043, -0.17524424993104137, -0.21011635500811088, -0.050441941434560156, -0.2656577869144745, 0.893481242097186, -0.5170154893436836, 0.6741833493449465, -0.5087253712622144, 0.21109943862140557, -0.4546611756557202, -0.1275641273479997, 0.16675708421190993, 0.5462306580983476, -0.39100939589379213, -0.37194544956863174, -0.5284570643006881, -0.12649551936412473, -0.06249218976843596, -0.3511754172583091, -0.35768536091412517, -0.31359395532087, -0.18837129820401266, -0.24779364703788176, -0.575787571258236, 0.25278322514065277, -0.37932339603061727, -0.5171920495199667, -0.5339385807216402, -0.4407059559034907, -0.46045978743391214, -0.38208746807840643, -0.030196451840504346, -0.4395806542741026, -0.09765455045611837, -0.12311717006767087, -0.42188997126078454, 0.020371652348915692, -0.24347287459546696, -0.1117540525461016, -0.307058631758109, -0.3726979958499053, -0.3819116856636925, -0.011404411415870563, -0.17769214199413985, -0.3900618201334224, -0.2055822999990189, -0.4107593889967668, -0.08123172829350789, -0.1379964280810605, -0.19112456280992907, -0.582543003581992, -0.4466937169544097, -0.11085020011240854], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19379539967453352, "mean_inference_ms": 0.9587295974872923, "mean_action_processing_ms": 0.04015112504294009, "mean_env_wait_ms": 0.9162891130792188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 67200, "timers": {"sample_time_ms": 2911.456, "sample_throughput": 3297.319, "learn_time_ms": 2509.271, "learn_throughput": 3825.813, "update_time_ms": 1.496}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.011717169359326363, "policy_loss": -0.02488571179409822, "vf_loss": 0.0029230653463552395, "vf_explained_var": 0.5149166584014893, "kl": 0.01024547675003608, "entropy": -3.3084533405303955, "entropy_coeff": 0.0}}, "num_steps_sampled": 67200, "num_steps_trained": 67200}, "done": false, "episodes_total": 64, "training_iteration": 7, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-26-33", "timestamp": 1617996393, "time_this_iter_s": 5.290521860122681, "time_total_s": 37.988877058029175, "pid": 7723, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.988877058029175, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 42.3, "ram_util_percent": 79.525}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.893481242097186, "episode_reward_min": -0.6617860915459899, "episode_reward_mean": -0.17382875879433868, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.11129053551261436, 0.7453529096435925, -0.43829809096253664, 0.4943803990055111, -0.3303761690079826, -0.6617860915459899, -0.1031823783289123, 0.07726141758926608, -0.16471900510384818, 0.11086260997700892, -0.2979373747641043, -0.17524424993104137, -0.21011635500811088, -0.050441941434560156, -0.2656577869144745, 0.893481242097186, -0.5170154893436836, 0.6741833493449465, -0.5087253712622144, 0.21109943862140557, -0.4546611756557202, -0.1275641273479997, 0.16675708421190993, 0.5462306580983476, -0.39100939589379213, -0.37194544956863174, -0.5284570643006881, -0.12649551936412473, -0.06249218976843596, -0.3511754172583091, -0.35768536091412517, -0.31359395532087, -0.18837129820401266, -0.24779364703788176, -0.575787571258236, 0.25278322514065277, -0.37932339603061727, -0.5171920495199667, -0.5339385807216402, -0.4407059559034907, -0.46045978743391214, -0.38208746807840643, -0.030196451840504346, -0.4395806542741026, -0.09765455045611837, -0.12311717006767087, -0.42188997126078454, 0.020371652348915692, -0.24347287459546696, -0.1117540525461016, -0.307058631758109, -0.3726979958499053, -0.3819116856636925, -0.011404411415870563, -0.17769214199413985, -0.3900618201334224, -0.2055822999990189, -0.4107593889967668, -0.08123172829350789, -0.1379964280810605, -0.19112456280992907, -0.582543003581992, -0.4466937169544097, -0.11085020011240854, -0.406293242646488, 0.37307585125105214, -0.1335114841333046, 0.23822316082804917, -0.39182404476679666, -0.48568786312419227, -0.03876771883013497, -0.1654263594886266], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19417030575306374, "mean_inference_ms": 0.9602242374157561, "mean_action_processing_ms": 0.04021059417026134, "mean_env_wait_ms": 0.9160857535434543, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 76800, "timers": {"sample_time_ms": 2924.645, "sample_throughput": 3282.45, "learn_time_ms": 2493.286, "learn_throughput": 3850.341, "update_time_ms": 1.52}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.014619588268299897, "policy_loss": -0.029175770804286003, "vf_loss": 0.003064489038661122, "vf_explained_var": 0.5701514482498169, "kl": 0.01149169459939003, "entropy": -3.31626895904541, "entropy_coeff": 0.0}}, "num_steps_sampled": 76800, "num_steps_trained": 76800}, "done": false, "episodes_total": 72, "training_iteration": 8, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-26-39", "timestamp": 1617996399, "time_this_iter_s": 5.404919862747192, "time_total_s": 43.39379692077637, "pid": 7723, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.39379692077637, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 44.4375, "ram_util_percent": 79.39999999999999}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.893481242097186, "episode_reward_min": -0.6617860915459899, "episode_reward_mean": -0.16880228315356116, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.0620810672095754, -0.18835619065125153, -0.14929601768852685, -0.5283667118655263, -0.2028997901556744, -0.2668231639486365, -0.40966626060426736, 0.81897718303095, -0.16471900510384818, 0.11086260997700892, -0.2979373747641043, -0.17524424993104137, -0.21011635500811088, -0.050441941434560156, -0.2656577869144745, 0.893481242097186, -0.5170154893436836, 0.6741833493449465, -0.5087253712622144, 0.21109943862140557, -0.4546611756557202, -0.1275641273479997, 0.16675708421190993, 0.5462306580983476, -0.39100939589379213, -0.37194544956863174, -0.5284570643006881, -0.12649551936412473, -0.06249218976843596, -0.3511754172583091, -0.35768536091412517, -0.31359395532087, -0.18837129820401266, -0.24779364703788176, -0.575787571258236, 0.25278322514065277, -0.37932339603061727, -0.5171920495199667, -0.5339385807216402, -0.4407059559034907, -0.46045978743391214, -0.38208746807840643, -0.030196451840504346, -0.4395806542741026, -0.09765455045611837, -0.12311717006767087, -0.42188997126078454, 0.020371652348915692, -0.24347287459546696, -0.1117540525461016, -0.307058631758109, -0.3726979958499053, -0.3819116856636925, -0.011404411415870563, -0.17769214199413985, -0.3900618201334224, -0.2055822999990189, -0.4107593889967668, -0.08123172829350789, -0.1379964280810605, -0.19112456280992907, -0.582543003581992, -0.4466937169544097, -0.11085020011240854, -0.406293242646488, 0.37307585125105214, -0.1335114841333046, 0.23822316082804917, -0.39182404476679666, -0.48568786312419227, -0.03876771883013497, -0.1654263594886266, 0.11129053551261436, 0.7453529096435925, -0.43829809096253664, 0.4943803990055111, -0.3303761690079826, -0.6617860915459899, -0.1031823783289123, 0.07726141758926608], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19457020625033544, "mean_inference_ms": 0.9616247386130059, "mean_action_processing_ms": 0.040274755764369896, "mean_env_wait_ms": 0.9160983158058318, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 86400, "timers": {"sample_time_ms": 2917.642, "sample_throughput": 3290.328, "learn_time_ms": 2535.286, "learn_throughput": 3786.555, "update_time_ms": 1.528}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.01291493384167552, "policy_loss": -0.025695670284330844, "vf_loss": 0.002687981173706551, "vf_explained_var": 0.6097613573074341, "kl": 0.010092753985275826, "entropy": -3.3189456049601236, "entropy_coeff": 0.0}}, "num_steps_sampled": 86400, "num_steps_trained": 86400}, "done": false, "episodes_total": 80, "training_iteration": 9, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-26-45", "timestamp": 1617996405, "time_this_iter_s": 5.739832639694214, "time_total_s": 49.13362956047058, "pid": 7723, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.13362956047058, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 52.962500000000006, "ram_util_percent": 74.875}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.893481242097186, "episode_reward_min": -0.664149058179107, "episode_reward_mean": -0.1621975400232846, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.045405379216985176, -0.39572971834079895, -0.16213055188414305, -0.2926539876491262, -0.3005016206820149, -0.372474054286514, 0.8026825377205009, -0.2677911494494265, 0.16036811113585858, 0.19046207480929533, -0.312310946576849, -0.21112810605949417, -0.03418347702543156, 0.13873157997922836, -0.664149058179107, -0.30056744424542114, -0.16471900510384818, 0.11086260997700892, -0.2979373747641043, -0.17524424993104137, -0.21011635500811088, -0.050441941434560156, -0.2656577869144745, 0.893481242097186, -0.5170154893436836, 0.6741833493449465, -0.5087253712622144, 0.21109943862140557, -0.4546611756557202, -0.1275641273479997, 0.16675708421190993, 0.5462306580983476, -0.39100939589379213, -0.37194544956863174, -0.5284570643006881, -0.12649551936412473, -0.06249218976843596, -0.3511754172583091, -0.35768536091412517, -0.31359395532087, -0.18837129820401266, -0.24779364703788176, -0.575787571258236, 0.25278322514065277, -0.37932339603061727, -0.5171920495199667, -0.5339385807216402, -0.4407059559034907, -0.46045978743391214, -0.38208746807840643, -0.030196451840504346, -0.4395806542741026, -0.09765455045611837, -0.12311717006767087, -0.42188997126078454, 0.020371652348915692, -0.24347287459546696, -0.1117540525461016, -0.307058631758109, -0.3726979958499053, -0.3819116856636925, -0.011404411415870563, -0.17769214199413985, -0.3900618201334224, -0.2055822999990189, -0.4107593889967668, -0.08123172829350789, -0.1379964280810605, -0.19112456280992907, -0.582543003581992, -0.4466937169544097, -0.11085020011240854, -0.406293242646488, 0.37307585125105214, -0.1335114841333046, 0.23822316082804917, -0.39182404476679666, -0.48568786312419227, -0.03876771883013497, -0.1654263594886266, 0.11129053551261436, 0.7453529096435925, -0.43829809096253664, 0.4943803990055111, -0.3303761690079826, -0.6617860915459899, -0.1031823783289123, 0.07726141758926608, -0.0620810672095754, -0.18835619065125153, -0.14929601768852685, -0.5283667118655263, -0.2028997901556744, -0.2668231639486365, -0.40966626060426736, 0.81897718303095], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1967777113819004, "mean_inference_ms": 0.9693149498198418, "mean_action_processing_ms": 0.040505075806804264, "mean_env_wait_ms": 0.9193122909979535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 96000, "timers": {"sample_time_ms": 2989.054, "sample_throughput": 3211.718, "learn_time_ms": 2526.785, "learn_throughput": 3799.295, "update_time_ms": 1.519}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.017586355693638325, "policy_loss": -0.032042282161613304, "vf_loss": 0.003118536788970232, "vf_explained_var": 0.6514750123023987, "kl": 0.011337391138076781, "entropy": -3.3264059034983315, "entropy_coeff": 0.0}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 10, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-26-51", "timestamp": 1617996411, "time_this_iter_s": 6.088395118713379, "time_total_s": 55.22202467918396, "pid": 7723, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 55.22202467918396, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 54.21111111111111, "ram_util_percent": 79.23333333333332}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.4829641897086616, "episode_reward_min": -0.21766378740157788, "episode_reward_mean": -0.022611155527958948, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.21543991445002786, -0.1977853795964818, -0.21766378740157788, -0.14235456078066522, -0.1579718057345767, -0.2113585711509116, 0.4829641897086616, 0.04784075628185214], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23146538214322232, "mean_inference_ms": 1.178588100912966, "mean_action_processing_ms": 0.04985494280139373, "mean_env_wait_ms": 1.177398539105621, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 105600, "timers": {"sample_time_ms": 3500.872, "sample_throughput": 2742.174, "learn_time_ms": 2889.328, "learn_throughput": 3322.572, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.01777973641951879, "policy_loss": -0.03258829320470492, "vf_loss": 0.002896604739750425, "vf_explained_var": 0.5569677948951721, "kl": 0.011911951688428719, "entropy": -3.3382781346639, "entropy_coeff": 0.0}}, "num_steps_sampled": 105600, "num_steps_trained": 105600}, "done": false, "episodes_total": 104, "training_iteration": 11, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-27-50", "timestamp": 1617996470, "time_this_iter_s": 6.395701169967651, "time_total_s": 61.61772584915161, "pid": 8400, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6.395701169967651, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 50.940000000000005, "ram_util_percent": 78.86}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.4829641897086616, "episode_reward_min": -0.5636454741101067, "episode_reward_mean": -0.17726860998423785, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.24954015310731192, -0.4494463598273725, -0.4108059231227662, -0.3293959337067215, -0.0582437696574577, -0.28200075531446267, -0.3123301466779348, -0.5636454741101067, 0.21543991445002786, -0.1977853795964818, -0.21766378740157788, -0.14235456078066522, -0.1579718057345767, -0.2113585711509116, 0.4829641897086616, 0.04784075628185214], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22216523720501238, "mean_inference_ms": 1.1515427468972914, "mean_action_processing_ms": 0.04858165908455543, "mean_env_wait_ms": 1.1342648654815126, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 115200, "timers": {"sample_time_ms": 3298.267, "sample_throughput": 2910.619, "learn_time_ms": 3173.306, "learn_throughput": 3025.236, "update_time_ms": 1.578}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.013223681971430779, "policy_loss": -0.028673164496819177, "vf_loss": 0.002902113649373253, "vf_explained_var": 0.6002237796783447, "kl": 0.012547368593513965, "entropy": -3.340834328333537, "entropy_coeff": 0.0}}, "num_steps_sampled": 115200, "num_steps_trained": 115200}, "done": false, "episodes_total": 112, "training_iteration": 12, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-27-57", "timestamp": 1617996477, "time_this_iter_s": 6.559774875640869, "time_total_s": 68.17750072479248, "pid": 8400, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12.95547604560852, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 53.266666666666666, "ram_util_percent": 75.47777777777779}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.4829641897086616, "episode_reward_min": -0.5636454741101067, "episode_reward_mean": -0.09135106139754057, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.13793438073193487, 0.2698510352816623, -0.17797046104243064, -0.01317744624901529, -0.22983600839322926, 0.2793482004464849, 0.3155890750593515, 0.06213351037207371, 0.21543991445002786, -0.1977853795964818, -0.21766378740157788, -0.14235456078066522, -0.1579718057345767, -0.2113585711509116, 0.4829641897086616, 0.04784075628185214, -0.24954015310731192, -0.4494463598273725, -0.4108059231227662, -0.3293959337067215, -0.0582437696574577, -0.28200075531446267, -0.3123301466779348, -0.5636454741101067], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22006833590147712, "mean_inference_ms": 1.1457270527171015, "mean_action_processing_ms": 0.04829449401311755, "mean_env_wait_ms": 1.120467864775947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 124800, "timers": {"sample_time_ms": 3311.103, "sample_throughput": 2899.336, "learn_time_ms": 3142.073, "learn_throughput": 3055.308, "update_time_ms": 1.614}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.016739344044278067, "policy_loss": -0.030797495394945144, "vf_loss": 0.0027564964753886063, "vf_explained_var": 0.6332637071609497, "kl": 0.011301654788355032, "entropy": -3.3520958932240803, "entropy_coeff": 0.0}}, "num_steps_sampled": 124800, "num_steps_trained": 124800}, "done": false, "episodes_total": 120, "training_iteration": 13, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-28-04", "timestamp": 1617996484, "time_this_iter_s": 6.423002243041992, "time_total_s": 74.60050296783447, "pid": 8400, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19.378478288650513, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 57.93333333333333, "ram_util_percent": 78.97777777777777}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.4829641897086616, "episode_reward_min": -0.5636454741101067, "episode_reward_mean": -0.1290249404702981, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.05294950487915817, -0.31354372776963835, -0.20111232815178204, -0.5229912645405277, -0.3108546831221657, -0.28133947204869614, -0.08045908850026906, -0.2790215622546449, 0.21543991445002786, -0.1977853795964818, -0.21766378740157788, -0.14235456078066522, -0.1579718057345767, -0.2113585711509116, 0.4829641897086616, 0.04784075628185214, -0.24954015310731192, -0.4494463598273725, -0.4108059231227662, -0.3293959337067215, -0.0582437696574577, -0.28200075531446267, -0.3123301466779348, -0.5636454741101067, 0.13793438073193487, 0.2698510352816623, -0.17797046104243064, -0.01317744624901529, -0.22983600839322926, 0.2793482004464849, 0.3155890750593515, 0.06213351037207371], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21534471167883565, "mean_inference_ms": 1.1318189145127957, "mean_action_processing_ms": 0.047345307413821314, "mean_env_wait_ms": 1.092561087427559, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 134400, "timers": {"sample_time_ms": 3129.074, "sample_throughput": 3068.001, "learn_time_ms": 3154.134, "learn_throughput": 3043.625, "update_time_ms": 1.606}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.016961795402069886, "policy_loss": -0.03168518892178933, "vf_loss": 0.0022778539825230835, "vf_explained_var": 0.6716348528862, "kl": 0.012445539614806572, "entropy": -3.364203443527222, "entropy_coeff": 0.0}}, "num_steps_sampled": 134400, "num_steps_trained": 134400}, "done": false, "episodes_total": 128, "training_iteration": 14, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-28-09", "timestamp": 1617996489, "time_this_iter_s": 5.780299186706543, "time_total_s": 80.38080215454102, "pid": 8400, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.158777475357056, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 32.4, "ram_util_percent": 79.1125}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.4829641897086616, "episode_reward_min": -0.5636454741101067, "episode_reward_mean": -0.11239376329659845, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.12629771737376583, -0.32026762156104094, -0.07884773649483745, 0.06394878544392912, 0.0930135543909818, 0.05418182116441561, -0.24700749034817526, 0.33783570511196737, -0.313542961677858, 0.28262976657679206, 0.3533316076958901, -0.35709116727125045, 0.03286309034861179, -0.47014955964152155, -0.3732827285413852, -0.19741989100993984, 0.21543991445002786, -0.1977853795964818, -0.21766378740157788, -0.14235456078066522, -0.1579718057345767, -0.2113585711509116, 0.4829641897086616, 0.04784075628185214, -0.24954015310731192, -0.4494463598273725, -0.4108059231227662, -0.3293959337067215, -0.0582437696574577, -0.28200075531446267, -0.3123301466779348, -0.5636454741101067, 0.13793438073193487, 0.2698510352816623, -0.17797046104243064, -0.01317744624901529, -0.22983600839322926, 0.2793482004464849, 0.3155890750593515, 0.06213351037207371, 0.05294950487915817, -0.31354372776963835, -0.20111232815178204, -0.5229912645405277, -0.3108546831221657, -0.28133947204869614, -0.08045908850026906, -0.2790215622546449], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21614221693087507, "mean_inference_ms": 1.1231682729411305, "mean_action_processing_ms": 0.04667029957183536, "mean_env_wait_ms": 1.0704662939496024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 144000, "timers": {"sample_time_ms": 3200.203, "sample_throughput": 2999.81, "learn_time_ms": 3080.493, "learn_throughput": 3116.385, "update_time_ms": 1.589}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.018337869408229988, "policy_loss": -0.03224418699741363, "vf_loss": 0.0028804947528988122, "vf_explained_var": 0.6243449449539185, "kl": 0.011025823323676983, "entropy": -3.3920691426595053, "entropy_coeff": 0.0}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 15, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-28-16", "timestamp": 1617996496, "time_this_iter_s": 6.277310132980347, "time_total_s": 86.65811228752136, "pid": 8400, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 31.436087608337402, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 50.32222222222222, "ram_util_percent": 79.3111111111111}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 1.1738463215819839, "episode_reward_min": -0.5636454741101067, "episode_reward_mean": -0.008339831457051238, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.06324822152285359, 0.9777766819836049, 0.24084603864823495, 0.975629762967011, 1.1738463215819839, -0.15275609162787074, 1.052672147706009, 0.59660699386003, 0.21543991445002786, -0.1977853795964818, -0.21766378740157788, -0.14235456078066522, -0.1579718057345767, -0.2113585711509116, 0.4829641897086616, 0.04784075628185214, -0.24954015310731192, -0.4494463598273725, -0.4108059231227662, -0.3293959337067215, -0.0582437696574577, -0.28200075531446267, -0.3123301466779348, -0.5636454741101067, 0.13793438073193487, 0.2698510352816623, -0.17797046104243064, -0.01317744624901529, -0.22983600839322926, 0.2793482004464849, 0.3155890750593515, 0.06213351037207371, 0.05294950487915817, -0.31354372776963835, -0.20111232815178204, -0.5229912645405277, -0.3108546831221657, -0.28133947204869614, -0.08045908850026906, -0.2790215622546449, -0.12629771737376583, -0.32026762156104094, -0.07884773649483745, 0.06394878544392912, 0.0930135543909818, 0.05418182116441561, -0.24700749034817526, 0.33783570511196737, -0.313542961677858, 0.28262976657679206, 0.3533316076958901, -0.35709116727125045, 0.03286309034861179, -0.47014955964152155, -0.3732827285413852, -0.19741989100993984], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21490053747153862, "mean_inference_ms": 1.11392434716722, "mean_action_processing_ms": 0.04622707947828235, "mean_env_wait_ms": 1.0574868768305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 153600, "timers": {"sample_time_ms": 3049.811, "sample_throughput": 3147.736, "learn_time_ms": 3131.294, "learn_throughput": 3065.826, "update_time_ms": 1.548}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.017139642325540383, "policy_loss": -0.03362700294703245, "vf_loss": 0.004677087487652898, "vf_explained_var": 0.5391273498535156, "kl": 0.011810273571560781, "entropy": -3.4369656721750896, "entropy_coeff": 0.0}}, "num_steps_sampled": 153600, "num_steps_trained": 153600}, "done": false, "episodes_total": 152, "training_iteration": 16, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-28-21", "timestamp": 1617996501, "time_this_iter_s": 5.690328121185303, "time_total_s": 92.34844040870667, "pid": 8400, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 37.126415729522705, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.67777777777778, "ram_util_percent": 79.16666666666667}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 1.1738463215819839, "episode_reward_min": -0.5636454741101067, "episode_reward_mean": 0.015248727429281747, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7033655464494224, -0.04837377076643368, 0.30283288716289025, 0.5473332926641936, -0.3407545453212396, 0.24453868010126523, -0.11936523759725726, 0.15337226437606022, 0.21543991445002786, -0.1977853795964818, -0.21766378740157788, -0.14235456078066522, -0.1579718057345767, -0.2113585711509116, 0.4829641897086616, 0.04784075628185214, -0.24954015310731192, -0.4494463598273725, -0.4108059231227662, -0.3293959337067215, -0.0582437696574577, -0.28200075531446267, -0.3123301466779348, -0.5636454741101067, 0.13793438073193487, 0.2698510352816623, -0.17797046104243064, -0.01317744624901529, -0.22983600839322926, 0.2793482004464849, 0.3155890750593515, 0.06213351037207371, 0.05294950487915817, -0.31354372776963835, -0.20111232815178204, -0.5229912645405277, -0.3108546831221657, -0.28133947204869614, -0.08045908850026906, -0.2790215622546449, -0.12629771737376583, -0.32026762156104094, -0.07884773649483745, 0.06394878544392912, 0.0930135543909818, 0.05418182116441561, -0.24700749034817526, 0.33783570511196737, -0.313542961677858, 0.28262976657679206, 0.3533316076958901, -0.35709116727125045, 0.03286309034861179, -0.47014955964152155, -0.3732827285413852, -0.19741989100993984, 0.06324822152285359, 0.9777766819836049, 0.24084603864823495, 0.975629762967011, 1.1738463215819839, -0.15275609162787074, 1.052672147706009, 0.59660699386003], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2133784595831296, "mean_inference_ms": 1.105010961700295, "mean_action_processing_ms": 0.04583140423199088, "mean_env_wait_ms": 1.045986816563379, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 163200, "timers": {"sample_time_ms": 2997.744, "sample_throughput": 3202.409, "learn_time_ms": 3094.98, "learn_throughput": 3101.797, "update_time_ms": 1.539}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.017890033076206843, "policy_loss": -0.033235360868275166, "vf_loss": 0.0038087744855632385, "vf_explained_var": 0.6435501575469971, "kl": 0.011536553495874008, "entropy": -3.4386474736531576, "entropy_coeff": 0.0}}, "num_steps_sampled": 163200, "num_steps_trained": 163200}, "done": false, "episodes_total": 160, "training_iteration": 17, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-28-27", "timestamp": 1617996507, "time_this_iter_s": 5.569007635116577, "time_total_s": 97.91744804382324, "pid": 8400, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.69542336463928, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.275, "ram_util_percent": 79.4375}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 1.1738463215819839, "episode_reward_min": -0.5636454741101067, "episode_reward_mean": 0.02521923286845526, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.012864006591965849, 0.2904988514317648, 0.09075188394384548, 0.2878986769560996, -0.18777419877374502, 0.5277043936788122, -0.47252677539603355, 0.3161773858059693, 0.21543991445002786, -0.1977853795964818, -0.21766378740157788, -0.14235456078066522, -0.1579718057345767, -0.2113585711509116, 0.4829641897086616, 0.04784075628185214, -0.24954015310731192, -0.4494463598273725, -0.4108059231227662, -0.3293959337067215, -0.0582437696574577, -0.28200075531446267, -0.3123301466779348, -0.5636454741101067, 0.13793438073193487, 0.2698510352816623, -0.17797046104243064, -0.01317744624901529, -0.22983600839322926, 0.2793482004464849, 0.3155890750593515, 0.06213351037207371, 0.05294950487915817, -0.31354372776963835, -0.20111232815178204, -0.5229912645405277, -0.3108546831221657, -0.28133947204869614, -0.08045908850026906, -0.2790215622546449, -0.12629771737376583, -0.32026762156104094, -0.07884773649483745, 0.06394878544392912, 0.0930135543909818, 0.05418182116441561, -0.24700749034817526, 0.33783570511196737, -0.313542961677858, 0.28262976657679206, 0.3533316076958901, -0.35709116727125045, 0.03286309034861179, -0.47014955964152155, -0.3732827285413852, -0.19741989100993984, 0.06324822152285359, 0.9777766819836049, 0.24084603864823495, 0.975629762967011, 1.1738463215819839, -0.15275609162787074, 1.052672147706009, 0.59660699386003, 0.7033655464494224, -0.04837377076643368, 0.30283288716289025, 0.5473332926641936, -0.3407545453212396, 0.24453868010126523, -0.11936523759725726, 0.15337226437606022], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21220735799109558, "mean_inference_ms": 1.0984928698027967, "mean_action_processing_ms": 0.045550991339131444, "mean_env_wait_ms": 1.0376522320905082, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 172800, "timers": {"sample_time_ms": 3005.227, "sample_throughput": 3194.434, "learn_time_ms": 3118.337, "learn_throughput": 3078.564, "update_time_ms": 1.551}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.015346108873685201, "policy_loss": -0.03297232735902071, "vf_loss": 0.0034814899569998183, "vf_explained_var": 0.7033226490020752, "kl": 0.0141447320766747, "entropy": -3.4754497241973876, "entropy_coeff": 0.0}}, "num_steps_sampled": 172800, "num_steps_trained": 172800}, "done": false, "episodes_total": 168, "training_iteration": 18, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-28-33", "timestamp": 1617996513, "time_this_iter_s": 6.346179485321045, "time_total_s": 104.26362752914429, "pid": 8400, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 49.04160284996033, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 51.833333333333336, "ram_util_percent": 79.28888888888889}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 1.255330191273056, "episode_reward_min": -0.5636454741101067, "episode_reward_mean": 0.04909394648028774, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.255330191273056, 0.14378789977431516, 0.27045658008140583, 0.10908436080088468, -0.29933702082161173, 0.3308923711227978, 0.4785888899199413, -0.17707232025654795, 0.21543991445002786, -0.1977853795964818, -0.21766378740157788, -0.14235456078066522, -0.1579718057345767, -0.2113585711509116, 0.4829641897086616, 0.04784075628185214, -0.24954015310731192, -0.4494463598273725, -0.4108059231227662, -0.3293959337067215, -0.0582437696574577, -0.28200075531446267, -0.3123301466779348, -0.5636454741101067, 0.13793438073193487, 0.2698510352816623, -0.17797046104243064, -0.01317744624901529, -0.22983600839322926, 0.2793482004464849, 0.3155890750593515, 0.06213351037207371, 0.05294950487915817, -0.31354372776963835, -0.20111232815178204, -0.5229912645405277, -0.3108546831221657, -0.28133947204869614, -0.08045908850026906, -0.2790215622546449, -0.12629771737376583, -0.32026762156104094, -0.07884773649483745, 0.06394878544392912, 0.0930135543909818, 0.05418182116441561, -0.24700749034817526, 0.33783570511196737, -0.313542961677858, 0.28262976657679206, 0.3533316076958901, -0.35709116727125045, 0.03286309034861179, -0.47014955964152155, -0.3732827285413852, -0.19741989100993984, 0.06324822152285359, 0.9777766819836049, 0.24084603864823495, 0.975629762967011, 1.1738463215819839, -0.15275609162787074, 1.052672147706009, 0.59660699386003, 0.7033655464494224, -0.04837377076643368, 0.30283288716289025, 0.5473332926641936, -0.3407545453212396, 0.24453868010126523, -0.11936523759725726, 0.15337226437606022, -0.012864006591965849, 0.2904988514317648, 0.09075188394384548, 0.2878986769560996, -0.18777419877374502, 0.5277043936788122, -0.47252677539603355, 0.3161773858059693], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2107588042538721, "mean_inference_ms": 1.0908754588985188, "mean_action_processing_ms": 0.045233529152461635, "mean_env_wait_ms": 1.0286153612977373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 182400, "timers": {"sample_time_ms": 2931.158, "sample_throughput": 3275.156, "learn_time_ms": 3103.84, "learn_throughput": 3092.943, "update_time_ms": 1.536}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.018928592006365458, "policy_loss": -0.035749211062987646, "vf_loss": 0.0044448172735671206, "vf_explained_var": 0.6771714687347412, "kl": 0.012375801783055067, "entropy": -3.4769641304016115, "entropy_coeff": 0.0}}, "num_steps_sampled": 182400, "num_steps_trained": 182400}, "done": false, "episodes_total": 176, "training_iteration": 19, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-28-39", "timestamp": 1617996519, "time_this_iter_s": 5.3335020542144775, "time_total_s": 109.59712958335876, "pid": 8400, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 54.375104904174805, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.97142857142857, "ram_util_percent": 79.2}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.716184078758606, "episode_reward_min": -0.07374808424915369, "episode_reward_mean": 0.2812116974326303, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.716184078758606, 0.43650736309373883, 0.47062331807555746, 0.029225429426173122, 0.27930556157726794, -0.07374808424915369, 0.12406378579385602, 0.26753212698499684], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15450131883232124, "mean_inference_ms": 0.8134067703742567, "mean_action_processing_ms": 0.0344614849598779, "mean_env_wait_ms": 0.8166316000249959, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 192000, "timers": {"sample_time_ms": 2695.869, "sample_throughput": 3561.003, "learn_time_ms": 3129.007, "learn_throughput": 3068.066, "update_time_ms": 1.685}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.016871912733962137, "policy_loss": -0.033884481812516846, "vf_loss": 0.004387482112894456, "vf_explained_var": 0.7005252838134766, "kl": 0.012625086841483911, "entropy": -3.5224229780832927, "entropy_coeff": 0.0}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 184, "training_iteration": 20, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-30-02", "timestamp": 1617996602, "time_this_iter_s": 5.830222845077515, "time_total_s": 115.42735242843628, "pid": 10024, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5.830222845077515, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.05555555555556, "ram_util_percent": 78.93333333333334}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.716184078758606, "episode_reward_min": -0.20726522590081675, "episode_reward_mean": 0.22878263190470613, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.10857802176776032, -0.20726522590081675, 0.5405191841163375, -0.18148297703944882, 0.43020979271276616, -0.0554937901644843, 0.10075785627845102, 0.6750056692436903, 0.716184078758606, 0.43650736309373883, 0.47062331807555746, 0.029225429426173122, 0.27930556157726794, -0.07374808424915369, 0.12406378579385602, 0.26753212698499684], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1549297734778713, "mean_inference_ms": 0.8122782566074425, "mean_action_processing_ms": 0.03439354742907856, "mean_env_wait_ms": 0.7985184510820406, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 201600, "timers": {"sample_time_ms": 2460.328, "sample_throughput": 3901.918, "learn_time_ms": 3171.42, "learn_throughput": 3027.036, "update_time_ms": 1.603}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.013299556753287712, "policy_loss": -0.03067663760234912, "vf_loss": 0.0039295683273424704, "vf_explained_var": 0.7158989310264587, "kl": 0.013447513580322265, "entropy": -3.4954614734649656, "entropy_coeff": 0.0}}, "num_steps_sampled": 201600, "num_steps_trained": 201600}, "done": false, "episodes_total": 192, "training_iteration": 21, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-30-07", "timestamp": 1617996607, "time_this_iter_s": 5.4451799392700195, "time_total_s": 120.8725323677063, "pid": 10024, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11.275402784347534, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 38.725, "ram_util_percent": 79.0625}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 0.8438584597780465, "episode_reward_min": -0.20726522590081675, "episode_reward_mean": 0.24028869063698788, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3796421858406065, 0.28250012196418894, 0.2351051382311704, -0.03968221421354701, 0.1901367365424289, 0.8438584597780465, -0.09290336186632109, 0.3077493985358386, 0.716184078758606, 0.43650736309373883, 0.47062331807555746, 0.029225429426173122, 0.27930556157726794, -0.07374808424915369, 0.12406378579385602, 0.26753212698499684, 0.10857802176776032, -0.20726522590081675, 0.5405191841163375, -0.18148297703944882, 0.43020979271276616, -0.0554937901644843, 0.10075785627845102, 0.6750056692436903], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15515379834155263, "mean_inference_ms": 0.8129626219034766, "mean_action_processing_ms": 0.03439628276981479, "mean_env_wait_ms": 0.7898584891077741, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 211200, "timers": {"sample_time_ms": 2415.298, "sample_throughput": 3974.665, "learn_time_ms": 3218.012, "learn_throughput": 2983.209, "update_time_ms": 1.655}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.01503375939403971, "policy_loss": -0.03199240792542696, "vf_loss": 0.004319839145367344, "vf_explained_var": 0.7293127179145813, "kl": 0.012638810835778714, "entropy": -3.543570540746053, "entropy_coeff": 0.0}}, "num_steps_sampled": 211200, "num_steps_trained": 211200}, "done": false, "episodes_total": 200, "training_iteration": 22, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-30-13", "timestamp": 1617996613, "time_this_iter_s": 5.642960548400879, "time_total_s": 126.51549291610718, "pid": 10024, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.918363332748413, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.5, "ram_util_percent": 79.125}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 1.1922957115999941, "episode_reward_min": -0.20726522590081675, "episode_reward_mean": 0.27373878481841735, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1922957115999941, 0.015654616920921516, 0.1637868702607843, 0.5999262744569012, 0.19692622867680498, 0.05707393429828622, 0.5362125600149545, 0.23083634267299913, 0.716184078758606, 0.43650736309373883, 0.47062331807555746, 0.029225429426173122, 0.27930556157726794, -0.07374808424915369, 0.12406378579385602, 0.26753212698499684, 0.10857802176776032, -0.20726522590081675, 0.5405191841163375, -0.18148297703944882, 0.43020979271276616, -0.0554937901644843, 0.10075785627845102, 0.6750056692436903, 0.3796421858406065, 0.28250012196418894, 0.2351051382311704, -0.03968221421354701, 0.1901367365424289, 0.8438584597780465, -0.09290336186632109, 0.3077493985358386], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1553358549896293, "mean_inference_ms": 0.8209204630872373, "mean_action_processing_ms": 0.03438932839114524, "mean_env_wait_ms": 0.7838581390039456, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 220800, "timers": {"sample_time_ms": 2432.892, "sample_throughput": 3945.921, "learn_time_ms": 3243.954, "learn_throughput": 2959.352, "update_time_ms": 1.609}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.01619770744194587, "policy_loss": -0.03366424145797888, "vf_loss": 0.004807890709489584, "vf_explained_var": 0.7389931678771973, "kl": 0.012658644380668799, "entropy": -3.5359761492411295, "entropy_coeff": 0.0}}, "num_steps_sampled": 220800, "num_steps_trained": 220800}, "done": false, "episodes_total": 208, "training_iteration": 23, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-30-19", "timestamp": 1617996619, "time_this_iter_s": 5.81371545791626, "time_total_s": 132.32920837402344, "pid": 10024, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.732078790664673, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.575, "ram_util_percent": 79.1}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 1.2253405507580997, "episode_reward_min": -0.37563046070180717, "episode_reward_mean": 0.31228217336152997, "episode_len_mean": 1000.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.21940717934810094, 0.7965494350697151, 0.4350144728898675, 0.3192831383867625, -0.37563046070180717, 0.7641916426949635, 1.2253405507580997, 0.7950861484079552, -0.13438110326375174, 0.9230859551403174, 0.010391232949803042, 0.9417097750869705, 0.2890707235816954, 0.02412241190686193, -0.02968390290676548, 0.026346007815296613, 0.716184078758606, 0.43650736309373883, 0.47062331807555746, 0.029225429426173122, 0.27930556157726794, -0.07374808424915369, 0.12406378579385602, 0.26753212698499684, 0.10857802176776032, -0.20726522590081675, 0.5405191841163375, -0.18148297703944882, 0.43020979271276616, -0.0554937901644843, 0.10075785627845102, 0.6750056692436903, 0.3796421858406065, 0.28250012196418894, 0.2351051382311704, -0.03968221421354701, 0.1901367365424289, 0.8438584597780465, -0.09290336186632109, 0.3077493985358386, 1.1922957115999941, 0.015654616920921516, 0.1637868702607843, 0.5999262744569012, 0.19692622867680498, 0.05707393429828622, 0.5362125600149545, 0.23083634267299913], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16095769816188316, "mean_inference_ms": 0.8325992195653488, "mean_action_processing_ms": 0.034591943459435656, "mean_env_wait_ms": 0.7823864829231999, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 230400, "timers": {"sample_time_ms": 2497.623, "sample_throughput": 3843.655, "learn_time_ms": 3225.952, "learn_throughput": 2975.866, "update_time_ms": 1.611}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.01338904071599245, "policy_loss": -0.03230902780468265, "vf_loss": 0.0057982023308674495, "vf_explained_var": 0.7204925417900085, "kl": 0.013121785453210274, "entropy": -3.5311731847127277, "entropy_coeff": 0.0}}, "num_steps_sampled": 230400, "num_steps_trained": 230400}, "done": false, "episodes_total": 224, "training_iteration": 24, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-30-25", "timestamp": 1617996625, "time_this_iter_s": 5.916710376739502, "time_total_s": 138.24591875076294, "pid": 10024, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 28.648789167404175, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.8625, "ram_util_percent": 79.05}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 1.2253405507580997, "episode_reward_min": -0.37563046070180717, "episode_reward_mean": 0.3347036847981703, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7856027764718039, 0.3125021449054417, 0.5173192226862808, 0.5712957610129283, 0.9767168535722057, 0.2757189034004013, -0.0822842136859041, 0.3969905789809356, 0.716184078758606, 0.43650736309373883, 0.47062331807555746, 0.029225429426173122, 0.27930556157726794, -0.07374808424915369, 0.12406378579385602, 0.26753212698499684, 0.10857802176776032, -0.20726522590081675, 0.5405191841163375, -0.18148297703944882, 0.43020979271276616, -0.0554937901644843, 0.10075785627845102, 0.6750056692436903, 0.3796421858406065, 0.28250012196418894, 0.2351051382311704, -0.03968221421354701, 0.1901367365424289, 0.8438584597780465, -0.09290336186632109, 0.3077493985358386, 1.1922957115999941, 0.015654616920921516, 0.1637868702607843, 0.5999262744569012, 0.19692622867680498, 0.05707393429828622, 0.5362125600149545, 0.23083634267299913, 0.21940717934810094, 0.7965494350697151, 0.4350144728898675, 0.3192831383867625, -0.37563046070180717, 0.7641916426949635, 1.2253405507580997, 0.7950861484079552, -0.13438110326375174, 0.9230859551403174, 0.010391232949803042, 0.9417097750869705, 0.2890707235816954, 0.02412241190686193, -0.02968390290676548, 0.026346007815296613], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1631416025339507, "mean_inference_ms": 0.8375187658199786, "mean_action_processing_ms": 0.03474443719144886, "mean_env_wait_ms": 0.7839825578279734, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 240000, "timers": {"sample_time_ms": 2527.675, "sample_throughput": 3797.957, "learn_time_ms": 3204.115, "learn_throughput": 2996.147, "update_time_ms": 1.585}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.011863161853204171, "policy_loss": -0.030856072381138803, "vf_loss": 0.006113609137634437, "vf_explained_var": 0.7241501808166504, "kl": 0.01287929984430472, "entropy": -3.5655880864461262, "entropy_coeff": 0.0}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 232, "training_iteration": 25, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-30-30", "timestamp": 1617996630, "time_this_iter_s": 5.77877402305603, "time_total_s": 144.02469277381897, "pid": 10024, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.427563190460205, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.577777777777776, "ram_util_percent": 79.1}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 1.2253405507580997, "episode_reward_min": -0.37563046070180717, "episode_reward_mean": 0.3571220978130071, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.24915948691966627, 1.0521667370309942, 0.4031959510613079, 0.5342118336263768, 0.6100708025134878, 0.8968838128590668, 0.014187239171325139, 0.3525320481526957, 0.716184078758606, 0.43650736309373883, 0.47062331807555746, 0.029225429426173122, 0.27930556157726794, -0.07374808424915369, 0.12406378579385602, 0.26753212698499684, 0.10857802176776032, -0.20726522590081675, 0.5405191841163375, -0.18148297703944882, 0.43020979271276616, -0.0554937901644843, 0.10075785627845102, 0.6750056692436903, 0.3796421858406065, 0.28250012196418894, 0.2351051382311704, -0.03968221421354701, 0.1901367365424289, 0.8438584597780465, -0.09290336186632109, 0.3077493985358386, 1.1922957115999941, 0.015654616920921516, 0.1637868702607843, 0.5999262744569012, 0.19692622867680498, 0.05707393429828622, 0.5362125600149545, 0.23083634267299913, 0.21940717934810094, 0.7965494350697151, 0.4350144728898675, 0.3192831383867625, -0.37563046070180717, 0.7641916426949635, 1.2253405507580997, 0.7950861484079552, -0.13438110326375174, 0.9230859551403174, 0.010391232949803042, 0.9417097750869705, 0.2890707235816954, 0.02412241190686193, -0.02968390290676548, 0.026346007815296613, 0.7856027764718039, 0.3125021449054417, 0.5173192226862808, 0.5712957610129283, 0.9767168535722057, 0.2757189034004013, -0.0822842136859041, 0.3969905789809356], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16521502917740571, "mean_inference_ms": 0.8435384350230046, "mean_action_processing_ms": 0.03497299662732231, "mean_env_wait_ms": 0.7878546446666815, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 249600, "timers": {"sample_time_ms": 2577.023, "sample_throughput": 3725.229, "learn_time_ms": 3192.087, "learn_throughput": 3007.437, "update_time_ms": 1.596}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.010920922458171844, "policy_loss": -0.030129685923457147, "vf_loss": 0.00595360180363059, "vf_explained_var": 0.71803879737854, "kl": 0.013255161624401808, "entropy": -3.5521189626057943, "entropy_coeff": 0.0}}, "num_steps_sampled": 249600, "num_steps_trained": 249600}, "done": false, "episodes_total": 240, "training_iteration": 26, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-30-36", "timestamp": 1617996636, "time_this_iter_s": 5.999479055404663, "time_total_s": 150.02417182922363, "pid": 10024, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.42704224586487, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 45.77499999999999, "ram_util_percent": 79.1}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 1.4065503870312335, "episode_reward_min": -0.37563046070180717, "episode_reward_mean": 0.39288669240127894, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.062419991638573924, 0.7828839352967474, 1.029092969027702, 1.078944629329183, 0.0208260155260509, 1.4065503870312335, 0.29880373114494563, 0.752505933865192, 0.716184078758606, 0.43650736309373883, 0.47062331807555746, 0.029225429426173122, 0.27930556157726794, -0.07374808424915369, 0.12406378579385602, 0.26753212698499684, 0.10857802176776032, -0.20726522590081675, 0.5405191841163375, -0.18148297703944882, 0.43020979271276616, -0.0554937901644843, 0.10075785627845102, 0.6750056692436903, 0.3796421858406065, 0.28250012196418894, 0.2351051382311704, -0.03968221421354701, 0.1901367365424289, 0.8438584597780465, -0.09290336186632109, 0.3077493985358386, 1.1922957115999941, 0.015654616920921516, 0.1637868702607843, 0.5999262744569012, 0.19692622867680498, 0.05707393429828622, 0.5362125600149545, 0.23083634267299913, 0.21940717934810094, 0.7965494350697151, 0.4350144728898675, 0.3192831383867625, -0.37563046070180717, 0.7641916426949635, 1.2253405507580997, 0.7950861484079552, -0.13438110326375174, 0.9230859551403174, 0.010391232949803042, 0.9417097750869705, 0.2890707235816954, 0.02412241190686193, -0.02968390290676548, 0.026346007815296613, 0.7856027764718039, 0.3125021449054417, 0.5173192226862808, 0.5712957610129283, 0.9767168535722057, 0.2757189034004013, -0.0822842136859041, 0.3969905789809356, 0.24915948691966627, 1.0521667370309942, 0.4031959510613079, 0.5342118336263768, 0.6100708025134878, 0.8968838128590668, 0.014187239171325139, 0.3525320481526957], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16696120103616957, "mean_inference_ms": 0.8498342518313979, "mean_action_processing_ms": 0.03524765462356098, "mean_env_wait_ms": 0.7928283518396477, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 259200, "timers": {"sample_time_ms": 2612.468, "sample_throughput": 3674.686, "learn_time_ms": 3228.281, "learn_throughput": 2973.719, "update_time_ms": 1.571}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.013629728977878888, "policy_loss": -0.03255557599167029, "vf_loss": 0.006196969822049141, "vf_explained_var": 0.7234575748443604, "kl": 0.012728875658164421, "entropy": -3.5899650065104165, "entropy_coeff": 0.0}}, "num_steps_sampled": 259200, "num_steps_trained": 259200}, "done": false, "episodes_total": 248, "training_iteration": 27, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-30-43", "timestamp": 1617996643, "time_this_iter_s": 6.348675489425659, "time_total_s": 156.3728473186493, "pid": 10024, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 46.77571773529053, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 46.49999999999999, "ram_util_percent": 75.71111111111111}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 1.9800248327328385, "episode_reward_min": -0.37563046070180717, "episode_reward_mean": 0.4232041616653731, "episode_len_mean": 1000.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2668852671786723, -0.15153337238084408, 0.6030727459933969, 0.43185578263470226, 0.8329972409626738, 0.3407725640425705, 0.2644160191737539, 1.9800248327328385, 0.716184078758606, 0.43650736309373883, 0.47062331807555746, 0.029225429426173122, 0.27930556157726794, -0.07374808424915369, 0.12406378579385602, 0.26753212698499684, 0.10857802176776032, -0.20726522590081675, 0.5405191841163375, -0.18148297703944882, 0.43020979271276616, -0.0554937901644843, 0.10075785627845102, 0.6750056692436903, 0.3796421858406065, 0.28250012196418894, 0.2351051382311704, -0.03968221421354701, 0.1901367365424289, 0.8438584597780465, -0.09290336186632109, 0.3077493985358386, 1.1922957115999941, 0.015654616920921516, 0.1637868702607843, 0.5999262744569012, 0.19692622867680498, 0.05707393429828622, 0.5362125600149545, 0.23083634267299913, 0.21940717934810094, 0.7965494350697151, 0.4350144728898675, 0.3192831383867625, -0.37563046070180717, 0.7641916426949635, 1.2253405507580997, 0.7950861484079552, -0.13438110326375174, 0.9230859551403174, 0.010391232949803042, 0.9417097750869705, 0.2890707235816954, 0.02412241190686193, -0.02968390290676548, 0.026346007815296613, 0.7856027764718039, 0.3125021449054417, 0.5173192226862808, 0.5712957610129283, 0.9767168535722057, 0.2757189034004013, -0.0822842136859041, 0.3969905789809356, 0.24915948691966627, 1.0521667370309942, 0.4031959510613079, 0.5342118336263768, 0.6100708025134878, 0.8968838128590668, 0.014187239171325139, 0.3525320481526957, 0.062419991638573924, 0.7828839352967474, 1.029092969027702, 1.078944629329183, 0.0208260155260509, 1.4065503870312335, 0.29880373114494563, 0.752505933865192], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16871474182569082, "mean_inference_ms": 0.8578657891662669, "mean_action_processing_ms": 0.03560024994158019, "mean_env_wait_ms": 0.8000746798525796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 268800, "timers": {"sample_time_ms": 2695.398, "sample_throughput": 3561.626, "learn_time_ms": 3208.37, "learn_throughput": 2992.174, "update_time_ms": 1.586}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0026710254461175718, "total_loss": -0.011615744990607102, "policy_loss": -0.0314048275227348, "vf_loss": 0.00625987750167648, "vf_explained_var": 0.7770415544509888, "kl": 0.013529203931490581, "entropy": -3.58544992129008, "entropy_coeff": 0.0}}, "num_steps_sampled": 268800, "num_steps_trained": 268800}, "done": false, "episodes_total": 256, "training_iteration": 28, "experiment_id": "11f469d083ed45cca9d4d5f6be76b19b", "date": "2021-04-09_12-30-49", "timestamp": 1617996649, "time_this_iter_s": 6.415212631225586, "time_total_s": 162.78805994987488, "pid": 10024, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 8552, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 36, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0026710254461175718, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9421439194936783, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3805002640880242, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.19093036651611, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 50.589999999999996, "ram_util_percent": 78.83000000000001}, "trial_id": "3d0f1_00003"}
{"episode_reward_max": 153.7623443217032, "episode_reward_min": 23.355538169386982, "episode_reward_mean": 62.170129986356386, "episode_len_mean": 1000.0, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.26304568326448, 53.22001632393168, 58.899980276456304, 134.52382034109172, 67.66338266531365, 56.23379938357131, 73.0919568738939, 51.09307602370619, 94.78265648842435, 47.7805648351813, 77.51443934502743, 71.52028698343958, 36.796070358023165, 44.4224293919666, 99.64003297347423, 118.7003946720221, 38.3350808295532, 31.2859917905646, 58.433901239982106, 105.72249806704502, 47.73120331105618, 89.38511399075604, 47.2974594987625, 58.99989962136346, 41.98848202849173, 41.987710889993956, 42.824080755450815, 153.7623443217032, 52.83338927540009, 96.40983973927813, 109.79788506029853, 84.13579717367607, 49.20892761658913, 41.4079841087948, 55.85359557264909, 40.07879683890507, 73.52877593013494, 73.19793410432753, 50.203743978821116, 25.032276231357244, 57.0430299210834, 45.72486849782158, 49.33526074399927, 49.40562770910794, 38.1368791297634, 66.9890256543799, 50.767246531926816, 34.1769696848451, 39.160997045107656, 59.243777499563585, 115.60884957605371, 53.55414128794135, 54.70155637456378, 54.6482048767531, 46.17107821294539, 69.08331971523936, 41.85323973338064, 47.99261196490365, 118.3296303181468, 77.9722539958318, 45.1641299117858, 60.29940268536981, 98.56625952017443, 38.22326458561131, 93.376657833805, 30.295038143522913, 36.607065576863945, 29.642788800254866, 61.48577718794798, 52.9323402195467, 54.63288221252521, 71.7187233368649, 46.87273569319499, 81.59993749278465, 73.51779261134095, 68.65857424846989, 36.5667228565938, 34.13216472914226, 37.03882785984432, 87.5428834504564, 121.99394308411212, 38.61715462079386, 66.72992269049081, 60.45147941359313, 31.228415914683723, 66.61116648907378, 40.38666670225048, 55.77656680118482, 85.90860948359679, 52.29757852745237, 85.88068856914818, 47.17902869122709, 23.355538169386982, 75.49416880151529, 83.20274247136778, 37.91907717198734, 70.95162618717843, 47.2601089639231, 105.99869186654333, 33.327967872833526, 37.43028685794878, 70.24436373982113, 85.22668039792178, 129.67007388528012, 71.48016259476752, 75.23293570342314, 30.5349338476231, 24.061414514567055, 47.874087369837326, 67.93477523845443, 46.691469685535665, 52.99810602292511, 61.35561211945496, 35.746945840092245, 70.58344971709444, 125.50680990662113, 74.62096295425286, 32.800299683327474, 33.48669232895023, 78.69094346154827, 66.79395493067754, 40.98418147317616, 24.547503566850335, 47.538132365464875, 68.77473075828509, 24.826014051716264, 68.86281490294061, 43.35715585026518, 70.58231911707945, 64.69611520396134, 89.12744678174064, 92.77336975560958, 91.28739045111347, 68.62975209600603, 63.39069563954908, 63.8627508150426], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19460750363551008, "mean_inference_ms": 0.9924636251822051, "mean_action_processing_ms": 0.041764443727795676, "mean_env_wait_ms": 0.9004189350474581, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 8, "timesteps_total": 454400, "timers": {"sample_time_ms": 41180.837, "sample_throughput": 3341.36, "learn_time_ms": 12075.125, "learn_throughput": 11395.327, "update_time_ms": 1.705}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.0010000000000000005, "total_loss": 0.1789891469386335, "policy_loss": -0.0040185399006587895, "vf_loss": 0.1651318307742345, "vf_explained_var": 0.9659088253974915, "kl": 0.017875856341133055, "entropy": -4.3825412666608194, "entropy_coeff": 0.0}}, "num_steps_sampled": 454400, "num_steps_trained": 454400}, "done": true, "episodes_total": 440, "training_iteration": 32, "experiment_id": "ad06e7185bcb4af590941567e34aaccc", "date": "2021-04-09_12-32-47", "timestamp": 1617996767, "time_this_iter_s": 53.277788162231445, "time_total_s": 211.01899003982544, "pid": 12044, "hostname": "4650286b7eb1", "node_ip": "172.17.0.2", "config": {"num_workers": 8, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 136702, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 9, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.6137954782716268, "kl_coeff": 1.0, "sgd_minibatch_size": 81, "shuffle_sequences": true, "num_sgd_iter": 2, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3477918748307604, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 53.277788162231445, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 55.6012987012987, "ram_util_percent": 78.50519480519482}, "trial_id": "3d0f1_00003"}
