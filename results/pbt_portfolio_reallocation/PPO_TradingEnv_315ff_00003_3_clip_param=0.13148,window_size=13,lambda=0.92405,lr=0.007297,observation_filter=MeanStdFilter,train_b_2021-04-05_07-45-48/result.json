{"episode_reward_max": 0.21413360623390854, "episode_reward_min": -0.7243654629853202, "episode_reward_mean": -0.3508864196062591, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5728815695377762, -0.26026131148590304, -0.4753367671244332, -0.026190145806762044, -0.14598577287650805, -0.3855826181200564, -0.6869109117619625, -0.42749958645545627, -0.24815960065026554, -0.7243654629853202, -0.09123253420188737, -0.29894002011134657, -0.5226188196554009, -0.46138203413833934, 0.21413360623390854, -0.5739950713037438, -0.545471615791413, -0.12205227644780803, -0.3121094602984494], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25276346997423965, "mean_inference_ms": 1.2704160751382085, "mean_action_processing_ms": 0.053959719182891025, "mean_env_wait_ms": 1.3090133591777324, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 19000, "timers": {"sample_time_ms": 3354.339, "sample_throughput": 5664.305, "learn_time_ms": 4401.871, "learn_throughput": 4316.346, "update_time_ms": 2.569}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.007296950126574734, "total_loss": 0.011441982119975474, "policy_loss": 0.000407057389266939, "vf_loss": 0.0027177791594021374, "vf_explained_var": 0.4766104221343994, "kl": 0.008317145403324558, "entropy": -3.2841733158034767, "entropy_coeff": 0.0}}, "num_steps_sampled": 19000, "num_steps_trained": 19000}, "done": false, "episodes_total": 19, "training_iteration": 1, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-46-04", "timestamp": 1617633964, "time_this_iter_s": 7.7636473178863525, "time_total_s": 7.7636473178863525, "pid": 1155, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7.7636473178863525, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.775, "ram_util_percent": 61.566666666666684}, "trial_id": "315ff_00003"}
{"episode_reward_max": 0.4106092175136815, "episode_reward_min": -0.7243654629853202, "episode_reward_mean": -0.2756022083813495, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3364944071299407, -0.25150061960856296, -0.5877659024341613, -0.015323249384588955, -0.14456225618540552, -0.046671783224182084, -0.24152182086006557, -0.06387720972694344, -0.4252366456652233, -0.4448405288626383, -0.26085259436476593, -0.6395710419620518, -0.4375505423385271, 0.4106092175136815, -0.37540117536392903, -0.4902520346569277, 0.09612649813480756, -0.011033220629218521, -0.21331144348359526, -0.5728815695377762, -0.26026131148590304, -0.4753367671244332, -0.026190145806762044, -0.14598577287650805, -0.3855826181200564, -0.6869109117619625, -0.42749958645545627, -0.24815960065026554, -0.7243654629853202, -0.09123253420188737, -0.29894002011134657, -0.5226188196554009, -0.46138203413833934, 0.21413360623390854, -0.5739950713037438, -0.545471615791413, -0.12205227644780803, -0.3121094602984494], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2543790747920933, "mean_inference_ms": 1.2716047933164847, "mean_action_processing_ms": 0.05387326398013412, "mean_env_wait_ms": 1.28089598495325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 38000, "timers": {"sample_time_ms": 3175.452, "sample_throughput": 5983.4, "learn_time_ms": 4286.646, "learn_throughput": 4432.369, "update_time_ms": 2.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.007296950126574734, "total_loss": 0.0034342347128604282, "policy_loss": -0.002590989068950583, "vf_loss": 0.002958134095647041, "vf_explained_var": 0.36296775937080383, "kl": 0.003067090812032955, "entropy": -3.271905601424659, "entropy_coeff": 0.0}}, "num_steps_sampled": 38000, "num_steps_trained": 38000}, "done": false, "episodes_total": 38, "training_iteration": 2, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-46-11", "timestamp": 1617633971, "time_this_iter_s": 7.1784398555755615, "time_total_s": 14.942087173461914, "pid": 1155, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14.942087173461914, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.41, "ram_util_percent": 61.79999999999999}, "trial_id": "315ff_00003"}
{"episode_reward_max": 0.9804333480408072, "episode_reward_min": -0.7243654629853202, "episode_reward_mean": -0.24623248127006245, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3760541287555023, -0.11078600845024011, -0.14552835738302172, 0.9804333480408072, 0.1223473599870386, -0.587150659773587, 0.37071698188232705, -0.1576072756074749, -0.26204384155229166, -0.6045894100351348, -0.41224545587755723, -0.7021436055229187, -0.48230038132912384, -0.40499264346422625, -0.4313943499416799, 0.16351452689722823, -0.5314523721277621, 0.23842689786211024, -0.22951813875127092, -0.5728815695377762, -0.26026131148590304, -0.4753367671244332, -0.026190145806762044, -0.14598577287650805, -0.3855826181200564, -0.6869109117619625, -0.42749958645545627, -0.24815960065026554, -0.7243654629853202, -0.09123253420188737, -0.29894002011134657, -0.5226188196554009, -0.46138203413833934, 0.21413360623390854, -0.5739950713037438, -0.545471615791413, -0.12205227644780803, -0.3121094602984494, 0.3364944071299407, -0.25150061960856296, -0.5877659024341613, -0.015323249384588955, -0.14456225618540552, -0.046671783224182084, -0.24152182086006557, -0.06387720972694344, -0.4252366456652233, -0.4448405288626383, -0.26085259436476593, -0.6395710419620518, -0.4375505423385271, 0.4106092175136815, -0.37540117536392903, -0.4902520346569277, 0.09612649813480756, -0.011033220629218521, -0.21331144348359526], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2548147396839685, "mean_inference_ms": 1.2728011296341633, "mean_action_processing_ms": 0.05383864415824355, "mean_env_wait_ms": 1.2656404439757627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 57000, "timers": {"sample_time_ms": 3110.355, "sample_throughput": 6108.627, "learn_time_ms": 4264.336, "learn_throughput": 4455.559, "update_time_ms": 2.683}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.007296950126574734, "total_loss": 0.0026723003864988384, "policy_loss": -0.0023587663461072934, "vf_loss": 0.0028748630902311148, "vf_explained_var": 0.5254672765731812, "kl": 0.004312409359911744, "entropy": -3.2724624208155895, "entropy_coeff": 0.0}}, "num_steps_sampled": 57000, "num_steps_trained": 57000}, "done": false, "episodes_total": 57, "training_iteration": 3, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-46-19", "timestamp": 1617633979, "time_this_iter_s": 7.2102370262146, "time_total_s": 22.152324199676514, "pid": 1155, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.152324199676514, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.010000000000005, "ram_util_percent": 61.9}, "trial_id": "315ff_00003"}
{"episode_reward_max": 0.9804333480408072, "episode_reward_min": -0.7340352887527103, "episode_reward_mean": -0.24521681967008718, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.09766917721841273, 0.005494023704371465, 0.20540751791855905, -0.5099159227847114, -0.41548033253786043, -0.4799112860640918, 0.22778523168227327, -0.15869312030019767, -0.39699205116753966, -0.4238550833039907, -0.31658915344482774, 0.22652929753887818, -0.5226171610141563, -0.39508709741602777, -0.3331565142982744, -0.4758594759178958, -0.7340352887527103, 0.06624795967426578, -0.07282922883071552, -0.5728815695377762, -0.26026131148590304, -0.4753367671244332, -0.026190145806762044, -0.14598577287650805, -0.3855826181200564, -0.6869109117619625, -0.42749958645545627, -0.24815960065026554, -0.7243654629853202, -0.09123253420188737, -0.29894002011134657, -0.5226188196554009, -0.46138203413833934, 0.21413360623390854, -0.5739950713037438, -0.545471615791413, -0.12205227644780803, -0.3121094602984494, 0.3364944071299407, -0.25150061960856296, -0.5877659024341613, -0.015323249384588955, -0.14456225618540552, -0.046671783224182084, -0.24152182086006557, -0.06387720972694344, -0.4252366456652233, -0.4448405288626383, -0.26085259436476593, -0.6395710419620518, -0.4375505423385271, 0.4106092175136815, -0.37540117536392903, -0.4902520346569277, 0.09612649813480756, -0.011033220629218521, -0.21331144348359526, -0.3760541287555023, -0.11078600845024011, -0.14552835738302172, 0.9804333480408072, 0.1223473599870386, -0.587150659773587, 0.37071698188232705, -0.1576072756074749, -0.26204384155229166, -0.6045894100351348, -0.41224545587755723, -0.7021436055229187, -0.48230038132912384, -0.40499264346422625, -0.4313943499416799, 0.16351452689722823, -0.5314523721277621, 0.23842689786211024, -0.22951813875127092], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2551715417134225, "mean_inference_ms": 1.2736349471369282, "mean_action_processing_ms": 0.053845274945609, "mean_env_wait_ms": 1.2558383616498603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 76000, "timers": {"sample_time_ms": 3075.512, "sample_throughput": 6177.832, "learn_time_ms": 4244.421, "learn_throughput": 4476.464, "update_time_ms": 2.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.007296950126574734, "total_loss": 0.002884919580928481, "policy_loss": -0.0015390571253686744, "vf_loss": 0.0030904061382873945, "vf_explained_var": 0.5836695432662964, "kl": 0.005334278207659821, "entropy": -3.2824741273918407, "entropy_coeff": 0.0}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 76, "training_iteration": 4, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-46-26", "timestamp": 1617633986, "time_this_iter_s": 7.166194915771484, "time_total_s": 29.318519115447998, "pid": 1155, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 29.318519115447998, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.78, "ram_util_percent": 61.9}, "trial_id": "315ff_00003"}
{"episode_reward_max": 0.9804333480408072, "episode_reward_min": -0.7340352887527103, "episode_reward_mean": -0.22015246027273294, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.529612061749544, -0.22953003891892287, -0.06801118606131995, -0.2787182956549371, -0.09343154294996814, -0.1012594338860171, -0.014901856318401019, 0.47193194863085575, -0.3148908466521495, -0.20704371410794553, 0.18739167022093994, -0.3428143494516055, 0.5444490574674867, 0.11182322232502218, -0.33137249736805563, 0.347607280183565, -0.6362438401497839, -0.5180996786809904, -0.2752792678612298, -0.5728815695377762, -0.26026131148590304, -0.4753367671244332, -0.026190145806762044, -0.14598577287650805, -0.3855826181200564, -0.6869109117619625, -0.42749958645545627, -0.24815960065026554, -0.7243654629853202, -0.09123253420188737, -0.29894002011134657, -0.5226188196554009, -0.46138203413833934, 0.21413360623390854, -0.5739950713037438, -0.545471615791413, -0.12205227644780803, -0.3121094602984494, 0.3364944071299407, -0.25150061960856296, -0.5877659024341613, -0.015323249384588955, -0.14456225618540552, -0.046671783224182084, -0.24152182086006557, -0.06387720972694344, -0.4252366456652233, -0.4448405288626383, -0.26085259436476593, -0.6395710419620518, -0.4375505423385271, 0.4106092175136815, -0.37540117536392903, -0.4902520346569277, 0.09612649813480756, -0.011033220629218521, -0.21331144348359526, -0.3760541287555023, -0.11078600845024011, -0.14552835738302172, 0.9804333480408072, 0.1223473599870386, -0.587150659773587, 0.37071698188232705, -0.1576072756074749, -0.26204384155229166, -0.6045894100351348, -0.41224545587755723, -0.7021436055229187, -0.48230038132912384, -0.40499264346422625, -0.4313943499416799, 0.16351452689722823, -0.5314523721277621, 0.23842689786211024, -0.22951813875127092, -0.09766917721841273, 0.005494023704371465, 0.20540751791855905, -0.5099159227847114, -0.41548033253786043, -0.4799112860640918, 0.22778523168227327, -0.15869312030019767, -0.39699205116753966, -0.4238550833039907, -0.31658915344482774, 0.22652929753887818, -0.5226171610141563, -0.39508709741602777, -0.3331565142982744, -0.4758594759178958, -0.7340352887527103, 0.06624795967426578, -0.07282922883071552], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.255345426618017, "mean_inference_ms": 1.2742460148178412, "mean_action_processing_ms": 0.05386422067832577, "mean_env_wait_ms": 1.2487383141084651, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 95000, "timers": {"sample_time_ms": 3054.641, "sample_throughput": 6220.044, "learn_time_ms": 4239.015, "learn_throughput": 4482.173, "update_time_ms": 2.668}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.007296950126574734, "total_loss": 0.0062920906824753585, "policy_loss": 0.0011907041060344485, "vf_loss": 0.0037276463258086433, "vf_explained_var": 0.5668584108352661, "kl": 0.005494962791730993, "entropy": -3.2890123168894108, "entropy_coeff": 0.0}}, "num_steps_sampled": 95000, "num_steps_trained": 95000}, "done": false, "episodes_total": 95, "training_iteration": 5, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-46-33", "timestamp": 1617633993, "time_this_iter_s": 7.1994030475616455, "time_total_s": 36.517922163009644, "pid": 1155, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 36.517922163009644, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.727272727272734, "ram_util_percent": 61.845454545454544}, "trial_id": "315ff_00003"}
{"episode_reward_max": 0.9804333480408072, "episode_reward_min": -0.7340352887527103, "episode_reward_mean": -0.15095196934290947, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3316220370124998, -0.4570295213648602, 0.3863408672934987, 0.5907890230758241, -0.303068831630101, -0.3424834072622296, 0.39554240614300884, -0.3657120969991132, 0.024348494802356235, 0.27349856260883043, 0.15197688576472523, -0.06016471641609278, -0.09971130164304676, -0.11746949599905732, -0.3533842609590596, -0.029430177572966842, 0.16825143813983523, 0.42431845018008163, -0.1262947184668709, 0.21413360623390854, -0.5739950713037438, -0.545471615791413, -0.12205227644780803, -0.3121094602984494, 0.3364944071299407, -0.25150061960856296, -0.5877659024341613, -0.015323249384588955, -0.14456225618540552, -0.046671783224182084, -0.24152182086006557, -0.06387720972694344, -0.4252366456652233, -0.4448405288626383, -0.26085259436476593, -0.6395710419620518, -0.4375505423385271, 0.4106092175136815, -0.37540117536392903, -0.4902520346569277, 0.09612649813480756, -0.011033220629218521, -0.21331144348359526, -0.3760541287555023, -0.11078600845024011, -0.14552835738302172, 0.9804333480408072, 0.1223473599870386, -0.587150659773587, 0.37071698188232705, -0.1576072756074749, -0.26204384155229166, -0.6045894100351348, -0.41224545587755723, -0.7021436055229187, -0.48230038132912384, -0.40499264346422625, -0.4313943499416799, 0.16351452689722823, -0.5314523721277621, 0.23842689786211024, -0.22951813875127092, -0.09766917721841273, 0.005494023704371465, 0.20540751791855905, -0.5099159227847114, -0.41548033253786043, -0.4799112860640918, 0.22778523168227327, -0.15869312030019767, -0.39699205116753966, -0.4238550833039907, -0.31658915344482774, 0.22652929753887818, -0.5226171610141563, -0.39508709741602777, -0.3331565142982744, -0.4758594759178958, -0.7340352887527103, 0.06624795967426578, -0.07282922883071552, -0.529612061749544, -0.22953003891892287, -0.06801118606131995, -0.2787182956549371, -0.09343154294996814, -0.1012594338860171, -0.014901856318401019, 0.47193194863085575, -0.3148908466521495, -0.20704371410794553, 0.18739167022093994, -0.3428143494516055, 0.5444490574674867, 0.11182322232502218, -0.33137249736805563, 0.347607280183565, -0.6362438401497839, -0.5180996786809904, -0.2752792678612298], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25607018229685574, "mean_inference_ms": 1.275303093272872, "mean_action_processing_ms": 0.05390880176199949, "mean_env_wait_ms": 1.2337748346726627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 114000, "timers": {"sample_time_ms": 3037.93, "sample_throughput": 6254.259, "learn_time_ms": 4257.819, "learn_throughput": 4462.378, "update_time_ms": 2.691}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.007296950126574734, "total_loss": 0.004845920246994535, "policy_loss": 3.333780727030447e-05, "vf_loss": 0.003703453060827099, "vf_explained_var": 0.559053361415863, "kl": 0.0044365130449276445, "entropy": -3.304309259325066, "entropy_coeff": 0.0}}, "num_steps_sampled": 114000, "num_steps_trained": 114000}, "done": false, "episodes_total": 114, "training_iteration": 6, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-46-40", "timestamp": 1617634000, "time_this_iter_s": 7.317270517349243, "time_total_s": 43.83519268035889, "pid": 1155, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.83519268035889, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.94, "ram_util_percent": 61.9}, "trial_id": "315ff_00003"}
{"episode_reward_max": 0.9804333480408072, "episode_reward_min": -0.7340352887527103, "episode_reward_mean": -0.15059295403894213, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5463867053308493, -0.21774340394099168, -0.2994983761454295, 0.6723730216215498, -0.2543022020206269, -0.1649672830834643, -0.46551324165228347, -0.25342629847017617, -0.5783160971239546, 0.3000882054159624, -0.0616146611132663, -0.40529047229630116, -0.4874594244549921, 0.0680793664490611, -0.5795103807031344, -0.35234858223958354, -0.08522747909778727, -0.45537042443854925, 0.05067058144055214, -0.37540117536392903, -0.4902520346569277, 0.09612649813480756, -0.011033220629218521, -0.21331144348359526, -0.3760541287555023, -0.11078600845024011, -0.14552835738302172, 0.9804333480408072, 0.1223473599870386, -0.587150659773587, 0.37071698188232705, -0.1576072756074749, -0.26204384155229166, -0.6045894100351348, -0.41224545587755723, -0.7021436055229187, -0.48230038132912384, -0.40499264346422625, -0.4313943499416799, 0.16351452689722823, -0.5314523721277621, 0.23842689786211024, -0.22951813875127092, -0.09766917721841273, 0.005494023704371465, 0.20540751791855905, -0.5099159227847114, -0.41548033253786043, -0.4799112860640918, 0.22778523168227327, -0.15869312030019767, -0.39699205116753966, -0.4238550833039907, -0.31658915344482774, 0.22652929753887818, -0.5226171610141563, -0.39508709741602777, -0.3331565142982744, -0.4758594759178958, -0.7340352887527103, 0.06624795967426578, -0.07282922883071552, -0.529612061749544, -0.22953003891892287, -0.06801118606131995, -0.2787182956549371, -0.09343154294996814, -0.1012594338860171, -0.014901856318401019, 0.47193194863085575, -0.3148908466521495, -0.20704371410794553, 0.18739167022093994, -0.3428143494516055, 0.5444490574674867, 0.11182322232502218, -0.33137249736805563, 0.347607280183565, -0.6362438401497839, -0.5180996786809904, -0.2752792678612298, 0.3316220370124998, -0.4570295213648602, 0.3863408672934987, 0.5907890230758241, -0.303068831630101, -0.3424834072622296, 0.39554240614300884, -0.3657120969991132, 0.024348494802356235, 0.27349856260883043, 0.15197688576472523, -0.06016471641609278, -0.09971130164304676, -0.11746949599905732, -0.3533842609590596, -0.029430177572966842, 0.16825143813983523, 0.42431845018008163, -0.1262947184668709], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2563255887956662, "mean_inference_ms": 1.2760682308661218, "mean_action_processing_ms": 0.05390375844554117, "mean_env_wait_ms": 1.223413103820954, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 133000, "timers": {"sample_time_ms": 3031.762, "sample_throughput": 6266.983, "learn_time_ms": 4266.241, "learn_throughput": 4453.569, "update_time_ms": 2.705}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.007296950126574734, "total_loss": 0.00364121102771703, "policy_loss": -0.00023150700613256268, "vf_loss": 0.003305391885102695, "vf_explained_var": 0.5899892449378967, "kl": 0.004538616710873758, "entropy": -3.321642598849815, "entropy_coeff": 0.0}}, "num_steps_sampled": 133000, "num_steps_trained": 133000}, "done": false, "episodes_total": 133, "training_iteration": 7, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-46-48", "timestamp": 1617634008, "time_this_iter_s": 7.322390794754028, "time_total_s": 51.157583475112915, "pid": 1155, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 51.157583475112915, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.36363636363637, "ram_util_percent": 61.9}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.0620853063358067, "episode_reward_min": -0.6536939069790796, "episode_reward_mean": -0.07988671397348221, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.07301378169932804, -0.391460756460685, -0.24914117679676095, -0.6536939069790796, -0.40646524179602844, 1.0620853063358067, 0.5022535282996565, 0.9283794644039387, -0.18414823311676165, -0.4154038593570979, -0.23042174630207046, -0.4627398426910467, 0.2201235514726385, -0.5071398059453556, 0.3320775385256216, -0.47366124946138555, 0.057307386131701055, -0.5178768940062619, -0.0549078460536635], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.256180681761861, "mean_inference_ms": 1.2698548343681917, "mean_action_processing_ms": 0.05504535797598912, "mean_env_wait_ms": 1.3005706537997748, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 152000, "timers": {"sample_time_ms": 3262.13, "sample_throughput": 5824.416, "learn_time_ms": 5278.282, "learn_throughput": 3599.656, "update_time_ms": 2.743}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.007296950126574734, "total_loss": 0.004119263946284984, "policy_loss": -0.0017271165098469929, "vf_loss": 0.003291217907138119, "vf_explained_var": 0.5964006185531616, "kl": 0.002555161865346834, "entropy": -3.336217721836679, "entropy_coeff": 0.0}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 152, "training_iteration": 8, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-48-39", "timestamp": 1617634119, "time_this_iter_s": 8.547857761383057, "time_total_s": 59.70544123649597, "pid": 2181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.547857761383057, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.784615384615385, "ram_util_percent": 61.76923076923076}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.0620853063358067, "episode_reward_min": -0.6536939069790796, "episode_reward_mean": -0.11868075039352212, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4422300257909986, -0.19532946659772787, 0.14870158987636328, 0.011793234684865483, 0.8664705551995922, -0.41734929519212793, 0.24175598556385203, -0.42613224173611686, -0.034143201941492785, -0.5912291398616886, -0.37031245919635225, -0.3300091757320406, -0.2577057302875926, -0.2391680096466522, -0.25559825637466616, -0.26917279394770377, -0.3054037886612324, -0.48974622766982856, 0.3627874978538699, -0.07301378169932804, -0.391460756460685, -0.24914117679676095, -0.6536939069790796, -0.40646524179602844, 1.0620853063358067, 0.5022535282996565, 0.9283794644039387, -0.18414823311676165, -0.4154038593570979, -0.23042174630207046, -0.4627398426910467, 0.2201235514726385, -0.5071398059453556, 0.3320775385256216, -0.47366124946138555, 0.057307386131701055, -0.5178768940062619, -0.0549078460536635], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25650954906388895, "mean_inference_ms": 1.2726366007677865, "mean_action_processing_ms": 0.05493464488366065, "mean_env_wait_ms": 1.2757718411470766, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 171000, "timers": {"sample_time_ms": 3118.015, "sample_throughput": 6093.621, "learn_time_ms": 5354.421, "learn_throughput": 3548.47, "update_time_ms": 2.889}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.007296950126574734, "total_loss": 0.004188112673918473, "policy_loss": -0.0006706716224001158, "vf_loss": 0.0033584686055554438, "vf_explained_var": 0.5572905540466309, "kl": 0.003000630924459422, "entropy": -3.336135773050705, "entropy_coeff": 0.0}}, "num_steps_sampled": 171000, "num_steps_trained": 171000}, "done": false, "episodes_total": 171, "training_iteration": 9, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-48-47", "timestamp": 1617634127, "time_this_iter_s": 8.41499948501587, "time_total_s": 68.12044072151184, "pid": 2181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.962857246398926, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 38.050000000000004, "ram_util_percent": 61.958333333333336}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.0620853063358067, "episode_reward_min": -0.6536939069790796, "episode_reward_mean": -0.04900878450367138, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.030391337193493406, 0.6300157586144781, -0.25340203877083667, -0.357410990955219, 0.5215829634651248, 0.0124049544684397, -0.10028195075471713, -0.21078210211045345, 1.0404343697414542, 0.5475790485180201, -0.03035889460579022, -0.056148722434293585, 0.652197728916116, -0.42496435688598044, -0.12109091389434834, 0.11046996029071132, -0.16681930808753498, 0.10309619533175818, -0.21054523979584994, -0.07301378169932804, -0.391460756460685, -0.24914117679676095, -0.6536939069790796, -0.40646524179602844, 1.0620853063358067, 0.5022535282996565, 0.9283794644039387, -0.18414823311676165, -0.4154038593570979, -0.23042174630207046, -0.4627398426910467, 0.2201235514726385, -0.5071398059453556, 0.3320775385256216, -0.47366124946138555, 0.057307386131701055, -0.5178768940062619, -0.0549078460536635, -0.4422300257909986, -0.19532946659772787, 0.14870158987636328, 0.011793234684865483, 0.8664705551995922, -0.41734929519212793, 0.24175598556385203, -0.42613224173611686, -0.034143201941492785, -0.5912291398616886, -0.37031245919635225, -0.3300091757320406, -0.2577057302875926, -0.2391680096466522, -0.25559825637466616, -0.26917279394770377, -0.3054037886612324, -0.48974622766982856, 0.3627874978538699], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25640790191304996, "mean_inference_ms": 1.2740097388222602, "mean_action_processing_ms": 0.0548278758047439, "mean_env_wait_ms": 1.2618203158859462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 190000, "timers": {"sample_time_ms": 3072.296, "sample_throughput": 6184.299, "learn_time_ms": 5369.897, "learn_throughput": 3538.243, "update_time_ms": 2.861}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.007296950126574734, "total_loss": 0.005191049101018665, "policy_loss": -0.0005178582110760996, "vf_loss": 0.0046131384258952315, "vf_explained_var": 0.568343997001648, "kl": 0.004383075132265987, "entropy": -3.3564742235529343, "entropy_coeff": 0.0}}, "num_steps_sampled": 190000, "num_steps_trained": 190000}, "done": false, "episodes_total": 190, "training_iteration": 10, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-48-56", "timestamp": 1617634136, "time_this_iter_s": 8.392418384552002, "time_total_s": 76.51285910606384, "pid": 2181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.355275630950928, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.574999999999996, "ram_util_percent": 62.03333333333334}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.0620853063358067, "episode_reward_min": -0.6536939069790796, "episode_reward_mean": -0.07738977726640214, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.11955756593222322, -0.39602393617676, 0.17100222151012767, 0.5429878297211392, -0.23675616594576354, -0.3881973885007823, -0.08363775280660879, -0.09925154188598606, -0.5634912183355127, -0.39021278602359954, -0.4116914265513756, -0.31609115375931696, 0.2781314808262807, 0.30935842219401377, -0.6007204334682413, -0.30220669031204594, 0.07391412365004069, -0.2532894418691456, -0.5415040637359827, -0.07301378169932804, -0.391460756460685, -0.24914117679676095, -0.6536939069790796, -0.40646524179602844, 1.0620853063358067, 0.5022535282996565, 0.9283794644039387, -0.18414823311676165, -0.4154038593570979, -0.23042174630207046, -0.4627398426910467, 0.2201235514726385, -0.5071398059453556, 0.3320775385256216, -0.47366124946138555, 0.057307386131701055, -0.5178768940062619, -0.0549078460536635, -0.4422300257909986, -0.19532946659772787, 0.14870158987636328, 0.011793234684865483, 0.8664705551995922, -0.41734929519212793, 0.24175598556385203, -0.42613224173611686, -0.034143201941492785, -0.5912291398616886, -0.37031245919635225, -0.3300091757320406, -0.2577057302875926, -0.2391680096466522, -0.25559825637466616, -0.26917279394770377, -0.3054037886612324, -0.48974622766982856, 0.3627874978538699, 0.030391337193493406, 0.6300157586144781, -0.25340203877083667, -0.357410990955219, 0.5215829634651248, 0.0124049544684397, -0.10028195075471713, -0.21078210211045345, 1.0404343697414542, 0.5475790485180201, -0.03035889460579022, -0.056148722434293585, 0.652197728916116, -0.42496435688598044, -0.12109091389434834, 0.11046996029071132, -0.16681930808753498, 0.10309619533175818, -0.21054523979584994], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25662847890104545, "mean_inference_ms": 1.2747932718562616, "mean_action_processing_ms": 0.054777134727520924, "mean_env_wait_ms": 1.2528148148761737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 209000, "timers": {"sample_time_ms": 3050.655, "sample_throughput": 6228.17, "learn_time_ms": 5375.638, "learn_throughput": 3534.464, "update_time_ms": 2.838}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.007296950126574734, "total_loss": 0.004241912453841643, "policy_loss": -0.000179022650590679, "vf_loss": 0.0038500670281132595, "vf_explained_var": 0.6021172404289246, "kl": 0.004566952570547794, "entropy": -3.368051440923806, "entropy_coeff": 0.0}}, "num_steps_sampled": 209000, "num_steps_trained": 209000}, "done": false, "episodes_total": 209, "training_iteration": 11, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-49-04", "timestamp": 1617634144, "time_this_iter_s": 8.389507055282593, "time_total_s": 84.90236616134644, "pid": 2181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.74478268623352, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 37.18333333333333, "ram_util_percent": 62.0}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.0620853063358067, "episode_reward_min": -0.6536939069790796, "episode_reward_mean": -0.09971779338270441, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0343263663901634, -0.3715302047198239, 0.13615801147499695, -0.40308498590940184, -0.35073009496318863, -0.4984918010597165, -0.4205167171452957, -0.29359240161782063, -0.14681722554305832, -0.2285451847204074, -0.33598104082449176, 0.04480232233896175, -0.2724172911061923, -0.11648763565699483, 0.3409778407359736, -0.4591201933095671, -0.027877469212645556, -0.11453314674456117, -0.10810644751728704, -0.07301378169932804, -0.391460756460685, -0.24914117679676095, -0.6536939069790796, -0.40646524179602844, 1.0620853063358067, 0.5022535282996565, 0.9283794644039387, -0.18414823311676165, -0.4154038593570979, -0.23042174630207046, -0.4627398426910467, 0.2201235514726385, -0.5071398059453556, 0.3320775385256216, -0.47366124946138555, 0.057307386131701055, -0.5178768940062619, -0.0549078460536635, -0.4422300257909986, -0.19532946659772787, 0.14870158987636328, 0.011793234684865483, 0.8664705551995922, -0.41734929519212793, 0.24175598556385203, -0.42613224173611686, -0.034143201941492785, -0.5912291398616886, -0.37031245919635225, -0.3300091757320406, -0.2577057302875926, -0.2391680096466522, -0.25559825637466616, -0.26917279394770377, -0.3054037886612324, -0.48974622766982856, 0.3627874978538699, 0.030391337193493406, 0.6300157586144781, -0.25340203877083667, -0.357410990955219, 0.5215829634651248, 0.0124049544684397, -0.10028195075471713, -0.21078210211045345, 1.0404343697414542, 0.5475790485180201, -0.03035889460579022, -0.056148722434293585, 0.652197728916116, -0.42496435688598044, -0.12109091389434834, 0.11046996029071132, -0.16681930808753498, 0.10309619533175818, -0.21054523979584994, 0.11955756593222322, -0.39602393617676, 0.17100222151012767, 0.5429878297211392, -0.23675616594576354, -0.3881973885007823, -0.08363775280660879, -0.09925154188598606, -0.5634912183355127, -0.39021278602359954, -0.4116914265513756, -0.31609115375931696, 0.2781314808262807, 0.30935842219401377, -0.6007204334682413, -0.30220669031204594, 0.07391412365004069, -0.2532894418691456, -0.5415040637359827], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2567425208321525, "mean_inference_ms": 1.2887991032117458, "mean_action_processing_ms": 0.05473458826085902, "mean_env_wait_ms": 1.2462968234242124, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 228000, "timers": {"sample_time_ms": 3106.41, "sample_throughput": 6116.385, "learn_time_ms": 5380.744, "learn_throughput": 3531.11, "update_time_ms": 2.782}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.007296950126574734, "total_loss": 0.00402940266559388, "policy_loss": -0.0005160916609152051, "vf_loss": 0.004254109534003691, "vf_explained_var": 0.5882819294929504, "kl": 0.004662150755405876, "entropy": -3.3611743290152325, "entropy_coeff": 0.0}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 228, "training_iteration": 12, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-49-13", "timestamp": 1617634153, "time_this_iter_s": 8.741041660308838, "time_total_s": 93.64340782165527, "pid": 2181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.48582434654236, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.725, "ram_util_percent": 61.958333333333336}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.0404343697414542, "episode_reward_min": -0.6007204334682413, "episode_reward_mean": -0.1122006703409509, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2679967109725181, -0.5944462045749245, 0.5130465880183435, 0.4310788759970985, 0.284042951432383, 0.15123798415592482, -0.4646571626984762, -0.497418582662986, -0.07976916086930652, -0.2107463415972355, -0.4357361798211954, -0.21944278648686322, -0.4656869812722646, -0.3519845514587019, -0.5532696821727499, -0.298654879325987, 0.052069696979634816, 0.058909539732358907, -0.1942329977179128, 0.3320775385256216, -0.47366124946138555, 0.057307386131701055, -0.5178768940062619, -0.0549078460536635, -0.4422300257909986, -0.19532946659772787, 0.14870158987636328, 0.011793234684865483, 0.8664705551995922, -0.41734929519212793, 0.24175598556385203, -0.42613224173611686, -0.034143201941492785, -0.5912291398616886, -0.37031245919635225, -0.3300091757320406, -0.2577057302875926, -0.2391680096466522, -0.25559825637466616, -0.26917279394770377, -0.3054037886612324, -0.48974622766982856, 0.3627874978538699, 0.030391337193493406, 0.6300157586144781, -0.25340203877083667, -0.357410990955219, 0.5215829634651248, 0.0124049544684397, -0.10028195075471713, -0.21078210211045345, 1.0404343697414542, 0.5475790485180201, -0.03035889460579022, -0.056148722434293585, 0.652197728916116, -0.42496435688598044, -0.12109091389434834, 0.11046996029071132, -0.16681930808753498, 0.10309619533175818, -0.21054523979584994, 0.11955756593222322, -0.39602393617676, 0.17100222151012767, 0.5429878297211392, -0.23675616594576354, -0.3881973885007823, -0.08363775280660879, -0.09925154188598606, -0.5634912183355127, -0.39021278602359954, -0.4116914265513756, -0.31609115375931696, 0.2781314808262807, 0.30935842219401377, -0.6007204334682413, -0.30220669031204594, 0.07391412365004069, -0.2532894418691456, -0.5415040637359827, 0.0343263663901634, -0.3715302047198239, 0.13615801147499695, -0.40308498590940184, -0.35073009496318863, -0.4984918010597165, -0.4205167171452957, -0.29359240161782063, -0.14681722554305832, -0.2285451847204074, -0.33598104082449176, 0.04480232233896175, -0.2724172911061923, -0.11648763565699483, 0.3409778407359736, -0.4591201933095671, -0.027877469212645556, -0.11453314674456117, -0.10810644751728704], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2570999804855329, "mean_inference_ms": 1.3003988469179462, "mean_action_processing_ms": 0.05459335734433299, "mean_env_wait_ms": 1.2334470340310322, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 247000, "timers": {"sample_time_ms": 3090.55, "sample_throughput": 6147.773, "learn_time_ms": 5387.03, "learn_throughput": 3526.99, "update_time_ms": 2.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 0.007296950126574734, "total_loss": 0.0019219935396623691, "policy_loss": -0.001969988832887787, "vf_loss": 0.0037398579977327745, "vf_explained_var": 0.605486273765564, "kl": 0.004867979587093245, "entropy": -3.337637701290566, "entropy_coeff": 0.0}}, "num_steps_sampled": 247000, "num_steps_trained": 247000}, "done": false, "episodes_total": 247, "training_iteration": 13, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-49-21", "timestamp": 1617634161, "time_this_iter_s": 8.4409499168396, "time_total_s": 102.08435773849487, "pid": 2181, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.92677426338196, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.025000000000006, "ram_util_percent": 62.0}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.078461119194615, "episode_reward_min": -0.5566349413731404, "episode_reward_mean": -0.041398261331417864, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.05452483164468469, 0.4187902455532544, -0.32286358674935567, -0.19678472359891175, -0.10062266873770787, -0.5522033906240081, 0.2344409969265966, -0.3819411550730895, 1.078461119194615, -0.33500336650842905, -0.5566349413731404, 1.0634135682103834, -0.17362091918279532, -0.4445581653099909, 0.34020802291031815, -0.17992854961537963, -0.4934481345976939, -0.41024318515242086, 0.280496700075501], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2536960089142137, "mean_inference_ms": 1.2678773478758665, "mean_action_processing_ms": 0.05396124855176689, "mean_env_wait_ms": 1.2817328156366403, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 266000, "timers": {"sample_time_ms": 3186.866, "sample_throughput": 5961.97, "learn_time_ms": 5336.748, "learn_throughput": 3560.221, "update_time_ms": 2.376}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 0.007296950126574734, "total_loss": 0.00552776839659118, "policy_loss": -0.0015768459091750568, "vf_loss": 0.004329159880844539, "vf_explained_var": 0.5097687244415283, "kl": 0.002775453904568649, "entropy": -3.3445118625692074, "entropy_coeff": 0.0}}, "num_steps_sampled": 266000, "num_steps_trained": 266000}, "done": false, "episodes_total": 266, "training_iteration": 14, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-51-38", "timestamp": 1617634298, "time_this_iter_s": 8.53071117401123, "time_total_s": 110.6150689125061, "pid": 3526, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.53071117401123, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.03076923076924, "ram_util_percent": 61.72307692307691}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.078461119194615, "episode_reward_min": -0.5566349413731404, "episode_reward_mean": -0.012475855632319843, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.08132140790023923, 0.09477457275171419, -0.15759469158906458, -0.08324726964061857, -0.009442951570406755, -0.20654471849847578, 0.4535376437925185, -0.09808762124153503, -0.41710637549848584, 0.03059237943409676, 0.13175774425536524, 0.14295404303955106, 0.10941287488221896, -0.18793707163239992, 0.06280315813862747, 0.5977433494752928, 0.10181933069129467, 0.21568091604837414, -0.3873094536690429, -0.05452483164468469, 0.4187902455532544, -0.32286358674935567, -0.19678472359891175, -0.10062266873770787, -0.5522033906240081, 0.2344409969265966, -0.3819411550730895, 1.078461119194615, -0.33500336650842905, -0.5566349413731404, 1.0634135682103834, -0.17362091918279532, -0.4445581653099909, 0.34020802291031815, -0.17992854961537963, -0.4934481345976939, -0.41024318515242086, 0.280496700075501], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2542494671323421, "mean_inference_ms": 1.2698551121012336, "mean_action_processing_ms": 0.05390129513612401, "mean_env_wait_ms": 1.2583521378735598, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 285000, "timers": {"sample_time_ms": 3071.784, "sample_throughput": 6185.332, "learn_time_ms": 5339.055, "learn_throughput": 3558.682, "update_time_ms": 2.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 0.007296950126574734, "total_loss": 0.006893472789768005, "policy_loss": 0.000718470656581773, "vf_loss": 0.004171031472529441, "vf_explained_var": 0.5111929774284363, "kl": 0.0040079398626061595, "entropy": -3.349871960262324, "entropy_coeff": 0.0}}, "num_steps_sampled": 285000, "num_steps_trained": 285000}, "done": false, "episodes_total": 285, "training_iteration": 15, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-51-46", "timestamp": 1617634306, "time_this_iter_s": 8.308384895324707, "time_total_s": 118.92345380783081, "pid": 3526, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16.839096069335938, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.525, "ram_util_percent": 61.98333333333333}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.7422716661387834, "episode_reward_min": -0.5566349413731404, "episode_reward_mean": 0.016624571813069998, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.08105287311532572, 1.7422716661387834, 0.4722860523605048, 0.16198910011089218, 0.16087480151455602, -0.28678181311228945, -0.10484976263812062, -0.053741574543540116, 0.27751335740142813, -0.31336489096877085, -0.06951242809396818, -0.4199887828495361, 0.08647054561674894, -0.5463551295925877, 0.3937513697756614, -0.21693246494661533, 0.17044268783845107, 0.286776584703351, -0.4002190844571307, -0.05452483164468469, 0.4187902455532544, -0.32286358674935567, -0.19678472359891175, -0.10062266873770787, -0.5522033906240081, 0.2344409969265966, -0.3819411550730895, 1.078461119194615, -0.33500336650842905, -0.5566349413731404, 1.0634135682103834, -0.17362091918279532, -0.4445581653099909, 0.34020802291031815, -0.17992854961537963, -0.4934481345976939, -0.41024318515242086, 0.280496700075501, -0.08132140790023923, 0.09477457275171419, -0.15759469158906458, -0.08324726964061857, -0.009442951570406755, -0.20654471849847578, 0.4535376437925185, -0.09808762124153503, -0.41710637549848584, 0.03059237943409676, 0.13175774425536524, 0.14295404303955106, 0.10941287488221896, -0.18793707163239992, 0.06280315813862747, 0.5977433494752928, 0.10181933069129467, 0.21568091604837414, -0.3873094536690429], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25433203792677594, "mean_inference_ms": 1.2704141212788378, "mean_action_processing_ms": 0.05387913056653976, "mean_env_wait_ms": 1.2451645975253438, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 304000, "timers": {"sample_time_ms": 3025.467, "sample_throughput": 6280.022, "learn_time_ms": 5337.485, "learn_throughput": 3559.729, "update_time_ms": 2.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 0.007296950126574734, "total_loss": 0.006377985175924013, "policy_loss": 0.0007322700694203377, "vf_loss": 0.004584084088357803, "vf_explained_var": 0.46909359097480774, "kl": 0.004246521891163499, "entropy": -3.3622959588198054, "entropy_coeff": 0.0}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 304, "training_iteration": 16, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-51-55", "timestamp": 1617634315, "time_this_iter_s": 8.278232097625732, "time_total_s": 127.20168590545654, "pid": 3526, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.11732816696167, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.77272727272728, "ram_util_percent": 61.9}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.7422716661387834, "episode_reward_min": -0.566728197524047, "episode_reward_mean": 0.01040217046016021, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.19446921525481575, -0.4217082215917396, -0.03913301408808756, 0.1176191064854828, 0.17008278160720214, 0.29693768003902754, 0.7019364321009418, -0.1941824433689181, 0.31611195430441463, -0.5072864643039385, -0.325516583569052, -0.566728197524047, 0.10595689800238994, 0.3220626030987541, 0.0261194300501435, 0.058162021321281676, 0.07563752890581421, -0.1317956251277097, -0.3557807399695886, -0.05452483164468469, 0.4187902455532544, -0.32286358674935567, -0.19678472359891175, -0.10062266873770787, -0.5522033906240081, 0.2344409969265966, -0.3819411550730895, 1.078461119194615, -0.33500336650842905, -0.5566349413731404, 1.0634135682103834, -0.17362091918279532, -0.4445581653099909, 0.34020802291031815, -0.17992854961537963, -0.4934481345976939, -0.41024318515242086, 0.280496700075501, -0.08132140790023923, 0.09477457275171419, -0.15759469158906458, -0.08324726964061857, -0.009442951570406755, -0.20654471849847578, 0.4535376437925185, -0.09808762124153503, -0.41710637549848584, 0.03059237943409676, 0.13175774425536524, 0.14295404303955106, 0.10941287488221896, -0.18793707163239992, 0.06280315813862747, 0.5977433494752928, 0.10181933069129467, 0.21568091604837414, -0.3873094536690429, 0.08105287311532572, 1.7422716661387834, 0.4722860523605048, 0.16198910011089218, 0.16087480151455602, -0.28678181311228945, -0.10484976263812062, -0.053741574543540116, 0.27751335740142813, -0.31336489096877085, -0.06951242809396818, -0.4199887828495361, 0.08647054561674894, -0.5463551295925877, 0.3937513697756614, -0.21693246494661533, 0.17044268783845107, 0.286776584703351, -0.4002190844571307], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25447030546325705, "mean_inference_ms": 1.2707087221080118, "mean_action_processing_ms": 0.05386199840414435, "mean_env_wait_ms": 1.2367081685463261, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 323000, "timers": {"sample_time_ms": 3002.977, "sample_throughput": 6327.055, "learn_time_ms": 5339.44, "learn_throughput": 3558.426, "update_time_ms": 2.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 0.007296950126574734, "total_loss": 0.006858713421720586, "policy_loss": 0.0015666269722250884, "vf_loss": 0.004690851302092408, "vf_explained_var": 0.4806191325187683, "kl": 0.004809886681997286, "entropy": -3.3987746030692287, "entropy_coeff": 0.0}}, "num_steps_sampled": 323000, "num_steps_trained": 323000}, "done": false, "episodes_total": 323, "training_iteration": 17, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-52-03", "timestamp": 1617634323, "time_this_iter_s": 8.290961503982544, "time_total_s": 135.4926474094391, "pid": 3526, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 33.408289670944214, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.949999999999996, "ram_util_percent": 61.87499999999999}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.7422716661387834, "episode_reward_min": -0.6395926394711788, "episode_reward_mean": 0.022523530179972343, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7792037309311461, 0.5265304455655422, -0.37214756348412326, -0.6304758416936618, 0.03605907347788939, -0.49138095551421307, -0.06967074759631575, -0.08393333199141106, 0.07988530571127583, 0.12289747327910439, 0.852880219198964, 0.28978322250853683, 0.3233613845548753, 0.9154096963243987, 0.16092789477080371, -0.6395926394711788, -0.12983691525965413, -0.08644301452503511, -0.23428702466174778, -0.05452483164468469, 0.4187902455532544, -0.32286358674935567, -0.19678472359891175, -0.10062266873770787, -0.5522033906240081, 0.2344409969265966, -0.3819411550730895, 1.078461119194615, -0.33500336650842905, -0.5566349413731404, 1.0634135682103834, -0.17362091918279532, -0.4445581653099909, 0.34020802291031815, -0.17992854961537963, -0.4934481345976939, -0.41024318515242086, 0.280496700075501, -0.08132140790023923, 0.09477457275171419, -0.15759469158906458, -0.08324726964061857, -0.009442951570406755, -0.20654471849847578, 0.4535376437925185, -0.09808762124153503, -0.41710637549848584, 0.03059237943409676, 0.13175774425536524, 0.14295404303955106, 0.10941287488221896, -0.18793707163239992, 0.06280315813862747, 0.5977433494752928, 0.10181933069129467, 0.21568091604837414, -0.3873094536690429, 0.08105287311532572, 1.7422716661387834, 0.4722860523605048, 0.16198910011089218, 0.16087480151455602, -0.28678181311228945, -0.10484976263812062, -0.053741574543540116, 0.27751335740142813, -0.31336489096877085, -0.06951242809396818, -0.4199887828495361, 0.08647054561674894, -0.5463551295925877, 0.3937513697756614, -0.21693246494661533, 0.17044268783845107, 0.286776584703351, -0.4002190844571307, 0.19446921525481575, -0.4217082215917396, -0.03913301408808756, 0.1176191064854828, 0.17008278160720214, 0.29693768003902754, 0.7019364321009418, -0.1941824433689181, 0.31611195430441463, -0.5072864643039385, -0.325516583569052, -0.566728197524047, 0.10595689800238994, 0.3220626030987541, 0.0261194300501435, 0.058162021321281676, 0.07563752890581421, -0.1317956251277097, -0.3557807399695886], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2546143486859705, "mean_inference_ms": 1.2801119277572246, "mean_action_processing_ms": 0.053861429366631214, "mean_env_wait_ms": 1.230978445500807, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 342000, "timers": {"sample_time_ms": 3053.546, "sample_throughput": 6222.274, "learn_time_ms": 5362.176, "learn_throughput": 3543.338, "update_time_ms": 2.688}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.007296950126574734, "total_loss": 0.005841029407894051, "policy_loss": 5.700901750750189e-05, "vf_loss": 0.005453357140177349, "vf_explained_var": 0.47591927647590637, "kl": 0.005290607629568885, "entropy": -3.4038312947190046, "entropy_coeff": 0.0}}, "num_steps_sampled": 342000, "num_steps_trained": 342000}, "done": false, "episodes_total": 342, "training_iteration": 18, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-52-12", "timestamp": 1617634332, "time_this_iter_s": 8.719819784164429, "time_total_s": 144.21246719360352, "pid": 3526, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 42.12810945510864, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.3, "ram_util_percent": 61.96923076923077}, "trial_id": "315ff_00003"}
{"episode_reward_max": 1.7422716661387834, "episode_reward_min": -0.6395926394711788, "episode_reward_mean": 0.04364851339623268, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.1478778250936369, 0.5671214934352937, -0.21245184580673082, -0.2121695389665308, -0.18109539911680472, -0.0023820066374077298, 0.05664272992012864, -0.11816222692969092, 0.3450880211073082, 0.1925655190875568, 0.3874171293489974, -0.22815489516129783, -0.5377738504973635, 0.7174373040202555, 1.2566288061037314, 0.31798072253606935, -0.32965902298835625, 0.12265038003071771, -0.09234134078360712, 0.34020802291031815, -0.17992854961537963, -0.4934481345976939, -0.41024318515242086, 0.280496700075501, -0.08132140790023923, 0.09477457275171419, -0.15759469158906458, -0.08324726964061857, -0.009442951570406755, -0.20654471849847578, 0.4535376437925185, -0.09808762124153503, -0.41710637549848584, 0.03059237943409676, 0.13175774425536524, 0.14295404303955106, 0.10941287488221896, -0.18793707163239992, 0.06280315813862747, 0.5977433494752928, 0.10181933069129467, 0.21568091604837414, -0.3873094536690429, 0.08105287311532572, 1.7422716661387834, 0.4722860523605048, 0.16198910011089218, 0.16087480151455602, -0.28678181311228945, -0.10484976263812062, -0.053741574543540116, 0.27751335740142813, -0.31336489096877085, -0.06951242809396818, -0.4199887828495361, 0.08647054561674894, -0.5463551295925877, 0.3937513697756614, -0.21693246494661533, 0.17044268783845107, 0.286776584703351, -0.4002190844571307, 0.19446921525481575, -0.4217082215917396, -0.03913301408808756, 0.1176191064854828, 0.17008278160720214, 0.29693768003902754, 0.7019364321009418, -0.1941824433689181, 0.31611195430441463, -0.5072864643039385, -0.325516583569052, -0.566728197524047, 0.10595689800238994, 0.3220626030987541, 0.0261194300501435, 0.058162021321281676, 0.07563752890581421, -0.1317956251277097, -0.3557807399695886, 0.7792037309311461, 0.5265304455655422, -0.37214756348412326, -0.6304758416936618, 0.03605907347788939, -0.49138095551421307, -0.06967074759631575, -0.08393333199141106, 0.07988530571127583, 0.12289747327910439, 0.852880219198964, 0.28978322250853683, 0.3233613845548753, 0.9154096963243987, 0.16092789477080371, -0.6395926394711788, -0.12983691525965413, -0.08644301452503511, -0.23428702466174778], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2552879788719289, "mean_inference_ms": 1.2900945425862553, "mean_action_processing_ms": 0.05392514422993872, "mean_env_wait_ms": 1.219971518247202, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 361000, "timers": {"sample_time_ms": 3061.452, "sample_throughput": 6206.206, "learn_time_ms": 5370.481, "learn_throughput": 3537.858, "update_time_ms": 2.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 0.007296950126574734, "total_loss": 0.007963083996968781, "policy_loss": 0.001816124305279063, "vf_loss": 0.0058499712640757125, "vf_explained_var": 0.5429118275642395, "kl": 0.004751843537810265, "entropy": -3.4247268350332374, "entropy_coeff": 0.0}}, "num_steps_sampled": 361000, "num_steps_trained": 361000}, "done": false, "episodes_total": 361, "training_iteration": 19, "experiment_id": "777e55bf85134e77a22fc1a9ea7bc5f0", "date": "2021-04-05_07-52-20", "timestamp": 1617634340, "time_this_iter_s": 8.52389669418335, "time_total_s": 152.73636388778687, "pid": 3526, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 16040, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 13, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.007296950126574734, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9240481979956189, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.13148370903807738, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.65200614929199, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.10833333333334, "ram_util_percent": 62.050000000000004}, "trial_id": "315ff_00003"}
