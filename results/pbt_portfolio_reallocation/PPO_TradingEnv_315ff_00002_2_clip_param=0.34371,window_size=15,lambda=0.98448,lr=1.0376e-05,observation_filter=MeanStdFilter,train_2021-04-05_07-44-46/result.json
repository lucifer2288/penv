{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 11400, "timers": {"sample_time_ms": 1866.778, "sample_throughput": 6106.778, "learn_time_ms": 2556.345, "learn_throughput": 4459.492, "update_time_ms": 2.686}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.004683784250583914, "policy_loss": -0.005980375109033452, "vf_loss": 0.009409621021606855, "vf_explained_var": 0.12170927226543427, "kl": 0.0012545407206440964, "entropy": -3.257198598649767, "entropy_coeff": 0.0}}, "num_steps_sampled": 11400, "num_steps_trained": 11400}, "done": false, "episodes_total": 0, "training_iteration": 1, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-00", "timestamp": 1617633900, "time_this_iter_s": 4.429976224899292, "time_total_s": 4.429976224899292, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4.429976224899292, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 49.128571428571426, "ram_util_percent": 61.557142857142864}, "trial_id": "315ff_00002"}
{"episode_reward_max": 0.7430431201836394, "episode_reward_min": -0.6619771677080823, "episode_reward_mean": -0.24364915091944192, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4014756928543227, -0.33060003915835845, 0.7430431201836394, -0.35321525279592325, 0.06719668328827333, -0.6619771677080823, -0.28557377924800376, -0.4168148225728744, -0.4849938709786967, -0.03199727172150446, -0.013120976208288115, -0.3132479470042141, -0.3123300636424542, -0.421748478641921, -0.22154319294650326, -0.5005570852922245, -0.4033891661758198, -0.09464121351332266, -0.19234765047879643], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23887555413965203, "mean_inference_ms": 1.2748348623588617, "mean_action_processing_ms": 0.05417331093904707, "mean_env_wait_ms": 1.2928826336982062, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 22800, "timers": {"sample_time_ms": 1841.483, "sample_throughput": 6190.662, "learn_time_ms": 2631.428, "learn_throughput": 4332.249, "update_time_ms": 2.745}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.003120032956616746, "policy_loss": -0.00783186639762587, "vf_loss": 0.009815082704234455, "vf_explained_var": 0.11581716686487198, "kl": 0.002273634358102249, "entropy": -3.2451229519314237, "entropy_coeff": 0.0}}, "num_steps_sampled": 22800, "num_steps_trained": 22800}, "done": false, "episodes_total": 19, "training_iteration": 2, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-04", "timestamp": 1617633904, "time_this_iter_s": 4.531952857971191, "time_total_s": 8.961929082870483, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8.961929082870483, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.78333333333333, "ram_util_percent": 61.699999999999996}, "trial_id": "315ff_00002"}
{"episode_reward_max": 0.7430431201836394, "episode_reward_min": -0.6619771677080823, "episode_reward_mean": -0.24364915091944192, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4014756928543227, -0.33060003915835845, 0.7430431201836394, -0.35321525279592325, 0.06719668328827333, -0.6619771677080823, -0.28557377924800376, -0.4168148225728744, -0.4849938709786967, -0.03199727172150446, -0.013120976208288115, -0.3132479470042141, -0.3123300636424542, -0.421748478641921, -0.22154319294650326, -0.5005570852922245, -0.4033891661758198, -0.09464121351332266, -0.19234765047879643], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23887555413965203, "mean_inference_ms": 1.2748348623588617, "mean_action_processing_ms": 0.05417331093904707, "mean_env_wait_ms": 1.2928826336982062, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 34200, "timers": {"sample_time_ms": 1796.418, "sample_throughput": 6345.963, "learn_time_ms": 2594.079, "learn_throughput": 4394.624, "update_time_ms": 2.761}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.0050087664328101605, "policy_loss": -0.003859100356284115, "vf_loss": 0.008282310298333566, "vf_explained_var": 0.40830713510513306, "kl": 0.002342225148135589, "entropy": -3.256153792805142, "entropy_coeff": 0.0}}, "num_steps_sampled": 34200, "num_steps_trained": 34200}, "done": false, "episodes_total": 19, "training_iteration": 3, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-08", "timestamp": 1617633908, "time_this_iter_s": 4.234167098999023, "time_total_s": 13.196096181869507, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13.196096181869507, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.81666666666667, "ram_util_percent": 61.71666666666667}, "trial_id": "315ff_00002"}
{"episode_reward_max": 0.7430431201836394, "episode_reward_min": -0.6619771677080823, "episode_reward_mean": -0.14310880103948034, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.18316111476865538, -0.1837589305175601, 0.03667406165354303, 0.3258602071929799, 0.1441206898565659, -0.29971110826375125, -0.32026136083100887, 0.11333307516017221, 0.2672306095025656, -0.38145941734108346, -0.33786490897432087, 0.251429030254668, 0.17875057269864447, -0.4045919686473804, 0.42024233055623794, -0.1616022257729377, -0.4221491519031561, -0.2360626574343665, 0.017859466010677227, -0.4014756928543227, -0.33060003915835845, 0.7430431201836394, -0.35321525279592325, 0.06719668328827333, -0.6619771677080823, -0.28557377924800376, -0.4168148225728744, -0.4849938709786967, -0.03199727172150446, -0.013120976208288115, -0.3132479470042141, -0.3123300636424542, -0.421748478641921, -0.22154319294650326, -0.5005570852922245, -0.4033891661758198, -0.09464121351332266, -0.19234765047879643], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23956078064731381, "mean_inference_ms": 1.276813280451279, "mean_action_processing_ms": 0.05408781433489985, "mean_env_wait_ms": 1.2722843223818194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 45600, "timers": {"sample_time_ms": 1804.45, "sample_throughput": 6317.715, "learn_time_ms": 2578.294, "learn_throughput": 4421.528, "update_time_ms": 2.707}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.004980589863326814, "policy_loss": -0.004029160261982017, "vf_loss": 0.008761902815765804, "vf_explained_var": 0.5951636433601379, "kl": 0.001982770734725313, "entropy": -3.2503085984124076, "entropy_coeff": 0.0}}, "num_steps_sampled": 45600, "num_steps_trained": 45600}, "done": false, "episodes_total": 38, "training_iteration": 4, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-13", "timestamp": 1617633913, "time_this_iter_s": 4.368433237075806, "time_total_s": 17.564529418945312, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17.564529418945312, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.0, "ram_util_percent": 61.800000000000004}, "trial_id": "315ff_00002"}
{"episode_reward_max": 0.7430431201836394, "episode_reward_min": -0.6684146781064526, "episode_reward_mean": -0.17277551753249698, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5514085865095215, -0.40760154243715313, -0.21141008386710947, -0.10765958487082716, 0.29057622928686766, -0.41019457566668394, -0.4556460890118977, -0.3077595756801558, 0.021520838265331632, -0.05243112594791144, -0.4269403178709504, -0.12076775171135212, -0.6684146781064526, -0.22107495672729338, 0.18103642231525607, -0.44000823935429223, -0.29953190873397584, 0.11723503524805379, -0.3395895684720067, -0.4014756928543227, -0.33060003915835845, 0.7430431201836394, -0.35321525279592325, 0.06719668328827333, -0.6619771677080823, -0.28557377924800376, -0.4168148225728744, -0.4849938709786967, -0.03199727172150446, -0.013120976208288115, -0.3132479470042141, -0.3123300636424542, -0.421748478641921, -0.22154319294650326, -0.5005570852922245, -0.4033891661758198, -0.09464121351332266, -0.19234765047879643, 0.18316111476865538, -0.1837589305175601, 0.03667406165354303, 0.3258602071929799, 0.1441206898565659, -0.29971110826375125, -0.32026136083100887, 0.11333307516017221, 0.2672306095025656, -0.38145941734108346, -0.33786490897432087, 0.251429030254668, 0.17875057269864447, -0.4045919686473804, 0.42024233055623794, -0.1616022257729377, -0.4221491519031561, -0.2360626574343665, 0.017859466010677227], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24580829989366706, "mean_inference_ms": 1.2780185107996735, "mean_action_processing_ms": 0.05407344805075878, "mean_env_wait_ms": 1.2631408537283586, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 57000, "timers": {"sample_time_ms": 1818.048, "sample_throughput": 6270.462, "learn_time_ms": 2574.717, "learn_throughput": 4427.672, "update_time_ms": 2.715}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.002942883761392699, "policy_loss": -0.002876003904061185, "vf_loss": 0.005761737066010634, "vf_explained_var": 0.560035765171051, "kl": 0.0009144099856105944, "entropy": -3.253287585576375, "entropy_coeff": 0.0}}, "num_steps_sampled": 57000, "num_steps_trained": 57000}, "done": false, "episodes_total": 57, "training_iteration": 5, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-17", "timestamp": 1617633917, "time_this_iter_s": 4.4428181648254395, "time_total_s": 22.007347583770752, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22.007347583770752, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.93333333333334, "ram_util_percent": 61.76666666666667}, "trial_id": "315ff_00002"}
{"episode_reward_max": 0.7430431201836394, "episode_reward_min": -0.6684146781064526, "episode_reward_mean": -0.172775517532497, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4014756928543227, -0.33060003915835845, 0.7430431201836394, -0.35321525279592325, 0.06719668328827333, -0.6619771677080823, -0.28557377924800376, -0.4168148225728744, -0.4849938709786967, -0.03199727172150446, -0.013120976208288115, -0.3132479470042141, -0.3123300636424542, -0.421748478641921, -0.22154319294650326, -0.5005570852922245, -0.4033891661758198, -0.09464121351332266, -0.19234765047879643, 0.18316111476865538, -0.1837589305175601, 0.03667406165354303, 0.3258602071929799, 0.1441206898565659, -0.29971110826375125, -0.32026136083100887, 0.11333307516017221, 0.2672306095025656, -0.38145941734108346, -0.33786490897432087, 0.251429030254668, 0.17875057269864447, -0.4045919686473804, 0.42024233055623794, -0.1616022257729377, -0.4221491519031561, -0.2360626574343665, 0.017859466010677227, -0.5514085865095215, -0.40760154243715313, -0.21141008386710947, -0.10765958487082716, 0.29057622928686766, -0.41019457566668394, -0.4556460890118977, -0.3077595756801558, 0.021520838265331632, -0.05243112594791144, -0.4269403178709504, -0.12076775171135212, -0.6684146781064526, -0.22107495672729338, 0.18103642231525607, -0.44000823935429223, -0.29953190873397584, 0.11723503524805379, -0.3395895684720067], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24580829989366706, "mean_inference_ms": 1.2780185107996733, "mean_action_processing_ms": 0.05407344805075878, "mean_env_wait_ms": 1.2631408537283588, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 68400, "timers": {"sample_time_ms": 1803.197, "sample_throughput": 6322.104, "learn_time_ms": 2567.456, "learn_throughput": 4440.192, "update_time_ms": 2.73}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 1.0376475996914016e-05, "total_loss": -0.002622802990178267, "policy_loss": -0.008256697675420178, "vf_loss": 0.005543236775944631, "vf_explained_var": 0.6733283400535583, "kl": 0.0029010343468851515, "entropy": -3.2673656887478297, "entropy_coeff": 0.0}}, "num_steps_sampled": 68400, "num_steps_trained": 68400}, "done": false, "episodes_total": 57, "training_iteration": 6, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-22", "timestamp": 1617633922, "time_this_iter_s": 4.269285202026367, "time_total_s": 26.27663278579712, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 26.27663278579712, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 43.1, "ram_util_percent": 61.800000000000004}, "trial_id": "315ff_00002"}
{"episode_reward_max": 0.7430431201836394, "episode_reward_min": -0.6684146781064526, "episode_reward_mean": -0.18756333252151086, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3373426301815875, -0.00135358252624862, -0.13031656744654752, -0.44469303065906585, -0.2721955805586902, 0.02143279612999338, -0.49779637794614734, -0.3582715857767912, -0.44806097338973017, -0.474223035769166, 0.13643071545965446, -0.19743253078653722, -0.5221625037825502, -0.12254690511984534, -0.32622312894486416, 0.37294605937916203, 0.025549798078552843, -0.5651350302392768, -0.26521467820281397, -0.4014756928543227, -0.33060003915835845, 0.7430431201836394, -0.35321525279592325, 0.06719668328827333, -0.6619771677080823, -0.28557377924800376, -0.4168148225728744, -0.4849938709786967, -0.03199727172150446, -0.013120976208288115, -0.3132479470042141, -0.3123300636424542, -0.421748478641921, -0.22154319294650326, -0.5005570852922245, -0.4033891661758198, -0.09464121351332266, -0.19234765047879643, 0.18316111476865538, -0.1837589305175601, 0.03667406165354303, 0.3258602071929799, 0.1441206898565659, -0.29971110826375125, -0.32026136083100887, 0.11333307516017221, 0.2672306095025656, -0.38145941734108346, -0.33786490897432087, 0.251429030254668, 0.17875057269864447, -0.4045919686473804, 0.42024233055623794, -0.1616022257729377, -0.4221491519031561, -0.2360626574343665, 0.017859466010677227, -0.5514085865095215, -0.40760154243715313, -0.21141008386710947, -0.10765958487082716, 0.29057622928686766, -0.41019457566668394, -0.4556460890118977, -0.3077595756801558, 0.021520838265331632, -0.05243112594791144, -0.4269403178709504, -0.12076775171135212, -0.6684146781064526, -0.22107495672729338, 0.18103642231525607, -0.44000823935429223, -0.29953190873397584, 0.11723503524805379, -0.3395895684720067], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24786365106509792, "mean_inference_ms": 1.278720436280141, "mean_action_processing_ms": 0.054064602475147355, "mean_env_wait_ms": 1.2563028358288888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 79800, "timers": {"sample_time_ms": 1806.232, "sample_throughput": 6311.481, "learn_time_ms": 2563.693, "learn_throughput": 4446.71, "update_time_ms": 2.737}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 1.0376475996914016e-05, "total_loss": -0.0010477802716195583, "policy_loss": -0.006300130708970958, "vf_loss": 0.005226099612708721, "vf_explained_var": 0.48572319746017456, "kl": 0.0016800205546638205, "entropy": -3.246988304456075, "entropy_coeff": 0.0}}, "num_steps_sampled": 79800, "num_steps_trained": 79800}, "done": false, "episodes_total": 76, "training_iteration": 7, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-26", "timestamp": 1617633926, "time_this_iter_s": 4.374995946884155, "time_total_s": 30.651628732681274, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.651628732681274, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 45.00000000000001, "ram_util_percent": 61.75000000000001}, "trial_id": "315ff_00002"}
{"episode_reward_max": 0.7430431201836394, "episode_reward_min": -0.6684146781064526, "episode_reward_mean": -0.18756333252151092, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4014756928543227, -0.33060003915835845, 0.7430431201836394, -0.35321525279592325, 0.06719668328827333, -0.6619771677080823, -0.28557377924800376, -0.4168148225728744, -0.4849938709786967, -0.03199727172150446, -0.013120976208288115, -0.3132479470042141, -0.3123300636424542, -0.421748478641921, -0.22154319294650326, -0.5005570852922245, -0.4033891661758198, -0.09464121351332266, -0.19234765047879643, 0.18316111476865538, -0.1837589305175601, 0.03667406165354303, 0.3258602071929799, 0.1441206898565659, -0.29971110826375125, -0.32026136083100887, 0.11333307516017221, 0.2672306095025656, -0.38145941734108346, -0.33786490897432087, 0.251429030254668, 0.17875057269864447, -0.4045919686473804, 0.42024233055623794, -0.1616022257729377, -0.4221491519031561, -0.2360626574343665, 0.017859466010677227, -0.5514085865095215, -0.40760154243715313, -0.21141008386710947, -0.10765958487082716, 0.29057622928686766, -0.41019457566668394, -0.4556460890118977, -0.3077595756801558, 0.021520838265331632, -0.05243112594791144, -0.4269403178709504, -0.12076775171135212, -0.6684146781064526, -0.22107495672729338, 0.18103642231525607, -0.44000823935429223, -0.29953190873397584, 0.11723503524805379, -0.3395895684720067, -0.3373426301815875, -0.00135358252624862, -0.13031656744654752, -0.44469303065906585, -0.2721955805586902, 0.02143279612999338, -0.49779637794614734, -0.3582715857767912, -0.44806097338973017, -0.474223035769166, 0.13643071545965446, -0.19743253078653722, -0.5221625037825502, -0.12254690511984534, -0.32622312894486416, 0.37294605937916203, 0.025549798078552843, -0.5651350302392768, -0.26521467820281397], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24786365106509792, "mean_inference_ms": 1.278720436280141, "mean_action_processing_ms": 0.054064602475147355, "mean_env_wait_ms": 1.2563028358288895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 91200, "timers": {"sample_time_ms": 1795.535, "sample_throughput": 6349.083, "learn_time_ms": 2559.606, "learn_throughput": 4453.811, "update_time_ms": 2.751}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0078125, "cur_lr": 1.0376475996914016e-05, "total_loss": -0.001905540997783343, "policy_loss": -0.0072111693262639975, "vf_loss": 0.0052714289579954415, "vf_explained_var": 0.6914628148078918, "kl": 0.004377469901616375, "entropy": -3.2915035247802735, "entropy_coeff": 0.0}}, "num_steps_sampled": 91200, "num_steps_trained": 91200}, "done": false, "episodes_total": 76, "training_iteration": 8, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-30", "timestamp": 1617633930, "time_this_iter_s": 4.260792016983032, "time_total_s": 34.91242074966431, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 34.91242074966431, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.86666666666667, "ram_util_percent": 61.800000000000004}, "trial_id": "315ff_00002"}
{"episode_reward_max": 1.324392323098599, "episode_reward_min": -0.6684146781064526, "episode_reward_mean": -0.15963851344634222, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.467392938712029, 0.15020545189410184, 1.324392323098599, -0.556575055711712, -0.47312930409720516, -0.4397993127102599, -0.07820653714361825, -0.4336201400144004, -0.3250560170609418, -0.10158329255808096, 1.0723643856946485, 0.04683634025487593, -0.40772014840295273, -0.3003803332226479, -0.3396977932481934, -0.3134389709585327, -0.4043868320361252, -0.26301924272999266, 0.46457603447272455, -0.4014756928543227, -0.33060003915835845, 0.7430431201836394, -0.35321525279592325, 0.06719668328827333, -0.6619771677080823, -0.28557377924800376, -0.4168148225728744, -0.4849938709786967, -0.03199727172150446, -0.013120976208288115, -0.3132479470042141, -0.3123300636424542, -0.421748478641921, -0.22154319294650326, -0.5005570852922245, -0.4033891661758198, -0.09464121351332266, -0.19234765047879643, 0.18316111476865538, -0.1837589305175601, 0.03667406165354303, 0.3258602071929799, 0.1441206898565659, -0.29971110826375125, -0.32026136083100887, 0.11333307516017221, 0.2672306095025656, -0.38145941734108346, -0.33786490897432087, 0.251429030254668, 0.17875057269864447, -0.4045919686473804, 0.42024233055623794, -0.1616022257729377, -0.4221491519031561, -0.2360626574343665, 0.017859466010677227, -0.5514085865095215, -0.40760154243715313, -0.21141008386710947, -0.10765958487082716, 0.29057622928686766, -0.41019457566668394, -0.4556460890118977, -0.3077595756801558, 0.021520838265331632, -0.05243112594791144, -0.4269403178709504, -0.12076775171135212, -0.6684146781064526, -0.22107495672729338, 0.18103642231525607, -0.44000823935429223, -0.29953190873397584, 0.11723503524805379, -0.3395895684720067, -0.3373426301815875, -0.00135358252624862, -0.13031656744654752, -0.44469303065906585, -0.2721955805586902, 0.02143279612999338, -0.49779637794614734, -0.3582715857767912, -0.44806097338973017, -0.474223035769166, 0.13643071545965446, -0.19743253078653722, -0.5221625037825502, -0.12254690511984534, -0.32622312894486416, 0.37294605937916203, 0.025549798078552843, -0.5651350302392768, -0.26521467820281397], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24863258876511465, "mean_inference_ms": 1.2792189853041631, "mean_action_processing_ms": 0.05406223400437744, "mean_env_wait_ms": 1.2512722948466695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 102600, "timers": {"sample_time_ms": 1798.594, "sample_throughput": 6338.284, "learn_time_ms": 2565.404, "learn_throughput": 4443.744, "update_time_ms": 2.741}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00390625, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.006398058517111672, "policy_loss": -0.000584945631110006, "vf_loss": 0.00697324487587644, "vf_explained_var": 0.7105488181114197, "kl": 0.002498391762168871, "entropy": -3.2808500183953178, "entropy_coeff": 0.0}}, "num_steps_sampled": 102600, "num_steps_trained": 102600}, "done": false, "episodes_total": 95, "training_iteration": 9, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-35", "timestamp": 1617633935, "time_this_iter_s": 4.444601535797119, "time_total_s": 39.357022285461426, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 39.357022285461426, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 39.67142857142857, "ram_util_percent": 61.75714285714287}, "trial_id": "315ff_00002"}
{"episode_reward_max": 1.324392323098599, "episode_reward_min": -0.6684146781064526, "episode_reward_mean": -0.13183903824148066, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.23823629307789707, 0.06063436704023695, -0.13513616647132232, -0.5063084044987591, -0.011401239491595772, 0.027709357319608108, 0.40829618270203616, -0.384039077509599, -0.3044248695448697, -0.4374448721514217, -0.2604965447574473, 0.047492037635623374, -0.4134182351386261, -0.15007858895769954, 0.10836690675127558, -0.15910141097117703, 0.04806485502740365, 0.016485097293725604, 1.0479362929922185, -0.22154319294650326, -0.5005570852922245, -0.4033891661758198, -0.09464121351332266, -0.19234765047879643, 0.18316111476865538, -0.1837589305175601, 0.03667406165354303, 0.3258602071929799, 0.1441206898565659, -0.29971110826375125, -0.32026136083100887, 0.11333307516017221, 0.2672306095025656, -0.38145941734108346, -0.33786490897432087, 0.251429030254668, 0.17875057269864447, -0.4045919686473804, 0.42024233055623794, -0.1616022257729377, -0.4221491519031561, -0.2360626574343665, 0.017859466010677227, -0.5514085865095215, -0.40760154243715313, -0.21141008386710947, -0.10765958487082716, 0.29057622928686766, -0.41019457566668394, -0.4556460890118977, -0.3077595756801558, 0.021520838265331632, -0.05243112594791144, -0.4269403178709504, -0.12076775171135212, -0.6684146781064526, -0.22107495672729338, 0.18103642231525607, -0.44000823935429223, -0.29953190873397584, 0.11723503524805379, -0.3395895684720067, -0.3373426301815875, -0.00135358252624862, -0.13031656744654752, -0.44469303065906585, -0.2721955805586902, 0.02143279612999338, -0.49779637794614734, -0.3582715857767912, -0.44806097338973017, -0.474223035769166, 0.13643071545965446, -0.19743253078653722, -0.5221625037825502, -0.12254690511984534, -0.32622312894486416, 0.37294605937916203, 0.025549798078552843, -0.5651350302392768, -0.26521467820281397, 0.467392938712029, 0.15020545189410184, 1.324392323098599, -0.556575055711712, -0.47312930409720516, -0.4397993127102599, -0.07820653714361825, -0.4336201400144004, -0.3250560170609418, -0.10158329255808096, 1.0723643856946485, 0.04683634025487593, -0.40772014840295273, -0.3003803332226479, -0.3396977932481934, -0.3134389709585327, -0.4043868320361252, -0.26301924272999266, 0.46457603447272455], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2517945006366455, "mean_inference_ms": 1.2798345935222344, "mean_action_processing_ms": 0.0540338596816972, "mean_env_wait_ms": 1.2412576736737924, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 114000, "timers": {"sample_time_ms": 1801.03, "sample_throughput": 6329.712, "learn_time_ms": 2561.583, "learn_throughput": 4450.373, "update_time_ms": 2.736}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001953125, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.0027597680170502927, "policy_loss": -0.001803620977120267, "vf_loss": 0.004555246021805538, "vf_explained_var": 0.7307783961296082, "kl": 0.004169597308565345, "entropy": -3.2701507091522215, "entropy_coeff": 0.0}}, "num_steps_sampled": 114000, "num_steps_trained": 114000}, "done": false, "episodes_total": 114, "training_iteration": 10, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-39", "timestamp": 1617633939, "time_this_iter_s": 4.359879732131958, "time_total_s": 43.716902017593384, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 43.716902017593384, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 45.050000000000004, "ram_util_percent": 61.800000000000004}, "trial_id": "315ff_00002"}
{"episode_reward_max": 1.324392323098599, "episode_reward_min": -0.6684146781064526, "episode_reward_mean": -0.13183903824148066, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.22154319294650326, -0.5005570852922245, -0.4033891661758198, -0.09464121351332266, -0.19234765047879643, 0.18316111476865538, -0.1837589305175601, 0.03667406165354303, 0.3258602071929799, 0.1441206898565659, -0.29971110826375125, -0.32026136083100887, 0.11333307516017221, 0.2672306095025656, -0.38145941734108346, -0.33786490897432087, 0.251429030254668, 0.17875057269864447, -0.4045919686473804, 0.42024233055623794, -0.1616022257729377, -0.4221491519031561, -0.2360626574343665, 0.017859466010677227, -0.5514085865095215, -0.40760154243715313, -0.21141008386710947, -0.10765958487082716, 0.29057622928686766, -0.41019457566668394, -0.4556460890118977, -0.3077595756801558, 0.021520838265331632, -0.05243112594791144, -0.4269403178709504, -0.12076775171135212, -0.6684146781064526, -0.22107495672729338, 0.18103642231525607, -0.44000823935429223, -0.29953190873397584, 0.11723503524805379, -0.3395895684720067, -0.3373426301815875, -0.00135358252624862, -0.13031656744654752, -0.44469303065906585, -0.2721955805586902, 0.02143279612999338, -0.49779637794614734, -0.3582715857767912, -0.44806097338973017, -0.474223035769166, 0.13643071545965446, -0.19743253078653722, -0.5221625037825502, -0.12254690511984534, -0.32622312894486416, 0.37294605937916203, 0.025549798078552843, -0.5651350302392768, -0.26521467820281397, 0.467392938712029, 0.15020545189410184, 1.324392323098599, -0.556575055711712, -0.47312930409720516, -0.4397993127102599, -0.07820653714361825, -0.4336201400144004, -0.3250560170609418, -0.10158329255808096, 1.0723643856946485, 0.04683634025487593, -0.40772014840295273, -0.3003803332226479, -0.3396977932481934, -0.3134389709585327, -0.4043868320361252, -0.26301924272999266, 0.46457603447272455, -0.23823629307789707, 0.06063436704023695, -0.13513616647132232, -0.5063084044987591, -0.011401239491595772, 0.027709357319608108, 0.40829618270203616, -0.384039077509599, -0.3044248695448697, -0.4374448721514217, -0.2604965447574473, 0.047492037635623374, -0.4134182351386261, -0.15007858895769954, 0.10836690675127558, -0.15910141097117703, 0.04806485502740365, 0.016485097293725604, 1.0479362929922185], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25179450063664555, "mean_inference_ms": 1.2798345935222344, "mean_action_processing_ms": 0.054033859681697216, "mean_env_wait_ms": 1.2412576736737924, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 125400, "timers": {"sample_time_ms": 1787.037, "sample_throughput": 6379.276, "learn_time_ms": 2566.613, "learn_throughput": 4441.652, "update_time_ms": 2.76}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0009765625, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.00219213596234719, "policy_loss": -0.002827726982326971, "vf_loss": 0.005015837959945202, "vf_explained_var": 0.7765032649040222, "kl": 0.004122125688526365, "entropy": -3.28262238767412, "entropy_coeff": 0.0}}, "num_steps_sampled": 125400, "num_steps_trained": 125400}, "done": false, "episodes_total": 114, "training_iteration": 11, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-43", "timestamp": 1617633943, "time_this_iter_s": 4.342456579208374, "time_total_s": 48.05935859680176, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 48.05935859680176, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 43.13333333333333, "ram_util_percent": 61.75000000000001}, "trial_id": "315ff_00002"}
{"episode_reward_max": 1.324392323098599, "episode_reward_min": -0.6684146781064526, "episode_reward_mean": -0.11665297089777432, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.16847496554839292, -0.557115941890554, 0.17341290975501855, -0.01569845074358267, 0.7649542039369086, -0.13019773535019974, 0.10571581667400243, 0.8005535330982789, -0.018276687962540894, -0.2850854425581959, -0.4523736239592183, -0.1986421536538986, 0.21053940749494293, -0.5390201304384651, 0.2614684898258368, -0.4163832827535612, -0.4355384710984591, -0.2977801040098619, 0.8769827216585979, 0.42024233055623794, -0.1616022257729377, -0.4221491519031561, -0.2360626574343665, 0.017859466010677227, -0.5514085865095215, -0.40760154243715313, -0.21141008386710947, -0.10765958487082716, 0.29057622928686766, -0.41019457566668394, -0.4556460890118977, -0.3077595756801558, 0.021520838265331632, -0.05243112594791144, -0.4269403178709504, -0.12076775171135212, -0.6684146781064526, -0.22107495672729338, 0.18103642231525607, -0.44000823935429223, -0.29953190873397584, 0.11723503524805379, -0.3395895684720067, -0.3373426301815875, -0.00135358252624862, -0.13031656744654752, -0.44469303065906585, -0.2721955805586902, 0.02143279612999338, -0.49779637794614734, -0.3582715857767912, -0.44806097338973017, -0.474223035769166, 0.13643071545965446, -0.19743253078653722, -0.5221625037825502, -0.12254690511984534, -0.32622312894486416, 0.37294605937916203, 0.025549798078552843, -0.5651350302392768, -0.26521467820281397, 0.467392938712029, 0.15020545189410184, 1.324392323098599, -0.556575055711712, -0.47312930409720516, -0.4397993127102599, -0.07820653714361825, -0.4336201400144004, -0.3250560170609418, -0.10158329255808096, 1.0723643856946485, 0.04683634025487593, -0.40772014840295273, -0.3003803332226479, -0.3396977932481934, -0.3134389709585327, -0.4043868320361252, -0.26301924272999266, 0.46457603447272455, -0.23823629307789707, 0.06063436704023695, -0.13513616647132232, -0.5063084044987591, -0.011401239491595772, 0.027709357319608108, 0.40829618270203616, -0.384039077509599, -0.3044248695448697, -0.4374448721514217, -0.2604965447574473, 0.047492037635623374, -0.4134182351386261, -0.15007858895769954, 0.10836690675127558, -0.15910141097117703, 0.04806485502740365, 0.016485097293725604, 1.0479362929922185], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2549682176820846, "mean_inference_ms": 1.2811898969505215, "mean_action_processing_ms": 0.05403719759008339, "mean_env_wait_ms": 1.2348282388457712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 136800, "timers": {"sample_time_ms": 1791.473, "sample_throughput": 6363.48, "learn_time_ms": 2549.551, "learn_throughput": 4471.375, "update_time_ms": 2.78}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00048828125, "cur_lr": 1.0376475996914016e-05, "total_loss": -0.003712546235571305, "policy_loss": -0.009066714946594502, "vf_loss": 0.005352409714315501, "vf_explained_var": 0.6908803582191467, "kl": 0.0035988037422713306, "entropy": -3.2866915490892197, "entropy_coeff": 0.0}}, "num_steps_sampled": 136800, "num_steps_trained": 136800}, "done": false, "episodes_total": 133, "training_iteration": 12, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-45-48", "timestamp": 1617633948, "time_this_iter_s": 4.406705856323242, "time_total_s": 52.466064453125, "pid": 806, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 52.466064453125, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 39.728571428571435, "ram_util_percent": 61.800000000000004}, "trial_id": "315ff_00002"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 148200, "timers": {"sample_time_ms": 1837.151, "sample_throughput": 6205.259, "learn_time_ms": 3153.616, "learn_throughput": 3614.898, "update_time_ms": 3.24}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0, "cur_lr": 1.0376475996914016e-05, "total_loss": -0.0021125536205040085, "policy_loss": -0.008494975666205088, "vf_loss": 0.00498415788428651, "vf_explained_var": 0.7941066026687622, "kl": 0.0013982642610143455, "entropy": -3.308413370450338, "entropy_coeff": 0.0}}, "num_steps_sampled": 148200, "num_steps_trained": 148200}, "done": false, "episodes_total": 133, "training_iteration": 13, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-49-35", "timestamp": 1617634175, "time_this_iter_s": 4.998414516448975, "time_total_s": 57.464478969573975, "pid": 2521, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4.998414516448975, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.025, "ram_util_percent": 61.725}, "trial_id": "315ff_00002"}
{"episode_reward_max": 0.7479315768260177, "episode_reward_min": -0.35195137510268515, "episode_reward_mean": 0.21010476029723235, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.1356844246575546, -0.314990403360894, 0.36217919923053765, 0.711119149429843, 0.319661416025927, 0.37036302744541194, -0.025451958977293798, 0.40573215636012083, 0.14711271653636726, 0.7479315768260177, -0.049869552890921764, 0.49801777424996874, -0.3226816184967328, 0.5169995572467967, -0.35195137510268515, -0.07590371504736215, 0.4194343625836987, -0.19028405752462674, 0.6888877664556872], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23817269002489058, "mean_inference_ms": 1.277667048142634, "mean_action_processing_ms": 0.05417224521771537, "mean_env_wait_ms": 1.2976640551424272, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 159600, "timers": {"sample_time_ms": 1870.01, "sample_throughput": 6096.225, "learn_time_ms": 3202.567, "learn_throughput": 3559.644, "update_time_ms": 3.019}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.00041499596296085253, "policy_loss": -0.00651343452433745, "vf_loss": 0.005965207431775828, "vf_explained_var": 0.7108624577522278, "kl": 0.0019264425383880735, "entropy": -3.2979546123080783, "entropy_coeff": 0.0}}, "num_steps_sampled": 159600, "num_steps_trained": 159600}, "done": false, "episodes_total": 152, "training_iteration": 14, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-49-40", "timestamp": 1617634180, "time_this_iter_s": 5.1640095710754395, "time_total_s": 62.628488540649414, "pid": 2521, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10.162424087524414, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.48571428571429, "ram_util_percent": 61.87142857142857}, "trial_id": "315ff_00002"}
{"episode_reward_max": 0.7479315768260177, "episode_reward_min": -0.35195137510268515, "episode_reward_mean": 0.21010476029723235, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.1356844246575546, -0.314990403360894, 0.36217919923053765, 0.711119149429843, 0.319661416025927, 0.37036302744541194, -0.025451958977293798, 0.40573215636012083, 0.14711271653636726, 0.7479315768260177, -0.049869552890921764, 0.49801777424996874, -0.3226816184967328, 0.5169995572467967, -0.35195137510268515, -0.07590371504736215, 0.4194343625836987, -0.19028405752462674, 0.6888877664556872], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23817269002489058, "mean_inference_ms": 1.277667048142634, "mean_action_processing_ms": 0.05417224521771537, "mean_env_wait_ms": 1.2976640551424272, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 171000, "timers": {"sample_time_ms": 1822.662, "sample_throughput": 6254.587, "learn_time_ms": 3189.21, "learn_throughput": 3574.552, "update_time_ms": 3.001}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.25, "cur_lr": 1.0376475996914016e-05, "total_loss": -0.002668366731247968, "policy_loss": -0.008651185087445709, "vf_loss": 0.005281425660683049, "vf_explained_var": 0.749501645565033, "kl": 0.0028055664953879184, "entropy": -3.3056227286656696, "entropy_coeff": 0.0}}, "num_steps_sampled": 171000, "num_steps_trained": 171000}, "done": false, "episodes_total": 152, "training_iteration": 15, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-49-45", "timestamp": 1617634185, "time_this_iter_s": 4.8995795249938965, "time_total_s": 67.52806806564331, "pid": 2521, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15.06200361251831, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 38.34285714285714, "ram_util_percent": 61.89999999999999}, "trial_id": "315ff_00002"}
{"episode_reward_max": 1.3053313255446581, "episode_reward_min": -0.5298656027880508, "episode_reward_mean": 0.2547989823502885, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.3053313255446581, 0.18772618517805317, 0.47795082842015235, 0.14046067131320972, -0.10878496674658755, 1.0839657032274013, -0.03270509206476779, 0.2404479436844269, -0.5184327349955205, 0.1172473203400426, 1.0201368974275566, 0.7241295648466182, 0.2640157388976414, 0.29058394388183695, 0.4311103298110941, 0.45874994425192606, 0.3151654585907764, -0.17686257515691994, -0.5298656027880508, 0.1356844246575546, -0.314990403360894, 0.36217919923053765, 0.711119149429843, 0.319661416025927, 0.37036302744541194, -0.025451958977293798, 0.40573215636012083, 0.14711271653636726, 0.7479315768260177, -0.049869552890921764, 0.49801777424996874, -0.3226816184967328, 0.5169995572467967, -0.35195137510268515, -0.07590371504736215, 0.4194343625836987, -0.19028405752462674, 0.6888877664556872], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2383076811846963, "mean_inference_ms": 1.279519077843528, "mean_action_processing_ms": 0.05435487325986233, "mean_env_wait_ms": 1.276843328281937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 182400, "timers": {"sample_time_ms": 1824.408, "sample_throughput": 6248.603, "learn_time_ms": 3180.354, "learn_throughput": 3584.507, "update_time_ms": 2.952}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.125, "cur_lr": 1.0376475996914016e-05, "total_loss": -0.00327901899193724, "policy_loss": -0.009234169063468774, "vf_loss": 0.00553467373829335, "vf_explained_var": 0.8302782773971558, "kl": 0.0033638218184933065, "entropy": -3.3286903911166723, "entropy_coeff": 0.0}}, "num_steps_sampled": 182400, "num_steps_trained": 182400}, "done": false, "episodes_total": 171, "training_iteration": 16, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-49-50", "timestamp": 1617634190, "time_this_iter_s": 4.993002653121948, "time_total_s": 72.52107071876526, "pid": 2521, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20.05500626564026, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.199999999999996, "ram_util_percent": 61.89999999999999}, "trial_id": "315ff_00002"}
{"episode_reward_max": 1.3553689128735837, "episode_reward_min": -0.5298656027880508, "episode_reward_mean": 0.24683900654653881, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4477992325140586, 0.16362539326376457, 0.556108857902553, -0.11107601276590662, 0.002556144254103776, -0.10039862400195321, -0.09399435732534966, 0.2264092156313675, 0.9173678952756081, -0.14682927604716556, 0.2952117154764571, 0.4476949941740258, 0.09161881369608449, 1.3553689128735837, 0.2826534227285531, 0.8536243388225175, -0.18193672864887955, 0.5238506827147833, -0.24659411166833844, 0.1356844246575546, -0.314990403360894, 0.36217919923053765, 0.711119149429843, 0.319661416025927, 0.37036302744541194, -0.025451958977293798, 0.40573215636012083, 0.14711271653636726, 0.7479315768260177, -0.049869552890921764, 0.49801777424996874, -0.3226816184967328, 0.5169995572467967, -0.35195137510268515, -0.07590371504736215, 0.4194343625836987, -0.19028405752462674, 0.6888877664556872, 1.3053313255446581, 0.18772618517805317, 0.47795082842015235, 0.14046067131320972, -0.10878496674658755, 1.0839657032274013, -0.03270509206476779, 0.2404479436844269, -0.5184327349955205, 0.1172473203400426, 1.0201368974275566, 0.7241295648466182, 0.2640157388976414, 0.29058394388183695, 0.4311103298110941, 0.45874994425192606, 0.3151654585907764, -0.17686257515691994, -0.5298656027880508], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24436677874907525, "mean_inference_ms": 1.2810373965691564, "mean_action_processing_ms": 0.0544584521166296, "mean_env_wait_ms": 1.2679745153085495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 193800, "timers": {"sample_time_ms": 1829.107, "sample_throughput": 6232.549, "learn_time_ms": 3187.06, "learn_throughput": 3576.964, "update_time_ms": 2.899}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 1.0376475996914016e-05, "total_loss": -0.006720578975768553, "policy_loss": -0.012930075348251396, "vf_loss": 0.005866592315336068, "vf_explained_var": 0.786101758480072, "kl": 0.005486469943490294, "entropy": -3.336208120981852, "entropy_coeff": 0.0}}, "num_steps_sampled": 193800, "num_steps_trained": 193800}, "done": false, "episodes_total": 190, "training_iteration": 17, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-49-55", "timestamp": 1617634195, "time_this_iter_s": 5.070884943008423, "time_total_s": 77.59195566177368, "pid": 2521, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25.12589120864868, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.05714285714286, "ram_util_percent": 61.942857142857136}, "trial_id": "315ff_00002"}
{"episode_reward_max": 1.3553689128735837, "episode_reward_min": -0.5298656027880508, "episode_reward_mean": 0.24683900654653884, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.1356844246575546, -0.314990403360894, 0.36217919923053765, 0.711119149429843, 0.319661416025927, 0.37036302744541194, -0.025451958977293798, 0.40573215636012083, 0.14711271653636726, 0.7479315768260177, -0.049869552890921764, 0.49801777424996874, -0.3226816184967328, 0.5169995572467967, -0.35195137510268515, -0.07590371504736215, 0.4194343625836987, -0.19028405752462674, 0.6888877664556872, 1.3053313255446581, 0.18772618517805317, 0.47795082842015235, 0.14046067131320972, -0.10878496674658755, 1.0839657032274013, -0.03270509206476779, 0.2404479436844269, -0.5184327349955205, 0.1172473203400426, 1.0201368974275566, 0.7241295648466182, 0.2640157388976414, 0.29058394388183695, 0.4311103298110941, 0.45874994425192606, 0.3151654585907764, -0.17686257515691994, -0.5298656027880508, -0.4477992325140586, 0.16362539326376457, 0.556108857902553, -0.11107601276590662, 0.002556144254103776, -0.10039862400195321, -0.09399435732534966, 0.2264092156313675, 0.9173678952756081, -0.14682927604716556, 0.2952117154764571, 0.4476949941740258, 0.09161881369608449, 1.3553689128735837, 0.2826534227285531, 0.8536243388225175, -0.18193672864887955, 0.5238506827147833, -0.24659411166833844], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2443667787490752, "mean_inference_ms": 1.2810373965691564, "mean_action_processing_ms": 0.0544584521166296, "mean_env_wait_ms": 1.2679745153085495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 205200, "timers": {"sample_time_ms": 1812.169, "sample_throughput": 6290.805, "learn_time_ms": 3182.389, "learn_throughput": 3582.214, "update_time_ms": 2.88}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0625, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.0007198007673852974, "policy_loss": -0.0044088672225674, "vf_loss": 0.004911505314521491, "vf_explained_var": 0.8285010457038879, "kl": 0.003474621262608303, "entropy": -3.351113388273451, "entropy_coeff": 0.0}}, "num_steps_sampled": 205200, "num_steps_trained": 205200}, "done": false, "episodes_total": 190, "training_iteration": 18, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-50-00", "timestamp": 1617634200, "time_this_iter_s": 4.895727872848511, "time_total_s": 82.48768353462219, "pid": 2521, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 30.021619081497192, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.08571428571428, "ram_util_percent": 61.92857142857142}, "trial_id": "315ff_00002"}
{"episode_reward_max": 1.8637262900682683, "episode_reward_min": -0.5298656027880508, "episode_reward_mean": 0.3223076375693414, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6218123662098685, 0.16866257571351073, 0.2533302183053263, 0.5809985560152777, 0.46680333927025597, 1.2091941262179629, -0.10652553145386423, 0.10904346033807433, 0.7548951597632036, 0.1772503604325837, 0.06239873252990047, 0.055829345970224376, 0.28262102461759975, 0.49939086778731845, 0.9383393382251877, 0.9070101262715677, 0.8330366392023703, 0.7477400866325934, 1.8637262900682683, 0.1356844246575546, -0.314990403360894, 0.36217919923053765, 0.711119149429843, 0.319661416025927, 0.37036302744541194, -0.025451958977293798, 0.40573215636012083, 0.14711271653636726, 0.7479315768260177, -0.049869552890921764, 0.49801777424996874, -0.3226816184967328, 0.5169995572467967, -0.35195137510268515, -0.07590371504736215, 0.4194343625836987, -0.19028405752462674, 0.6888877664556872, 1.3053313255446581, 0.18772618517805317, 0.47795082842015235, 0.14046067131320972, -0.10878496674658755, 1.0839657032274013, -0.03270509206476779, 0.2404479436844269, -0.5184327349955205, 0.1172473203400426, 1.0201368974275566, 0.7241295648466182, 0.2640157388976414, 0.29058394388183695, 0.4311103298110941, 0.45874994425192606, 0.3151654585907764, -0.17686257515691994, -0.5298656027880508, -0.4477992325140586, 0.16362539326376457, 0.556108857902553, -0.11107601276590662, 0.002556144254103776, -0.10039862400195321, -0.09399435732534966, 0.2264092156313675, 0.9173678952756081, -0.14682927604716556, 0.2952117154764571, 0.4476949941740258, 0.09161881369608449, 1.3553689128735837, 0.2826534227285531, 0.8536243388225175, -0.18193672864887955, 0.5238506827147833, -0.24659411166833844], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2465110375928448, "mean_inference_ms": 1.2820246497222896, "mean_action_processing_ms": 0.054475206807025424, "mean_env_wait_ms": 1.2610989000710975, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 216600, "timers": {"sample_time_ms": 1815.992, "sample_throughput": 6277.562, "learn_time_ms": 3180.084, "learn_throughput": 3584.811, "update_time_ms": 2.911}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.0045001262384984225, "policy_loss": -0.0020425325207826164, "vf_loss": 0.006376530739685728, "vf_explained_var": 0.7775581479072571, "kl": 0.005316049564215872, "entropy": -3.350613276163737, "entropy_coeff": 0.0}}, "num_steps_sampled": 216600, "num_steps_trained": 216600}, "done": false, "episodes_total": 209, "training_iteration": 19, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-50-05", "timestamp": 1617634205, "time_this_iter_s": 5.015506267547607, "time_total_s": 87.5031898021698, "pid": 2521, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 35.0371253490448, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.587500000000006, "ram_util_percent": 62.0}, "trial_id": "315ff_00002"}
{"episode_reward_max": 1.8637262900682683, "episode_reward_min": -0.5298656027880508, "episode_reward_mean": 0.32230763756934133, "episode_len_mean": 1000.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.1356844246575546, -0.314990403360894, 0.36217919923053765, 0.711119149429843, 0.319661416025927, 0.37036302744541194, -0.025451958977293798, 0.40573215636012083, 0.14711271653636726, 0.7479315768260177, -0.049869552890921764, 0.49801777424996874, -0.3226816184967328, 0.5169995572467967, -0.35195137510268515, -0.07590371504736215, 0.4194343625836987, -0.19028405752462674, 0.6888877664556872, 1.3053313255446581, 0.18772618517805317, 0.47795082842015235, 0.14046067131320972, -0.10878496674658755, 1.0839657032274013, -0.03270509206476779, 0.2404479436844269, -0.5184327349955205, 0.1172473203400426, 1.0201368974275566, 0.7241295648466182, 0.2640157388976414, 0.29058394388183695, 0.4311103298110941, 0.45874994425192606, 0.3151654585907764, -0.17686257515691994, -0.5298656027880508, -0.4477992325140586, 0.16362539326376457, 0.556108857902553, -0.11107601276590662, 0.002556144254103776, -0.10039862400195321, -0.09399435732534966, 0.2264092156313675, 0.9173678952756081, -0.14682927604716556, 0.2952117154764571, 0.4476949941740258, 0.09161881369608449, 1.3553689128735837, 0.2826534227285531, 0.8536243388225175, -0.18193672864887955, 0.5238506827147833, -0.24659411166833844, 0.6218123662098685, 0.16866257571351073, 0.2533302183053263, 0.5809985560152777, 0.46680333927025597, 1.2091941262179629, -0.10652553145386423, 0.10904346033807433, 0.7548951597632036, 0.1772503604325837, 0.06239873252990047, 0.055829345970224376, 0.28262102461759975, 0.49939086778731845, 0.9383393382251877, 0.9070101262715677, 0.8330366392023703, 0.7477400866325934, 1.8637262900682683], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24651103759284473, "mean_inference_ms": 1.2820246497222898, "mean_action_processing_ms": 0.054475206807025424, "mean_env_wait_ms": 1.2610989000710975, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 228000, "timers": {"sample_time_ms": 1847.239, "sample_throughput": 6171.371, "learn_time_ms": 3176.129, "learn_throughput": 3589.275, "update_time_ms": 3.757}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 1.0376475996914016e-05, "total_loss": -0.004494167098568545, "policy_loss": -0.011674299536065923, "vf_loss": 0.006954106662629379, "vf_explained_var": 0.7988539934158325, "kl": 0.007232852306009995, "entropy": -3.3833467377556694, "entropy_coeff": 0.0}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 209, "training_iteration": 20, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-50-10", "timestamp": 1617634210, "time_this_iter_s": 5.230937719345093, "time_total_s": 92.73412752151489, "pid": 2521, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 40.26806306838989, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 44.671428571428564, "ram_util_percent": 62.057142857142864}, "trial_id": "315ff_00002"}
{"episode_reward_max": 2.381385496933891, "episode_reward_min": -0.5298656027880508, "episode_reward_mean": 0.4254233045424671, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.2314560725202639, 0.7433095803904959, 0.8644586892591501, 0.4294672813905227, 0.7225054985646548, 0.4163799429811459, 1.9092812291523122, 0.06441678312723087, 0.6533570850448511, 0.20499546237392874, 0.9733781398801085, 0.16057289934017227, 1.8041529059480679, 1.5761291117888985, 0.9727364561572303, 2.381385496933891, 0.694346381053194, 0.26776448761805494, 0.8497399727402568, 0.1356844246575546, -0.314990403360894, 0.36217919923053765, 0.711119149429843, 0.319661416025927, 0.37036302744541194, -0.025451958977293798, 0.40573215636012083, 0.14711271653636726, 0.7479315768260177, -0.049869552890921764, 0.49801777424996874, -0.3226816184967328, 0.5169995572467967, -0.35195137510268515, -0.07590371504736215, 0.4194343625836987, -0.19028405752462674, 0.6888877664556872, 1.3053313255446581, 0.18772618517805317, 0.47795082842015235, 0.14046067131320972, -0.10878496674658755, 1.0839657032274013, -0.03270509206476779, 0.2404479436844269, -0.5184327349955205, 0.1172473203400426, 1.0201368974275566, 0.7241295648466182, 0.2640157388976414, 0.29058394388183695, 0.4311103298110941, 0.45874994425192606, 0.3151654585907764, -0.17686257515691994, -0.5298656027880508, -0.4477992325140586, 0.16362539326376457, 0.556108857902553, -0.11107601276590662, 0.002556144254103776, -0.10039862400195321, -0.09399435732534966, 0.2264092156313675, 0.9173678952756081, -0.14682927604716556, 0.2952117154764571, 0.4476949941740258, 0.09161881369608449, 1.3553689128735837, 0.2826534227285531, 0.8536243388225175, -0.18193672864887955, 0.5238506827147833, -0.24659411166833844, 0.6218123662098685, 0.16866257571351073, 0.2533302183053263, 0.5809985560152777, 0.46680333927025597, 1.2091941262179629, -0.10652553145386423, 0.10904346033807433, 0.7548951597632036, 0.1772503604325837, 0.06239873252990047, 0.055829345970224376, 0.28262102461759975, 0.49939086778731845, 0.9383393382251877, 0.9070101262715677, 0.8330366392023703, 0.7477400866325934, 1.8637262900682683], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2472500532648426, "mean_inference_ms": 1.2956142032740776, "mean_action_processing_ms": 0.05451493750158903, "mean_env_wait_ms": 1.2563411912489661, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 239400, "timers": {"sample_time_ms": 1849.081, "sample_throughput": 6165.225, "learn_time_ms": 3174.479, "learn_throughput": 3591.14, "update_time_ms": 3.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.03125, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.004040883802291419, "policy_loss": -0.002854169925881757, "vf_loss": 0.0067640846077766685, "vf_explained_var": 0.8594440817832947, "kl": 0.004190968277139796, "entropy": -3.4037500619888306, "entropy_coeff": 0.0}}, "num_steps_sampled": 239400, "num_steps_trained": 239400}, "done": false, "episodes_total": 228, "training_iteration": 21, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-50-15", "timestamp": 1617634215, "time_this_iter_s": 5.034275531768799, "time_total_s": 97.76840305328369, "pid": 2521, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 45.30233860015869, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.271428571428565, "ram_util_percent": 62.10000000000001}, "trial_id": "315ff_00002"}
{"episode_reward_max": 3.1586053192318717, "episode_reward_min": -0.5298656027880508, "episode_reward_mean": 0.5640462414798502, "episode_len_mean": 1000.0, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.22039306525819113, 0.8871319290110933, 1.0373529602108538, 0.9441451242779637, 1.5098208659294392, 3.1586053192318717, 0.42648895583407986, 1.0306083089632665, 0.7833946718760925, 1.002954481660066, 2.388817344961773, 0.2980823181916701, 0.6597943802789548, 1.0015748774105244, 0.3301213080537708, 1.1676326828758046, 0.8033307880412723, 0.6512630841110252, 1.1897052145556328, -0.35195137510268515, -0.07590371504736215, 0.4194343625836987, -0.19028405752462674, 0.6888877664556872, 1.3053313255446581, 0.18772618517805317, 0.47795082842015235, 0.14046067131320972, -0.10878496674658755, 1.0839657032274013, -0.03270509206476779, 0.2404479436844269, -0.5184327349955205, 0.1172473203400426, 1.0201368974275566, 0.7241295648466182, 0.2640157388976414, 0.29058394388183695, 0.4311103298110941, 0.45874994425192606, 0.3151654585907764, -0.17686257515691994, -0.5298656027880508, -0.4477992325140586, 0.16362539326376457, 0.556108857902553, -0.11107601276590662, 0.002556144254103776, -0.10039862400195321, -0.09399435732534966, 0.2264092156313675, 0.9173678952756081, -0.14682927604716556, 0.2952117154764571, 0.4476949941740258, 0.09161881369608449, 1.3553689128735837, 0.2826534227285531, 0.8536243388225175, -0.18193672864887955, 0.5238506827147833, -0.24659411166833844, 0.6218123662098685, 0.16866257571351073, 0.2533302183053263, 0.5809985560152777, 0.46680333927025597, 1.2091941262179629, -0.10652553145386423, 0.10904346033807433, 0.7548951597632036, 0.1772503604325837, 0.06239873252990047, 0.055829345970224376, 0.28262102461759975, 0.49939086778731845, 0.9383393382251877, 0.9070101262715677, 0.8330366392023703, 0.7477400866325934, 1.8637262900682683, 0.2314560725202639, 0.7433095803904959, 0.8644586892591501, 0.4294672813905227, 0.7225054985646548, 0.4163799429811459, 1.9092812291523122, 0.06441678312723087, 0.6533570850448511, 0.20499546237392874, 0.9733781398801085, 0.16057289934017227, 1.8041529059480679, 1.5761291117888985, 0.9727364561572303, 2.381385496933891, 0.694346381053194, 0.26776448761805494, 0.8497399727402568], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2507007848636072, "mean_inference_ms": 1.3074658617927646, "mean_action_processing_ms": 0.054583972937502896, "mean_env_wait_ms": 1.2467297260748482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 19, "timesteps_total": 250800, "timers": {"sample_time_ms": 1854.853, "sample_throughput": 6146.04, "learn_time_ms": 3175.975, "learn_throughput": 3589.449, "update_time_ms": 3.524}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.015625, "cur_lr": 1.0376475996914016e-05, "total_loss": 0.007628161553293466, "policy_loss": -0.004001925285491679, "vf_loss": 0.011555940901032753, "vf_explained_var": 0.7937409281730652, "kl": 0.004745481406441993, "entropy": -3.434436255031162, "entropy_coeff": 0.0}}, "num_steps_sampled": 250800, "num_steps_trained": 250800}, "done": false, "episodes_total": 247, "training_iteration": 22, "experiment_id": "a3343f52753b445fbacea970cfbc8897", "date": "2021-04-05_07-50-21", "timestamp": 1617634221, "time_this_iter_s": 5.105639457702637, "time_total_s": 102.87404251098633, "pid": 2521, "hostname": "5e08ae53878a", "node_ip": "172.17.0.3", "config": {"num_workers": 19, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 9664, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "reallocate", "custom_model_config": {"num_assets": 4}, "custom_action_dist": "dirichlet", "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "TradingEnv", "env_config": {"total_steps": 1000, "num_assets": 4, "commission": 0.001, "time_cost": 0, "window_size": 15, "min_periods": 150}, "render_env": false, "record_env": false, "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1.0376475996914016e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 0.9844823477380924, "kl_coeff": 1.0, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.34370756907049715, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 50.40797805786133, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 36.375, "ram_util_percent": 62.0375}, "trial_id": "315ff_00002"}
